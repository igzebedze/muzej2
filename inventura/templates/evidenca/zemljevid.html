{% extends "app.html" %}
{% load smart_if %}
{% load static %}

{% block menu %}
<ul>
    <li><a href="/evidenca/">Seznam</a></li>
    <li class="selected"><a href="/evidenca/zemljevid/">Zemljevid</a></li>
    <li><a href="/evidenca/oprojektu/">O projektu</a></li>
</ul>
{% endblock %}

{% block head %}
<script src="https://cdn.maptiler.com/maplibre-gl-js/v2.4.0/maplibre-gl.js"></script>
<link href="https://cdn.maptiler.com/maplibre-gl-js/v2.4.0/maplibre-gl.css" rel="stylesheet" />
{% endblock %}

{% block content %}
<div class="app">
        <h1>Prvi raƒçunalniki v Sloveniji: <span id='year'>1972</span></h1>
        <div id="map">
            <!-- iframe width="100%" height="800" src="https://api.maptiler.com/maps/64168023-8d71-4171-862a-662b76857020/?key=ct9mAzrnD0WFczmLJ24B#7.5/46.22656/14.93719"></iframe -->
        </div>    
        <div id="slider">
            <input class="slider" type="range" min="1945" max="1990" step="1" value="1972" id="myslider" />
        </div>
        <!-- script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script -->
        <script>
            const key = 'ct9mAzrnD0WFczmLJ24B';
            const map = new maplibregl.Map({
              container: 'map', // container id
              style: 'https://api.maptiler.com/maps/56ec32c0-2e07-4dc9-93f6-159032e89cc6/style.json?key=ct9mAzrnD0WFczmLJ24B', // style URL
              center: [14.93719, 46.22656], // starting position [lng, lat]
              zoom: 8, // starting zoom/
            });

            function filterBy(year) {
                var filters = ['<=', "leto", parseInt(year)];
                map.setFilter('blobs', filters);
                map.setFilter('racunalniki', filters);
                document.getElementById('year').textContent = year;
            }

            map.on('load', function () {
                //console.log(map.getStyle().layers);
                filterBy(1972);
            });

            document.getElementById('slider').addEventListener('input', function (e) {
                var year = e.target.value;
                filterBy(year);
            });
        </script>  
</div>
{% endblock %}