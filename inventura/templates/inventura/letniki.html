{% load static %}
<!doctype html>
<html lang="en" class="no-js  " >
<head>
    <style>
        .box { width: 120px; float: left; padding: 10px;  }
        .box img { box-shadow: 4px 4px black; }
        h1, h2, hr { clear: both; }
        #sidebar { width: 10%; position: fixed; top: 0px; background-color: bisque;}
        #content { width: 90%; margin-left: 12%; margin-top: 120px; }
        .nav { list-style-type: none; }
        .nav li { float: left; padding: 10px; }
        #top { position: fixed; width: 90%; top: 0px; margin-left: 10%;  background-color: bisque; }
        #search { float: right; margin-right: 2em; }
    </style>
    <meta charset="utf-8">
    <title>Revije v knjižnici računalniškega muzeja</title>
</head>
<body>
    <div id="sidebar">
        <ul>
            {% regroup object_list|dictsort:"leto" by leto as newlist %}
            {% for title in newlist %}
            <li><a href="#{{ title.grouper }}">{{ title.grouper }}</a> ({{ title.list|length }})</li>
            {% endfor %}
        </ul>    
    </div>
    <div id="top">
        <h1>Arhiv tiskovin računalniškega muzeja
            <span id="search">
                <form method="get" action="/revije/" class="form" role="form">
                    {{ form.non_field_errors }}
                    <input type="search" name="q" value="{% if query %}{{ query }}{% endif %}" id="id_q">
                    <input type="submit" class="btn btn-primary" value="Iskanje">
                </form>
            </span>
        </h1>
        {% regroup object_list by eksponat as revije %}
        <ul class="nav">
            {% for revija in revije %}<li><a href="#{{ revija.grouper.id }}" revija="{{ revija.grouper }}">{{ revija.grouper }}</a> ({{ revija.list|length }})</li>{% endfor %}
        </ul>    
    </div>
    <div id="content">
    {% for year in newlist %}
    <a name='{{ year.grouper }}'></a>
    <h1>{{ year.grouper }}</h1>
        {% regroup year.list|dictsort:"leto" by eksponat as letniki %}
        {% for leto in letniki %}

        <div class="{{ leto.grouper }}">
        <h2>{{ leto.grouper }}</h2>
        {% for object in leto.list|dictsort:"datum" %}
        <div class="box {{ object.eksponat.id }}" revija="{{ object.eksponat.ime }}">
            {% if user.is_authenticated %}
            <a target="_blank" href="{{ object.get_absolute_url }}"><img src="{{ object.get_cover_image }}" /></a>
            {% elif object.dovoljenje %}
            <a target="_blank" href="{{ object.get_absolute_url }}"><img src="{{ object.get_cover_image }}" /></a>
            {% else %}
            <a target="_blank" href="{{ object.eksponat.uradnastran }}"><img src="{{ object.get_cover_image }}" /></a>
            {% endif %}
            {% if object.datum %}<p>{{ object.datum|date:"E Y" }}</p>
            {% else %}<p>{{ object.mesec}} - {{ object.leto }}</p>{% endif %}
            <p>{{ object.pages }} strani</p>
        </div>
        {% endfor %}
        </div>
        {% endfor %}
        <hr />
    {% endfor %}
    </div>
</body>
</html>