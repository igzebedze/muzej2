/* auto generated by editiondigital :: 2022-05-12 12:38:48 GMT+0  fmdf-1uge51gs6au9y */
window.createPageMeta=function(){window.pageMeta=new Array();var currentSection='';var currentPageIndex=0;for(var d in window.eddata.pages)
{if(window.eddata.pages[d].mob_page_id>0)
{var tmpobjMobile=window.eddata.pages_mobile[window.eddata.pages[d].mob_page_id];var tmpobj=window.eddata.pages[d];if((window.eddata.pages[d].mob_page_id>0)&&(window.eddata.pages[d].mob_page_id!=currentSection))
{currentPageIndex++;currentSection=window.eddata.pages[d].mob_page_id;var urlToPut=tmpobjMobile.mobile_url;var contentHTML='';var additionalsefs=new Array();var sefforpagetohave=tmpobj.sef;if(typeof(tmpobjMobile.mobile_sef)!='undefined')
{if(tmpobjMobile.mobile_sef!='')
{additionalsefs.push(tmpobj.sef);for(var d in tmpobj.additional_sef)
{additionalsefs.push(tmpobj.additional_sef[d]);}
sefforpagetohave=tmpobjMobile.mobile_sef;}}
if((typeof(tmpobjMobile.mobile_url)=='undefined')&&(typeof(tmpobjMobile.mobile_content)!='undefined'))
{urlToPut='';contentHTML=tmpobjMobile.mobile_content;}
var inx=window.pageMeta.push({pageid:tmpobj.id,hash:sefforpagetohave,additionalhash:additionalsefs,mobilepageid:currentSection,pagenumber:currentPageIndex,title:tmpobjMobile.mobile_titile,url:urlToPut,script:'',style:'',eddataIndex:d})
if(contentHTML!='')
{window.pageMeta[inx-1].content=contentHTML;}}}}}
window.mobile_external_link_event=function(wichlink,src,texttoadd){var category='External';if(src.toLowerCase().indexOf('mailto')>-1)
{category='Email';src=src.toLowerCase().replace('mailto:','');}
if($(wichlink).text()=='')
{var text=src.toLowerCase().replace('http://','').replace('https://','');if(text.indexOf('?')>0)
{var arr=text.split('?');text=arr[0];}
if(text.indexOf('/')>0)
{var arr=text.split('/');text=arr[0];}}
else
{var text=$(wichlink).text();}
if(typeof(texttoadd)!='undefined')
{if(texttoadd!='')
{text=texttoadd;}}
window.sendInteractiveStats('Link',category,window.CitadelaPlayer.pageMeta.pageid,text,src,0);};window.sendStatsScrollTrack=function(action,label,pageid){try
{var Category='Article';var statDataObj={category:Category,page_id:-1,label:'',label2:'',value:0};statDataObj.page_id=pageid;statDataObj.action=action;statDataObj.label=label;statDataObj.label2='';statDataObj.value=parseInt(label);window.stats.event(Category,action,statDataObj,-1);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 28; column: 417;  :: '+v);console.log("Invalid request statistics -> "+e.message);}}
window.sendInteractiveStats=function(Category,action,page_id,label,label2,value,percent,edition_obj_id,duration,image_id,imagename,is_mobile){try
{var statDataObj={category:Category,page_id:-1,label:'',label2:'',value:0};statDataObj.page_id=page_id;statDataObj.action=action;statDataObj.label=label;statDataObj.label2=label2;statDataObj.value=value;var puttomainobjedition_obj_id=0;if((typeof(imageid)=='undefined')||(imageid==null))
{imageid=-1;}
if(typeof(imagename)!='undefined')
{if(imagename!=null)
{if(imagename!='')
{statDataObj.image=imagename;}}}
if(typeof(image_id)!='undefined')
{if(image_id!=null)
{if(image_id!='')
{if(parseInt(image_id)>0)
{statDataObj.image_id=parseInt(image_id);}}}}
if(typeof(percent)!='undefined')
{statDataObj.percent=percent;}
if(typeof(edition_obj_id)!='undefined')
{statDataObj.edition_object_id=edition_obj_id;puttomainobjedition_obj_id=edition_obj_id;}
if(typeof(duration)!='undefined')
{if(duration!=null)
{if(duration>-1)
{statDataObj.duration=duration;}}}
if(is_mobile!==undefined){statDataObj.mobile=is_mobile;}
window.stats.event(Category,action,statDataObj,puttomainobjedition_obj_id);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 50; column: 210;  :: '+v);console.log("Invalid request statistics -> "+e.message);}}
window.applayEditionAppearance=function(){if(!window.eddata||!eddata.appearance){return;}
if(typeof(window.eddata.appearance.loader_logo_img)!='undefined')
{$('.edition-loader-middle').css({'background-image':'url(\''+window.eddata.appearance.loader_logo_img+'\')'});}};window.handleResizeEvent=function(event){if(window.ed_gallery&&ed_gallery.isFullScreenGallery())
{ed_gallery.fscResizeHandle();}};window.setScrollTimeoutEventsScroll=function(){}
mobile_scroll_firt_time_ready=false;window.mobileInit=function(){window.trackedscroll30=false;window.trackedscroll60=false;window.trackedscroll100=false;window.trackscrollstats=true;window.trasckingscrollenabled=false;var addclassloading='';if(window.initer.isArticle)
{window.trackscrollstats=true;$('#edition-player').css({'top':'0px'});$('#edition-toolbar').addClass('tlbar_edition_article');};if(window.trackscrollstats)
{window.trackedscroll30=false;window.trackedscroll60=false;window.trackedscroll100=false;$(document).scroll(function(evt){window.CitadelaPlayer.onMainWindowsScroll(evt);window.setScrollTimeoutEventsScroll();});}
if((window.edgl.preview_mode==1)&&(!window.initer.isTouchDevice))
{addclassloading='';if((window.initer.isArticle)||(window.initer.simulateArticleView))
{if((window.initer.isArticle)&&(window.edgl.argo.indexOf('*sim_')>0))
{$('#edition-bg').addClass('mobilerelative').addClass('mobilemax');}}
else
{$('#edition-bg').addClass('mobilerelative').addClass('mobilemax');$('#edition-toolbar').addClass('mobilemax');$('edition-layer .panel').addClass('mobilemax');}
if(window.edgl.argo.indexOf('*sim_')>0)
{try
{var arr=window.edgl.argo.split('*sim_');var arrsize=arr[1].split('_');var width=arrsize[1];var height=arrsize[2].split('*')[0];if((!isNaN(width))&&(!isNaN(height)))
{width=parseInt(width)-1;var widthwithscrollbar=parseInt(width)+14;$('#edition-bg').css({'overflow':'hidden','overflow-x':'hidden','overflow-y':'scroll'});$('.edition-layer .panel').each(function(){this.style.setProperty('max-width',width.toString()+'px','important');this.style.setProperty('max-height',height.toString()+'px','important');});$('#edition-toolbar').each(function(){this.style.setProperty('max-width',width.toString()+'px','important');this.style.setProperty('max-height',height.toString()+'px','important');this.style.setProperty('margin-top','-'+Math.round((height/2)-15).toString()+'px','important');this.style.setProperty('top','50%','important');this.style.setProperty('overflow','hidden');});$('#edition-layers').each(function(){this.style.setProperty('max-width',width.toString()+'px','important');this.style.setProperty('max-width',width.toString()+'px','important');this.style.setProperty('max-height',height.toString()+'px','important');this.style.setProperty('margin-top','-'+Math.round((height/2)-15).toString()+'px','important');this.style.setProperty('top','50%','important');this.style.setProperty('left','auto','important');this.style.setProperty('right','auto','important');this.style.setProperty('overflow','hidden','important');});$('#edition-bg').each(function(){this.style.setProperty('max-width',widthwithscrollbar.toString()+'px','important');this.style.setProperty('max-height',height.toString()+'px','important');this.style.setProperty('margin-top','-'+Math.round((height/2)).toString()+'px','important');this.style.setProperty('top','50%','important');this.style.setProperty('border','15px solid rgb(100,100,100)','important');this.style.setProperty('border-radius','10px','important');});}
else
{$('#edition-player').addClass('mobilerelativebordersnonvisible');$('#edition-toolbar').addClass('mobilerelativeborders');$('#edition-toolbar').addClass('mobilemax');$('edition-layer .panel').addClass('mobilemax');}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 69; column: 350;  :: '+v);}}}
$(document).on("edResize",function(event){window.handleResizeEvent(event);});createPageMeta();if(typeof(window.eddata.edition_templates_css)=='undefined')
{if(typeof(window.eddata.mobile_css)!='undefined')
{if(window.eddata.mobile_css!='')
{var head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=window.eddata.mobile_css;}else{style.appendChild(document.createTextNode(window.eddata.mobile_css));}
head.appendChild(style);}}}
if(typeof(window.eddata.edition_templates_css)!='undefined')
{if(window.eddata.edition_templates_css!='')
{var head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=window.eddata.edition_templates_css;}else{style.appendChild(document.createTextNode(window.eddata.edition_templates_css));}
head.appendChild(style);}}
var addHTML='';addHTML+='<div id="content"></div>';addHTML+='<div id="navigation-arrows">';addHTML+='<div class="ed-arrow-left arrow-left-mobile"><div class="ed-arrow-ico-big"><div class="inner-arrow-icon ed-ico-left"></div></div></div>';addHTML+='<div class="ed-arrow-right arrow-right-mobile"><div class="ed-arrow-ico-big"><div class="inner-arrow-icon ed-ico-right"></div></div></div>';addHTML+='</div>';var loadingaddHTML='';loadingaddHTML+='<div id="loading" class="'+addclassloading+'">';loadingaddHTML+='<div class="edition-loader-middle LoadingMenu NoSelect clickthrough gpuAcc edition-spinner-loading">';loadingaddHTML+='<span class="edition-spinner-logo NoSelect clickthrough "></span>';loadingaddHTML+='<span class="spinner1 edition-spinner-circle NoSelect clickthrough "></span>';loadingaddHTML+='<span class="spinner2 edition-spinner-circle NoSelect clickthrough "></span>';loadingaddHTML+='<span class="spinner3 edition-spinner-circle NoSelect clickthrough "></span>';loadingaddHTML+='</div></div>';$('#loading').remove();$('#navigation-arrows').remove();if(window.eddata.appearance){$('#edition-player').css({'background-color':window.eddata.appearance.background_color_mobile});}
if(!window.edgl.edition_article_static_html){$('#edition-player').html(addHTML);$('#edition-bg').append(loadingaddHTML);}
$('#loading').css({'z-index':2});window.applayEditionAppearance();window.CitadelaPlayer=new window.CitadelaPlayer();window.citadela=window.citadela||{};window.citadela.navigation=new CNavigation();if(isApp()){setInterval(function(){if(mobile_scroll_firt_time_ready){var last_visited_page_ed="last_visited_page_mobile_ed"+window.edgl.edition.id;try
{var lvp=localStorage.getItem(last_visited_page_ed);if(lvp=='undefined'){lvp='';}
if(lvp){var arr_p=lvp.split('|');var lhash=arr_p[0];var lpos=0;if(arr_p.length>=2){lpos=parseInt(arr_p[1],10);}
var hash=location.hash.replace(/\#!/g,'').replace(/\#/g,'');if(hash==lhash){try
{var pos=$(window).scrollTop();if(lpos!=pos){localStorage.setItem(last_visited_page_ed,lhash+"|"+pos);}}catch(e){}}}}catch(e){}}},1500);}
window.initer.showPlayerAndRemoveIntro();}
window.mobile=new Object();window.mobile.api=function(actions,targets,params){ed_atp(actions,targets,params);}
;
/*! Hammer.JS - v2.0.8 - 2016-04-23
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
 
 // 14.10.2019 ===  Hammer.JS - v2.0.4 - 2014-09-28 ---> Hammer.JS - v2.0.8 - 2016-04-23
 
 try{  /* try catch for - IE8 is not supported - 23.7.2015 - by editiondigital */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],e=c?c+f:b,e in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b,c=a.options.inputClass;return new(b=c?c:xa?M:ya?P:wa?R:L)(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e===0,g=b&(Ga|Ha)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?0>a?Ja:Ka:0>b?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(db>=f&&db>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=c?a.CSS.supports("touch-action",d):!0}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?"cancel":a&qb?"end":a&pb?"move":a&ob?"start":""}function $(a){return a==Ma?"down":a==La?"up":a==Ja?"left":a==Ka?"right":""}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=["","webkit","Moz","MS","ms","o"],na=b.createElement("div"),oa="function",pa=Math.round,qa=Math.abs,ra=Date.now;la="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),ta=h(function(a,b){return sa(a,b,!0)},"merge","Use `assign`."),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa="ontouchstart"in a,xa=false/* disable pointerevents editiondigital */,ya=wa&&va.test(navigator.userAgent),za="touch",Aa="pen",Ba="mouse",Ca="kinect",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=["x","y"],Ra=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta="mousedown",Ua="mousemove mouseup";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa="pointerdown",Ya="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xa="MSPointerDown",Ya="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,"pointerId");e&Ea&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a="touchstart",_a="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,"touchAction"),fb=eb!==d,gb="compute",hb="auto",ib="manipulation",jb="none",kb="pan-x",lb="pan-y",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;qb>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=tb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),void(this.state&(ob|pb|qb|sb)&&this.tryEmit(b))):(this.reset(),void(this.state=tb))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:0>f?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:0>g?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.8",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:Na}],[ba,{direction:Na},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ub=1,vb=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?vb:ub},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===vb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u});var wb="undefined"!=typeof a?a:"undefined"!=typeof self?self:{};wb.Hammer=ha,"function"==typeof define&&define.amd?define(function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,"Hammer");
} catch(err) { /*console.log('Handled Hammer.js ERROR : ' + err.message)*/ }
//# source-Mapping-URL=hammer.min.js.map
;
/*! VelocityJS.org (1.2.2). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License */
/*! VelocityJS.org jQuery Shim (1.0.1). (C) 2014 The jQuery Foundation. MIT @license: en.wikipedia.org/wiki/MIT_License. */
!function(e){function t(e){var t=e.length,r=$.type(e);return"function"===r||$.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e}if(!e.jQuery){var $=function(e,t){return new $.fn.init(e,t)};$.isWindow=function(e){return null!=e&&e==e.window},$.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?a[o.call(e)]||"object":typeof e},$.isArray=Array.isArray||function(e){return"array"===$.type(e)},$.isPlainObject=function(e){var t;if(!e||"object"!==$.type(e)||e.nodeType||$.isWindow(e))return!1;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(t in e);return void 0===t||n.call(e,t)},$.each=function(e,r,a){var n,o=0,i=e.length,s=t(e);if(a){if(s)for(;i>o&&(n=r.apply(e[o],a),n!==!1);o++);else for(o in e)if(n=r.apply(e[o],a),n===!1)break}else if(s)for(;i>o&&(n=r.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=r.call(e[o],o,e[o]),n===!1)break;return e},$.data=function(e,t,a){if(void 0===a){var n=e[$.expando],o=n&&r[n];if(void 0===t)return o;if(o&&t in o)return o[t]}else if(void 0!==t){var n=e[$.expando]||(e[$.expando]=++$.uuid);return r[n]=r[n]||{},r[n][t]=a,a}},$.removeData=function(e,t){var a=e[$.expando],n=a&&r[a];n&&$.each(t,function(e,t){delete n[t]})},$.extend=function(){var e,t,r,a,n,o,i=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof i&&(u=i,i=arguments[s]||{},s++),"object"!=typeof i&&"function"!==$.type(i)&&(i={}),s===l&&(i=this,s--);l>s;s++)if(null!=(n=arguments[s]))for(a in n)e=i[a],r=n[a],i!==r&&(u&&r&&($.isPlainObject(r)||(t=$.isArray(r)))?(t?(t=!1,o=e&&$.isArray(e)?e:[]):o=e&&$.isPlainObject(e)?e:{},i[a]=$.extend(u,o,r)):void 0!==r&&(i[a]=r));return i},$.queue=function(e,r,a){function n(e,r){var a=r||[];return null!=e&&(t(Object(e))?!function(e,t){for(var r=+t.length,a=0,n=e.length;r>a;)e[n++]=t[a++];if(r!==r)for(;void 0!==t[a];)e[n++]=t[a++];return e.length=n,e}(a,"string"==typeof e?[e]:e):[].push.call(a,e)),a}if(e){r=(r||"fx")+"queue";var o=$.data(e,r);return a?(!o||$.isArray(a)?o=$.data(e,r,n(a)):o.push(a),o):o||[]}},$.dequeue=function(e,t){$.each(e.nodeType?[e]:e,function(e,r){t=t||"fx";var a=$.queue(r,t),n=a.shift();"inprogress"===n&&(n=a.shift()),n&&("fx"===t&&a.unshift("inprogress"),n.call(r,function(){$.dequeue(r,t)}))})},$.fn=$.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}var t=this[0],e=e.apply(t),r=this.offset(),a=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:$(e).offset();return r.top-=parseFloat(t.style.marginTop)||0,r.left-=parseFloat(t.style.marginLeft)||0,e.style&&(a.top+=parseFloat(e.style.borderTopWidth)||0,a.left+=parseFloat(e.style.borderLeftWidth)||0),{top:r.top-a.top,left:r.left-a.left}}};var r={};$.expando="velocity"+(new Date).getTime(),$.uuid=0;for(var a={},n=a.hasOwnProperty,o=a.toString,i="Boolean Number String Function Array Date RegExp Object Error".split(" "),s=0;s<i.length;s++)a["[object "+i[s]+"]"]=i[s].toLowerCase();$.fn.init.prototype=$.fn,e.Velocity={Utilities:$}}}(window),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){return function(e,t,r,a){function n(e){for(var t=-1,r=e?e.length:0,a=[];++t<r;){var n=e[t];n&&a.push(n)}return a}function o(e){return g.isWrapped(e)?e=[].slice.call(e):g.isNode(e)&&(e=[e]),e}function i(e){var t=$.data(e,"velocity");return null===t?a:t}function s(e){return function(t){return Math.round(t*e)*(1/e)}}function l(e,r,a,n){function o(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function s(e){return 3*e}function l(e,t,r){return((o(t,r)*e+i(t,r))*e+s(t))*e}function u(e,t,r){return 3*o(t,r)*e*e+2*i(t,r)*e+s(t)}function c(t,r){for(var n=0;m>n;++n){var o=u(r,e,a);if(0===o)return r;var i=l(r,e,a)-t;r-=i/o}return r}function p(){for(var t=0;b>t;++t)w[t]=l(t*x,e,a)}function f(t,r,n){var o,i,s=0;do i=r+(n-r)/2,o=l(i,e,a)-t,o>0?n=i:r=i;while(Math.abs(o)>h&&++s<v);return i}function d(t){for(var r=0,n=1,o=b-1;n!=o&&w[n]<=t;++n)r+=x;--n;var i=(t-w[n])/(w[n+1]-w[n]),s=r+i*x,l=u(s,e,a);return l>=y?c(t,s):0==l?s:f(t,r,r+x)}function g(){V=!0,(e!=r||a!=n)&&p()}var m=4,y=.001,h=1e-7,v=10,b=11,x=1/(b-1),S="Float32Array"in t;if(4!==arguments.length)return!1;for(var P=0;4>P;++P)if("number"!=typeof arguments[P]||isNaN(arguments[P])||!isFinite(arguments[P]))return!1;e=Math.min(e,1),a=Math.min(a,1),e=Math.max(e,0),a=Math.max(a,0);var w=S?new Float32Array(b):new Array(b),V=!1,C=function(t){return V||g(),e===r&&a===n?t:0===t?0:1===t?1:l(d(t),r,n)};C.getControlPoints=function(){return[{x:e,y:r},{x:a,y:n}]};var T="generateBezier("+[e,r,a,n]+")";return C.toString=function(){return T},C}function u(e,t){var r=e;return g.isString(e)?v.Easings[e]||(r=!1):r=g.isArray(e)&&1===e.length?s.apply(null,e):g.isArray(e)&&2===e.length?b.apply(null,e.concat([t])):g.isArray(e)&&4===e.length?l.apply(null,e):!1,r===!1&&(r=v.Easings[v.defaults.easing]?v.defaults.easing:h),r}function c(e){if(e){var t=(new Date).getTime(),r=v.State.calls.length;r>1e4&&(v.State.calls=n(v.State.calls));for(var o=0;r>o;o++)if(v.State.calls[o]){var s=v.State.calls[o],l=s[0],u=s[2],f=s[3],d=!!f,m=null;f||(f=v.State.calls[o][3]=t-16);for(var y=Math.min((t-f)/u.duration,1),h=0,b=l.length;b>h;h++){var S=l[h],w=S.element;if(i(w)){var V=!1;if(u.display!==a&&null!==u.display&&"none"!==u.display){if("flex"===u.display){var C=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];$.each(C,function(e,t){x.setPropertyValue(w,"display",t)})}x.setPropertyValue(w,"display",u.display)}u.visibility!==a&&"hidden"!==u.visibility&&x.setPropertyValue(w,"visibility",u.visibility);for(var T in S)if("element"!==T){var k=S[T],A,F=g.isString(k.easing)?v.Easings[k.easing]:k.easing;if(1===y)A=k.endValue;else{var E=k.endValue-k.startValue;if(A=k.startValue+E*F(y,u,E),!d&&A===k.currentValue)continue}if(k.currentValue=A,"tween"===T)m=A;else{if(x.Hooks.registered[T]){var j=x.Hooks.getRoot(T),H=i(w).rootPropertyValueCache[j];H&&(k.rootPropertyValue=H)}var N=x.setPropertyValue(w,T,k.currentValue+(0===parseFloat(A)?"":k.unitType),k.rootPropertyValue,k.scrollData);x.Hooks.registered[T]&&(i(w).rootPropertyValueCache[j]=x.Normalizations.registered[j]?x.Normalizations.registered[j]("extract",null,N[1]):N[1]),"transform"===N[0]&&(V=!0)}}u.mobileHA&&i(w).transformCache.translate3d===a&&(i(w).transformCache.translate3d="(0px, 0px, 0px)",V=!0),V&&x.flushTransformCache(w)}}u.display!==a&&"none"!==u.display&&(v.State.calls[o][2].display=!1),u.visibility!==a&&"hidden"!==u.visibility&&(v.State.calls[o][2].visibility=!1),u.progress&&u.progress.call(s[1],s[1],y,Math.max(0,f+u.duration-t),f,m),1===y&&p(o)}}v.State.isTicking&&P(c)}function p(e,t){if(!v.State.calls[e])return!1;for(var r=v.State.calls[e][0],n=v.State.calls[e][1],o=v.State.calls[e][2],s=v.State.calls[e][4],l=!1,u=0,c=r.length;c>u;u++){var p=r[u].element;if(t||o.loop||("none"===o.display&&x.setPropertyValue(p,"display",o.display),"hidden"===o.visibility&&x.setPropertyValue(p,"visibility",o.visibility)),o.loop!==!0&&($.queue(p)[1]===a||!/\.velocityQueueEntryFlag/i.test($.queue(p)[1]))&&i(p)){i(p).isAnimating=!1,i(p).rootPropertyValueCache={};var f=!1;$.each(x.Lists.transforms3D,function(e,t){var r=/^scale/.test(t)?1:0,n=i(p).transformCache[t];i(p).transformCache[t]!==a&&new RegExp("^\\("+r+"[^.]").test(n)&&(f=!0,delete i(p).transformCache[t])}),o.mobileHA&&(f=!0,delete i(p).transformCache.translate3d),f&&x.flushTransformCache(p),x.Values.removeClass(p,"velocity-animating")}if(!t&&o.complete&&!o.loop&&u===c-1)try{o.complete.call(n,n)}catch(d){setTimeout(function(){throw d},1)}s&&o.loop!==!0&&s(n),i(p)&&o.loop===!0&&!t&&($.each(i(p).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),v(p,"reverse",{loop:!0,delay:o.delay})),o.queue!==!1&&$.dequeue(p,o.queue)}v.State.calls[e]=!1;for(var g=0,m=v.State.calls.length;m>g;g++)if(v.State.calls[g]!==!1){l=!0;break}l===!1&&(v.State.isTicking=!1,delete v.State.calls,v.State.calls=[])}var f=function(){if(r.documentMode)return r.documentMode;for(var e=7;e>4;e--){var t=r.createElement("div");if(t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->",t.getElementsByTagName("span").length)return t=null,e}return a}(),d=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var r=(new Date).getTime(),a;return a=Math.max(0,16-(r-e)),e=r+a,setTimeout(function(){t(r+a)},a)}}(),g={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==a&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},$,m=!1;if(e.fn&&e.fn.jquery?($=e,m=!0):$=t.Velocity.Utilities,8>=f&&!m)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=f)return void(jQuery.fn.velocity=jQuery.fn.animate);var y=400,h="swing",v={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:r.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:$,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:y,easing:h,begin:a,complete:a,progress:a,display:a,visibility:a,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){$.data(e,"velocity",{isSVG:g.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==a?(v.State.scrollAnchor=t,v.State.scrollPropertyLeft="pageXOffset",v.State.scrollPropertyTop="pageYOffset"):(v.State.scrollAnchor=r.documentElement||r.body.parentNode||r.body,v.State.scrollPropertyLeft="scrollLeft",v.State.scrollPropertyTop="scrollTop");var b=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,r,a){var n={x:t.x+a.dx*r,v:t.v+a.dv*r,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}function r(r,a){var n={dx:r.v,dv:e(r)},o=t(r,.5*a,n),i=t(r,.5*a,o),s=t(r,a,i),l=1/6*(n.dx+2*(o.dx+i.dx)+s.dx),u=1/6*(n.dv+2*(o.dv+i.dv)+s.dv);return r.x=r.x+l*a,r.v=r.v+u*a,r}return function a(e,t,n){var o={x:-1,v:0,tension:null,friction:null},i=[0],s=0,l=1e-4,u=.016,c,p,f;for(e=parseFloat(e)||500,t=parseFloat(t)||20,n=n||null,o.tension=e,o.friction=t,c=null!==n,c?(s=a(e,t),p=s/n*u):p=u;;)if(f=r(f||o,p),i.push(1+f.x),s+=16,!(Math.abs(f.x)>l&&Math.abs(f.v)>l))break;return c?function(e){return i[e*(i.length-1)|0]}:s}}();v.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},$.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){v.Easings[t[0]]=l.apply(null,t[1])});var x=v.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<x.Lists.colors.length;e++){var t="color"===x.Lists.colors[e]?"0 0 0 1":"255 255 255 1";x.Hooks.templates[x.Lists.colors[e]]=["Red Green Blue Alpha",t]}var r,a,n;if(f)for(r in x.Hooks.templates){a=x.Hooks.templates[r],n=a[0].split(" ");var o=a[1].match(x.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),o.push(o.shift()),x.Hooks.templates[r]=[n.join(" "),o.join(" ")])}for(r in x.Hooks.templates){a=x.Hooks.templates[r],n=a[0].split(" ");for(var e in n){var i=r+n[e],s=e;x.Hooks.registered[i]=[r,s]}}},getRoot:function(e){var t=x.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return x.RegEx.valueUnwrap.test(t)&&(t=t.match(x.RegEx.valueUnwrap)[1]),x.Values.isCSSNullValue(t)&&(t=x.Hooks.templates[e][1]),t},extractValue:function(e,t){var r=x.Hooks.registered[e];if(r){var a=r[0],n=r[1];return t=x.Hooks.cleanRootPropertyValue(a,t),t.toString().match(x.RegEx.valueSplit)[n]}return t},injectValue:function(e,t,r){var a=x.Hooks.registered[e];if(a){var n=a[0],o=a[1],i,s;return r=x.Hooks.cleanRootPropertyValue(n,r),i=r.toString().match(x.RegEx.valueSplit),i[o]=t,s=i.join(" ")}return r}},Normalizations:{registered:{clip:function(e,t,r){switch(e){case"name":return"clip";case"extract":var a;return x.RegEx.wrappedValueAlreadyExtracted.test(r)?a=r:(a=r.toString().match(x.RegEx.valueUnwrap),a=a?a[1].replace(/,(\s+)?/g," "):r),a;case"inject":return"rect("+r+")"}},blur:function(e,t,r){switch(e){case"name":return v.State.isFirefox?"filter":"-webkit-filter";case"extract":var a=parseFloat(r);if(!a&&0!==a){var n=r.toString().match(/blur\(([0-9]+[A-z]+)\)/i);a=n?n[1]:0}return a;case"inject":return parseFloat(r)?"blur("+r+")":"none"}},opacity:function(e,t,r){if(8>=f)switch(e){case"name":return"filter";case"extract":var a=r.toString().match(/alpha\(opacity=(.*)\)/i);return r=a?a[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(r)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(r),10)+")"}else switch(e){case"name":return"opacity";case"extract":return r;case"inject":return r}}},register:function(){9>=f||v.State.isGingerbread||(x.Lists.transformsBase=x.Lists.transformsBase.concat(x.Lists.transforms3D));for(var e=0;e<x.Lists.transformsBase.length;e++)!function(){var t=x.Lists.transformsBase[e];x.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return"transform";case"extract":return i(r)===a||i(r).transformCache[t]===a?/^scale/i.test(t)?1:0:i(r).transformCache[t].replace(/[()]/g,"");case"inject":var o=!1;switch(t.substr(0,t.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":v.State.isAndroid&&i(r).transformCache[t]===a&&1>n&&(n=1),o=!/(\d)$/i.test(n);break;case"skew":o=!/(deg|\d)$/i.test(n);break;case"rotate":o=!/(deg|\d)$/i.test(n)}return o||(i(r).transformCache[t]="("+n+")"),i(r).transformCache[t]}}}();for(var e=0;e<x.Lists.colors.length;e++)!function(){var t=x.Lists.colors[e];x.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return t;case"extract":var o;if(x.RegEx.wrappedValueAlreadyExtracted.test(n))o=n;else{var i,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?i=s[n]!==a?s[n]:s.black:x.RegEx.isHex.test(n)?i="rgb("+x.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(i=s.black),o=(i||n).toString().match(x.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=f||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return 8>=f?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(8>=f?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(f||v.State.isAndroid&&!v.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(v.State.prefixMatches[e])return[v.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],r=0,a=t.length;a>r;r++){var n;if(n=0===r?e:t[r]+e.replace(/^\w/,function(e){return e.toUpperCase()}),g.isString(v.State.prefixElement.style[n]))return v.State.prefixMatches[e]=n,[n,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,a;return e=e.replace(t,function(e,t,r,a){return t+t+r+r+a+a}),a=r.exec(e),a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,r,n,o){function s(e,r){function n(){u&&x.setPropertyValue(e,"display","none")}var l=0;if(8>=f)l=$.css(e,r);else{var u=!1;if(/^(width|height)$/.test(r)&&0===x.getPropertyValue(e,"display")&&(u=!0,x.setPropertyValue(e,"display",x.Values.getDisplayType(e))),!o){if("height"===r&&"border-box"!==x.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var c=e.offsetHeight-(parseFloat(x.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(x.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(x.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(x.getPropertyValue(e,"paddingBottom"))||0);return n(),c}if("width"===r&&"border-box"!==x.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var p=e.offsetWidth-(parseFloat(x.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(x.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(x.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(x.getPropertyValue(e,"paddingRight"))||0);return n(),p}}var d;d=i(e)===a?t.getComputedStyle(e,null):i(e).computedStyle?i(e).computedStyle:i(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===r&&(r="borderTopColor"),l=9===f&&"filter"===r?d.getPropertyValue(r):d[r],(""===l||null===l)&&(l=e.style[r]),n()}if("auto"===l&&/^(top|right|bottom|left)$/i.test(r)){var g=s(e,"position");("fixed"===g||"absolute"===g&&/top|left/i.test(r))&&(l=$(e).position()[r]+"px")}return l}var l;if(x.Hooks.registered[r]){var u=r,c=x.Hooks.getRoot(u);n===a&&(n=x.getPropertyValue(e,x.Names.prefixCheck(c)[0])),x.Normalizations.registered[c]&&(n=x.Normalizations.registered[c]("extract",e,n)),l=x.Hooks.extractValue(u,n)}else if(x.Normalizations.registered[r]){var p,d;p=x.Normalizations.registered[r]("name",e),"transform"!==p&&(d=s(e,x.Names.prefixCheck(p)[0]),x.Values.isCSSNullValue(d)&&x.Hooks.templates[r]&&(d=x.Hooks.templates[r][1])),l=x.Normalizations.registered[r]("extract",e,d)}if(!/^[\d-]/.test(l))if(i(e)&&i(e).isSVG&&x.Names.SVGAttribute(r))if(/^(height|width)$/i.test(r))try{l=e.getBBox()[r]}catch(g){l=0}else l=e.getAttribute(r);else l=s(e,x.Names.prefixCheck(r)[0]);return x.Values.isCSSNullValue(l)&&(l=0),v.debug>=2&&console.log("Get "+r+": "+l),l},setPropertyValue:function(e,r,a,n,o){var s=r;if("scroll"===r)o.container?o.container["scroll"+o.direction]=a:"Left"===o.direction?t.scrollTo(a,o.alternateValue):t.scrollTo(o.alternateValue,a);else if(x.Normalizations.registered[r]&&"transform"===x.Normalizations.registered[r]("name",e))x.Normalizations.registered[r]("inject",e,a),s="transform",a=i(e).transformCache[r];else{if(x.Hooks.registered[r]){var l=r,u=x.Hooks.getRoot(r);n=n||x.getPropertyValue(e,u),a=x.Hooks.injectValue(l,a,n),r=u}if(x.Normalizations.registered[r]&&(a=x.Normalizations.registered[r]("inject",e,a),r=x.Normalizations.registered[r]("name",e)),s=x.Names.prefixCheck(r)[0],8>=f)try{e.style[s]=a}catch(c){v.debug&&console.log("Browser does not support ["+a+"] for ["+s+"]")}else i(e)&&i(e).isSVG&&x.Names.SVGAttribute(r)?e.setAttribute(r,a):e.style[s]=a;v.debug>=2&&console.log("Set "+r+" ("+s+"): "+a)}return[s,a]},flushTransformCache:function(e){function t(t){return parseFloat(x.getPropertyValue(e,t))}var r="";if((f||v.State.isAndroid&&!v.State.isChrome)&&i(e).isSVG){var a={translate:[t("translateX"),t("translateY")],skewX:[t("skewX")],skewY:[t("skewY")],scale:1!==t("scale")?[t("scale"),t("scale")]:[t("scaleX"),t("scaleY")],rotate:[t("rotateZ"),0,0]};$.each(i(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),a[e]&&(r+=e+"("+a[e].join(" ")+") ",delete a[e])})}else{var n,o;$.each(i(e).transformCache,function(t){return n=i(e).transformCache[t],"transformPerspective"===t?(o=n,!0):(9===f&&"rotateZ"===t&&(t="rotate"),void(r+=t+n+" "))}),o&&(r="perspective"+o+" "+r)}x.setPropertyValue(e,"transform",r)}};x.Hooks.register(),x.Normalizations.register(),v.hook=function(e,t,r){var n=a;return e=o(e),$.each(e,function(e,o){if(i(o)===a&&v.init(o),r===a)n===a&&(n=v.CSS.getPropertyValue(o,t));else{var s=v.CSS.setPropertyValue(o,t,r);"transform"===s[0]&&v.CSS.flushTransformCache(o),n=s}}),n};var S=function(){function e(){return l?T.promise||null:f}function n(){function e(e){function p(e,t){var r=a,i=a,s=a;return g.isArray(e)?(r=e[0],!g.isArray(e[1])&&/^[\d-]/.test(e[1])||g.isFunction(e[1])||x.RegEx.isHex.test(e[1])?s=e[1]:(g.isString(e[1])&&!x.RegEx.isHex.test(e[1])||g.isArray(e[1]))&&(i=t?e[1]:u(e[1],o.duration),e[2]!==a&&(s=e[2]))):r=e,t||(i=i||o.easing),g.isFunction(r)&&(r=r.call(n,w,P)),g.isFunction(s)&&(s=s.call(n,w,P)),[r||0,i,s]}function f(e,t){var r,a;return a=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return r=e,""}),r||(r=x.Values.getUnitType(e)),[a,r]}function d(){var e={myParent:n.parentNode||r.body,position:x.getPropertyValue(n,"position"),fontSize:x.getPropertyValue(n,"fontSize")},a=e.position===N.lastPosition&&e.myParent===N.lastParent,o=e.fontSize===N.lastFontSize;N.lastParent=e.myParent,N.lastPosition=e.position,N.lastFontSize=e.fontSize;var s=100,l={};if(o&&a)l.emToPx=N.lastEmToPx,l.percentToPxWidth=N.lastPercentToPxWidth,l.percentToPxHeight=N.lastPercentToPxHeight;else{var u=i(n).isSVG?r.createElementNS("http://www.w3.org/2000/svg","rect"):r.createElement("div");v.init(u),e.myParent.appendChild(u),$.each(["overflow","overflowX","overflowY"],function(e,t){v.CSS.setPropertyValue(u,t,"hidden")}),v.CSS.setPropertyValue(u,"position",e.position),v.CSS.setPropertyValue(u,"fontSize",e.fontSize),v.CSS.setPropertyValue(u,"boxSizing","content-box"),$.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){v.CSS.setPropertyValue(u,t,s+"%")}),v.CSS.setPropertyValue(u,"paddingLeft",s+"em"),l.percentToPxWidth=N.lastPercentToPxWidth=(parseFloat(x.getPropertyValue(u,"width",null,!0))||1)/s,l.percentToPxHeight=N.lastPercentToPxHeight=(parseFloat(x.getPropertyValue(u,"height",null,!0))||1)/s,l.emToPx=N.lastEmToPx=(parseFloat(x.getPropertyValue(u,"paddingLeft"))||1)/s,e.myParent.removeChild(u)}return null===N.remToPx&&(N.remToPx=parseFloat(x.getPropertyValue(r.body,"fontSize"))||16),null===N.vwToPx&&(N.vwToPx=parseFloat(t.innerWidth)/100,N.vhToPx=parseFloat(t.innerHeight)/100),l.remToPx=N.remToPx,l.vwToPx=N.vwToPx,l.vhToPx=N.vhToPx,v.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),n),l}if(o.begin&&0===w)try{o.begin.call(m,m)}catch(y){setTimeout(function(){throw y},1)}if("scroll"===k){var S=/^x$/i.test(o.axis)?"Left":"Top",V=parseFloat(o.offset)||0,C,A,F;o.container?g.isWrapped(o.container)||g.isNode(o.container)?(o.container=o.container[0]||o.container,C=o.container["scroll"+S],F=C+$(n).position()[S.toLowerCase()]+V):o.container=null:(C=v.State.scrollAnchor[v.State["scrollProperty"+S]],A=v.State.scrollAnchor[v.State["scrollProperty"+("Left"===S?"Top":"Left")]],F=$(n).offset()[S.toLowerCase()]+V),s={scroll:{rootPropertyValue:!1,startValue:C,currentValue:C,endValue:F,unitType:"",easing:o.easing,scrollData:{container:o.container,direction:S,alternateValue:A}},element:n},v.debug&&console.log("tweensContainer (scroll): ",s.scroll,n)}else if("reverse"===k){if(!i(n).tweensContainer)return void $.dequeue(n,o.queue);"none"===i(n).opts.display&&(i(n).opts.display="auto"),"hidden"===i(n).opts.visibility&&(i(n).opts.visibility="visible"),i(n).opts.loop=!1,i(n).opts.begin=null,i(n).opts.complete=null,b.easing||delete o.easing,b.duration||delete o.duration,o=$.extend({},i(n).opts,o);var E=$.extend(!0,{},i(n).tweensContainer);for(var j in E)if("element"!==j){var H=E[j].startValue;E[j].startValue=E[j].currentValue=E[j].endValue,E[j].endValue=H,g.isEmptyObject(b)||(E[j].easing=o.easing),v.debug&&console.log("reverse tweensContainer ("+j+"): "+JSON.stringify(E[j]),n)}s=E}else if("start"===k){var E;i(n).tweensContainer&&i(n).isAnimating===!0&&(E=i(n).tweensContainer),$.each(h,function(e,t){if(RegExp("^"+x.Lists.colors.join("$|^")+"$").test(e)){var r=p(t,!0),n=r[0],o=r[1],i=r[2];if(x.RegEx.isHex.test(n)){for(var s=["Red","Green","Blue"],l=x.Values.hexToRgb(n),u=i?x.Values.hexToRgb(i):a,c=0;c<s.length;c++){var f=[l[c]];o&&f.push(o),u!==a&&f.push(u[c]),h[e+s[c]]=f}delete h[e]}}});for(var R in h){var O=p(h[R]),z=O[0],q=O[1],M=O[2];R=x.Names.camelCase(R);var I=x.Hooks.getRoot(R),B=!1;if(i(n).isSVG||"tween"===I||x.Names.prefixCheck(I)[1]!==!1||x.Normalizations.registered[I]!==a){(o.display!==a&&null!==o.display&&"none"!==o.display||o.visibility!==a&&"hidden"!==o.visibility)&&/opacity|filter/.test(R)&&!M&&0!==z&&(M=0),o._cacheValues&&E&&E[R]?(M===a&&(M=E[R].endValue+E[R].unitType),B=i(n).rootPropertyValueCache[I]):x.Hooks.registered[R]?M===a?(B=x.getPropertyValue(n,I),M=x.getPropertyValue(n,R,B)):B=x.Hooks.templates[I][1]:M===a&&(M=x.getPropertyValue(n,R));var W,G,D,X=!1;if(W=f(R,M),M=W[0],D=W[1],W=f(R,z),z=W[0].replace(/^([+-\/*])=/,function(e,t){return X=t,""}),G=W[1],M=parseFloat(M)||0,z=parseFloat(z)||0,"%"===G&&(/^(fontSize|lineHeight)$/.test(R)?(z/=100,G="em"):/^scale/.test(R)?(z/=100,G=""):/(Red|Green|Blue)$/i.test(R)&&(z=z/100*255,G="")),/[\/*]/.test(X))G=D;else if(D!==G&&0!==M)if(0===z)G=D;else{l=l||d();var Y=/margin|padding|left|right|width|text|word|letter/i.test(R)||/X$/.test(R)||"x"===R?"x":"y";switch(D){case"%":M*="x"===Y?l.percentToPxWidth:l.percentToPxHeight;break;case"px":break;default:M*=l[D+"ToPx"]}switch(G){case"%":M*=1/("x"===Y?l.percentToPxWidth:l.percentToPxHeight);break;case"px":break;default:M*=1/l[G+"ToPx"]}}switch(X){case"+":z=M+z;break;case"-":z=M-z;break;case"*":z=M*z;break;case"/":z=M/z}s[R]={rootPropertyValue:B,startValue:M,currentValue:M,endValue:z,unitType:G,easing:q},v.debug&&console.log("tweensContainer ("+R+"): "+JSON.stringify(s[R]),n)}else v.debug&&console.log("Skipping ["+I+"] due to a lack of browser support.")}s.element=n}s.element&&(x.Values.addClass(n,"velocity-animating"),L.push(s),""===o.queue&&(i(n).tweensContainer=s,i(n).opts=o),i(n).isAnimating=!0,w===P-1?(v.State.calls.push([L,m,o,null,T.resolver]),v.State.isTicking===!1&&(v.State.isTicking=!0,c())):w++)}var n=this,o=$.extend({},v.defaults,b),s={},l;switch(i(n)===a&&v.init(n),parseFloat(o.delay)&&o.queue!==!1&&$.queue(n,o.queue,function(e){v.velocityQueueEntryFlag=!0,i(n).delayTimer={setTimeout:setTimeout(e,parseFloat(o.delay)),next:e}}),o.duration.toString().toLowerCase()){case"fast":o.duration=200;break;case"normal":o.duration=y;break;case"slow":o.duration=600;break;default:o.duration=parseFloat(o.duration)||1}v.mock!==!1&&(v.mock===!0?o.duration=o.delay=1:(o.duration*=parseFloat(v.mock)||1,o.delay*=parseFloat(v.mock)||1)),o.easing=u(o.easing,o.duration),o.begin&&!g.isFunction(o.begin)&&(o.begin=null),o.progress&&!g.isFunction(o.progress)&&(o.progress=null),o.complete&&!g.isFunction(o.complete)&&(o.complete=null),o.display!==a&&null!==o.display&&(o.display=o.display.toString().toLowerCase(),"auto"===o.display&&(o.display=v.CSS.Values.getDisplayType(n))),o.visibility!==a&&null!==o.visibility&&(o.visibility=o.visibility.toString().toLowerCase()),o.mobileHA=o.mobileHA&&v.State.isMobile&&!v.State.isGingerbread,o.queue===!1?o.delay?setTimeout(e,o.delay):e():$.queue(n,o.queue,function(t,r){return r===!0?(T.promise&&T.resolver(m),!0):(v.velocityQueueEntryFlag=!0,void e(t))}),""!==o.queue&&"fx"!==o.queue||"inprogress"===$.queue(n)[0]||$.dequeue(n)}var s=arguments[0]&&(arguments[0].p||$.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||g.isString(arguments[0].properties)),l,f,d,m,h,b;if(g.isWrapped(this)?(l=!1,d=0,m=this,f=this):(l=!0,d=1,m=s?arguments[0].elements||arguments[0].e:arguments[0]),m=o(m)){s?(h=arguments[0].properties||arguments[0].p,b=arguments[0].options||arguments[0].o):(h=arguments[d],b=arguments[d+1]);var P=m.length,w=0;if(!/^(stop|finish)$/i.test(h)&&!$.isPlainObject(b)){var V=d+1;b={};for(var C=V;C<arguments.length;C++)g.isArray(arguments[C])||!/^(fast|normal|slow)$/i.test(arguments[C])&&!/^\d/.test(arguments[C])?g.isString(arguments[C])||g.isArray(arguments[C])?b.easing=arguments[C]:g.isFunction(arguments[C])&&(b.complete=arguments[C]):b.duration=arguments[C]}var T={promise:null,resolver:null,rejecter:null};l&&v.Promise&&(T.promise=new v.Promise(function(e,t){T.resolver=e,T.rejecter=t}));var k;switch(h){case"scroll":k="scroll";break;case"reverse":k="reverse";break;case"finish":case"stop":$.each(m,function(e,t){i(t)&&i(t).delayTimer&&(clearTimeout(i(t).delayTimer.setTimeout),i(t).delayTimer.next&&i(t).delayTimer.next(),delete i(t).delayTimer)});var A=[];return $.each(v.State.calls,function(e,t){t&&$.each(t[1],function(r,n){var o=b===a?"":b;return o===!0||t[2].queue===o||b===a&&t[2].queue===!1?void $.each(m,function(r,a){a===n&&((b===!0||g.isString(b))&&($.each($.queue(a,g.isString(b)?b:""),function(e,t){g.isFunction(t)&&t(null,!0)}),$.queue(a,g.isString(b)?b:"",[])),"stop"===h?(i(a)&&i(a).tweensContainer&&o!==!1&&$.each(i(a).tweensContainer,function(e,t){t.endValue=t.currentValue
}),A.push(e)):"finish"===h&&(t[2].duration=1))}):!0})}),"stop"===h&&($.each(A,function(e,t){p(t,!0)}),T.promise&&T.resolver(m)),e();default:if(!$.isPlainObject(h)||g.isEmptyObject(h)){if(g.isString(h)&&v.Redirects[h]){var F=$.extend({},b),E=F.duration,j=F.delay||0;return F.backwards===!0&&(m=$.extend(!0,[],m).reverse()),$.each(m,function(e,t){parseFloat(F.stagger)?F.delay=j+parseFloat(F.stagger)*e:g.isFunction(F.stagger)&&(F.delay=j+F.stagger.call(t,e,P)),F.drag&&(F.duration=parseFloat(E)||(/^(callout|transition)/.test(h)?1e3:y),F.duration=Math.max(F.duration*(F.backwards?1-e/P:(e+1)/P),.75*F.duration,200)),v.Redirects[h].call(t,t,F||{},e,P,m,T.promise?T:a)}),e()}var H="Velocity: First argument ("+h+") was not a property map, a known action, or a registered redirect. Aborting.";return T.promise?T.rejecter(new Error(H)):console.log(H),e()}k="start"}var N={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},L=[];$.each(m,function(e,t){g.isNode(t)&&n.call(t)});var F=$.extend({},v.defaults,b),R;if(F.loop=parseInt(F.loop),R=2*F.loop-1,F.loop)for(var O=0;R>O;O++){var z={delay:F.delay,progress:F.progress};O===R-1&&(z.display=F.display,z.visibility=F.visibility,z.complete=F.complete),S(m,"reverse",z)}return e()}};v=$.extend(S,v),v.animate=S;var P=t.requestAnimationFrame||d;return v.State.isMobile||r.hidden===a||r.addEventListener("visibilitychange",function(){r.hidden?(P=function(e){return setTimeout(function(){e(!0)},16)},c()):P=t.requestAnimationFrame||d}),e.Velocity=v,e!==t&&(e.fn.velocity=S,e.fn.velocity.defaults=v.defaults),$.each(["Down","Up"],function(e,t){v.Redirects["slide"+t]=function(e,r,n,o,i,s){var l=$.extend({},r),u=l.begin,c=l.complete,p={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},f={};l.display===a&&(l.display="Down"===t?"inline"===v.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),l.begin=function(){u&&u.call(i,i);for(var r in p){f[r]=e.style[r];var a=v.CSS.getPropertyValue(e,r);p[r]="Down"===t?[a,0]:[0,a]}f.overflow=e.style.overflow,e.style.overflow="hidden"},l.complete=function(){for(var t in f)e.style[t]=f[t];c&&c.call(i,i),s&&s.resolver(i)},v(e,p,l)}}),$.each(["In","Out"],function(e,t){v.Redirects["fade"+t]=function(e,r,n,o,i,s){var l=$.extend({},r),u={opacity:"In"===t?1:0},c=l.complete;l.complete=n!==o-1?l.begin=null:function(){c&&c.call(i,i),s&&s.resolver(i)},l.display===a&&(l.display="In"===t?"auto":"none"),v(this,u,l)}}),v}(window.jQuery||window.Zepto||window,window,document)});
;
var Class=(function(){var initializing=false,ArrayProto=Array.prototype;function copy(from,to){var name;for(name in from){if(from.hasOwnProperty(name)){to[name]=from[name];}}}
function Fiber(){}
Fiber.extend=function(fn){var parent=this.prototype,properties=fn(parent),proto;function child(){if(!initializing){this.construct.apply(this,arguments);this.construct=void 0;}}
initializing=true;proto=child.prototype=new this;initializing=false;proto.construct=function(){if(typeof parent.construct==='function'){parent.construct.apply(this,arguments);}};copy(properties,proto);proto.constructor=child;child.__base__=parent;child.extend=child.prototype.extend||Class.extend;return child;};Fiber.proxy=function(base,instance){var name,iface={},wrap;if(arguments.length===1){instance=base;base=instance.constructor.__base__;}
wrap=function(fn){return function(){return base[fn].apply(instance,arguments);};};for(name in base){if(base.hasOwnProperty(name)&&typeof base[name]==='function'){iface[name]=wrap(name);}}
return iface;};Fiber.decorate=function(instance){var i,base=instance.constructor.__base__,decorators=ArrayProto.slice.call(arguments,1),len=decorators.length;for(i=0;i<len;i++){copy(decorators[i].call(instance,base),instance);}};Fiber.mixin=function(definition){var i,base=definition.__base__,mixins=ArrayProto.slice.call(arguments,1),len=mixins.length;for(i=0;i<len;i++){copy(mixins[i](base),definition.prototype);}};return Fiber;})();
;
var Network={serialize:function(data){var ret='';for(var key in data){ret+=(ret.length>0?'&':'')+key+'='+data[key];}
return ret;},get:function(url,headers,data){var deferred=new Deferred();headers=headers||{};data=data||{};var request=new XMLHttpRequest();request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){deferred.resolve(request.responseText);}else{deferred.reject(request);}}};request.open('GET',url,true);for(var key in headers)
request.setRequestHeader(key,headers[key]);request.setRequestHeader('X-Requested-With','XMLHttpRequest');request.responseType='text';request.send(Network.serialize(data));return deferred.promise();},post:function(url,headers,data){var deferred=new Deferred();headers=headers||{};data=data||{};var request=new XMLHttpRequest();request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){deferred.resolve(request.responseText);}else{deferred.reject(request);}}};request.open('POST',url,true);for(var key in headers)
request.setRequestHeader(key,headers[key]);request.setRequestHeader('X-Requested-With','XMLHttpRequest');request.setRequestHeader('Content-Type','application/x-www-form-urlencoded');request.send(Network.serialize(data));return deferred.promise();},postJSON:function(url,headers,data){var deferred=new Deferred();headers=headers||{};data=data||{};var request=new XMLHttpRequest();request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){deferred.resolve(request.responseText);}else{deferred.reject(request);}}};request.open('POST',url,true);for(var key in headers)
request.setRequestHeader(key,headers[key]);request.setRequestHeader('X-Requested-With','XMLHttpRequest');request.setRequestHeader('Content-Type','application/json');request.responseType='text';request.send(JSON.stringify(data));return deferred.promise();}};
;
var Deferred=function(){var _resolvedCallback=null;var _resolvedValue=null;var _rejectedCallback=null;var _rejectedValue=null;this.promise=function(){return{then:function(resolvedCallback,rejectedCallback){_resolvedCallback=resolvedCallback;_rejectedCallback=rejectedCallback;if(_resolvedValue&&_resolvedCallback&&typeof(_resolvedCallback)==='function')
_resolvedCallback(_resolvedValue);else
if(_rejectedValue&&_rejectedCallback&&typeof(_rejectedCallback)==='function')
_rejectedCallback(_rejectedValue);}};};this.resolve=function(val){if(_resolvedCallback&&typeof(_resolvedCallback)==='function'){_resolvedCallback(val);}else{_resolvedValue=val;}};this.reject=function(val){if(_rejectedCallback&&typeof(_rejectedCallback)==='function'){_rejectedCallback(val);}else{_rejectedValue=val;}};};
;
ARTICLE_FOOTER_HTML='<div id=\"article_footer\">\n	<div class=\"left_buttons\">\n	<\/div>\n<\/div>';window.CitadelaPlayer=Class.extend(function(){return{opacityArrows:0,currentPageIndex:0,edition_youtube_api_url:'https://www.youtube.com/iframe_api',construct:function(){var self=this;self.contentPlaceholder=null;self.$document=$(document);self.$document.on('pageLoad',function(ev,pageMeta){self.loadPage.call(self,pageMeta);});},getMobilePageData:function(mobileid){var resvar=null;resvar=window.eddata.pages_mobile[mobileid];return resvar;},init:function(navigationHandler,options){var self=this;$('#edition-toolbar').removeClass('mobile-toolbar-theme').addClass('mobile-toolbar-theme');self.navigationHandler=navigationHandler;options=options||{};this.leftArrow=options.leftArrow?options.leftArrow:$('.ed-arrow-left');this.rightArrow=options.rightArrow?options.rightArrow:$('.ed-arrow-right');this.contentPlaceholder=options.contentPlaceholder?options.contentPlaceholder:$('#content');if(window.edgl.argo.indexOf('*visual_debug=1*')>-1)
{$('html').addClass('ed_visual_debug')}
if(!window.initer.isArticle)
{var hammerHandler=new Hammer(document.body);hammerHandler.on('panstart',function(ev){self.onPanStart.call(self,ev)});hammerHandler.on('pan',function(ev){self.onPan.call(self,ev)});hammerHandler.on('panend',function(ev){self.onPanEnd.call(self,ev)});}else{new Hammer(document.body);$(document.body).css('user-select','unset');}
$(document).on('scroll',function(){clearTimeout(CitadelaPlayer.saveScrollTimer);CitadelaPlayer.saveScrollTimer=setTimeout(function(){CitadelaPlayer.savePageScrollPos();},500);});if((window.eddata.appearance.show_reading_position_indicator)&&(window.initer.isArticle)&&(window.edgl.teaser_mode==0)){var readPosition=[];readPosition.scroll=function(pos){var h=$("body").height();var p=$(window).innerHeight();var m=60;var end=h-p-m*3;readPosition.percent=-100+Math.min(Math.max(parseInt(Math.round((pos-m)*100/end)),0),101);$("#positionScrollerBG").css({"-webkit-transform":"translateX("+readPosition.percent+"%)","transform":"translateX("+readPosition.percent+"%)"});}
readPosition.ini=function(){$("article").prepend("<div id='positionScroller'><span id='positionScrollerBG'>&nbsp;</span></div>");$(window).scroll(function(){readPosition.scroll(Math.round($(document).scrollTop()));});}
readPosition.ini();}
if(window.edgl.additional_data&&window.edgl.additional_data.popup_edition){introPopup.showIfNeeded();}},savePageScrollPos:function(){if(!localStorage||!localStorage.setItem||!eddata){return}
var key='edition_'+eddata.head.edident+'_scrollpos';var payload={page:CitadelaPlayer.currentPageIndex,scroll_y:$(document).scrollTop()}
localStorage.setItem(key,JSON.stringify(payload));},loadPageScrollPos:function(){if(!localStorage||!localStorage.getItem||!eddata){return}
var key='edition_'+eddata.head.edident+'_scrollpos';var data=JSON.parse(localStorage.getItem(key)||'{}');if(data.page==CitadelaPlayer.currentPageIndex){$(document).scrollTop(data.scroll_y);}},findInteractivePageObj:function(id,itype){for(var d in window.eddata.pages)
{var tmpobj=window.eddata.pages[d];for(var l in tmpobj.interactive)
{var interactiveObj=tmpobj.interactive[l];if(interactiveObj.itype==itype)
{if(interactiveObj.id==id)
{return interactiveObj;break;}}}}
return null;},findInteractivePGSObj:function(id,itype){for(var d in window.eddata.pages)
{var tmpobj=window.eddata.pages[d];for(var l in tmpobj.interactive)
{var interactiveObj=tmpobj.interactive[l];if(interactiveObj.itype==itype)
{if(interactiveObj.id==id)
{return tmpobj;break;}}}}
return null;},onAudioOnPlay:function(state){var audioid=$(state.target).data("audioid");$(state.target).data("controlnum",1);if(typeof($(state.target).data("playbacksent"))=="undefined")
{$(state.target).data("playbacksent",0);}
var percentage_viewed=state.target.currentTime/state.target.duration;window.sendInteractiveStats('Audio','Play',$(state.target).data("pageid"),$(state.target).data("audiotitle"),'',Math.round(percentage_viewed*100),Math.round(percentage_viewed*100),$(state.target).data("audioid"),state.target.duration);},onAudioEnded:function(state){var audioid=$(state.target).data("audioid");$(state.target).data("controlnum",(parseInt($(state.target).data("controlnum"))+1));var percentage_viewed=state.target.currentTime/state.target.duration;if($(state.target).data("playbacksent")=="0")
{window.CitadelaPlayer.onAudioSendPlayback($(state.target).data("audioid"));}
window.sendInteractiveStats('Audio','Finished',$(state.target).data("pageid"),$(state.target).data("audiotitle"),'',Math.round(percentage_viewed*100),Math.round(percentage_viewed*100),$(state.target).data("audioid"),state.target.duration);},onAudioPaused:function(state){var audioid=$(state.target).data("audioid");$(state.target).data("controlnum",(parseInt($(state.target).data("controlnum"))+1));window.setTimeout('if($(".audioobj'+audioid+'").data("controlnum") == '+$(state.target).data("controlnum")+'){window.CitadelaPlayer.onAudioSendPlayback("'+$(state.target).data("audioid")+'");}',10000);var percentage_viewed=state.target.currentTime/state.target.duration;window.sendInteractiveStats('Audio','Stop',$(state.target).data("pageid"),$(state.target).data("audiotitle"),'',Math.round(percentage_viewed*100),Math.round(percentage_viewed*100),$(state.target).data("audioid"),state.target.duration);},onAudioSendPlayback:function(edition_obj_id){if(edition_obj_id==edition_obj_id)
{var percentage_viewed=$('.audioobj'+edition_obj_id.toString())[0].currentTime/$('.audioobj'+edition_obj_id.toString())[0].duration;if(!isNaN(percentage_viewed))
{if($('.audioobj'+edition_obj_id.toString()).data("playbacksent")=="0")
{var statDataObj={category:'Audio',action:'playback_percent',page_id:$('.audioobj'+edition_obj_id.toString()).data("pageid"),label:$('.audioobj'+edition_obj_id.toString()).data("audiotitle"),duration:$('.audioobj'+edition_obj_id.toString())[0].duration,current_time:$('.audioobj'+edition_obj_id.toString())[0].currentTime,percent:Math.round(percentage_viewed*100),edition_object_id:edition_obj_id};window.stats.event('Audio','playback_percent',statDataObj,Math.round(percentage_viewed*100));$('.audioobj'+edition_obj_id.toString()).data("playbacksent","1");}}}},gotoDesktopView:function(){var usecookies=false;try
{localStorage.setItem("forcedesktopversion","1");if(localStorage.getItem("forcedesktopversion")=="1")
{}
else
{usecookies=true;}}catch(e)
{usecookies=true;}
if(usecookies)
{window.initer.setCookie('forcedesktopversion',"1",1);}
window.location.reload();},drawEdAudio:function(audioid,element){if(audioid!='')
{var pageobj=this.findInteractivePageObj(audioid,'audio');var addHTML='';if(pageobj!=null)
{var pgsobj=window.CitadelaPlayer.findInteractivePGSObj(audioid,'audio');addHTML+='<div class="ed-audio-play ed-obj-audio">';addHTML+='<p><audio class="ed-audio-obj audioobj'+pageobj.id+'" data-pageid="'+pgsobj.id+'" data-audiotitle="'+pageobj.mp3Title+'" data-audioid="'+pageobj.id+'" alt="'+pageobj.dev_name+'" controls>';addHTML+='<source src="'+pageobj.mp3+'">';addHTML+='</audio></p>';addHTML+='</div>';$(element).append(addHTML);$('.audioobj'+pageobj.id.toString()).on("pause",function(e){window.CitadelaPlayer.onAudioPaused(e);});$('.audioobj'+pageobj.id.toString()).on("play",function(e){window.CitadelaPlayer.onAudioOnPlay(e);});$('.audioobj'+pageobj.id.toString()).on("ended",function(e){window.CitadelaPlayer.onAudioEnded(e);});}}},drawEdImage:function(imageid,element,imglink,imgtype,linkTarget,linkAction){if(imageid!='')
{if(imageid=='mobile_only')
{if(($(element).data("url")!='')&&($(element).data("url")!=null))
{var pageobj={id:'-99999',dat:$(element).data("url")};}}
else{var pageobj=this.findInteractivePageObj(imageid,'image');}
var addHTML='';var gotolink=false;if(typeof(imglink)!='undefined')
{if(imglink!='')
{gotolink=imglink;}}
var imageclasstype='';if(typeof(imgtype)!='undefined')
{if(imgtype!='')
{imageclasstype=' '+imgtype;}}
if(pageobj!=null)
{addHTML+='<div class="fullimage ed-image'+imageclasstype+'">';if(gotolink)
{if(linkAction=='gotoanchor'){addHTML+='<a href="#'+gotolink+'" onclick="javascript:EDgotoAnchor(\''+gotolink+'\'); return false;" class="imagelink" >';addHTML+='<img src="'+pageobj.dat+'" alt="'+pageobj.dev_name+'" />';addHTML+='</a>';}else if(linkAction=='addtocart'){if(window.eddata.wishlist[gotolink]){var pr_obj=window.eddata.wishlist[gotolink];pr_obj.url=gotolink;var jqe=$(element);jqe.data("product",pr_obj);jqe.unbind("click");jqe.addClass('button-image');if(pr_obj.title){jqe.prop('title','Add to cart: '+pr_obj.title);}
jqe.click(function(){window.wishlist.addItem(jqe.data("product"));});addHTML+='<img src="'+pageobj.dat+'" alt="'+pageobj.dev_name+'" />';}}else{addHTML+='<a href="'+gotolink+'" onclick="javascript:window.mobile_external_link_event(this,this.href);" class="imagelink" target="'+(linkTarget?linkTarget:'_blank')+'">';addHTML+='<img src="'+pageobj.dat+'" alt="'+pageobj.dev_name+'" />';addHTML+='</a>';}}else{addHTML+='<img src="'+pageobj.dat+'" alt="'+pageobj.dev_name+'" />';}
addHTML+='</div>';$(element).append(addHTML);}}},getMobileCurrentPage:function(){return this.currentPageIndex;},getMobileCurrentPageId:function(){return this.pageMeta.pageid;},getMobilePagesLength:function(){var count=0;for(var d in window.eddata.pages_mobile)
{count++;}
return count;},gotonextorprevious:function(ev){var target=$(ev.target);if(target.attr('href')==undefined){var page=target.data('page');if(typeof(ev)=='string')
{page=ev;}
var currPageIndex=this.currentPageIndex-1;switch(page){case'nextsub':case'next':{if(currPageIndex<window.pageMeta.length-1){currPageMeta=window.pageMeta[++currPageIndex];location.hash='#!'+currPageMeta.hash;}
else
{currPageMeta=window.pageMeta[0];location.hash='#!'+currPageMeta.hash;}
break;}
case'previous':case'prevsub':case'prev':{if(currPageIndex>0){currPageMeta=window.pageMeta[--currPageIndex];location.hash='#!'+currPageMeta.hash;}
else
{currPageMeta=window.pageMeta[window.pageMeta.length-1];location.hash='#!'+currPageMeta.hash;}
break;}
case'first':{currPageMeta=window.pageMeta[0];location.hash='#!'+currPageMeta.hash;break;}
case'last':{currPageMeta=window.pageMeta[window.pageMeta.length-1];location.hash='#!'+currPageMeta.hash;break;}}
try
{ev.preventDefault();}catch(e){}}},_gotoElement:function(target)
{if(!String(target)){return}
var el=$('.ed-anchor[data-mobile-element-id='+target+']');if(!el.length){el=$((target[0]=='#'?'':'#')+target);}
if(!el.length){return}
$("html, body").animate({scrollTop:el.offset().top-50});$("main").animate({scrollTop:el.offset().top-$("main").offset().top-50});},drawBottomToolbar:function(){if(window.edgl.edition_article_static_html){return;}
if(window.initer.isArticle)
{window.tlbr.redrawCurrentActiveToc(window.CitadelaPlayer.getMobileCurrentPage(),window.CitadelaPlayer.getMobileCurrentPageId());$('.ed_copyright_branding').remove();if((window.edgl.eddevp.indexOf('*powered-by-hidden*')<0)){$('.edition-player').append('<div class="ed_copyright_branding" onclick="javascript:window.open(\'https://www.editiondigital.com\');"></div>')}
return;}
$('.ed-mobile-bottom-toolbar-parent').remove();var addHTML='<div class="ed-mobile-bottom-toolbar-parent">';addHTML+='<div class="ed-mobile-toolbar-bottom">';addHTML+='<div class="ed-holder-mobile-bottom">';addHTML+='<div onclick="javascript:window.CitadelaPlayer.gotonextorprevious(event);" data-page="previous" class="ed-toolbar-mobile-previous-page"></div>';addHTML+='<div class="ed-toolbar-current-page"><span class="ed-toolbar-current-page-label"></span><span class="ed-toolbar-current-page-label-all"></span></div>';addHTML+='<div onclick="javascript:window.CitadelaPlayer.gotonextorprevious(event);" data-page="next" class="ed-toolbar-mobile-next-page"></div>';addHTML+='</div>';addHTML+='</div>';addHTML+='</div">';$('.ed-mobile-bottom-toolbar-parent').remove();$('.edition-player').append(addHTML);$('.ed-toolbar-mobile-previous-page').append('<svg id="ed_svg_mobile_arrow_left" class="clickthrough svg-mobile-left-and-right" style="fill:#EEEEEE;" version="1.1" id="ICONS" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 22 22" style="enable-background:new 0 0 22 22;" xml:space="preserve"> <path id="XMLID_229_" d="M20.8,22c-0.2,0-0.4,0-0.6-0.2L0.7,12C0.4,11.8,0,11.4,0,10.9c0-0.2,0.1-0.8,0.8-1.1 l19.4-9.6c0.3-0.2,0.8-0.2,1.3,0C21.6,0.3,22,0.6,22,1.3v19.3c0,0.4-0.2,0.9-0.6,1.2C21.3,21.9,21.1,22,20.8,22z M3,10.9l17,8.6V2.4 L3,10.9z"/></svg>');$('.ed-toolbar-mobile-next-page').append('<svg id="ed_svg_mobile_arrow_right" class="clickthrough svg-mobile-left-and-right" style="fill:#EEEEEE;" version="1.1" id="ICONS" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 22 22" style="enable-background:new 0 0 22 22;" xml:space="preserve"> <path id="XMLID_253_" d="M1.2,0c0.2,0,0.4,0,0.6,0.2L21.3,10c0.4,0.2,0.7,0.6,0.7,1.1c0,0.2-0.1,0.8-0.8,1.1 L1.9,21.8c-0.3,0.2-0.8,0.2-1.3,0C0.4,21.7,0,21.4,0,20.7V1.3C0,1,0.2,0.5,0.6,0.2C0.7,0.1,0.9,0,1.2,0z M19,11.1L2,2.5v17.1 L19,11.1z"/></svg>');$('.ed-toolbar-current-page-label').html(window.CitadelaPlayer.getMobileCurrentPage());$('.ed-toolbar-current-page-label-all').html(' / '+window.CitadelaPlayer.getMobilePagesLength().toString());var addCss='';$('.ed_copyright_branding').remove();if((window.edgl.eddevp.indexOf('*powered-by-hidden*')<0)){$('.ed-mobile-bottom-toolbar-parent').append('<div class="ed_copyright_branding" onclick="javascript:window.open(\'https://www.editiondigital.com\');"></div>');}
window.tlbr.redrawCurrentActiveToc(window.CitadelaPlayer.getMobileCurrentPage(),window.CitadelaPlayer.getMobileCurrentPageId());if(window.eddata.appearance.toolbar_theme=='light')
{addCss=' white-theme';$('.ed-mobile-bottom-toolbar-parent').removeClass('white-theme').addClass('white-theme');}
else if(window.eddata.appearance.toolbar_theme=='custom')
{var color1=window.eddata.appearance.toolbar_theme_color_1;var color2=window.eddata.appearance.toolbar_theme_color_2;var color3=window.eddata.appearance.toolbar_theme_color_3;var color4=window.eddata.appearance.toolbar_theme_color_4;var color5=window.eddata.appearance.toolbar_theme_color_5;var color6=window.eddata.appearance.toolbar_theme_color_6;}
if(window.eddata.appearance.toolbar_theme=='custom')
{$('.ed-mobile-toolbar-bottom').css({'color':color4,'background-color':color1});$('.ed-toolbar-current-page-label-all').css({'color':color3});$('.top-panel').css({'color':color4,'background-color':color5});$('.top-panel .ed-toc-sectiontitle').css({'color':color6,'background-color':'transparent'});$('.top-panel .ed-toc-sectiontitle.active').css({'color':color5,'background-color':color6});$('.ed-toolbar-mobile-next-page svg,.ed-toolbar-mobile-previous-page svg').css({'fill':color4});}
$('.ed-mobile-bottom-toolbar-parent').transition({'opacity':1},250,'fast');},drawFooter:function()
{if(window.edgl.edition_article_static_html){if($("#article_footer").length){return;}}
if($(".article-share-icons").length){return;}else{var articleDiv=$('article.edition_article');}
articleDiv.removeClass('article_footer_visible');if(!window.initer.isArticle){return;}
var btns=$('#edition-toolbar-social-panel .sharer-icon-holder');if(!btns.length){return;}
var footerDiv=$(ARTICLE_FOOTER_HTML).appendTo(articleDiv);articleDiv.addClass('article_footer_visible');var newButtons=btns.clone(true,true).appendTo(footerDiv.find('.left_buttons'));newButtons.find('.icons').addClass('dark');},ishashinArray:function(hasharray,searchhash){var resvar=false;for(var d in hasharray)
{var tmphash=hasharray[d];if((searchhash!='')&&(tmphash!=''))
{if(tmphash==searchhash)
{resvar=true;}}}
return resvar;},ed_atp:function(arrObj){for(var d in arrObj)
{var tmpobj=arrObj[d];if(tmpobj.action=='gotopage')
{var pageid=tmpobj.params;var pageobj=window.CitadelaPlayer.findPageObj(pageid);if(pageobj!=null)
{if(pageobj.mob_page_id>0)
{for(var m in window.pageMeta)
{if(window.pageMeta[m].mobilepageid.toString()==pageobj.mob_page_id.toString())
{location.hash='#!'+window.pageMeta[m].hash;break;}}}}}
if(tmpobj.action=='gotourl')
{var doprocess=true;var focusRequest=window.open(tmpobj.params,"newLink");focusRequest.focus();}}},findPageObj:function(pageid){var resvar=null;if(typeof(pageid)=='object')
{pageid=pageid[0];}
if(isNaN(pageid))
{window.CitadelaPlayer.gotonextorprevious(pageid);return null;}
else
{for(var l in window.eddata.pages)
{if(window.eddata.pages[l].id==pageid)
{resvar=window.eddata.pages[l];return resvar;break;}}}
return resvar;},beginDrawingInteractiveElements:function(){ed_video.removeVideos();ed_gallery.removeGalleries();ed_mobile_soundcloud.removeAll();ed_mobile_iframe.removeAll();ed_mobile_code.removeAll();$('.ed-image').remove();$('.ed-audio-play').remove();ed_survey.removeSurveys();this.drawInteractiveElements();},drawInteractiveElements:function(){if(window.initer.isArticle){$('.edition_article').find('a').each(function(){$(this).on('click',function(){window.mobile_external_link_event(this,this.href);});});}else{$('.edition-player #content').find('a').each(function(){$(this).on('click',function(){window.mobile_external_link_event(this,this.href);});});}
ed_gallery.drawGalleries();$(".image").each(function(index){window.CitadelaPlayer.drawEdImage($(this).data("imageid"),this,$(this).data("link"),$(this).data("imagetype"),$(this).data("link-target"),$(this).data("tap-action"));});$(".ed-wishlist").each(function(index){if(window.eddata.mobile_elements[$(this).data("mobileElementId")]){var wl_url=window.eddata.mobile_elements[$(this).data("mobileElementId")].wishlist_url;if(wl_url){if(window.eddata.wishlist){if(window.eddata.wishlist[wl_url]){var pr_obj=window.eddata.wishlist[wl_url];pr_obj.url=wl_url;var jqe=$(this);jqe.data("product",pr_obj);jqe.unbind("click");jqe.addClass('ed-wishlist-mobile');jqe.addClass('ed-wishlist-visible');jqe.click(function(){console.warn(" ADD",jqe.data("product"))
window.wishlist.addItem(jqe.data("product"));});}}}}});ed_mobile_iframe.drawIframes();ed_mobile_code.drawCodeElements();ed_survey.drawSurveys();ed_video.drawVideos();ed_mobile_soundcloud.drawSoundClouds();$(".ed-audio").each(function(index){window.CitadelaPlayer.drawEdAudio($(this).data("audioid"),this);});try{if(window.parent)
{window.parent.$(window.parent.document).trigger('ed_intro_popup_loaded');}}catch(e){}},onPageDownloadedCallback:function(responseData){var self=this;if(responseData.indexOf('<body>')>0)
{var bodyText=responseData.substring(responseData.indexOf('<body>')+6,responseData.indexOf('</body>'));}
else
{var bodyText=responseData;}
bodyText=window.CitadelaPlayer.personalizePageMobile(bodyText);pageMeta.content=bodyText;self.contentPlaceholder[0].innerHTML=bodyText;this.drawBottomToolbar();this.beginDrawingInteractiveElements();window.scrollTo(0,0);window.onAfterPageLoad.trigger(pageMeta);},getScreenHeight:function(){return $('#edition-bg').height();},onMainWindowsScroll:function(evt,sendstartstats){if(typeof(sendstartstats)=='undefined')
{var sendstartstats=false;}
if(window.trasckingscrollenabled)
{var screenHeight=CitadelaPlayer.getScreenHeight()>300?CitadelaPlayer.getScreenHeight():$(window).height();var contentHeight=$('body').height()?$('body').height():320;var currentScrollTop=$(document).scrollTop();if(currentScrollTop==0)
{currentScrollTop=1;}
var fullscrollpossible=(contentHeight-screenHeight)+$('.ed-mobile-toolbar-bottom').outerHeight()+$('#edition-toolbar-main').outerHeight()+10;if(fullscrollpossible<=0)
{fullscrollpossible=1;}
var currentScrollPercent=((currentScrollTop/fullscrollpossible)*100);if(sendstartstats)
{var visibleFromStartScreen=(screenHeight/contentHeight);if(visibleFromStartScreen>=0.96)
{currentScrollPercent=99;}
else if(visibleFromStartScreen>=0.59)
{currentScrollPercent=60;}
else if(visibleFromStartScreen>=0.29)
{currentScrollPercent=30;}}
if(currentScrollPercent>=92)
{if(!window.trackedscroll30)
{window.sendStatsScrollTrack('Depth','30',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll30=true;}
if(!window.trackedscroll60)
{window.sendStatsScrollTrack('Depth','60',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll60=true;}
if(!window.trackedscroll100)
{window.sendStatsScrollTrack('Depth','100',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll100=true;}
window.trasckingscrollenabled=false;}
else if(currentScrollPercent>=54)
{if(!window.trackedscroll60)
{window.sendStatsScrollTrack('Depth','60',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll60=true;}
if(!window.trackedscroll30)
{window.sendStatsScrollTrack('Depth','30',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll30=true;}}
else if(currentScrollPercent>=26)
{if(!window.trackedscroll30)
{window.sendStatsScrollTrack('Depth','30',window.CitadelaPlayer.pageMeta.pageid);window.trackedscroll30=true;}}}},personalizePageMobile:function(pagetext){try
{var personalizationitems=new Array();var tmptxt=pagetext;var fullquerystring=location.search;fullquerystring=fullquerystring.replace('?','');var arrofparams=fullquerystring.split("&");for(var d in arrofparams){var paramSngl=arrofparams[d].split("=");var pname=paramSngl[0];var pval=paramSngl[1];if(pname.toLowerCase().substring(0,4)=='edp_')
{personalizationitems[pname.toLowerCase()]=pval;}}
var tmparrtxt=tmptxt.toLowerCase().split("[edp_");if(tmparrtxt.length>1)
{for(var d in tmparrtxt)
{var currparram=tmparrtxt[d];if(d>0)
{var tmptwoarr=currparram.split("]")[0];var paramname='[edp_'+tmptwoarr+"]";var handled=false;var paramnamewithoutbrackets=paramname.replace("]","").replace("[","");if(paramnamewithoutbrackets.indexOf(',')>0){paramnamewithoutbrackets=paramnamewithoutbrackets.split(',')[0];}
if(typeof(personalizationitems[paramnamewithoutbrackets])!="undefined")
{var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,decodeURI(personalizationitems[paramnamewithoutbrackets]));handled=true;}
else
{var paramdefcheckarr=paramname.split(',',2);if(paramdefcheckarr.length>1)
{var defaultval=paramdefcheckarr[1].replace("]","");var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,defaultval);handled=true;}}
if(!handled)
{var defaultval="";var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,defaultval);handled=true;}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 281; column: 280;  :: '+v);}
return tmptxt;},pageUrlLoadExecute:function(url){var tmpScript=document.createElement('script');tmpScript.type='text/javascript';tmpScript.src=url;try{var head=document.getElementsByTagName('head').item(0);head.appendChild(tmpScript);}catch(e){}},loadPage:function(pageMeta){var self=this;window.CitadelaPlayer.pageMeta=pageMeta;window.onBeforePageLoad.trigger(pageMeta);ed_soundcloud.destroyAllOnPage($('#content'));ed_video.sendPlaybackPercent();this.currentPageIndex=pageMeta.pagenumber;window.stats.pageview(pageMeta.pageid);if(pageMeta.content){if(window.edgl.edition.edition_type==""){var page_title=pageMeta.title;var is_true_title=true;if(page_title==""){for(var d in window.eddata.pages){if(window.eddata.pages[d].mob_page_id==pageMeta.mobilepageid){page_title=window.eddata.pages[d].page_title_calc;is_true_title=window.eddata.pages[d].is_true_title;break;}}}
if(is_true_title){document.title=page_title+" - "+window.edgl.edition.title;}else{document.title=window.edgl.edition.title+" - "+page_title;}}
if(!window.edgl.edition_article_static_html){self.contentPlaceholder[0].innerHTML=window.CitadelaPlayer.personalizePageMobile(pageMeta.content);setTimeout(function(){mobile_scroll_firt_time_ready=true;},50);}
if(!window.edgl.edition_article_static_html){$("html, body").animate({scrollTop:0},"fast");}
window.CitadelaPlayer.drawBottomToolbar();window.CitadelaPlayer.drawFooter();tlbr.setPageNumber(CitadelaPlayer.getMobileCurrentPage());window.CitadelaPlayer.beginDrawingInteractiveElements();$('[data-scroll-target]').off('click').click(self,function(e){self._gotoElement($(this).data('scroll-target'));e.stopImmediatePropagation();return false;});window.onAfterPageLoad.trigger(pageMeta);setTimeout(function(){window.tlbr.markSearchResultsMobile();},800);}else{window.CitadelaPlayer.pageUrlLoadExecute(pageMeta.url);}},onPanStart:function(ev){if(ev&&$(ev.target).parents('.handle_touches').length){return false}
this.swipeSet=false;this.validSwipeGesture=false;this.navigateToPrevPageRequested=false;this.navigateToNextPageRequested=false;this.leftOffset=0;this.rightOffset=0;this.opacityArrows=0;this.leftSwipeEnabled=!this.navigationHandler.isFirstPage(this.pageMeta);this.rightSwipeEnabled=!this.navigationHandler.isLastPage(this.pageMeta);this.leftArrow.velocity('stop');this.rightArrow.velocity('stop');},onPan:function(ev){if(ev&&$(ev.target).parents('.handle_touches').length){return false}
if(!this.swipeSet){if(ev.distance>20){if(Math.abs(ev.deltaX)>Math.abs(ev.deltaY)){this.validSwipeGesture=true;}
this.swipeSet=true;}}else
if(this.validSwipeGesture){var leftOffset=this.leftOffset=Math.min(this.leftArrow[0].clientWidth,Math.max(0,ev.deltaX*0.75));var rightOffset=this.rightOffset=Math.max(-this.rightArrow[0].clientWidth,Math.min(0,ev.deltaX*0.75));if(this.opacityArrows<1)
{this.opacityArrows=this.opacityArrows+0.10;}
else
{this.opacityArrows=1;}
if((this.leftSwipeEnabled)&&(Math.abs(leftOffset)>0))this.leftArrow[0].style.opacity=this.opacityArrows;if((this.rightSwipeEnabled)&&(Math.abs(rightOffset)>0))this.rightArrow[0].style.opacity=this.opacityArrows;if(this.leftSwipeEnabled)this.leftArrow[0].style.transform='translate('+leftOffset+'px, 0)';if(this.rightSwipeEnabled)this.rightArrow[0].style.transform='translate('+rightOffset+'px, 0)';if(this.leftSwipeEnabled&&Math.abs(leftOffset)==this.leftArrow[0].clientWidth){this.navigateToPrevPageRequested=true;}else{this.navigateToPrevPageRequested=false;}
if(this.rightSwipeEnabled&&Math.abs(rightOffset)==this.rightArrow[0].clientWidth){this.navigateToNextPageRequested=true;}else{this.navigateToNextPageRequested=false;}}},onPanEnd:function(ev){if(ev&&$(ev.target).parents('.handle_touches').length){return}
var opacityArrowLeft=0;var opacityArrowRight=0;if(this.leftSwipeEnabled)
try
{if(this.leftArrow[0].style.opacity>0)
{opacityArrowLeft=this.leftArrow[0].style.opacity;}}catch(e){opacityArrowLeft=0;}
this.leftArrow.velocity({opacity:[0,opacityArrowLeft],translateX:[0,this.leftOffset]},{duration:100});if(this.rightSwipeEnabled)
try
{if(this.rightArrow[0].style.opacity>0)
{opacityArrowRight=this.rightArrow[0].style.opacity;}}catch(e){opacityArrowRight=0;}
this.rightArrow.velocity({opacity:[0,opacityArrowRight],translateX:[0,this.rightOffset]},{duration:100});if(!ed_gallery.isFullScreenGallery())
{if(this.navigateToPrevPageRequested)
this.$document.trigger('loadPrevPage');else
if(this.navigateToNextPageRequested)
this.$document.trigger('loadNextPage');}}};});function EDgotoAnchor(anchorName){if(!anchorName){return;}
var ancor_jq=$("a[name='"+anchorName+"']");if(!ancor_jq.length){return;}
var toppos=Math.floor(ancor_jq.offset().top);$('main, body, html').animate({scrollTop:toppos},'fast');return false;}
;
var ed_video={video_file_html:'<div class=\"ed-video-object ed-mp4video\">\n    <video class=\"ed-mp4-vid\" data-pageid=\"\" data-videoid=\"\" controls poster=\"\">\n        <source class=\"mp4_source\" type=\"video\/mp4\">\n        <source class=\"webm_source\" type=\"video\/webm\">\n    <\/video>\n<\/div>\n',removeVideos:function(){var youtube_videos=$('.ed-yotube-video');var mp4_videos=$('.ed-mp4video');$.each(youtube_videos,function(){var player=$(this).data('youtube_player');if(player){player.destroy();}});youtube_videos.remove();mp4_videos.remove();},sendPlaybackPercent:function(){var player;$('.video[data-videoid]').each(function(index){$(this).find('video').off('pause');ed_video._onMp4SendPlayback($(this));});$('.ed-youtube-video').each(function(){player=$(this).data('youtube_player');ed_video._onYoutubeVideoSendPlaybackPercentVal($(this),player);});},drawVideos:function(){$(".video[data-videoid]").each(function(index){$(this).addClass('ed-mp4-video');ed_video._drawVideo($(this).data('videoid'),this);});this._isYoutubeApiLoaded();},_drawVideo:function(videoid,element){if(videoid)
{var pageobj=CitadelaPlayer.findInteractivePageObj(videoid,'video');if(pageobj!=null){this._drawVideoFromFile(pageobj,element);}
else if(videoid=='mobile_only'){var mobile_element_id=$(element).data('mobile-element-id');var data_el;var copied_data={};if(!mobile_element_id){return;}
if(!eddata.mobile_elements){return;}
data_el=eddata.mobile_elements[mobile_element_id];if(!data_el){return;}
$.extend(copied_data,data_el);copied_data.videoImage=data_el.source_file;copied_data.id=data_el.mobile_element_id;copied_data.webm=data_el.video_webm;copied_data.mp4=data_el.video_mp4;copied_data.dev_name='Video';this._drawVideoFromFile(copied_data,element);}}},_drawYoutubeVideos:function(){$(".youtube-video").each(function(index){var get_id=$(this).data("videoid");if(typeof(get_id)=='undefined'){get_id=$(this).data("youtubeid");}
ed_video._drawYoutubeVideo(get_id,this);});},_drawYoutubeVideo:function(video_id,element){var page_obj,data_el,mobile_element_id,player,poster;if(!video_id){return;}
if(video_id=='mobile_only'){mobile_element_id=$(element).data('mobile-element-id');data_el=eddata.mobile_elements[mobile_element_id];if(!data_el){return;}
page_obj={youtubeid:data_el.video_youtube};if(data_el.source_file){poster=data_el.source_file;}}
else{page_obj=CitadelaPlayer.findInteractivePageObj(video_id,'video');}
if(!page_obj){return;}
$(element).addClass('ed-youtube-video');if(this._noConnectionYoutube(element,page_obj.videoImage)){return;}
$(element).attr('data-pageid',CitadelaPlayer.getMobileCurrentPageId());if(poster){$(element).css('background-image','url('+poster+')');$(element).on('click.youtube_poster_click',{youtube_id:page_obj.youtubeid},this._onYoutubePosterClick);$(element).append('<div class="btn_play_youtube"></div>').append('<div class="youtube_logo_image"></div>');return;}
this._createYoutubePlayer(element,page_obj.youtubeid);},_noConnectionYoutube:function(element,video_image){if(CitadelaPlayer.edition_youtube_api_url!="api_load_failed"){return false;}
$(element).addClass('no_connection');if(video_image){$(element).css("background-image",'url('+video_image+')');}
$(element).append('<div class="background_no_connection"></div>');return true;},_createYoutubePlayer:function(element,youtube_id){if(!element){return;}
var player=new YT.Player(element,{videoId:youtube_id,height:$(element).height(),width:$(element).width(),playerVars:{rel:0,modestbranding:1,},events:{onStateChange:this._onYoutubePlayerStateChange,onReady:this._onYoutubeReady}});return player;},_onYoutubePosterClick:function(e){$(this).attr('data-has-poster-image',true);ed_video._createYoutubePlayer(this,e.data.youtube_id);},_isYoutubeApiLoaded:function(){if(CitadelaPlayer.edition_youtube_api_url!=''&&CitadelaPlayer.edition_youtube_api_url!="api_load_failed")
{if(!window.ed_checkConnectivity()){CitadelaPlayer.edition_youtube_api_url="api_load_failed";ed_video._drawYoutubeVideos();return;}
var tag=document.createElement('script');tag.src=CitadelaPlayer.edition_youtube_api_url;var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);onYouTubeIframeAPIReady=function(){CitadelaPlayer.edition_youtube_api_url='';ed_video._drawYoutubeVideos();};tag.onerror=function(){CitadelaPlayer.edition_youtube_api_url='api_load_failed';ed_video._drawYoutubeVideos();}}else{ed_video._drawYoutubeVideos();}},_drawVideoFromFile:function(page_obj,element){if(!page_obj||!page_obj.mp4){return;}
var poster_image='';var content,video_element;if(page_obj.videoImage!=''){poster_image=page_obj.videoImage;}
$(element).attr('data-pageid',CitadelaPlayer.getMobileCurrentPageId());content=$(this.video_file_html).clone();video_element=content.find('video');video_element.attr('poster',poster_image);content.find('.mp4_source').attr('src',page_obj.mp4);if(page_obj.webm){content.find('.webm_source').attr('src',page_obj.webm);}
$(element).append(content);video_element.on('webkitfullscreenchange mozfullscreenchange fullscreenchange',function(e){try
{var state=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;var enterfullscreen=state?true:false;if(enterfullscreen)
{ed_video._onMp4VideoFullscreenToggle(e,'Full screen');}
else
{ed_video._onMp4VideoFullscreenToggle(e,'Close full screen');}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 337; column: 197;  :: '+v);}});video_element.on("pause",this._onMp4VideoPaused);video_element.on("play",this._onMp4VideoOnPlay);video_element.on("ended",this._onMp4VideoEnded);},_getViewedPercentage:function(video_el){if(!video_el){return 0;}
var current_time=video_el.get(0).currentTime;var duration=video_el.get(0).duration;var percentage_viewed=current_time/duration;if(isNaN(percentage_viewed)){percentage_viewed=0;}
return percentage_viewed*100;},_onMp4SendPlayback:function(root_el){var default_data;if(!root_el||!root_el.length){return;}
default_data=ed_video._getDefaultStatsData(root_el,'playback_percent');if(!default_data){return;}
if(root_el.data("playbacksent")=="0"){ed_video._sendAnalyticsData(root_el,default_data);root_el.data("playbacksent","1");}},_onMp4VideoOnPlay:function(state){var root_el=$(state.target).parents('[data-videoid]');var default_data=ed_video._getDefaultStatsData(root_el,'Play');if(!default_data){return;}
root_el.data("playbacksent",0);clearTimeout(root_el.data('send_playback_timer'));ed_video._sendAnalyticsData(root_el,default_data);},_onMp4VideoEnded:function(state){var root=$(state.target).parents('[data-videoid]');var default_data=ed_video._getDefaultStatsData(root_el,'Finished');if(!default_data){return;}
if(root.data("playbacksent")=="0"){ed_video._onMp4SendPlayback(root);}
ed_video._sendAnalyticsData(root_el,default_data);},_onMp4VideoFullscreenToggle:function(state,event_name){var root_el=$(state.target).parents('[data-videoid]');var default_data=ed_video._getDefaultStatsData(root_el,event_name);if(!default_data){return;}
ed_video._sendAnalyticsData(root_el,default_data);},_onMp4VideoPaused:function(state){var root_el=$(state.target).parents('[data-videoid]');var default_data=ed_video._getDefaultStatsData(root_el,'Pause');if(!default_data){return;}
ed_video._sendAnalyticsData(root_el,default_data);(function(root_el){var timer=setTimeout(function(){ed_video._onMp4SendPlayback(root_el);},10000);root_el.data('send_playback_timer',timer);})(root_el);},_onYoutubeVideoSendPlaybackPercentVal:function(root_el,player){var default_data,player_state;if(!root_el||!player){return;}
if(root_el.data('playback_sent')){return;}
player_state=player.getPlayerState();if(player_state!=1&&player_state!=2){return;}
default_data=ed_video._getYoutubeStatsData(root_el,player,'playback_percent');ed_video._sendAnalyticsData(root_el,default_data);clearTimeout(root_el.data('send_playback_timer'));root_el.data('playback_sent',1);},_onYoutubePlayerStateChange:function(event){var player=event.target;var root_el=$(player.getIframe());var default_data;if(event.data==0){ed_video._onYoutubeVideoSendPlaybackPercentVal(root_el,player);default_data=ed_video._getYoutubeStatsData(root_el,player,'Finished');ed_video._sendAnalyticsData(root_el,default_data);}
else if(event.data==1){root_el.data("playbacksent",0);clearTimeout(root_el.data('send_playback_timer'));default_data=ed_video._getYoutubeStatsData(root_el,player,'Play');ed_video._sendAnalyticsData(root_el,default_data);}
else if(event.data==2){(function(root_el,player){var timer=setTimeout(function(){ed_video._onYoutubeVideoSendPlaybackPercentVal(root_el,player);},10000);root_el.data('send_playback_timer',timer);})(root_el,player);default_data=ed_video._getYoutubeStatsData(root_el,player,'Pause');ed_video._sendAnalyticsData(root_el,default_data);}
else if(event.data==3){}},_onYoutubeReady:function(event){var player=event.target;var root_el=$(player.getIframe());root_el.data('youtube_player',player);if(root_el.attr('data-has-poster-image')){root_el.off('click.youtube_poster_click');root_el.css('background-image','none');player.playVideo();}},_isMobileElement:function(root_el){return $(root_el).data('mobile-element-id')!==undefined;},_getMobileElementId:function(root_el){return $(root_el).data('mobile-element-id');},_sendAnalyticsData:function(root_el,stat_obj){var id;if(!root_el||!stat_obj){return;}
if(!stat_obj.action||stat_obj.percent){}
if(ed_video._isMobileElement(root_el)){id=ed_video._getMobileElementId(root_el);stat_obj.mobile=1;}
else{id=$(root_el).data('videoid');stat_obj.mobile=0;}
stat_obj.edition_object_id=id;stats.event('Video',stat_obj.action,stat_obj,stat_obj.percent);},_getDefaultStatsData:function(root_el,event_name){if(!root_el||!event_name){return;}
var video_element=root_el.find('video');if(!video_element){return;}
if(!video_element.get(0)){return;}
var duration=video_element.get(0).duration;var current_time=video_element.get(0).currentTime;var percentage_viewed=ed_video._getViewedPercentage(video_element);var stat_obj={category:'Video',action:event_name,page_id:root_el.data("pageid"),label:'',duration:duration,current_time:current_time,percent:Math.round(percentage_viewed),};return stat_obj;},_getYoutubeStatsData:function(root_el,player,event_name){var percentage_viewed,stat_obj,result;if(!player||!event_name||!root_el){return;}
percentage_viewed=player.getCurrentTime()/ player.getDuration();if(isNaN(percentage_viewed)){percentage_viewed=0;}
percentage_viewed*=100;stat_obj={category:'Video',action:event_name,page_id:root_el.data("pageid"),label:'',duration:player.getDuration(),current_time:player.getCurrentTime(),percent:percentage_viewed,};return stat_obj;},};
;
var ed_mobile_soundcloud={elClass:'ed-mobile-soundcloud',removeAll:function(){$('.'+this.elClass).remove();},drawSoundClouds:function(){var self=this;$(".ed-soundcloud").each(function(index){$(this).addClass(self.elClass);self._drawSoundcloud($(this).data("soundcloudid"),$(this));});},_drawSoundcloud:function(soundcloud_id,element){var soundcloud_obj,form,additional_data,is_mobile_element;var html='';if(!soundcloud_id){return;}
soundcloud_obj=this._getSoundCloudObj(soundcloud_id,element);if(!soundcloud_obj||!soundcloud_obj.soundcloud_track_id){return;}
if(window.ed_checkConnectivity()){is_mobile_element=soundcloud_id=='mobile_only';soundcloud_obj=$.extend({},soundcloud_obj);soundcloud_obj.is_mobile_element=is_mobile_element;ed_soundcloud.create_mobile_soundcloud(soundcloud_obj);}else{html='<img src="'+window.ed_getNoConnImage()+'" width="100%" style="height:auto;">';}
$(element).append(html);},_getSoundCloudObj:function(soundcloud_id,element){var soundcloud_obj,element_id;if(soundcloud_id!='mobile_only'){soundcloud_obj=CitadelaPlayer.findInteractivePageObj(soundcloud_id,'soundcloud');}
else{if(eddata&&eddata.mobile_elements){element_id=element.attr('data-mobile-element-id');soundcloud_obj=$.extend({},eddata.mobile_elements[element_id]);if(soundcloud_obj){soundcloud_obj.id=soundcloud_obj.mobile_element_id;}}}
return soundcloud_obj;}};
;
var ed_mobile_iframe={elClass:'ed-mobile-iframe',removeAll:function(){$('.'+this.elClass).remove();},drawIframes:function(){var self=this;$(".ed-iframe").each(function(index){$(this).addClass(self.elClass);self._drawIframe($(this).data("iframeid"),$(this));});},_drawIframe:function(iframe_id,element){var iframe_obj,form,additional_data,is_mobile_element;var iframe,iframe_height;var html='';if(!iframe_id){return;}
iframe_obj=this._getIframeObj(iframe_id,element);if(!iframe_obj||!iframe_obj.url_link){return;}
if(window.ed_checkConnectivity()){iframe=$('<iframe></iframe>');iframe.attr('src',iframe_obj.url_link);html=iframe.wrap('<p>').parent().html();}else{html='<img src="'+window.ed_getNoConnImage()+'" width="100%" style="height:auto;">';}
iframe_height=CitadelaPlayer.getScreenHeight()*0.7;$(element).css('height',iframe_height);$(element).css('padding',iframe_obj.padding);$(element).append(html);},_getIframeObj:function(iframe_id,element){var iframe_obj,element_id;if(iframe_id!='mobile_only'){iframe_obj=CitadelaPlayer.findInteractivePageObj(iframe_id,'iframe');}
else{if(eddata&&eddata.mobile_elements){element_id=element.attr('data-mobile-element-id');iframe_obj=$.extend({},eddata.mobile_elements[element_id]);if(iframe_obj){iframe_obj.id=iframe_obj.mobile_element_id;}}}
return iframe_obj;}};
;
var ed_mobile_code={elClass:'ed-mobile-code',removeAll:function(){$('.'+this.elClass).remove();},drawCodeElements:function(){var self=this;$(".ed-code").each(function(index){$(this).addClass(self.elClass);self._drawCode($(this).data("codeid"),$(this));});},_drawCode:function(code_id,element){var code_obj,form,additional_data,is_mobile_element;var code,code_height;var html='';if(!code_id){return;}
code_obj=this._getCodeObj(code_id,element);if(!code_obj||(!code_obj.html_content&&!code_obj.code_inner_html)){return;}
if(window.ed_checkConnectivity()){html=code_obj.html_content||code_obj.code_inner_html;}else{html='<img src="'+window.ed_getNoConnImage()+'" width="100%" style="height:auto;">';}
$(element).html(html);},_getCodeObj:function(code_id,element){var code_obj,element_id;if(code_id!='mobile_only'){code_obj=CitadelaPlayer.findInteractivePageObj(code_id,'code');}
else{if(eddata&&eddata.mobile_elements){element_id=element.attr('data-mobile-element-id');code_obj=$.extend({},eddata.mobile_elements[element_id]);if(code_obj){code_obj.id=code_obj.mobile_element_id;}}}
return code_obj;}};
;
var ed_survey={removeSurveys:function(){$('.ed-mobile-survey').remove();},drawSurveys:function(){$(".survey").each(function(index){ed_survey._drawSurvey($(this).data("surveyid"),$(this));});},_drawSurvey:function(survey_id,element){var survey_obj,form,additional_data,is_mobile_element;if(!survey_id){return;}
survey_obj=this._getSurveyObj(survey_id,element);if(!survey_obj){return;}
$(element).append('<div class="innerholder mobilesurveyholder"></div>');$(element).find('.mobilesurveyholder').removeClass('ed-mobile-survey').addClass('ed-mobile-survey');$(element).find('.mobilesurveyholder').removeClass('ed-popup-survey').addClass('ed-popup-survey');if(window.ed_checkConnectivity()&&typeof window.eddata.appearance.data_collection_rq_url!="undefined"){is_mobile_element=survey_id=='mobile_only';additional_data={is_mobile_element:is_mobile_element};form=ed_form_builder.createForm(survey_obj,'',additional_data);}else{form='<img src="'+window.ed_getNoConnImage()+'" width="100%" style="height:auto;">';}
$(element).find('.mobilesurveyholder').append(form);},_getSurveyObj:function(survey_id,element){var survey_obj,element_id;if(survey_id!='mobile_only'){survey_obj=CitadelaPlayer.findInteractivePageObj(survey_id,'survey');}
else{if(eddata&&eddata.mobile_elements){element_id=element.attr('data-mobile-element-id');survey_obj=$.extend({},eddata.mobile_elements[element_id]);if(survey_obj){survey_obj.id=survey_obj.mobile_element_id;}}}
return survey_obj;}};
;
var ed_gallery={gallery_html:'<div class=\"gallery-holder ed-gallery-object\" data-imgindex=\"-1\" data-visible=\"false\">\n    <div class=\"gallery-holder-bg\"><\/div>\n    <div class=\"gallery-holder-inner\"><\/div>\n    <div class=\"gal-fullscreen-btn\"><\/div>\n<\/div>\n',_debug:true,_fullscreen_data:{},_inplaceIscroll:undefined,_default_fullscreen_data:{gallery_max_zoom:1,zoomed_in:false,gallery_visible:false,gallery_id:-1,is_mobile:false,img_index:0,offsetFSC:0,neededmoveXforswipe:0,iscroll:undefined},fscResizeHandle:function(){this._fscResizeHandle();},removeGalleries:function(){$('.ed-gallery-object').remove();},drawGalleries:function(){$(".gallery").each(function(index){var gallery_id=ed_gallery._getRootElementId($(this));ed_gallery._drawGallery(gallery_id,this);});},_images:function(gallery)
{return $(gallery).find('.gallery-single-image');},isFullScreenGallery:function(){return this._fullscreen_data.gallery_visible;},_log:function(msg,additional){if(this._debug){console.log(msg,additional);}},_getRootEl:function(el){var root;if(!el){return;}
if(el.hasClass('gallery')){return el;}
else{root=el.parents('.gallery');if(!root.length){return;}
return root;}},_getRootElementId:function(root){if(!root){return;}
if(this._is_mobile_element(root)){return root.attr('data-mobile-element-id');}
else{return root.attr('data-galleryid');}},_is_mobile_element:function(root){if(!root){return false;}
return root.attr('data-galleryid')=='mobile_only';},_drawGallery:function(gallery_id,element){var self=this;this._log('Drawing gallery');var root_el=this._getRootEl($(element));var is_mobile=this._is_mobile_element(root_el);var pageobj=this._getPageObj(gallery_id,is_mobile);if(pageobj)
{if(typeof(pageobj.jsobj)!='undefined')
{console.log('gal obj',pageobj);if(pageobj.jsobj.images.length==0){root_el.remove();return;}
if(pageobj.mobile_element_subtype=='threesixty'){edThreesixty.drawDivForMobile(pageobj,element);}
else{self._drawNormalGallery(pageobj,element);}}}},_drawNormalGallery:function(pageobj,element)
{var self=this;var html=$(this.gallery_html);$(element).append(html);var inner_el=$('<div class="gallery_iscroll_content"></div>');inner_el.appendTo(html.find('.gallery-holder-inner'));inner_el.addClass('handle_touches');var indicators=$('<ul class="gal_indicators"></ul>');indicators.insertAfter(html.find('.gal-fullscreen-btn'));var count=0;$.each(pageobj.jsobj.images,function(index,current_image){var el=$('<div></div>');el.addClass('gallery-single-image');el.attr('data-gallery-viewmode','fill');el.css('background-image','url('+current_image.img+')');inner_el.append(el);var indicator=$('<li class="item '+(index==0?'active':'')+'"></li>');indicator.data('img_index',index);indicators.append(indicator);indicator.click(self,self._indicatorClicked);count++;});inner_el.css({width:count*100+'%'});inner_el.find('.gallery-single-image').css({width:100/count+'%'});html.find('.gal-fullscreen-btn').on('click',function(e){ed_gallery._fullScreenGalleryInitiate($(this));e.stopPropagation();});html.find('.gallery-holder-bg').css({'opacity':(pageobj.fill_opacity/100),'background-color':pageobj.fill_color});this._setData($(element),{visible:false,img_index:-1,time:pageobj.jsobj.time});this._runGalleryImage($(element));this._inplaceIscroll=new eIScroll(html.find('.gallery-holder-inner')[0],{click:false,tap:false,HWCompositing:true,freeScroll:false,scrollX:true,snap:'.gallery-single-image',momentum:false,useTransition:true,});this._inplaceIscroll.on('scrollEnd',function(){self._updateIndicator(html)});setTimeout(function(){self._inplaceIscroll.refresh()},1000);},_getPageObj:function(id,is_mobile){var element;if(!id){return;}
if(is_mobile){if(!eddata||!eddata.mobile_elements){return;}
element=eddata.mobile_elements[id];if(!element){return;}
element=$.extend(true,{},element);return element;}
else{return CitadelaPlayer.findInteractivePageObj(id,'gallery');}},_getData:function(element){if(!element){return;}
return $.extend({},element.data('gallery-data'));},_setData:function(element,data){this._log('Setting gallery data',[element,data]);if(!element){return;}
element.data('gallery-data',data);},_indicatorClicked:function(e)
{var self=e.data;console.log('click '+$(this).data('img_index')+'!');var index=parseInt($(this).data('img_index'),10);if(!(index>-1)){return}
var gallery=$(this).parents('.gallery');var indicators=gallery.find('.gal_indicators .item');indicators.removeClass('active').eq(index).addClass('active');self._goToImageInPlace(gallery,index);e.stopImmediatePropagation();return false;},_goToImageInPlace:function(gallery,index)
{gallery=$(gallery);if(!gallery.length){return}
var img=gallery.find('.gallery-single-image').eq(index);if(this._inplaceIscroll)
{this._inplaceIscroll.scrollTo(-index*img.width(),0,500);this._log('Run gallery image',[element,next]);page_obj=this._getPageObj(gallery.data('mobile-element-id'),1);if(page_obj){window.sendInteractiveStats('Gallery','Click to image',window.CitadelaPlayer.pageMeta.pageid,'','',0,0,1,null,page_obj.jsobj.images[index].image_id,page_obj.jsobj.images[index].title,1);}}},_updateIndicator:function(gallery)
{var indicators=gallery.find('.gal_indicators .item');indicators.removeClass('active');var x=Math.abs(this._inplaceIscroll.x);var oneWidth=this._inplaceIscroll.scrollerWidth / this._images(gallery).length;var index=Math.round(x / oneWidth);console.log([x,oneWidth,index,this._inplaceIscroll.scrollerWidth,this._images().length]);indicators.eq(index).addClass('active');},_runGalleryImage:function(element,next){this._log('Run gallery image',[element,next]);var root_el=this._getRootEl(element);if(!element||!root_el){return;}
var galleryid=this._getRootElementId(root_el);var is_mobile=this._is_mobile_element(root_el);var pageobj=this._getPageObj(galleryid,is_mobile);var data=this._getData(element);var animate,go_to_next;if(!data){return;}
if(pageobj){animate=true;go_to_next=true;if(data.img_index==-1){animate=false;}
if(data.visible=='false'){data.visible=true;data.img_index=1;this._setData(element,data);}
if(!animate){element.find('.gallery-single-image').first().css({'left':'0px'});element.find('.gallery-holder').stop().delay(200).transition({opacity:1},250,'ease-in-out');}}},_fscResizeHandle:function(elem){this._log('fscResizeHandle');if(this._fullscreen_data.gallery_visible)
{var img=$('#gallery_current_image');var image_width=img.width();var image_height=img.height();if(elem){image_width=elem.get(0).width;image_height=elem.get(0).height;}
var ratio=image_width / image_height;var set_height=$('#edition-layers').height();var set_width=Math.round(set_height*ratio);var currentSCREENWIDTH=$('#edition-layers').width();var currentSCREENHEIGHT=$('#edition-layers').height();var offset_x=0;var offset_y=0;if(set_width>currentSCREENWIDTH){set_width=currentSCREENWIDTH;set_height=Math.round(set_width/ratio);}
if(set_height>currentSCREENHEIGHT){set_height=currentSCREENHEIGHT;set_width=Math.round(set_height*ratio);}
if(set_height>=currentSCREENHEIGHT){offset_x=Math.round((currentSCREENWIDTH-set_width)/ 2);}
if(set_width>=currentSCREENWIDTH){offset_y=Math.round((currentSCREENHEIGHT-set_height)/ 2);}
if(!this._fullscreen_data.zoomed_in){img.attr('data-gallery-zoomed',false);img.css({'left':offset_x,'top':offset_y});if(image_width>image_height){img.attr('data-gallery-image-mode','landscape');}
else
{img.attr('data-gallery-image-mode','landscape');}
img.css({width:set_width,height:set_height});}
if(window.initer.isTouchDevice)
{$('#pageGalleryFullscrenDiv').css({height:currentSCREENHEIGHT});img.css({'padding-bottom':offset_y,'padding-right':offset_x});}
if(this._fullscreen_data.iscroll){this._fullscreen_data.iscroll.refresh();}}},_galshowlinkbtn:function(interactiveobj,classlinkbtn,duration,imagesobj,isfsc){this._log('Gallery show link button');if(isfsc)
{var imageUrl=imagesobj;if(imageUrl!='')
{if(imageUrl.indexOf("://")<1)
{imageUrl='http://'+imageUrl;}
$('#'+classlinkbtn).on('click',function(){try
{var focusRequest=window.open(imageUrl,"GalleryLink",'');focusRequest.focus();}catch(e){}});$('#'+classlinkbtn).stop().css({'display':'inline'}).delay(duration).transition({'opacity':'1'},250,'ease-in-out');}
else
{$('#'+classlinkbtn).stop().delay(duration).transition({'opacity':'0'},250,'ease-in-out',function(){$('#'+classlinkbtn).css({'display':'none'});});}}
else
{var imageUrl='';if(imagesobj.link!='')
{imageUrl=imagesobj.link;}
if(imageUrl!='')
{if(imageUrl.indexOf("://")<1)
{imageUrl='http://'+imageUrl;}
$('#'+classlinkbtn).on('click',function(){try
{var focusRequest=window.open(imageUrl,"GalleryLink",'');focusRequest.focus();}catch(e){}});$('#'+classlinkbtn).stop().css({'display':'inline'}).delay(duration).transition({'opacity':'1'},250,'ease-in-out');}
else
{$('#'+classlinkbtn).stop().delay(duration).transition({'opacity':'0'},250,'ease-in-out',function(){$('#'+classlinkbtn).css({'display':'none'});});}}},_destroyIscroll:function(){this._log('Gallery destroy iscroll');if(this._fullscreen_data.iscroll){this._fullscreen_data.iscroll.destroy();this._fullscreen_data.iscroll=undefined;}},_fscEndedLoadingShowImage:function(elem,src,galleryid){this._log('Gallery ended loading show image');var fromw=-1;var fromh=-1;var current_img;$('#loading').velocity({opacity:0},{duration:200,display:"none"});current_img=$('<img id="gallery_current_image">');current_img.addClass('gpuAcc');current_img.addClass('renderBQ');current_img.attr('src',src);$('#gallery_current_image').remove();$('.parentParentOfImageFSCGallery').append(current_img);this._destroyIscroll();this._fscResizeHandle($(elem));current_img.delay(200).fadeTo(250,1,function(){ed_gallery._runIscroll(current_img);});},_runIscroll:function(objimg){this._log('Gallery run iscroll');this._fullscreen_data.iscroll=new eIScroll('.parentParentOfImageFSCGallery',{zoom:true,click:true,HWCompositing:true,startX:0,startY:0,interactiveScrollbars:true,freeScroll:true,scrollX:true,scrollY:true,scrollbars:true,mouseWheel:true,wheelAction:'scroll'});},_FSCGalleryNextOrPrevious:function(incdec){this._log('Gallery next or previous image',[incdec]);var page_obj,currimgindex;if(this._fullscreen_data.zoomed_in){this._zoomInZoomOutFSCGalllery();}
var next=false;var previous=false;if(incdec>0){next=true;}
else{previous=true;}
page_obj=this._getPageObj(this._fullscreen_data.gallery_id,this._fullscreen_data.is_mobile);currimgindex=this._fullscreen_data.img_index;if(next){currimgindex=currimgindex+1;if(currimgindex>page_obj.jsobj.images.length){currimgindex=1;}
if(page_obj){window.sendInteractiveStats('Gallery','Next',window.CitadelaPlayer.pageMeta.pageid,page_obj.jsobj.settings.albumtitle,'',0,0,page_obj.id,null,page_obj.jsobj.images[currimgindex-1].image_id,page_obj.jsobj.images[currimgindex-1].title,this._fullscreen_data.is_mobile);}
this._fscGalLoadAndDisplayImage(this._fullscreen_data.gallery_id,currimgindex);}
else
{currimgindex=currimgindex-1;if(currimgindex<1)
{currimgindex=page_obj.jsobj.images.length;}
if(page_obj)
{window.sendInteractiveStats('Gallery','Previous',window.CitadelaPlayer.pageMeta.pageid,page_obj.jsobj.settings.albumtitle,'',0,0,page_obj.id,null,page_obj.jsobj.images[currimgindex-1].image_id,page_obj.jsobj.images[currimgindex-1].title,this._fullscreen_data.is_mobile);}
this._fscGalLoadAndDisplayImage(this._fullscreen_data.gallery_id,currimgindex);}},_clearFSCFallery:function(){this._log('Gallery clear fsc gallery');$('#loading').css({'z-index':2});$('#pageGalleryFullscrenDiv').remove();this._destroyIscroll();$('#edition-layers').stop().css({'position':'fixed',display:'none'});this._fullscreen_data=$.extend({},this._default_fullscreen_data);},_fscGalClose:function(){this._log('Gallery close');var page_obj=this._getPageObj(this._fullscreen_data.gallery_id,this._fullscreen_data.is_mobile);if(page_obj){window.sendInteractiveStats('Gallery','Close full screen',window.CitadelaPlayer.pageMeta.pageid,page_obj.jsobj.settings.albumtitle,'',0,0,page_obj.id,null,undefined,undefined,this._fullscreen_data.is_mobile);}
this._fullscreen_data.gallery_visible=false;$('#pageGalleryFullscrenDiv').transition({'opacity':'0'},300,'ease-in-out',function(){ed_gallery._clearFSCFallery();});},_fscGalLoadAndDisplayImage:function(gallery_id,imageactiveindex){this._log('gallery load and display image',[imageactiveindex]);$('#edition-player').removeClass('edition-player').addClass('edition-player');var page_obj=this._getPageObj(gallery_id,this._fullscreen_data.is_mobile);$('#loading').css({'background-color':'transparent'}).velocity({opacity:1},{duration:200,display:"block"});if(page_obj){imageactiveindex=parseInt(imageactiveindex);if((parseInt(imageactiveindex)<1)||(isNaN(imageactiveindex)))
{imageactiveindex=1;}
if(imageactiveindex>page_obj.jsobj.images.length)
{imageactiveindex=page_obj.jsobj.images.length;}
var tmpImage=new Image();var countindex=0;tmpImage.alt=gallery_id;for(var d in page_obj.jsobj.images)
{countindex++;if(countindex==imageactiveindex)
{$('.parentParentOfImageFSCGallery').fadeTo(0,'fast');var currimage=page_obj.jsobj.images[d];tmpImage.onload=function(){ed_gallery._fscEndedLoadingShowImage(this,this.src,this.alt);};tmpImage.src=currimage.bigimg;this._fullscreen_data.img_index=imageactiveindex;$('.FSgalleryLabel').html(imageactiveindex+' / '+(page_obj.jsobj.images.length));this._galshowlinkbtn(null,'gal'+this._fullscreen_data.gallery_id+'linkbtnfsc',0,page_obj.jsobj.images[d].link,true);}}}},_zoomInZoomOutFSCGalllery:function(){this._log('Gallery zoom in zoom out');if(this._fullscreen_data.zoomed_in)
{$('.FSgalleryZoomInButton').removeClass('FSgalleryZoomOutButton');zoomFromX=Math.round(parseInt($('#edition-layers').width())/2);this._fullscreen_data.iscroll.zoom(0,Math.round(($('#gallery_current_image').width()/2)),0,300);$('#gallery_current_image').css({'left':'0px','top':'0px'});this._fullscreen_data.zoomed_in=false;this._fscResizeHandle();}
else
{$('.FSgalleryZoomInButton').removeClass('FSgalleryZoomOutButton').addClass('FSgalleryZoomOutButton');this._fullscreen_data.zoomed_in=true;$('#gallery_current_image').css({'left':'0px','top':'0px'});zoomFromX=Math.round(parseInt($('#edition-layers').width())/2);this._fullscreen_data.iscroll.zoom(2,Math.round(($('#gallery_current_image').width()/2)),0,300);}},_fullScreenGalleryInitiate:function(clickedel){this._log('fullscreen gallery initiate',[clickedel]);var root_el=this._getRootEl(clickedel);if(!root_el){return;}
$('#loading').css({'z-index':999});this._fullscreen_data.gallery_visible=true;this._fullscreen_data.gallery_id=this._getRootElementId(root_el);this._fullscreen_data.is_mobile=this._is_mobile_element(root_el);var page_obj=this._getPageObj(this._fullscreen_data.gallery_id,this._fullscreen_data.is_mobile);if(page_obj)
{window.sendInteractiveStats('Gallery','Full screen',window.CitadelaPlayer.pageMeta.pageid,page_obj.jsobj.settings.albumtitle,'',0,0,page_obj.id,null,page_obj.jsobj.images[0].image_id,page_obj.jsobj.images[0].title,this._fullscreen_data.is_mobile);}
try
{if(page_obj){var currentindex=this._fullscreen_data.img_index;var full_screen_div=$('#pageGalleryFullscrenDiv');if(full_screen_div.length==0){$('#edition-layers').append('<div id="pageGalleryFullscrenDiv" class="gpuAcc gallFullScreen NoSelect textAlignLeft"></div>');full_screen_div=$('#pageGalleryFullscrenDiv');}
$('.parentParentOfImageFSCGallery').html('');full_screen_div.append('<div class="parentParentOfImageFSCGallery"></div>');if(page_obj.jsobj.images.length>1)
{full_screen_div.append('<div id="FSCbuttonleft" class="FSgalleryLeftButton gpuAcc button90 FSCleftarrow coloroverride" onclick="javascript:ed_gallery._FSCGalleryNextOrPrevious(-1);"><div></div><span></span></div>');full_screen_div.append('<div id="FSCbuttonright" class="FSgalleryRightButton gpuAcc button90 FSCrightarrow coloroverride" style="right:0px;" onclick="javascript:ed_gallery._FSCGalleryNextOrPrevious(1);"><div></div><span></span></div>');}
full_screen_div.append('<div id="FSCbuttonclose" class="FSgalleryCloseButton gpuAcc button90 FSCclosegallery coloroverride" style="right:0px" onclick="javascript:ed_gallery._fscGalClose();"><div></div><span></span></div>');full_screen_div.append('<div id="gal'+this._fullscreen_data.gallery_id+'linkbtnfsc" class="FSCGalleryLinkButton FSCgallinkbutton gpuAcc button90 coloroverride"></div>');full_screen_div.append('<div id="FSCGalleryZoomId" class="FSgalleryZoomInButton gpuAcc button90 FSCzoominouttogle coloroverride" style="right:0px" onclick="javascript:ed_gallery._zoomInZoomOutFSCGalllery();"><div></div><span></span></div>');full_screen_div.append('<div id="FSClabelpages" class="FSgalleryLabel gpuAcc"></div>');$('#edition-layers').stop().css({'position':'fixed',display:'block'});full_screen_div.transition({'opacity':1},'fast');if(page_obj.jsobj.images.length>1)
{var hammerHandler=new Hammer($('#pageGalleryFullscrenDiv')[0]);hammerHandler.on('panstart',function(ev){ed_gallery._onFSCGalPanStart(ev);});hammerHandler.on('pan',function(ev){ed_gallery._onFSCGalPan(ev);});hammerHandler.on('panend',function(ev){ed_gallery._onFSCGalPanEnd(ev);});}
this._fscGalLoadAndDisplayImage(this._fullscreen_data.gallery_id,currentindex);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: mobileplayer.js; line: 479; column: 126;  :: '+v);console.log('Error while trying to run FULLSCREEN Gallery -> '+e.message);}},_onFSCGalPanStart:function(ev){this._log('Gallery pan start');this._fullscreen_data.zoomed_in=this._fullscreen_data.iscroll.scale>1;this._fullscreen_data.neededmoveXforswipe=Math.round($('#edition-layers').width()/4);if(this._fullscreen_data.neededmoveXforswipe>300){this._fullscreen_data.neededmoveXforswipe=300;}
else if(this._fullscreen_data.neededmoveXforswipe<120){this._fullscreen_data.neededmoveXforswipe=120;}
this._fullscreen_data.offsetFSC=0;},_onFSCGalPan:function(ev){this._log('Gallery panning');if(!this._fullscreen_data.zoomed_in)
{this._fullscreen_data.offsetFSC=ev.deltaX;var opacityset=Math.abs(this._fullscreen_data.offsetFSC)/this._fullscreen_data.neededmoveXforswipe;if(opacityset>1)
{opacityset=1;}
else if(opacityset<0)
{opacityset=0;}
opacityset=1-opacityset;if(this._fullscreen_data.offsetFSC<0)
{$('#FSCbuttonright').css({opacity:1});$('#FSCbuttonleft').css({opacity:opacityset});$('.parentParentOfImageFSCGallery').css({x:this._fullscreen_data.offsetFSC,opacity:opacityset});}
else if(this._fullscreen_data.offsetFSC>0)
{$('#FSCbuttonleft').css({opacity:1});$('#FSCbuttonright').css({opacity:opacityset});$('.parentParentOfImageFSCGallery').css({x:this._fullscreen_data.offsetFSC,opacity:opacityset});}
else
{$('#FSCbuttonleft').css({opacity:1});$('#FSCbuttonright').css({opacity:1});$('.parentParentOfImageFSCGallery').css({x:0,opacity:1});}}},_onFSCGalPanEnd:function(ev){this._log('Pan ended');this._fullscreen_data.zoomed_in=this._fullscreen_data.iscroll.scale>1;if((this._fullscreen_data.offsetFSC<=-this._fullscreen_data.neededmoveXforswipe)&&(!this._fullscreen_data.zoomed_in))
{$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');$('.parentParentOfImageFSCGallery').transition({x:0,opacity:1},'fast');this._FSCGalleryNextOrPrevious(1);}
else if((this._fullscreen_data.offsetFSC>=this._fullscreen_data.neededmoveXforswipe)&&(!this._fullscreen_data.zoomed_in))
{$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');$('.parentParentOfImageFSCGallery').transition({x:0,opacity:1},'fast');this._FSCGalleryNextOrPrevious(-1);}
else
{$('.parentParentOfImageFSCGallery').transition({x:0,opacity:1},'fast');$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');}
this._fullscreen_data.offsetFSC=0;},};
;
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(window,document,Math){var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000 / 60);};var utils=(function(){var me={};var _elementStyle=document.createElement('div').style;var _vendor=(function(){var vendors=['t','webkitT','MozT','msT','OT'],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+'ransform';if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);}
return false;})();function _prefixStyle(style){if(_vendor===false)return false;if(_vendor==='')return style;return _vendor+style.charAt(0).toUpperCase()+style.substr(1);}
me.getTime=Date.now||function getTime(){return new Date().getTime();};me.extend=function(target,obj){for(var i in obj){target[i]=obj[i];}};me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture);};me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture);};me.prefixPointerEvent=function(pointerEvent){return window.MSPointerEvent?'MSPointer'+pointerEvent.charAt(9).toUpperCase()+pointerEvent.substr(10):pointerEvent;};me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/ time,destination,duration;deceleration=deceleration===undefined?0.0006:deceleration;destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);duration=speed / deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-(wrapperSize / 2.5*(speed / 8)):lowerMargin;distance=Math.abs(destination-current);duration=distance / speed;}else if(destination>0){destination=wrapperSize?wrapperSize / 2.5*(speed / 8):0;distance=Math.abs(current)+destination;duration=distance / speed;}
return{destination:Math.round(destination),duration:duration};};var _transform=_prefixStyle('transform');me.extend(me,{hasTransform:_transform!==false,hasPerspective:_prefixStyle('perspective')in _elementStyle,hasTouch:'ontouchstart'in window,hasPointer:window.PointerEvent||window.MSPointerEvent,hasTransition:_prefixStyle('transition')in _elementStyle});me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle('transitionTimingFunction'),transitionDuration:_prefixStyle('transitionDuration'),transitionDelay:_prefixStyle('transitionDelay'),transformOrigin:_prefixStyle('transformOrigin')});me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className);};me.addClass=function(e,c){if(me.hasClass(e,c)){return;}
var newclass=e.className.split(' ');newclass.push(c);e.className=newclass.join(' ');};me.removeClass=function(e,c){if(!me.hasClass(e,c)){return;}
var re=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');e.className=e.className.replace(re,' ');};me.offset=function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop;}
return{left:left,top:top};};me.preventDefaultException=function(el,exceptions){for(var i in exceptions){if(exceptions[i].test(el[i])){return true;}}
return false;};me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});me.extend(me.ease={},{quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k);}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return Math.sqrt(1-(--k*k));}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1;}},bounce:{style:'',fn:function(k){if((k /=1)<(1 / 2.75)){return 7.5625*k*k;}else if(k<(2 / 2.75)){return 7.5625*(k-=(1.5 / 2.75))*k+0.75;}else if(k<(2.5 / 2.75)){return 7.5625*(k-=(2.25 / 2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625 / 2.75))*k+0.984375;}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0;}
if(k==1){return 1;}
return(e*Math.pow(2,-10*k)*Math.sin((k-f / 4)*(2*Math.PI)/ f)+1);}}});me.tap=function(e,eventName){var ev=document.createEvent('Event');ev.initEvent(eventName,true,true);ev.pageX=e.pageX;ev.pageY=e.pageY;e.target.dispatchEvent(ev);};me.click=function(e){var target=e.target,ev;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName)){ev=document.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._constructed=true;target.dispatchEvent(ev);}};return me;})();function IScrollProbe(el,options){this.wrapper=typeof el=='string'?document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.scroller.style['touch-action']='none';this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:'',preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true,janMarryGoRound:false};for(var i in options){this.options[i]=options[i];}
if(this.options.janMarryGoRound){this.options.bounce=false;}
this.translateZ=this.options.HWCompositing&&utils.hasPerspective?' translateZ(0) translate3d(0,0,0)':'';this.options.useTransition=utils.hasTransition&&this.options.useTransition;this.options.useTransform=utils.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=='string'?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap='tap';}
if(this.options.shrinkScrollbars=='scale'){this.options.useTransition=false;}
this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.probeType==3){this.options.useTransition=false;}
this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable();}
IScrollProbe.prototype={version:'5.1.3',_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators();}
if(this.options.mouseWheel){this._initWheel();}
if(this.options.snap){this._initSnap();}
if(this.options.keyBindings){this._initKeys();}},destroy:function(){this._initEvents(true);this._execEvent('destroy');},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return;}
this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent('scrollEnd');}},_start:function(e){if(utils.eventType[e.type]!=1){if(e.button!==0){return;}}
if(!this.enabled||(this.initiated&&utils.eventType[e.type]!==this.initiated)){return;}
if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.touches?e.touches[0]:e,pos;this.initiated=utils.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=utils.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this._execEvent('scrollEnd');}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent('scrollEnd');}
this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this._execEvent('beforeScrollStart');},_move:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime(),newX,newY,absDistX,absDistY;this.pointX=point.pageX;this.pointY=point.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return;}
if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked='h';}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked='v';}else{this.directionLocked='n';}}
if(this.directionLocked=='h'){if(this.options.eventPassthrough=='vertical'){e.preventDefault();}else if(this.options.eventPassthrough=='horizontal'){this.initiated=false;return;}
deltaY=0;}else if(this.directionLocked=='v'){if(this.options.eventPassthrough=='horizontal'){e.preventDefault();}else if(this.options.eventPassthrough=='vertical'){this.initiated=false;return;}
deltaX=0;}
deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX / 3:newX>0?0:this.maxScrollX;}
if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY / 3:newY>0?0:this.maxScrollY;}
this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent('scrollStart');}
this.moved=true;this._translate(newX,newY);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent('scroll');}}
if(this.options.probeType>1){this._execEvent('scroll');}},_end:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
this._execEvent('scrollReleased');if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing='';this.isInTransition=0;this.initiated=0;this.endTime=utils.getTime();if(this.resetPosition(this.options.bounceTime)){return;}
this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){utils.tap(e,this.options.tap);}
if(this.options.click){utils.click(e);}
this._execEvent('scrollCancel');return;}
if(this._events.flick&&duration<200&&distanceX<100&&distanceY<(this.options.maxFlickY||150)&&distanceY>(this.options.minFlickY||20)){this._execEvent('flick');return;}
if(this.options.momentum&&duration<500){momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=Math.max(momentumX.duration,momentumY.duration);this.isInTransition=1;}
if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap;time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1000),Math.min(Math.abs(newY-snap.y),1000)),300);newX=snap.x;newY=snap.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing;}
if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=utils.ease.quadratic;}
this.scrollTo(newX,newY,time,easing);return;}
this._execEvent('scrollEnd');},_resize:function(){var that=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){that.refresh();},this.options.resizePolling);},resetPosition:function(time){var x=this.x,y=this.y;time=time||0;if(!this.hasHorizontalScroll||this.x>0){x=0;}else if(this.x<this.maxScrollX){x=this.maxScrollX;}
if(!this.hasVerticalScroll||this.y>0){y=0;}else if(this.y<this.maxScrollY){y=this.maxScrollY;}
if(x==this.x&&y==this.y){return false;}
this.scrollTo(x,y,time,this.options.bounceEasing);return true;},disable:function(){this.enabled=false;},enable:function(){this.enabled=true;},refresh:function(){var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=(this.options.janMarryGoRound?0:this.wrapperWidth)-
this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth;}
if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight;}
this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=utils.offset(this.wrapper);this._execEvent('refresh');this.resetPosition();},on:function(type,fn){if(!this._events[type]){this._events[type]=[];}
this._events[type].push(fn);},off:function(type,fn){if(!this._events[type]){return;}
var index=this._events[type].indexOf(fn);if(index>-1){this._events[type].splice(index,1);}},_execEvent:function(type){if(!this._events[type]){return;}
var i=0,l=this._events[type].length;if(!l){return;}
for(;i<l;i++){this._events[type][i].apply(this,[].slice.call(arguments,1));}},scrollBy:function(x,y,time,easing){x=this.x+x;y=this.y+y;time=time||0;this.scrollTo(x,y,time,easing);},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular;this.isInTransition=this.options.useTransition&&time>0;if(!time||(this.options.useTransition&&easing.style)){this._transitionTimingFunction(easing.style);this._transitionTime(time);this._translate(x,y);}else{this._animate(x,y,time,easing.fn);}},scrollToElement:function(el,time,offsetX,offsetY,easing){el=el.nodeType?el:this.scroller.querySelector(el);if(!el){return;}
var pos=utils.offset(el);pos.left-=this.wrapperOffset.left;pos.top-=this.wrapperOffset.top;if(offsetX===true){offsetX=Math.round(el.offsetWidth / 2-this.wrapper.offsetWidth / 2);}
if(offsetY===true){offsetY=Math.round(el.offsetHeight / 2-this.wrapper.offsetHeight / 2);}
pos.left-=offsetX||0;pos.top-=offsetY||0;pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;time=time===undefined||time===null||time==='auto'?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;this.scrollTo(pos.left,pos.top,time,easing);},_transitionTime:function(time){time=time||0;this.scrollerStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.scrollerStyle[utils.style.transitionDuration]='0.001s';}
if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(time);}}},_transitionTimingFunction:function(easing){this.scrollerStyle[utils.style.transitionTimingFunction]=easing;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(easing);}}},_translate:function(x,y){if(this.options.useTransform){this.scrollerStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.translateZ;}else{x=Math.round(x);y=Math.round(y);this.scrollerStyle.left=x+'px';this.scrollerStyle.top=y+'px';}
this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition();}}},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,'orientationchange',this);eventType(window,'resize',this);if(this.options.click){eventType(this.wrapper,'click',this,true);}
if(!this.options.disableMouse){eventType(this.wrapper,'mousedown',this);eventType(target,'mousemove',this);eventType(target,'mousecancel',this);eventType(target,'mouseup',this);}
if(utils.hasPointer&&!this.options.disablePointer){eventType(this.wrapper,utils.prefixPointerEvent('pointerdown'),this);eventType(target,utils.prefixPointerEvent('pointermove'),this);eventType(target,utils.prefixPointerEvent('pointercancel'),this);eventType(target,utils.prefixPointerEvent('pointerup'),this);}
if(utils.hasTouch&&!this.options.disableTouch){eventType(this.wrapper,'touchstart',this);eventType(target,'touchmove',this);eventType(target,'touchcancel',this);eventType(target,'touchend',this);}
eventType(this.scroller,'transitionend',this);eventType(this.scroller,'webkitTransitionEnd',this);eventType(this.scroller,'oTransitionEnd',this);eventType(this.scroller,'MSTransitionEnd',this);},getComputedPosition:function(){var matrix=window.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){matrix=matrix[utils.style.transform].split(')')[0].split(', ');x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5]);}else{x=+matrix.left.replace(/[^-\d.]/g,'');y=+matrix.top.replace(/[^-\d.]/g,'');}
return{x:x,y:y};},_initIndicators:function(){var interactive=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!='string',indicators=[],indicator;var that=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar('v',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}
if(this.options.scrollX){indicator={el:createDefaultScrollbar('h',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}}
if(this.options.indicators){indicators=indicators.concat(this.options.indicators);}
for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]));}
function _indicatorsMap(fn){for(var i=that.indicators.length;i--;){fn.call(that.indicators[i]);}}
if(this.options.fadeScrollbars){this.on('scrollEnd',function(){_indicatorsMap(function(){this.fade();});});this.on('scrollCancel',function(){_indicatorsMap(function(){this.fade();});});this.on('scrollStart',function(){_indicatorsMap(function(){this.fade(1);});});this.on('beforeScrollStart',function(){_indicatorsMap(function(){this.fade(1,true);});});}
this.on('refresh',function(){_indicatorsMap(function(){this.refresh();});});this.on('destroy',function(){_indicatorsMap(function(){this.destroy();});delete this.indicators;});},_initWheel:function(){utils.addEvent(this.wrapper,'wheel',this);utils.addEvent(this.wrapper,'mousewheel',this);utils.addEvent(this.wrapper,'DOMMouseScroll',this);this.on('destroy',function(){utils.removeEvent(this.wrapper,'wheel',this);utils.removeEvent(this.wrapper,'mousewheel',this);utils.removeEvent(this.wrapper,'DOMMouseScroll',this);});},_wheel:function(e){if(!this.enabled){return;}
e.preventDefault();e.stopPropagation();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent('scrollStart');}
clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('scrollEnd');that.wheelTimeout=undefined;},400);if('deltaX'in e){if(e.deltaMode===1){wheelDeltaX=-e.deltaX*this.options.mouseWheelSpeed;wheelDeltaY=-e.deltaY*this.options.mouseWheelSpeed;}else{wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY;}}else if('wheelDeltaX'in e){wheelDeltaX=e.wheelDeltaX / 120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY / 120*this.options.mouseWheelSpeed;}else if('wheelDelta'in e){wheelDeltaX=wheelDeltaY=e.wheelDelta / 120*this.options.mouseWheelSpeed;}else if('detail'in e){wheelDeltaX=wheelDeltaY=-e.detail / 3*this.options.mouseWheelSpeed;}else{return;}
wheelDeltaX*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){wheelDeltaX=wheelDeltaY;wheelDeltaY=0;}
if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(wheelDeltaX>0){newX--;}else if(wheelDeltaX<0){newX++;}
if(wheelDeltaY>0){newY--;}else if(wheelDeltaY<0){newY++;}
this.goToPage(newX,newY);return;}
newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
this.scrollTo(newX,newY,0);if(this.options.probeType>1){this._execEvent('scroll');}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=='string'){this.options.origSnap=this.options.snap;this.options.snap=this.scroller.querySelectorAll(this.options.snap);}
this.on('refresh',function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return;}
if(this.options.snap===true){cx=Math.round(stepX / 2);cy=Math.round(stepY / 2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++;}
x-=stepX;i++;}}else{this.options.snap=this.scroller.querySelectorAll(this.options.origSnap);el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++;}
if(!this.pages[m]){this.pages[m]=[];}
x=Math.max(-el[i].offsetLeft,this.maxScrollX);y=Math.max(-el[i].offsetTop,this.maxScrollY);cx=x-Math.round(el[i].offsetWidth / 2);cy=y-Math.round(el[i].offsetHeight / 2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++;}}}
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold;}else{this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold);}});this.on('flick',function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1000),Math.min(Math.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time);});},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0};}
var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage;}
if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break;}}
l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break;}}
if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0;}else if(i>=this.pages.length){i=this.pages.length-1;}
x=this.pages[i][0].x;}
if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0;}else if(m>=this.pages[0].length){m=this.pages[0].length-1;}
y=this.pages[0][m].y;}
return{x:x,y:y,pageX:i,pageY:m};},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1;}else if(x<0){x=0;}
if(y>=this.pages[x].length){y=this.pages[x].length-1;}else if(y<0){y=0;}
var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=time===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1000),Math.min(Math.abs(posY-this.y),1000)),300):time;this.currentPage={x:posX,y:posY,pageX:x,pageY:y};this.scrollTo(posX,posY,time,easing);},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++;}
this.goToPage(x,y,time,easing);},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--;}
this.goToPage(x,y,time,easing);},_initKeys:function(e){var keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=='object'){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=='string'){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0);}}}else{this.options.keyBindings={};}
for(i in keys){this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];}
utils.addEvent(window,'keydown',this);this.on('destroy',function(){utils.removeEvent(window,'keydown',this);});},_key:function(e){if(!this.enabled){return;}
var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=0.250,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this.isInTransition=false;}
this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=snap?1:this.wrapperWidth;}else{newY+=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=snap?1:this.wrapperWidth;}else{newY-=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX;newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return;}
if(snap){this.goToPage(newX,newY);return;}
if(newX>0){newX=0;this.keyAcceleration=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0;}
if(newY>0){newY=0;this.keyAcceleration=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0;}
this.scrollTo(newX,newY,0);this.keyTime=now;},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;function step(){var now=utils.getTime(),newX,newY,easing;if(now>=destTime){that.isAnimating=false;that._translate(destX,destY);if(!that.resetPosition(that.options.bounceTime)){that._execEvent('scrollEnd');}
return;}
now=(now-startTime)/ duration;easing=easingFn(now);newX=(destX-startX)*easing+startX;newY=(destY-startY)*easing+startY;that._translate(newX,newY);if(that.isAnimating){rAF(step);}
if(that.options.probeType==3){that._execEvent('scroll');}}
this.isAnimating=true;step();},handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;case'orientationchange':case'resize':this._resize();break;case'transitionend':case'webkitTransitionEnd':case'oTransitionEnd':case'MSTransitionEnd':this._transitionEnd(e);break;case'wheel':case'DOMMouseScroll':case'mousewheel':this._wheel(e);break;case'keydown':this._key(e);break;case'click':if(!e._constructed){e.preventDefault();e.stopPropagation();}
break;}}};function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement('div'),indicator=document.createElement('div');if(type===true){scrollbar.style.cssText='position:absolute;z-index:9999';indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px';}
indicator.className='iScrollIndicator';if(direction=='h'){if(type===true){scrollbar.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';indicator.style.height='100%';}
scrollbar.className='iScrollHorizontalScrollbar';}else{if(type===true){scrollbar.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';indicator.style.width='100%';}
scrollbar.className='iScrollVerticalScrollbar';}
scrollbar.style.cssText+=';overflow:hidden';if(!interactive){scrollbar.style.pointerEvents='none';}
scrollbar.appendChild(indicator);return scrollbar;}
function Indicator(scroller,options){this.wrapper=typeof options.el=='string'?document.querySelector(options.el):options.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in options){this.options[i]=options[i];}
this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){utils.addEvent(this.indicator,'touchstart',this);utils.addEvent(window,'touchend',this);}
if(!this.options.disablePointer){utils.addEvent(this.indicator,utils.prefixPointerEvent('pointerdown'),this);utils.addEvent(window,utils.prefixPointerEvent('pointerup'),this);}
if(!this.options.disableMouse){utils.addEvent(this.indicator,'mousedown',this);utils.addEvent(window,'mouseup',this);}}
if(this.options.fade){this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?'0.001s':'0ms';this.wrapperStyle.opacity='0';}}
Indicator.prototype={handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;}},destroy:function(){if(this.options.interactive){utils.removeEvent(this.indicator,'touchstart',this);utils.removeEvent(this.indicator,utils.prefixPointerEvent('pointerdown'),this);utils.removeEvent(this.indicator,'mousedown',this);utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,utils.prefixPointerEvent('pointermove'),this);utils.removeEvent(window,'mousemove',this);utils.removeEvent(window,'touchend',this);utils.removeEvent(window,utils.prefixPointerEvent('pointerup'),this);utils.removeEvent(window,'mouseup',this);}
if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper);}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=utils.getTime();if(!this.options.disableTouch){utils.addEvent(window,'touchmove',this);}
if(!this.options.disablePointer){utils.addEvent(window,utils.prefixPointerEvent('pointermove'),this);}
if(!this.options.disableMouse){utils.addEvent(window,'mousemove',this);}
this.scroller._execEvent('beforeScrollStart');},_move:function(e){var point=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=utils.getTime();if(!this.moved){this.scroller._execEvent('scrollStart');}
this.moved=true;deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);if(this.scroller.options.probeType==1&&timestamp-this.startTime>300){this.startTime=timestamp;this.scroller._execEvent('scroll');}else if(this.scroller.options.probeType>1){this.scroller._execEvent('scroll');}
e.preventDefault();e.stopPropagation();},_end:function(e){if(!this.initiated){return;}
this.initiated=false;e.preventDefault();e.stopPropagation();utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,utils.prefixPointerEvent('pointermove'),this);utils.removeEvent(window,'mousemove',this);if(this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1000),Math.min(Math.abs(this.scroller.y-snap.y),1000)),300);if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=snap;this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing);}}
if(this.moved){this.scroller._execEvent('scrollEnd');}},transitionTime:function(time){time=time||0;this.indicatorStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.indicatorStyle[utils.style.transitionDuration]='0.001s';}},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing;},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none';}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none';}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none';}
if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){utils.addClass(this.wrapper,'iScrollBothScrollbars');utils.removeClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='8px';}else{this.wrapper.style.bottom='8px';}}}else{utils.removeClass(this.wrapper,'iScrollBothScrollbars');utils.addClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='2px';}else{this.wrapper.style.bottom='2px';}}}
var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth /(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+'px';}else{this.indicatorWidth=this.indicator.clientWidth;}
this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=='clip'){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8;}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX;}
this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX / this.scroller.maxScrollX));}
if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight /(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+'px';}else{this.indicatorHeight=this.indicator.clientHeight;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=='clip'){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8;}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY / this.scroller.maxScrollY));}
this.updatePosition();},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+'px';}
x=this.minBoundaryX;}else if(x>this.maxBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+'px';x=this.maxPosX+this.indicatorWidth-this.width;}else{x=this.maxBoundaryX;}}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+'px';}
if(y<this.minBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+'px';}
y=this.minBoundaryY;}else if(y>this.maxBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+'px';y=this.maxPosY+this.indicatorHeight-this.height;}else{y=this.maxBoundaryY;}}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+'px';}}
this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ;}else{this.indicatorStyle.left=x+'px';this.indicatorStyle.top=y+'px';}},_pos:function(x,y){if(x<0){x=0;}else if(x>this.maxPosX){x=this.maxPosX;}
if(y<0){y=0;}else if(y>this.maxPosY){y=this.maxPosY;}
x=this.options.listenX?Math.round(x / this.sizeRatioX):this.scroller.x;y=this.options.listenY?Math.round(y / this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y);},fade:function(val,hold){if(hold&&!this.visible){return;}
clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?'1':'0';this.wrapperStyle[utils.style.transitionDuration]=time+'ms';this.fadeTimeout=setTimeout((function(val){this.wrapperStyle.opacity=val;this.visible=+val;}).bind(this,val),delay);}};IScrollProbe.utils=utils;if(typeof module!='undefined'&&module.exports){module.exports=IScrollProbe;}else{window.IScrollProbe=IScrollProbe;}})(window,document,Math);
;
var edThreesixty={_windowResizeRegistered:false,THUMB_PADDING:20,_oneImgDistance:10,getDiv:function(parent_index,interactive_index,into_parent_div)
{var currobj=window.eddata.pages[parent_index].interactive[interactive_index];currobj.holderDivId='threesixty'+currobj.id;currobj.contentloaded=true;currobj.divid=currobj.holderDivId;var protoStr=''+'<div class="el_threesixty gpuAcc element_holder" ontouchstart="window.ed._is_gallery_mouse_down = true;" ontouchend="window.ed._is_gallery_mouse_down = false;"  '+'>'+'   <img class="preloader"></img>'+'   <div class="progbar">'+'       <div class="progthumb"></div>'+'   </div>'+'   <div class="iscroll_holder">'+'        <div class="iscroll_content"></div>'+'    </div>'+'</div>';var div=$(protoStr).attr('id',currobj.holderDivId).css({left:currobj.x,top:currobj.y,width:currobj.w,height:currobj.h,opacity:0.01});var src_html=div[0].outerHTML;var pageNum=window.eddata.pages[parent_index].pagenumber;setTimeout(function(){window.ed.checkPreloadedImgs(pageNum,currobj.holderDivId,'threesixty');},300);return src_html;},drawDivForMobile:function(pageobj,div){var self=this;div=$(div);if(!div.length){return}
var html=$(''+'   <img class="preloader"></img>'+'   <div class="progbar">'+'       <div class="progthumb"></div>'+'   </div>'+'   <div class="iscroll_holder">'+'        <div class="iscroll_content"></div>'+'    </div>');div.append(html);div.removeClass('ed-gallery').removeClass('gallery').addClass('el_threesixty handle_touches');this.finalizeElement(pageobj,div);},finalizeElement:function(data,div)
{var self=this;jtrace('finalize edThreesixty',data);var div=$(div);if(!div.length){div=$('#'+data.holderDivId);}
var i=0;div.find('.progbar').addClass('hidden');if(data.additional_params)
{var color=data.additional_params.threesixty_background;if(color){div.css({'background-color':color});}}
var iscroll=new IScrollProbe(div.find('.iscroll_holder')[0],{scrollX:true,probeType:3,momentum:true,janMarryGoRound:true,});iscroll.disable();iscroll.on('scroll',this._onScroll);iscroll.maxScrollX=-2147480000;iscroll.x=iscroll.maxScrollX / 2;iscroll.hasHorizontalScroll=true;div.data('iscroll',iscroll);div.data('scrollStartPoint',iscroll.x);if(!self._windowResizeRegistered)
{self._windowResizeRegistered=true;var resetTO=false;$(document).on("edResize",function(){clearTimeout(resetTO);resetTO=setTimeout(function(){$('.el_threesixty').each(function()
{var iscroll=$(this).data('iscroll');if(!iscroll){return}
iscroll.maxScrollX=-2147480000;iscroll.x=iscroll.maxScrollX / 2;self._onScroll.call(iscroll);});},100);});}
div.find('.progbar').on('mousedown',this,this._thumbMouseDown);div.find('.progbar').on('mousemove',this,this._thumbMouseMove);var preloader=div.find('.preloader');var thumbsLoaded=false;preloader.on('load',function(e)
{var imgEl=div.find('.threesixty_img').filter(function(){return $(this).data('index')==i});if(!imgEl.length)
{imgEl=$('<div class="threesixty_img"></div>');imgEl.data('index',i);div.append(imgEl);}
imgEl.css({'background-image':'url('+$(this).attr('src')+')'});if(i==0){imgEl.addClass('max');}
i++;if(!thumbsLoaded)
{if(i<=data.jsobj.images.length-1)
{preloader.attr('src',data.jsobj.images[i].thumb);}
else
{thumbsLoaded=true;iscroll.enable();if(!data.additional_params||data.additional_params.threesixty_slider==1)
{div.find('.progbar').removeClass('hidden');}
jtrace('*** Loading big images ***');i=0;preloader.attr('src',data.jsobj.images[i].bigimg);self._updateProgressThumbPos(div);}}
else if(i<=data.jsobj.images.length-1)
{preloader.attr('src',data.jsobj.images[i].bigimg);}})
if(!data.jsobj.images||!data.jsobj.images.length){return}
jtrace('*** Loading thumbs ***');preloader.attr('src',data.jsobj.images[0].thumb);},_elFromIscroll:function(iscroll)
{return $(iscroll.wrapper).parents('.el_threesixty').first();},getImages:function(el)
{return $(el).find('.threesixty_img');},_updateProgressThumbPos:function(el)
{el=$(el);var images=this.getImages(el);if(!images.length){console.log('Error _updateProgressThumbPos: div not found');return}
var index=images.filter('.max').data('index');var bar=el.find('.progbar');var thumb=bar.find('.progthumb');var progress=index /(images.length-1);var x=this.THUMB_PADDING+(bar.width()-2*this.THUMB_PADDING)*progress;thumb.css({left:x});},_onScroll:function(e)
{var self=edThreesixty;var iscroll=this;var el=self._elFromIscroll(this);var images=el.find('.threesixty_img');jtrace('index!',[iscroll.x,iscroll.maxScrollX]);var imgCount=images.length;var scrollStart=el.data('scrollStartPoint');var allImagesDist=imgCount*self._oneImgDistance;var floatIndex=-(iscroll.x-scrollStart)%allImagesDist / self._oneImgDistance;if(floatIndex<0){floatIndex=imgCount+floatIndex}
var index=Math.floor(floatIndex);var img=images.filter(function(){return $(this).data('index')==index});images.not(img).smartRemoveClass('max');img.smartAddClass('max');self._updateProgressThumbPos(el);},_thumbMouseDown:function(e)
{var self=e.data;$(this).addClass('dragging');var el=$(this).parents('.el_threesixty');var thumb=$(this);function mouseUp(e)
{delete self._dragData;thumb.removeClass('dragging');$('body').off('mouseup',mouseUp);return false;}
$('body').on('mouseup',mouseUp);self._updateIndexFromThumbPos(e.offsetX,$(this).parents('.el_threesixty'));return false;},_thumbMouseMove:function(e)
{var self=e.data;if(!$(this).hasClass('dragging')){return}
self._updateIndexFromThumbPos(e.offsetX,$(this).parents('.el_threesixty'));return false;},_updateIndexFromThumbPos:function(offset,el)
{var self=this;var images=self.getImages(el);var count=images.length-1;var width=el.find('.progbar').width()-2*self.THUMB_PADDING;offset=Math.min(offset-self.THUMB_PADDING,width);var index=Math.max(0,offset / width*count);var startIndex=(self._dragData?self._dragData.startIndex:images.filter('.max').data('index'))||0;var dIndex=index-startIndex;jtrace('---- thumb ------');jtrace('offset',offset);jtrace('startIndex',startIndex);jtrace('dIndex',dIndex);jtrace('index',index);var startX=self._dragData?self._dragData.startX:el.data('iscroll').x;var x=startX+(startIndex-index)*self._oneImgDistance;if(!self._dragData)
{self._dragData={startX:x,startIndex:index}}
el.data('iscroll').scrollTo(x,0,0);self._onScroll.call(el.data('iscroll'));},}
;
var CSignal=Class.extend(function(){return{construct:function(){this.numCallbacks=0;this.callbacks=[];this.oneCallbacks=[];},destroy:function(){this.callbacks=[];this.oneCallbacks=[];},once:function(callback){if(callback&&typeof(callback)==='function'){this.oneCallbacks.push(callback);}},attach:function(callback){if(callback&&typeof(callback)==='function'){this.callbacks.push(callback);this.numCallbacks++;}},detach:function(callback){for(var i=0;i<this.numCallbacks;++i){if(this.callbacks[i]==callback){this.callbacks.splice(i,1);this.numCallbacks--;break;}}},trigger:function(data){if(!data)data={};var oneCallbacks=this.oneCallbacks;this.oneCallbacks=[];for(var i=0;i<this.numCallbacks;++i){this.callbacks[i].call(this,data);}
for(var i=0;i<oneCallbacks.length;i++){oneCallbacks[i].call(this,data);}}}});
;
/*!
 * jQuery hashchange event, v1.4, 2013-11-29
 * https://github.com/georgekosmidis/jquery-hashchange
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 *
 * GitHub       - https://github.com/georgekosmidis/jquery-hashchange
 * Source       - https://raw.github.com/georgekosmidis/jquery-hashchange/master/jquery.hashchange.js
 * (Minified)   - https://raw.github.com/georgekosmidis/jquery-hashchange/master/jquery.hashchange.min.js
 *
 *
 * Forked to correct bugs created by jQuery 1.9 version
 * For usage, please visit creator site http://benalman.com/projects/jquery-hashchange-plugin/
 */
(function($,window,undefined){'$:nomunge';var str_hashchange='hashchange',doc=document,fake_onhashchange,special=$.event.special,doc_mode=doc.documentMode,supports_onhashchange='on'+str_hashchange in window&&(doc_mode===undefined||doc_mode>7);function get_fragment(url){url=url||location.href;return'#!'+url.replace(/^[^#]*#?(.*)$/,'$1');};$.fn[str_hashchange]=function(fn){return fn?this.bind(str_hashchange,fn):this.trigger(str_hashchange);};$.fn[str_hashchange].delay=50;special[str_hashchange]=$.extend(special[str_hashchange],{setup:function(){if(supports_onhashchange){return false;}
$(fake_onhashchange.start);},teardown:function(){if(supports_onhashchange){return false;}
$(fake_onhashchange.stop);}});fake_onhashchange=(function(){var self={},timeout_id,last_hash=get_fragment(),fn_retval=function(val){return val;},history_set=fn_retval,history_get=fn_retval;self.start=function(){timeout_id||poll();};self.stop=function(){timeout_id&&clearTimeout(timeout_id);timeout_id=undefined;};function poll(){var hash=get_fragment(),history_hash=history_get(last_hash);if(hash!==last_hash){history_set(last_hash=hash,history_hash);$(window).trigger(str_hashchange);}else if(history_hash!==last_hash){location.href=location.href.replace(/#!.*/,'')+history_hash;}
timeout_id=setTimeout(poll,$.fn[str_hashchange].delay);};var ie=(function(){var undef,v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while(div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->',all[0]);return v>4?v:undef;}());ie&&!supports_onhashchange&&(function(){var iframe,iframe_src;self.start=function(){if(!iframe){iframe_src=$.fn[str_hashchange].src;iframe_src=iframe_src&&iframe_src+get_fragment();iframe=$('<iframe tabindex="-1" title="empty"/>').hide().one('load',function(){iframe_src||history_set(get_fragment());poll();}).attr('src',iframe_src||'javascript:0').insertAfter('body')[0].contentWindow;doc.onpropertychange=function(){try{if(event.propertyName==='title'){iframe.document.title=doc.title;}}catch(e){}};}};self.stop=fn_retval;history_get=function(){return get_fragment(iframe.location.href);};history_set=function(hash,history_hash){var iframe_doc=iframe.document,domain=$.fn[str_hashchange].domain;if(hash!==history_hash){iframe_doc.title=doc.title;iframe_doc.open();domain&&iframe_doc.write('<script>document.domain="'+domain+'"</script>');iframe_doc.close();iframe.location.hash=hash;}};})();return self;})();})(jQuery,window);
;
var CNavigation=Class.extend(function(){return{articleLocationHandler:function(){currPageMeta=window.pageMeta[0];this.enableLoading(true);setTimeout(function(){$(document).trigger('pageLoad',[currPageMeta]);},1000);return false;},enableLoading:function(enable){var opacity=enable?1:0;var display=enable?"block":"none";$('#loading').velocity({opacity:opacity},{duration:200,display:display});},selectMenuSelected:function(hash){$('.nav-page-item').removeClass('selected');$('a[href="#!'+hash+'"]').addClass('selected');},construct:function(){var self=this;var this_instance=this;var currPageIndex=0;var currPageMeta=window.pageMeta[currPageIndex];var navigation=$('.navigation');var $document=$(document);window.onBeforePageLoad=new CSignal();window.onAfterPageLoad=new CSignal();window.CitadelaPlayer.init(self);$document.on('loadPrevPage',function(ev){if(currPageIndex>0){currPageMeta=window.pageMeta[--currPageIndex];location.hash='!'+currPageMeta.hash;}});$document.on('loadNextPage',function(ev){if(currPageIndex<window.pageMeta.length-1){currPageMeta=window.pageMeta[++currPageIndex];location.hash='!'+currPageMeta.hash;}});$(window).hashchange(function(){window.citadela.navigation.enableLoading(true);setTimeout(function(){var foundHash=false;var hash=location.hash.replace(/\#!/g,'').replace(/\#/g,'');window.citadela.navigation.selectMenuSelected(hash);for(var i=0;i<window.pageMeta.length;i++){if((window.pageMeta[i].hash===hash)||(window.CitadelaPlayer.ishashinArray(window.pageMeta[i].additionalhash,hash)))
{foundHash=true;currPageIndex=i;currPageMeta=window.pageMeta[i];if(isApp()){var last_visited_page_ed="last_visited_page_mobile_ed"+window.edgl.edition.id;try
{localStorage.setItem(last_visited_page_ed,currPageMeta.hash+"|0");}catch(e){}}
$document.trigger('pageLoad',[currPageMeta]);break;}}
if(!foundHash){currPageIndex=0;currPageMeta=window.pageMeta[0];$document.trigger('pageLoad',[currPageMeta]);}},500);});window.onAfterPageLoad.attach(function(pageMeta){if(window.trackscrollstats)
{window.trasckingscrollenabled=true;window.trackedscroll30=false;window.trackedscroll60=false;window.trackedscroll100=false;window.setTimeout("if(window.CitadelaPlayer.pageMeta.pageid == "+window.CitadelaPlayer.pageMeta.pageid.toString()+"){window.CitadelaPlayer.onMainWindowsScroll(null,true);}",1000);}
this_instance.enableLoading(false);if(window.initer.simulateArticleView)
{$('.mobile_edition_story').removeClass('edition_article').addClass('edition_article');}});var doneloadingpage=false;if(window.edgl.edition&&window.edgl.edition.edition_type=='article'){doneloadingpage=true;this.articleLocationHandler();}else if(location.hash==''){location.hash="!"+window.pageMeta[0].hash;this.selectMenuSelected(hash);if(isApp()){var last_visited_page_ed="last_visited_page_mobile_ed"+window.edgl.edition.id;try
{var lvp=localStorage.getItem(last_visited_page_ed);if(lvp=='undefined'){lvp='';}
if(lvp){var arr_p=lvp.split('|');var lhash=arr_p[0];var lpos=0;if(arr_p.length>=2){lpos=parseInt(arr_p[1],10);}
location.hash="!"+lhash;this.selectMenuSelected(lhash);window.scrl_back_int=setInterval(function(){if(mobile_scroll_firt_time_ready){if($(window).scrollTop()!=lpos){console.log('LPOS'+lpos);$(window).scrollTop(lpos);}else{clearInterval(window.scrl_back_int);}}},200);}}catch(e){}}}else{var hash=location.hash.replace(/\#!/g,'').replace(/\#/g,'');this.selectMenuSelected(hash);found=false;for(var i=0;i<window.pageMeta.length;i++){if((window.pageMeta[i].hash===hash)||(window.CitadelaPlayer.ishashinArray(window.pageMeta[i].additionalhash,hash))){found=true;if(window.pageMeta[i].hash!=hash)
{doneloadingpage=true;location.hash="!"+window.pageMeta[i].hash;break;return;}
navigation.find('a').removeClass('selected');navigation.find('a[href="'+hash+'"]').addClass('selected');currPageIndex=i;currPageMeta=window.pageMeta[i];$document.trigger('pageLoad',[currPageMeta]);doneloadingpage=true;break;}}
if(!found){var curr_landing_sef='';var use_landing_sef='';for(var i=0;i<window.eddata.pages.length;i++){var dpg=window.eddata.pages[i];if(!window.eddata.pages[i].subpage){if(dpg.mob_page_id){for(var j=0;j<window.pageMeta.length;j++){if(window.pageMeta[j].mobilepageid==dpg.mob_page_id){curr_landing_sef=window.pageMeta[j].hash;}}}}
if(dpg.sef==hash){use_landing_sef=curr_landing_sef;}}}
if(use_landing_sef){doneloadingpage=true;location.hash="!"+use_landing_sef;return;}
if(!doneloadingpage)
{doneloadingpage=true;location.hash="!"+window.pageMeta[0].hash;this.selectMenuSelected(hash);}}},isLastPage:function(pageMeta){for(var i=0;i<window.pageMeta.length;i++){if((window.pageMeta[i].hash==pageMeta.hash)||(window.CitadelaPlayer.ishashinArray(window.pageMeta[i].additionalhash,pageMeta.hash))){if(i==window.pageMeta.length-1)
return true;}}},isFirstPage:function(pageMeta){for(var i=0;i<window.pageMeta.length;i++){if((window.pageMeta[i].hash==pageMeta.hash)||(window.CitadelaPlayer.ishashinArray(window.pageMeta[i].additionalhash,pageMeta.hash))){if(i==0)
{return true;}}}}}});
;
/*!***************************************************
* mark.js v8.11.1
* https://markjs.io/
* Copyright (c) 2014–2018, Julian Kühnel
* Released under the MIT license https://git.io/vwTVl
*****************************************************/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Mark=t()}(this,function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(n){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;t(this,e),this.ctx=n,this.iframes=r,this.exclude=i,this.iframesTimeout=o}return n(e,[{key:"getContexts",value:function(){var e=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach(function(t){var n=e.filter(function(e){return e.contains(t)}).length>0;-1!==e.indexOf(t)||n||e.push(t)}),e}},{key:"getIframeContents",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=void 0;try{var i=e.contentWindow;if(r=i.document,!i||!r)throw new Error("iframe inaccessible")}catch(e){n()}r&&t(r)}},{key:"isIframeBlank",value:function(e){var t=e.getAttribute("src").trim();return"about:blank"===e.contentWindow.location.href&&"about:blank"!==t&&t}},{key:"observeIframeLoad",value:function(e,t,n){var r=this,i=!1,o=null,a=function a(){if(!i){i=!0,clearTimeout(o);try{r.isIframeBlank(e)||(e.removeEventListener("load",a),r.getIframeContents(e,t,n))}catch(e){n()}}};e.addEventListener("load",a),o=setTimeout(a,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,t,n){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,n):this.getIframeContents(e,t,n):this.observeIframeLoad(e,t,n)}catch(e){n()}}},{key:"waitForIframes",value:function(e,t){var n=this,r=0;this.forEachIframe(e,function(){return!0},function(e){r++,n.waitForIframes(e.querySelector("html"),function(){--r||t()})},function(e){e||t()})}},{key:"forEachIframe",value:function(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=t.querySelectorAll("iframe"),s=a.length,c=0;a=Array.prototype.slice.call(a);var u=function(){--s<=0&&o(c)};s||u(),a.forEach(function(t){e.matches(t,i.exclude)?u():i.onIframeReady(t,function(e){n(t)&&(c++,r(e)),u()},u)})}},{key:"createIterator",value:function(e,t,n){return document.createNodeIterator(e,t,n,!1)}},{key:"createInstanceOnIframe",value:function(t){return new e(t.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,t,n){if(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(e){var t=e.previousNode();return{prevNode:t,node:null===t?e.nextNode():e.nextNode()&&e.nextNode()}}},{key:"checkIframeFilter",value:function(e,t,n,r){var i=!1,o=!1;return r.forEach(function(e,t){e.val===n&&(i=t,o=e.handled)}),this.compareNodeIframe(e,t,n)?(!1!==i||o?!1===i||o||(r[i].handled=!0):r.push({val:n,handled:!0}),!0):(!1===i&&r.push({val:n,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,t,n,r){var i=this;e.forEach(function(e){e.handled||i.getIframeContents(e.val,function(e){i.createInstanceOnIframe(e).forEachNode(t,n,r)})})}},{key:"iterateThroughNodes",value:function(e,t,n,r,i){for(var o,a=this,s=this.createIterator(t,e,r),c=[],u=[],l=void 0,h=void 0;void 0,o=a.getIteratorNode(s),h=o.prevNode,l=o.node;)this.iframes&&this.forEachIframe(t,function(e){return a.checkIframeFilter(l,h,e,c)},function(t){a.createInstanceOnIframe(t).forEachNode(e,function(e){return u.push(e)},r)}),u.push(l);u.forEach(function(e){n(e)}),this.iframes&&this.handleOpenIframes(c,e,n,r),i()}},{key:"forEachNode",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.getContexts(),a=o.length;a||i(),o.forEach(function(o){var s=function(){r.iterateThroughNodes(e,o,t,n,function(){--a<=0&&i()})};r.iframes?r.waitForIframes(o,s):s()})}}],[{key:"matches",value:function(e,t){var n="string"==typeof t?[t]:t,r=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(r){var i=!1;return n.every(function(t){return!r.call(e,t)||(i=!0,!1)}),i}return!1}}]),e}(),o=function(){function o(e){t(this,o),this.ctx=e,this.ie=!1;var n=window.navigator.userAgent;(n.indexOf("MSIE")>-1||n.indexOf("Trident")>-1)&&(this.ie=!0)}return n(o,[{key:"log",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",r=this.opt.log;this.opt.debug&&"object"===(void 0===r?"undefined":e(r))&&"function"==typeof r[n]&&r[n]("mark.js: "+t)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e)}},{key:"createSynonymsRegExp",value:function(e){var t=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",r=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var i in t)if(t.hasOwnProperty(i)){var o=t[i],a="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(i):this.escapeStr(i),s="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(o):this.escapeStr(o);""!==a&&""!==s&&(e=e.replace(new RegExp("("+this.escapeStr(a)+"|"+this.escapeStr(s)+")","gm"+n),r+"("+this.processSynomyms(a)+"|"+this.processSynomyms(s)+")"+r))}return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return(e=e.replace(/(?:\\)*\?/g,function(e){return"\\"===e.charAt(0)?"?":""})).replace(/(?:\\)*\*/g,function(e){return"\\"===e.charAt(0)?"*":""})}},{key:"createWildcardsRegExp",value:function(e){var t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,function(e,t,n){var r=n.charAt(t+1);return/[(|)\\]/.test(r)||""===r?e:e+"\0"})}},{key:"createJoinersRegExp",value:function(e){var t=[],n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&t.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join("["+t.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(e){var t=this.opt.caseSensitive?"":"i",n=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],r=[];return e.split("").forEach(function(i){n.every(function(n){if(-1!==n.indexOf(i)){if(r.indexOf(n)>-1)return!1;e=e.replace(new RegExp("["+n+"]","gm"+t),"["+n+"]"),r.push(n)}return!0})}),e}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var t=this,n=this.opt.accuracy,r="string"==typeof n?n:n.value,i="";switch(("string"==typeof n?[]:n.limiters).forEach(function(e){i+="|"+t.escapeStr(e)}),r){case"partially":default:return"()("+e+")";case"complementary":return"()([^"+(i="\\s"+(i||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+e+"[^"+i+"]*)";case"exactly":return"(^|\\s"+i+")("+e+")(?=$|\\s"+i+")"}}},{key:"getSeparatedKeywords",value:function(e){var t=this,n=[];return e.forEach(function(e){t.opt.separateWordSearch?e.split(" ").forEach(function(e){e.trim()&&-1===n.indexOf(e)&&n.push(e)}):e.trim()&&-1===n.indexOf(e)&&n.push(e)}),{keywords:n.sort(function(e,t){return t.length-e.length}),length:n.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var t=this;if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var n=[],r=0;return e.sort(function(e,t){return e.start-t.start}).forEach(function(e){var i=t.callNoMatchOnInvalidRanges(e,r),o=i.start,a=i.end;i.valid&&(e.start=o,e.length=a-o,n.push(e),r=a)}),n}},{key:"callNoMatchOnInvalidRanges",value:function(e,t){var n=void 0,r=void 0,i=!1;return e&&void 0!==e.start?(r=(n=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&r-t>0&&r-n>0?i=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:n,end:r,valid:i}}},{key:"checkWhitespaceRanges",value:function(e,t,n){var r=void 0,i=!0,o=n.length,a=t-o,s=parseInt(e.start,10)-a;return(r=(s=s>o?o:s)+parseInt(e.length,10))>o&&(r=o,this.log("End range automatically set to the max value of "+o)),s<0||r-s<0||s>o||r>o?(i=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===n.substring(s,r).replace(/\s+/g,"")&&(i=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:s,end:r,valid:i}}},{key:"getTextNodes",value:function(e){var t=this,n="",r=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(e){r.push({start:n.length,end:(n+=e.textContent).length,node:e})},function(e){return t.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){e({value:n,nodes:r})})}},{key:"matchesExclude",value:function(e){return i.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,t,n){var r=this.opt.element?this.opt.element:"mark",i=e.splitText(t),o=i.splitText(n-t),a=document.createElement(r);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=i.textContent,i.parentNode.replaceChild(a,i),o}},{key:"wrapRangeInMappedTextNode",value:function(e,t,n,r,i){var o=this;e.nodes.every(function(a,s){var c=e.nodes[s+1];if(void 0===c||c.start>t){if(!r(a.node))return!1;var u=t-a.start,l=(n>a.end?a.end:n)-a.start,h=e.value.substr(0,a.start),f=e.value.substr(l+a.start);if(a.node=o.wrapRangeInTextNode(a.node,u,l),e.value=h+f,e.nodes.forEach(function(t,n){n>=s&&(e.nodes[n].start>0&&n!==s&&(e.nodes[n].start-=l),e.nodes[n].end-=l)}),n-=l,i(a.node.previousSibling,a.start),!(n>a.end))return!1;t=a.end}return!0})}},{key:"wrapMatches",value:function(e,t,n,r,i){var o=this,a=0===t?0:t+1;this.getTextNodes(function(t){t.nodes.forEach(function(t){t=t.node;for(var i=void 0;null!==(i=e.exec(t.textContent))&&""!==i[a];)if(n(i[a],t)){var s=i.index;if(0!==a)for(var c=1;c<a;c++)s+=i[c].length;t=o.wrapRangeInTextNode(t,s,s+i[a].length),r(t.previousSibling),e.lastIndex=0}}),i()})}},{key:"wrapMatchesAcrossElements",value:function(e,t,n,r,i){var o=this,a=0===t?0:t+1;this.getTextNodes(function(t){for(var s=void 0;null!==(s=e.exec(t.value))&&""!==s[a];){var c=s.index;if(0!==a)for(var u=1;u<a;u++)c+=s[u].length;var l=c+s[a].length;o.wrapRangeInMappedTextNode(t,c,l,function(e){return n(s[a],e)},function(t,n){e.lastIndex=n,r(t)})}i()})}},{key:"wrapRangeFromIndex",value:function(e,t,n,r){var i=this;this.getTextNodes(function(o){var a=o.value.length;e.forEach(function(e,r){var s=i.checkWhitespaceRanges(e,a,o.value),c=s.start,u=s.end;s.valid&&i.wrapRangeInMappedTextNode(o,c,u,function(n){return t(n,e,o.value.substring(c,u),r)},function(t){n(t,e)})}),r()})}},{key:"unwrapMatches",value:function(e){for(var t=e.parentNode,n=document.createDocumentFragment();e.firstChild;)n.appendChild(e.removeChild(e.firstChild));t.replaceChild(n,e),this.ie?this.normalizeTextNode(t):t.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,t){var n=this;this.opt=t,this.log('Searching with expression "'+e+'"');var r=0,i="wrapMatches";this.opt.acrossElements&&(i="wrapMatchesAcrossElements"),this[i](e,this.opt.ignoreGroups,function(e,t){return n.opt.filter(t,e,r)},function(e){r++,n.opt.each(e)},function(){0===r&&n.opt.noMatch(e),n.opt.done(r)})}},{key:"mark",value:function(e,t){var n=this;this.opt=t;var r=0,i="wrapMatches",o=this.getSeparatedKeywords("string"==typeof e?[e]:e),a=o.keywords,s=o.length,c=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(i="wrapMatchesAcrossElements"),0===s?this.opt.done(r):function e(t){var o=new RegExp(n.createRegExp(t),"gm"+c),u=0;n.log('Searching with expression "'+o+'"'),n[i](o,1,function(e,i){return n.opt.filter(i,t,r,u)},function(e){u++,r++,n.opt.each(e)},function(){0===u&&n.opt.noMatch(t),a[s-1]===t?n.opt.done(r):e(a[a.indexOf(t)+1])})}(a[0])}},{key:"markRanges",value:function(e,t){var n=this;this.opt=t;var r=0,i=this.checkRanges(e);i&&i.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(i)),this.wrapRangeFromIndex(i,function(e,t,r,i){return n.opt.filter(e,t,r,i)},function(e,t){r++,n.opt.each(e,t)},function(){n.opt.done(r)})):this.opt.done(r)}},{key:"unmark",value:function(e){var t=this;this.opt=e;var n=this.opt.element?this.opt.element:"*";n+="[data-markjs]",this.opt.className&&(n+="."+this.opt.className),this.log('Removal selector "'+n+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(e){t.unwrapMatches(e)},function(e){var r=i.matches(e,n),o=t.matchesExclude(e);return!r||o?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(e){this._opt=r({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new i(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),o}();return function(e){var t=this,n=new o(e);return this.mark=function(e,r){return n.mark(e,r),t},this.markRegExp=function(e,r){return n.markRegExp(e,r),t},this.markRanges=function(e,r){return n.markRanges(e,r),t},this.unmark=function(e){return n.unmark(e),t},this}});

;
if(typeof(window.edgl)=='object'){if(window.edgl.argo.indexOf('*test_errors*')!=-1){setTimeout(function(){ed_error_testing_developers_editiondigital__mobile();},2000);setTimeout(function(){var i=100;var d=0;console.log((i/d));},2100);}}
;
setTimeout(function(){if(typeof(ed_js_ready_file)=="function"){ed_js_ready_file("player");}else{console.log("function ed_js_ready_file not defined");}},100);
;
