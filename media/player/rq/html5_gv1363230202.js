/* auto generated by editiondigital :: 2022-03-07 15:04:45 GMT+0  fmdf-3h3n9kmo0r1y0 */
/*! iScroll v5.1.1 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(window,document,Math){var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000 / 60);};var utils=(function(){var me={};var _elementStyle=document.createElement('div').style;var _vendor=(function(){var vendors=['t','webkitT','MozT','msT','OT'],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+'ransform';if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);}
return false;})();function _prefixStyle(style){if(_vendor===false)return false;if(_vendor==='')return style;return _vendor+style.charAt(0).toUpperCase()+style.substr(1);}
me.getTime=Date.now||function getTime(){return new Date().getTime();};me.extend=function(target,obj){for(var i in obj){target[i]=obj[i];}};me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture);};me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture);};me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/ time,destination,duration;deceleration=deceleration===undefined?0.0006:deceleration;destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);duration=speed / deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-(wrapperSize / 2.5*(speed / 8)):lowerMargin;distance=Math.abs(destination-current);duration=distance / speed;}else if(destination>0){destination=wrapperSize?wrapperSize / 2.5*(speed / 8):0;distance=Math.abs(current)+destination;duration=distance / speed;}
return{destination:Math.round(destination),duration:duration};};var _transform=_prefixStyle('transform');me.extend(me,{hasTransform:_transform!==false,hasPerspective:_prefixStyle('perspective')in _elementStyle,hasTouch:'ontouchstart'in window,hasPointer:navigator.msPointerEnabled,hasTransition:_prefixStyle('transition')in _elementStyle});me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle('transitionTimingFunction'),transitionDuration:_prefixStyle('transitionDuration'),transitionDelay:_prefixStyle('transitionDelay'),transformOrigin:_prefixStyle('transformOrigin')});me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className);};me.addClass=function(e,c){if(me.hasClass(e,c)){return;}
var newclass=e.className.split(' ');newclass.push(c);e.className=newclass.join(' ');};me.removeClass=function(e,c){if(!me.hasClass(e,c)){return;}
var re=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');e.className=e.className.replace(re,' ');};me.offset=function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop;}
return{left:left,top:top};};me.preventDefaultException=function(el,exceptions){for(var i in exceptions){if(exceptions[i].test(el[i])){return true;}}
return false;};me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});me.extend(me.ease={},{quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k);}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return Math.sqrt(1-(--k*k));}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1;}},bounce:{style:'',fn:function(k){if((k /=1)<(1 / 2.75)){return 7.5625*k*k;}else if(k<(2 / 2.75)){return 7.5625*(k-=(1.5 / 2.75))*k+0.75;}else if(k<(2.5 / 2.75)){return 7.5625*(k-=(2.25 / 2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625 / 2.75))*k+0.984375;}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0;}
if(k==1){return 1;}
return(e*Math.pow(2,-10*k)*Math.sin((k-f / 4)*(2*Math.PI)/ f)+1);}}});me.tap=function(e,eventName){var ev=document.createEvent('Event');ev.initEvent(eventName,true,true);ev.pageX=e.pageX;ev.pageY=e.pageY;e.target.dispatchEvent(ev);};me.click=function(e){var target=e.target,ev;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName)){ev=document.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._constructed=true;target.dispatchEvent(ev);}};return me;})();function IScroll(el,options){this.wrapper=typeof el=='string'?document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;currentWrapper=this;this.options={currentparalaxpage:1,zoomMin:1,zoomMax:4,startZoom:1,resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,ignoreBoundaries:false,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,useCenterOfUnzoomedElement:false,useCenterOfUnzoomedElementParalas:false,paralaxOverlap:0,bounce:true,bounceTime:600,bounceEasing:'',preventDefault:true,resizePolling:60,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true,handleSingleDrags:true};this.refreshTranslateZ=function(){this.translateZ=this.options.HWCompositing&&utils.hasPerspective?(ed.isAndroid?' translate3d(0,0,0)':' translateZ(0)'):'';if(this.translateZ=='')
{this.scroller.style[utils.style.transform]=this.scroller.style[utils.style.transform].replace(' translateZ(0)','').replace(' translateZ(0px)','');}
else
{this.scroller.style[utils.style.transform]=this.scroller.style[utils.style.transform].replace(' translateZ(0)','').replace(' translateZ(0px)','')+this.translateZ;}};for(var i in options){this.options[i]=options[i];}
this.translateZ=this.options.HWCompositing&&utils.hasPerspective?' translateZ(0)':'';this.options.useTransition=utils.hasTransition&&this.options.useTransition;this.options.useTransform=utils.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=='string'?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap='tap';}
if(this.options.shrinkScrollbars=='scale'){this.options.useTransition=false;}
this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this.scale=Math.min(Math.max(this.options.startZoom,this.options.zoomMin),this.options.zoomMax);this.zoomCurrentPageScale=Math.min(Math.max(this.options.startZoom,this.options.zoomMin),this.options.zoomMax);this.forPageNumber=-1;this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable();}
IScroll.prototype={version:'5.1.1',_init:function(){this._initEvents();if(this.options.zoom){this._initZoom();}
if(this.options.scrollbars||this.options.indicators){this._initIndicators();}
if(this.options.mouseWheel){this._initWheel();}
if(this.options.snap){this._initSnap();}
if(this.options.keyBindings){this._initKeys();}},destroy:function(){this._initEvents(true);this._execEvent('destroy');},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return;}
this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent('scrollEnd');}},_start:function(e){if(utils.eventType[e.type]!=1){if(e.button!==0){return;}}
if(!this.enabled||(this.initiated&&utils.eventType[e.type]!==this.initiated)){return;}
if(window.ed.isiscrollroll)
{return}
if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.touches?e.touches[0]:e,pos;if(!this.options.handleSingleDrags&&(!e.touches||e.touches.length<2)){return}
this.initiated=utils.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=utils.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this._execEvent('scrollEnd');}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent('scrollEnd');}
this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this._execEvent('beforeScrollStart');},_move:function(e){if(this.options.useCenterOfUnzoomedElementParalas)
{return false;}
if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(window.ed._disableYScroll)
{return;}
if(window.ed.isiscrollroll)
{return}
if(this.options.preventDefault){e.preventDefault();}
var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime(),newX,newY,absDistX,absDistY;this.pointX=point.pageX;this.pointY=point.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return;}
if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked='h';}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked='v';}else{this.directionLocked='n';}}
if(this.directionLocked=='h'){if(this.options.eventPassthrough=='vertical'){e.preventDefault();}else if(this.options.eventPassthrough=='horizontal'){this.initiated=false;return;}
deltaY=0;}else if(this.directionLocked=='v'){if(this.options.eventPassthrough=='horizontal'){e.preventDefault();}else if(this.options.eventPassthrough=='vertical'){this.initiated=false;return;}
deltaX=0;}
deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX / 3:newX>0?0:this.maxScrollX;}
if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY / 3:newY>0?0:this.maxScrollY;}
this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent('scrollStart');}
this.moved=true;this._translate(newX,newY,true);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y;}},_end:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(window.ed.isiscrollroll)
{return}
if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing='';this.isInTransition=0;this.initiated=0;this.endTime=utils.getTime();if(this.resetPosition(this.options.bounceTime)){return;}
this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){utils.tap(e,this.options.tap);}
if(this.options.click){utils.click(e);}
this._execEvent('scrollCancel');return;}
if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100){this._execEvent('flick');return;}
if(this.options.momentum&&duration<300){momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=Math.max(momentumX.duration,momentumY.duration);this.isInTransition=1;}
if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap;time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1000),Math.min(Math.abs(newY-snap.y),1000)),300);newX=snap.x;newY=snap.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing;}
if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=utils.ease.quadratic;}
this.scrollTo(newX,newY,time,easing);return;}
this._execEvent('scrollEnd');},_resize:function(){var that=this;clearTimeout(this.resizeTimeout);},resetPosition:function(time){var x=this.x,y=this.y;time=time||0;if(!this.hasHorizontalScroll||this.x>0){x=0;}else if(this.x<this.maxScrollX){x=this.maxScrollX;}
if(!this.hasVerticalScroll||this.y>0){y=0;}else if(this.y<this.maxScrollY){y=this.maxScrollY;}
if(x==this.x&&y==this.y){return false;}
this.scrollTo(x,y,time,this.options.bounceEasing);return true;},disable:function(){this.enabled=false;},enable:function(){this.enabled=true;},refresh:function(){var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=Math.round(this.scroller.offsetWidth*this.scale);this.scrollerHeight=Math.round(this.scroller.offsetHeight*this.scale);this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth;}
if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight;}
this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=utils.offset(this.wrapper);this._execEvent('refresh');this.resetPosition();},on:function(type,fn){if(!this._events[type]){this._events[type]=[];}
this._events[type].push(fn);},off:function(type,fn){if(!this._events[type]){return;}
var index=this._events[type].indexOf(fn);if(index>-1){this._events[type].splice(index,1);}},_execEvent:function(type){if(!this._events[type]){return;}
var i=0,l=this._events[type].length;if(!l){return;}
for(;i<l;i++){this._events[type][i].apply(this,[].slice.call(arguments,1));}},scrollBy:function(x,y,time,easing){if(window.ed._disableYScroll)
{return false;}
x=this.x+x;y=this.y+y;time=time||0;this.scrollTo(x,y,time,easing);},scrollTo:function(x,y,time,easing,ishandlingthroughscrollbars,noQuestions){if(noQuestions)
{this._transitionTimingFunction(utils.ease.circular);this._transitionTime(0);this._translate(x,y);return;}
if(typeof(ishandlingthroughscrollbars)=="undefined"){var ishandlingthroughscrollbars=false;}
if(window.ed._disableYScroll)
{return false;}
var shouldcenter=false;var isparalxcenter=false;if(this.options.useCenterOfUnzoomedElementParalas)
{shouldcenter=true;isparalxcenter=true;}
var allowcenterpositioning=true;if(ishandlingthroughscrollbars)
{var originalX=x;var originalY=y;allowcenterpositioning=false;}
if((typeof(window.ide)!='undefined')&&((this.options.useCenterOfUnzoomedElement)||(shouldcenter)))
{var isFirstPageAndMustBeCentered=false;var isFirstPageAndMustBeRight=false;if(this.wrapper!=null)
{if(this.wrapper.id=='iscrollholder0')
{if(window.ide.orientIsBookMode)
{if(window.ide.firstPageBookMode==1)
{isFirstPageAndMustBeRight=true;}
else if(window.ide.firstPageBookMode==0)
{isFirstPageAndMustBeCentered=true;}}}}
if(isFirstPageAndMustBeCentered)
{var current_elem_width=window.ide.originalSinglePageWidth*this.scale;}
else
{var current_elem_width=window.ide.editionSinglePageWidth*this.scale;}
var notSetYet=true;if(current_elem_width<window.ide.screenWidth)
{if(isparalxcenter)
{$(this.wrapper).find('.dummyparalaxtopoffset').first().css({'height':'0px'});}
var currentDifference=(current_elem_width-window.ide.screenWidth);if(currentDifference!=0)
{if(isFirstPageAndMustBeRight)
{x=Math.round(x-(currentDifference/2)+(current_elem_width/2));notSetYet=false;}
else
{x=Math.round(x-currentDifference/2);notSetYet=false;}}}
var current_elem_height=window.ide.editionSinglePageHeight*this.scale;if(!isparalxcenter)
{if(current_elem_height<window.ide.screenHeight)
{if(isparalxcenter)
{$(this.wrapper).find('.dummyparalaxtopoffset').first().css({'height':'0px'});}
var currentDifference=(current_elem_height-window.ide.screenHeight);if((isFirstPageAndMustBeRight)&&(currentDifference<0)&&(notSetYet))
{x=Math.round(x+(current_elem_width/2));notSetYet=false;}
if(currentDifference!=0)
{y=Math.round(y-currentDifference/2);if(isNaN(y))
{y=0;}}}}
else
{if(isparalxcenter)
{var currentDifference=(current_elem_height-window.ide.screenHeight);y=0;if(currentDifference!=0)
{if((y<0)&&(time==3))
{y=0;}
var tmpy=Math.round(y-currentDifference/2);tmpy=tmpy / this.scale;if(isNaN(tmpy))
{tmpy=0;}
else
{$(this.wrapper).find('.dummyparalaxtopoffset').first().css({'height':tmpy.toString()+'px'});}}}}
if(Math.round(current_elem_height)==window.ide.screenHeight)
{var currentDifference=(current_elem_height-window.ide.screenHeight);if((isFirstPageAndMustBeRight)&&(notSetYet))
{if(isparalxcenter)
{$(this.wrapper).find('.dummyparalaxtopoffset').first().css({'height':'0px'});}
x=Math.round(x+(current_elem_width/2));}}}
easing=easing||utils.ease.circular;this.isInTransition=this.options.useTransition&&time>0;if(!allowcenterpositioning)
{x=originalX;y=originalY;}
if(!time||(this.options.useTransition&&easing.style)){this._transitionTimingFunction(easing.style);this._transitionTime(time);this._translate(x,y,true);}else{this._animate(x,y,time,easing.fn);}},scrollToElement:function(el,time,offsetX,offsetY,easing){el=el.nodeType?el:this.scroller.querySelector(el);if(!el){return;}
var pos=utils.offset(el);pos.left-=this.wrapperOffset.left;pos.top-=this.wrapperOffset.top;if(offsetX===true){offsetX=Math.round(el.offsetWidth / 2-this.wrapper.offsetWidth / 2);}
if(offsetY===true){offsetY=Math.round(el.offsetHeight / 2-this.wrapper.offsetHeight / 2);}
pos.left-=offsetX||0;pos.top-=offsetY||0;pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;time=time===undefined||time===null||time==='auto'?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;this.scrollTo(pos.left,pos.top,time,easing);},_transitionTime:function(time){time=time||0;this.scrollerStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.scrollerStyle[utils.style.transitionDuration]='0.001s';}
if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(time);}}},_transitionTimingFunction:function(easing){this.scrollerStyle[utils.style.transitionTimingFunction]=easing;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(easing);}}},_translate:function(x,y){if(this.options.useTransform){{this.scrollerStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+' scale('+this.scale+') '+this.translateZ;}}else{x=Math.round(x);y=Math.round(y);this.scrollerStyle.left=x+'px';this.scrollerStyle.top=y+'px';}
if((isNaN(x))||(isNaN(y)))
{return;}
this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition();}}},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,'orientationchange',this);eventType(window,'resize',this);if(this.options.click){eventType(this.wrapper,'click',this,true);}
if(!this.options.disableMouse){eventType(this.wrapper,'mousedown',this);eventType(target,'mousemove',this);eventType(target,'mousecancel',this);eventType(target,'mouseup',this);}
if(utils.hasPointer&&!this.options.disablePointer){eventType(this.wrapper,'MSPointerDown',this);eventType(target,'MSPointerMove',this);eventType(target,'MSPointerCancel',this);eventType(target,'MSPointerUp',this);}
if(utils.hasTouch&&!this.options.disableTouch){eventType(this.wrapper,'touchstart',this);eventType(target,'touchmove',this);eventType(target,'touchcancel',this);eventType(target,'touchend',this);}
eventType(this.scroller,'transitionend',this);eventType(this.scroller,'webkitTransitionEnd',this);eventType(this.scroller,'oTransitionEnd',this);eventType(this.scroller,'MSTransitionEnd',this);},getComputedPosition:function(){var matrix=window.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){matrix=matrix[utils.style.transform].split(')')[0].split(', ');x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5]);}else{x=+matrix.left.replace(/[^-\d.]/g,'');y=+matrix.top.replace(/[^-\d.]/g,'');}
return{x:x,y:y};},_initIndicators:function(){var interactive=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!='string',indicators=[],indicator;var that=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar('v',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}
if(this.options.scrollX){indicator={el:createDefaultScrollbar('h',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}}
if(this.options.indicators){indicators=indicators.concat(this.options.indicators);}
try
{for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]));}}catch(e){}
function _indicatorsMap(fn,caller){try
{for(var i=that.indicators.length;i--;){fn.call(that.indicators[i]);}}catch(e){}}
if(this.options.fadeScrollbars){this.on('scrollEnd',function(){_indicatorsMap(function(){this.fade();},this);});this.on('scrollCancel',function(){_indicatorsMap(function(){this.fade();},this);});this.on('scrollStart',function(){_indicatorsMap(function(){this.fade(1);},this);});this.on('beforeScrollStart',function(){_indicatorsMap(function(){this.fade(1,true);},this);});}
this.on('refresh',function(){_indicatorsMap(function(){this.refresh();},this);});this.on('destroy',function(){_indicatorsMap(function(){this.destroy();},this);delete this.indicators;});},_initZoom:function(){this.scrollerStyle[utils.style.transformOrigin]='0 0';},_zoomStart:function(e){var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY);this.touchesDistanceStart=Math.sqrt(c1*c1+c2*c2);this.startScale=this.scale;this.originX=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/ 2+this.wrapperOffset.left-this.x;this.originY=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/ 2+this.wrapperOffset.top-this.y;this._execEvent('zoomStart');},_zoom:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
try
{if(window.ide.currentPageObjPgs!=null)
{if(!window.ide.currentPageObjPgs.zoom)
{return;}}}catch(e){}
if((window.ed.isiscrollroll)||(!window.ed._enableZoom))
{return}
if(this.options.preventDefault){e.preventDefault();}
var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY),distance=Math.sqrt(c1*c1+c2*c2),scale=1 / this.touchesDistanceStart*distance*this.startScale,lastScale,x,y;this.scaled=true;if(scale<this.options.zoomMin){scale=0.5*this.options.zoomMin*Math.pow(2.0,scale / this.options.zoomMin);}else if(scale>this.options.zoomMax){scale=2.0*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax / scale);}
lastScale=scale / this.startScale;x=this.originX-this.originX*lastScale+this.startX;y=this.originY-this.originY*lastScale+this.startY;this.scale=scale;this.scrollTo(x,y,0,false,false,true);},_zoomEnd:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var newX,newY,lastScale;this.isInTransition=0;this.initiated=0;if(this.scale>this.options.zoomMax){this.scale=this.options.zoomMax;}else if(this.scale<this.options.zoomMin){this.scale=this.options.zoomMin;}
this.refresh();lastScale=this.scale / this.startScale;newX=this.originX-this.originX*lastScale+this.startX;newY=this.originY-this.originY*lastScale+this.startY;if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
if(this.x!=newX||this.y!=newY){this.scrollTo(newX,newY,this.options.bounceTime);}
this.scaled=false;this._execEvent('zoomEnd');},zoom:function(scale,x,y,time){if(scale<this.options.zoomMin){scale=this.options.zoomMin;}else if(scale>this.options.zoomMax){scale=this.options.zoomMax;}
if(scale.toString()==this.scale.toString()){return;}
var relScale=scale / this.scale;x=x===undefined?this.wrapperWidth / 2:x;y=y===undefined?this.wrapperHeight / 2:y;time=time===undefined?300:time;x=x+this.wrapperOffset.left-this.x;y=y+this.wrapperOffset.top-this.y;x=x-x*relScale+this.x;y=y-y*relScale+this.y;this.scaled=window.f.getCurrentPageScale(window.ide.currentPage)>(Math.round(window.ide.defaultPublicationScale*1000)/1000);var previousScaled=this.scaled;this.scaled=scale>window.ide.defaultPublicationScale;this.scale=scale;this.zoomCurrentPageScale=window.f.getCurrentPageScale(window.ide.currentPage);if(window.ide.currentPage==this.forPageNumber)
{if(previousScaled!=this.scaled)
{this._execEvent('zoomStart');}}
this.refresh();if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
this.scrollTo(x,y,time);if(window.ide.currentPage==this.forPageNumber)
{if(previousScaled!=this.scaled)
{if(time<=0)
{this._execEvent('zoomEnd');}
else
{window.ed.iscrolllastthis=this;window.setTimeout(function(){window.ed.iscrolllastthis._execEvent('zoomEnd');},time+1);}}}},_wheelZoom:function(e){if(window.ed.isiscrollWheelRoll){return false;}
var wheelDeltaY,deltaScale,that=this;clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('zoomEnd');},400);if('deltaX'in e){wheelDeltaY=-e.deltaY / Math.abs(e.deltaY);}else if('wheelDeltaX'in e){wheelDeltaY=e.wheelDeltaY / Math.abs(e.wheelDeltaY);}else if('wheelDelta'in e){wheelDeltaY=e.wheelDelta / Math.abs(e.wheelDelta);}else if('detail'in e){wheelDeltaY=-e.detail / Math.abs(e.wheelDelta);}else{return;}
deltaScale=this.scale+wheelDeltaY / 5;if(!isNaN(deltaScale))
{this.zoom(deltaScale,e.pageX,e.pageY,100);}},_initWheel:function(){utils.addEvent(this.wrapper,'wheel',this);utils.addEvent(this.wrapper,'mousewheel',this);utils.addEvent(this.wrapper,'DOMMouseScroll',this);this.on('destroy',function(){utils.removeEvent(this.wrapper,'wheel',this);utils.removeEvent(this.wrapper,'mousewheel',this);utils.removeEvent(this.wrapper,'DOMMouseScroll',this);});},_wheel:function(e){if(!this.enabled){return;}
if(this.options.useCenterOfUnzoomedElementParalas)
{return false;}
e.preventDefault();e.stopPropagation();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent('scrollStart');}
clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('scrollEnd');that.wheelTimeout=undefined;},400);if('deltaX'in e){wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY;}else if('wheelDeltaX'in e){wheelDeltaX=e.wheelDeltaX / 120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY / 120*this.options.mouseWheelSpeed;}else if('wheelDelta'in e){wheelDeltaX=wheelDeltaY=e.wheelDelta / 120*this.options.mouseWheelSpeed;}else if('detail'in e){wheelDeltaX=wheelDeltaY=-e.detail / 3*this.options.mouseWheelSpeed;}else{return;}
if(this.options.useCenterOfUnzoomedElementParalas)
{if(wheelDeltaY<0)
{wheelDeltaY=-10;}
else if(wheelDeltaY>0)
{wheelDeltaY=10;}}
wheelDeltaX*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){wheelDeltaX=wheelDeltaY;wheelDeltaY=0;}
if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(wheelDeltaX>0){newX--;}else if(wheelDeltaX<0){newX++;}
if(wheelDeltaY>0){newY--;}else if(wheelDeltaY<0){newY++;}
this.goToPage(newX,newY);return;}
newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
this.scrollTo(newX,newY,0);},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=='string'){this.options.snap=this.scroller.querySelectorAll(this.options.snap);}
this.on('refresh',function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return;}
if(this.options.snap===true){cx=Math.round(stepX / 2);cy=Math.round(stepY / 2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++;}
x-=stepX;i++;}}else{el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++;}
if(!this.pages[m]){this.pages[m]=[];}
x=Math.max(-el[i].offsetLeft,this.maxScrollX);y=Math.max(-el[i].offsetTop,this.maxScrollY);cx=x-Math.round(el[i].offsetWidth / 2);cy=y-Math.round(el[i].offsetHeight / 2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++;}}}
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold;}else{this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold);}});this.on('flick',function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1000),Math.min(Math.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time);});},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0};}
var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage;}
if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break;}}
l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break;}}
if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0;}else if(i>=this.pages.length){i=this.pages.length-1;}
x=this.pages[i][0].x;}
if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0;}else if(m>=this.pages[0].length){m=this.pages[0].length-1;}
y=this.pages[0][m].y;}
return{x:x,y:y,pageX:i,pageY:m};},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1;}else if(x<0){x=0;}
if(y>=this.pages[x].length){y=this.pages[x].length-1;}else if(y<0){y=0;}
var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=time===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1000),Math.min(Math.abs(posY-this.y),1000)),300):time;this.currentPage={x:posX,y:posY,pageX:x,pageY:y};this.scrollTo(posX,posY,time,easing);},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++;}
this.goToPage(x,y,time,easing);},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--;}
this.goToPage(x,y,time,easing);},_initKeys:function(e){var keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=='object'){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=='string'){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0);}}}else{this.options.keyBindings={};}
for(i in keys){this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];}
utils.addEvent(window,'keydown',this);this.on('destroy',function(){utils.removeEvent(window,'keydown',this);});},_key:function(e){if(!this.enabled){return;}
var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=0.250,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this.isInTransition=false;}
this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=snap?1:this.wrapperWidth;}else{newY+=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=snap?1:this.wrapperWidth;}else{newY-=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX;newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return;}
if(snap){this.goToPage(newX,newY);return;}
if(newX>0){newX=0;this.keyAcceleration=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0;}
if(newY>0){newY=0;this.keyAcceleration=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0;}
this.scrollTo(newX,newY,0);this.keyTime=now;},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;function step(){var now=utils.getTime(),newX,newY,easing;if(now>=destTime){that.isAnimating=false;that._translate(destX,destY);if(!that.resetPosition(that.options.bounceTime)){that._execEvent('scrollEnd');}
return;}
now=(now-startTime)/ duration;easing=easingFn(now);newX=(destX-startX)*easing+startX;newY=(destY-startY)*easing+startY;that._translate(newX,newY);if(that.isAnimating){rAF(step);}}
this.isAnimating=true;step();},handleEvent:function(e){var wasFired=false;switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._execEvent('zoomStart');wasFired=true;break;case'wheel':case'DOMMouseScroll':case'mousewheel':this._execEvent('zoomStart');wasFired=true;break;}
if(!this.enabled)
{if(wasFired)
{this._execEvent('zoomEnd');}
return false;}
switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._start(e);if(this.options.zoom&&e.touches&&e.touches.length>1){this._zoomStart(e);}
break;case'touchmove':case'MSPointerMove':case'mousemove':if(this.options.zoom&&e.touches&&e.touches[1]){this._zoom(e);return;}
this._move(e);break;case'touchend':case'MSPointerUp':case'mouseup':case'touchcancel':case'MSPointerCancel':case'mousecancel':if(this.scaled){this._zoomEnd(e);return;}
this._end(e);break;case'orientationchange':case'resize':break;case'transitionend':case'webkitTransitionEnd':case'oTransitionEnd':case'MSTransitionEnd':this._transitionEnd(e);break;case'wheel':case'DOMMouseScroll':case'mousewheel':if(this.options.wheelAction=='zoom'){this._wheelZoom(e);return;}
this._wheel(e);break;case'keydown':this._key(e);break;}}};function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement('div'),indicator=document.createElement('div');if(type===true){scrollbar.style.cssText='position:absolute;z-index:9999';indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.4);border-radius:3px';}
indicator.className='iScrollIndicator';if(direction=='h'){if(type===true){scrollbar.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';indicator.style.height='100%';}
scrollbar.className='iScrollHorizontalScrollbar';}else{if(type===true){scrollbar.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';indicator.style.width='100%';}
scrollbar.className='iScrollVerticalScrollbar';}
scrollbar.style.cssText+=';overflow:hidden';if(!interactive){scrollbar.style.pointerEvents='none';}
scrollbar.appendChild(indicator);return scrollbar;}
function Indicator(scroller,options){this.wrapper=typeof options.el=='string'?document.querySelector(options.el):options.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in options){this.options[i]=options[i];}
this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){utils.addEvent(this.indicator,'touchstart',this);utils.addEvent(window,'touchend',this);}
if(!this.options.disablePointer){utils.addEvent(this.indicator,'MSPointerDown',this);utils.addEvent(window,'MSPointerUp',this);}
if(!this.options.disableMouse){utils.addEvent(this.indicator,'mousedown',this);utils.addEvent(window,'mouseup',this);}}
if(this.options.fade){this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?'0.001s':'0ms';this.wrapperStyle.opacity='0';}}
Indicator.prototype={handleEvent:function(e){switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'MSPointerUp':case'mouseup':case'touchcancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;}},destroy:function(){if(this.options.interactive){utils.removeEvent(this.indicator,'touchstart',this);utils.removeEvent(this.indicator,'MSPointerDown',this);utils.removeEvent(this.indicator,'mousedown',this);utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,'MSPointerMove',this);utils.removeEvent(window,'mousemove',this);utils.removeEvent(window,'touchend',this);utils.removeEvent(window,'MSPointerUp',this);utils.removeEvent(window,'mouseup',this);}
if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper);}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=utils.getTime();if(!this.options.disableTouch){utils.addEvent(window,'touchmove',this);}
if(!this.options.disablePointer){utils.addEvent(window,'MSPointerMove',this);}
if(!this.options.disableMouse){utils.addEvent(window,'mousemove',this);}
this.scroller._execEvent('beforeScrollStart');},_move:function(e){var point=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=utils.getTime();if(!this.moved){this.scroller._execEvent('scrollStart');}
this.moved=true;deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);e.preventDefault();e.stopPropagation();},_end:function(e){if(!this.initiated){return;}
this.initiated=false;e.preventDefault();e.stopPropagation();utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,'MSPointerMove',this);utils.removeEvent(window,'mousemove',this);if(this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1000),Math.min(Math.abs(this.scroller.y-snap.y),1000)),300);if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=snap;this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing);}}
if(this.moved){this.scroller._execEvent('scrollEnd');}},transitionTime:function(time){time=time||0;this.indicatorStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.indicatorStyle[utils.style.transitionDuration]='0.001s';}},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing;},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none';}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none';}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none';}
if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){utils.addClass(this.wrapper,'iScrollBothScrollbars');utils.removeClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='8px';}else{this.wrapper.style.bottom='8px';}}}else{utils.removeClass(this.wrapper,'iScrollBothScrollbars');utils.addClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='2px';}else{this.wrapper.style.bottom='2px';}}}
var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth /(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+'px';}else{this.indicatorWidth=this.indicator.clientWidth;}
this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=='clip'){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8;}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX;}
this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX / this.scroller.maxScrollX));}
if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight /(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+'px';}else{this.indicatorHeight=this.indicator.clientHeight;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=='clip'){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8;}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY / this.scroller.maxScrollY));}
this.updatePosition();},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+'px';}
x=this.minBoundaryX;}else if(x>this.maxBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+'px';x=this.maxPosX+this.indicatorWidth-this.width;}else{x=this.maxBoundaryX;}}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+'px';}
if(y<this.minBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+'px';}
y=this.minBoundaryY;}else if(y>this.maxBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+'px';y=this.maxPosY+this.indicatorHeight-this.height;}else{y=this.maxBoundaryY;}}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+'px';}}
this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ;}else{this.indicatorStyle.left=x+'px';this.indicatorStyle.top=y+'px';}},_pos:function(x,y){if(x<0){x=0;}else if(x>this.maxPosX){x=this.maxPosX;}
if(y<0){y=0;}else if(y>this.maxPosY){y=this.maxPosY;}
x=this.options.listenX?Math.round(x / this.sizeRatioX):this.scroller.x;y=this.options.listenY?Math.round(y / this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y,0,'',true);},fade:function(val,hold){if(hold&&!this.visible){return;}
clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?'1':'0';this.wrapperStyle[utils.style.transitionDuration]=time+'ms';this.fadeTimeout=setTimeout((function(val){this.wrapperStyle.opacity=val;this.visible=+val;}).bind(this,val),delay);}};IScroll.utils=utils;if(typeof module!='undefined'&&module.exports){module.exports=IScroll;}else{window.IScroll=IScroll;}})(window,document,Math);
;
/*!
 * Paper.js v0.12.15 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Mar 17 10:49:48 2021 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */
var paper=function(self,undefined){self=self||require('./node/self.js');var window=self.window,document=self.document;var Base=new function(){var hidden=/^(statics|enumerable|beans|preserve)$/,array=[],slice=array.slice,create=Object.create,describe=Object.getOwnPropertyDescriptor,define=Object.defineProperty,forEach=array.forEach||function(iter,bind){for(var i=0,l=this.length;i<l;i++){iter.call(bind,this[i],i,this);}},forIn=function(iter,bind){for(var i in this){if(this.hasOwnProperty(i))
iter.call(bind,this[i],i,this);}},set=Object.assign||function(dst){for(var i=1,l=arguments.length;i<l;i++){var src=arguments[i];for(var key in src){if(src.hasOwnProperty(key))
dst[key]=src[key];}}
return dst;},each=function(obj,iter,bind){if(obj){var desc=describe(obj,'length');(desc&&typeof desc.value==='number'?forEach:forIn).call(obj,iter,bind=bind||obj);}
return bind;};function inject(dest,src,enumerable,beans,preserve){var beansNames={};function field(name,val){val=val||(val=describe(src,name))&&(val.get?val:val.value);if(typeof val==='string'&&val[0]==='#')
val=dest[val.substring(1)]||val;var isFunc=typeof val==='function',res=val,prev=preserve||isFunc&&!val.base?(val&&val.get?name in dest:dest[name]):null,bean;if(!preserve||!prev){if(isFunc&&prev)
val.base=prev;if(isFunc&&beans!==false&&(bean=name.match(/^([gs]et|is)(([A-Z])(.*))$/)))
beansNames[bean[3].toLowerCase()+bean[4]]=bean[2];if(!res||isFunc||!res.get||typeof res.get!=='function'||!Base.isPlainObject(res)){res={value:res,writable:true};}
if((describe(dest,name)||{configurable:true}).configurable){res.configurable=true;res.enumerable=enumerable!=null?enumerable:!bean;}
define(dest,name,res);}}
if(src){for(var name in src){if(src.hasOwnProperty(name)&&!hidden.test(name))
field(name);}
for(var name in beansNames){var part=beansNames[name],set=dest['set'+part],get=dest['get'+part]||set&&dest['is'+part];if(get&&(beans===true||get.length===0))
field(name,{get:get,set:set});}}
return dest;}
function Base(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];if(src)
set(this,src);}
return this;}
return inject(Base,{inject:function(src){if(src){var statics=src.statics===true?src:src.statics,beans=src.beans,preserve=src.preserve;if(statics!==src)
inject(this.prototype,src,src.enumerable,beans,preserve);inject(this,statics,null,beans,preserve);}
for(var i=1,l=arguments.length;i<l;i++)
this.inject(arguments[i]);return this;},extend:function(){var base=this,ctor,proto;for(var i=0,obj,l=arguments.length;i<l&&!(ctor&&proto);i++){obj=arguments[i];ctor=ctor||obj.initialize;proto=proto||obj.prototype;}
ctor=ctor||function(){base.apply(this,arguments);};proto=ctor.prototype=proto||create(this.prototype);define(proto,'constructor',{value:ctor,writable:true,configurable:true});inject(ctor,this);if(arguments.length)
this.inject.apply(ctor,arguments);ctor.base=base;return ctor;}}).inject({enumerable:false,initialize:Base,set:Base,inject:function(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];if(src){inject(this,src,src.enumerable,src.beans,src.preserve);}}
return this;},extend:function(){var res=create(this);return res.inject.apply(res,arguments);},each:function(iter,bind){return each(this,iter,bind);},clone:function(){return new this.constructor(this);},statics:{set:set,each:each,create:create,define:define,describe:describe,clone:function(obj){return set(new obj.constructor(),obj);},isPlainObject:function(obj){var ctor=obj!=null&&obj.constructor;return ctor&&(ctor===Object||ctor===Base||ctor.name==='Object');},pick:function(a,b){return a!==undefined?a:b;},slice:function(list,begin,end){return slice.call(list,begin,end);}}});};if(typeof module!=='undefined')
module.exports=Base;Base.inject({enumerable:false,toString:function(){return this._id!=null?(this._class||'Object')+(this._name?" '"+this._name+"'":' @'+this._id):'{ '+Base.each(this,function(value,key){if(!/^_/.test(key)){var type=typeof value;this.push(key+': '+(type==='number'?Formatter.instance.number(value):type==='string'?"'"+value+"'":value));}},[]).join(', ')+' }';},getClassName:function(){return this._class||'';},importJSON:function(json){return Base.importJSON(json,this);},exportJSON:function(options){return Base.exportJSON(this,options);},toJSON:function(){return Base.serialize(this);},set:function(props,exclude){if(props)
Base.filter(this,props,exclude,this._prioritize);return this;}},{beans:false,statics:{exports:{},extend:function extend(){var res=extend.base.apply(this,arguments),name=res.prototype._class;if(name&&!Base.exports[name])
Base.exports[name]=res;return res;},equals:function(obj1,obj2){if(obj1===obj2)
return true;if(obj1&&obj1.equals)
return obj1.equals(obj2);if(obj2&&obj2.equals)
return obj2.equals(obj1);if(obj1&&obj2&&typeof obj1==='object'&&typeof obj2==='object'){if(Array.isArray(obj1)&&Array.isArray(obj2)){var length=obj1.length;if(length!==obj2.length)
return false;while(length--){if(!Base.equals(obj1[length],obj2[length]))
return false;}}else{var keys=Object.keys(obj1),length=keys.length;if(length!==Object.keys(obj2).length)
return false;while(length--){var key=keys[length];if(!(obj2.hasOwnProperty(key)&&Base.equals(obj1[key],obj2[key])))
return false;}}
return true;}
return false;},read:function(list,start,options,amount){if(this===Base){var value=this.peek(list,start);list.__index++;return value;}
var proto=this.prototype,readIndex=proto._readIndex,begin=start||readIndex&&list.__index||0,length=list.length,obj=list[begin];amount=amount||length-begin;if(obj instanceof this||options&&options.readNull&&obj==null&&amount<=1){if(readIndex)
list.__index=begin+1;return obj&&options&&options.clone?obj.clone():obj;}
obj=Base.create(proto);if(readIndex)
obj.__read=true;obj=obj.initialize.apply(obj,begin>0||begin+amount<length?Base.slice(list,begin,begin+amount):list)||obj;if(readIndex){list.__index=begin+obj.__read;var filtered=obj.__filtered;if(filtered){list.__filtered=filtered;obj.__filtered=undefined;}
obj.__read=undefined;}
return obj;},peek:function(list,start){return list[list.__index=start||list.__index||0];},remain:function(list){return list.length-(list.__index||0);},readList:function(list,start,options,amount){var res=[],entry,begin=start||0,end=amount?begin+amount:list.length;for(var i=begin;i<end;i++){res.push(Array.isArray(entry=list[i])?this.read(entry,0,options):this.read(list,i,options,1));}
return res;},readNamed:function(list,name,start,options,amount){var value=this.getNamed(list,name),hasValue=value!==undefined;if(hasValue){var filtered=list.__filtered;if(!filtered){var source=this.getSource(list);filtered=list.__filtered=Base.create(source);filtered.__unfiltered=source;}
filtered[name]=undefined;}
return this.read(hasValue?[value]:list,start,options,amount);},readSupported:function(list,dest){var source=this.getSource(list),that=this,read=false;if(source){Object.keys(source).forEach(function(key){if(key in dest){var value=that.readNamed(list,key);if(value!==undefined){dest[key]=value;}
read=true;}});}
return read;},getSource:function(list){var source=list.__source;if(source===undefined){var arg=list.length===1&&list[0];source=list.__source=arg&&Base.isPlainObject(arg)?arg:null;}
return source;},getNamed:function(list,name){var source=this.getSource(list);if(source){return name?source[name]:list.__filtered||source;}},hasNamed:function(list,name){return!!this.getNamed(list,name);},filter:function(dest,source,exclude,prioritize){var processed;function handleKey(key){if(!(exclude&&key in exclude)&&!(processed&&key in processed)){var value=source[key];if(value!==undefined)
dest[key]=value;}}
if(prioritize){var keys={};for(var i=0,key,l=prioritize.length;i<l;i++){if((key=prioritize[i])in source){handleKey(key);keys[key]=true;}}
processed=keys;}
Object.keys(source.__unfiltered||source).forEach(handleKey);return dest;},isPlainValue:function(obj,asString){return Base.isPlainObject(obj)||Array.isArray(obj)||asString&&typeof obj==='string';},serialize:function(obj,options,compact,dictionary){options=options||{};var isRoot=!dictionary,res;if(isRoot){options.formatter=new Formatter(options.precision);dictionary={length:0,definitions:{},references:{},add:function(item,create){var id='#'+item._id,ref=this.references[id];if(!ref){this.length++;var res=create.call(item),name=item._class;if(name&&res[0]!==name)
res.unshift(name);this.definitions[id]=res;ref=this.references[id]=[id];}
return ref;}};}
if(obj&&obj._serialize){res=obj._serialize(options,dictionary);var name=obj._class;if(name&&!obj._compactSerialize&&(isRoot||!compact)&&res[0]!==name){res.unshift(name);}}else if(Array.isArray(obj)){res=[];for(var i=0,l=obj.length;i<l;i++)
res[i]=Base.serialize(obj[i],options,compact,dictionary);}else if(Base.isPlainObject(obj)){res={};var keys=Object.keys(obj);for(var i=0,l=keys.length;i<l;i++){var key=keys[i];res[key]=Base.serialize(obj[key],options,compact,dictionary);}}else if(typeof obj==='number'){res=options.formatter.number(obj,options.precision);}else{res=obj;}
return isRoot&&dictionary.length>0?[['dictionary',dictionary.definitions],res]:res;},deserialize:function(json,create,_data,_setDictionary,_isRoot){var res=json,isFirst=!_data,hasDictionary=isFirst&&json&&json.length&&json[0][0]==='dictionary';_data=_data||{};if(Array.isArray(json)){var type=json[0],isDictionary=type==='dictionary';if(json.length==1&&/^#/.test(type)){return _data.dictionary[type];}
type=Base.exports[type];res=[];for(var i=type?1:0,l=json.length;i<l;i++){res.push(Base.deserialize(json[i],create,_data,isDictionary,hasDictionary));}
if(type){var args=res;if(create){res=create(type,args,isFirst||_isRoot);}else{res=new type(args);}}}else if(Base.isPlainObject(json)){res={};if(_setDictionary)
_data.dictionary=res;for(var key in json)
res[key]=Base.deserialize(json[key],create,_data);}
return hasDictionary?res[1]:res;},exportJSON:function(obj,options){var json=Base.serialize(obj,options);return options&&options.asString==false?json:JSON.stringify(json);},importJSON:function(json,target){return Base.deserialize(typeof json==='string'?JSON.parse(json):json,function(ctor,args,isRoot){var useTarget=isRoot&&target&&target.constructor===ctor,obj=useTarget?target:Base.create(ctor.prototype);if(args.length===1&&obj instanceof Item&&(useTarget||!(obj instanceof Layer))){var arg=args[0];if(Base.isPlainObject(arg)){arg.insert=false;if(useTarget){args=args.concat([{insert:true}]);}}}
(useTarget?obj.set:ctor).apply(obj,args);if(useTarget)
target=null;return obj;});},push:function(list,items){var itemsLength=items.length;if(itemsLength<4096){list.push.apply(list,items);}else{var startLength=list.length;list.length+=itemsLength;for(var i=0;i<itemsLength;i++){list[startLength+i]=items[i];}}
return list;},splice:function(list,items,index,remove){var amount=items&&items.length,append=index===undefined;index=append?list.length:index;if(index>list.length)
index=list.length;for(var i=0;i<amount;i++)
items[i]._index=index+i;if(append){Base.push(list,items);return[];}else{var args=[index,remove];if(items)
Base.push(args,items);var removed=list.splice.apply(list,args);for(var i=0,l=removed.length;i<l;i++)
removed[i]._index=undefined;for(var i=index+amount,l=list.length;i<l;i++)
list[i]._index=i;return removed;}},capitalize:function(str){return str.replace(/\b[a-z]/g,function(match){return match.toUpperCase();});},camelize:function(str){return str.replace(/-(.)/g,function(match,chr){return chr.toUpperCase();});},hyphenate:function(str){return str.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase();}}});var Emitter={on:function(type,func){if(typeof type!=='string'){Base.each(type,function(value,key){this.on(key,value);},this);}else{var types=this._eventTypes,entry=types&&types[type],handlers=this._callbacks=this._callbacks||{};handlers=handlers[type]=handlers[type]||[];if(handlers.indexOf(func)===-1){handlers.push(func);if(entry&&entry.install&&handlers.length===1)
entry.install.call(this,type);}}
return this;},off:function(type,func){if(typeof type!=='string'){Base.each(type,function(value,key){this.off(key,value);},this);return;}
var types=this._eventTypes,entry=types&&types[type],handlers=this._callbacks&&this._callbacks[type],index;if(handlers){if(!func||(index=handlers.indexOf(func))!==-1&&handlers.length===1){if(entry&&entry.uninstall)
entry.uninstall.call(this,type);delete this._callbacks[type];}else if(index!==-1){handlers.splice(index,1);}}
return this;},once:function(type,func){return this.on(type,function handler(){func.apply(this,arguments);this.off(type,handler);});},emit:function(type,event){var handlers=this._callbacks&&this._callbacks[type];if(!handlers)
return false;var args=Base.slice(arguments,1),setTarget=event&&event.target&&!event.currentTarget;handlers=handlers.slice();if(setTarget)
event.currentTarget=this;for(var i=0,l=handlers.length;i<l;i++){if(handlers[i].apply(this,args)==false){if(event&&event.stop)
event.stop();break;}}
if(setTarget)
delete event.currentTarget;return true;},responds:function(type){return!!(this._callbacks&&this._callbacks[type]);},attach:'#on',detach:'#off',fire:'#emit',_installEvents:function(install){var types=this._eventTypes,handlers=this._callbacks,key=install?'install':'uninstall';if(types){for(var type in handlers){if(handlers[type].length>0){var entry=types[type],func=entry&&entry[key];if(func)
func.call(this,type);}}}},statics:{inject:function inject(src){var events=src._events;if(events){var types={};Base.each(events,function(entry,key){var isString=typeof entry==='string',name=isString?entry:key,part=Base.capitalize(name),type=name.substring(2).toLowerCase();types[type]=isString?{}:entry;name='_'+name;src['get'+part]=function(){return this[name];};src['set'+part]=function(func){var prev=this[name];if(prev)
this.off(type,prev);if(func)
this.on(type,func);this[name]=func;};});src._eventTypes=types;}
return inject.base.apply(this,arguments);}}};var PaperScope=Base.extend({_class:'PaperScope',initialize:function PaperScope(){paper=this;this.settings=new Base({applyMatrix:true,insertItems:true,handleSize:4,hitTolerance:0});this.project=null;this.projects=[];this.tools=[];this._id=PaperScope._id++;PaperScope._scopes[this._id]=this;var proto=PaperScope.prototype;if(!this.support){var ctx=CanvasProvider.getContext(1,1)||{};proto.support={nativeDash:'setLineDash'in ctx||'mozDash'in ctx,nativeBlendModes:BlendMode.nativeModes};CanvasProvider.release(ctx);}
if(!this.agent){var user=self.navigator.userAgent.toLowerCase(),os=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(user)||[])[0],platform=os==='darwin'?'mac':os,agent=proto.agent=proto.browser={platform:platform};if(platform)
agent[platform]=true;user.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(match,n,v1,v2,rv){if(!agent.chrome){var v=n==='opera'?v2:/^(node|trident)$/.test(n)?rv:v1;agent.version=v;agent.versionNumber=parseFloat(v);n={trident:'msie',jsdom:'node'}[n]||n;agent.name=n;agent[n]=true;}});if(agent.chrome)
delete agent.webkit;if(agent.atom)
delete agent.chrome;}},version:"0.12.15",getView:function(){var project=this.project;return project&&project._view;},getPaper:function(){return this;},execute:function(code,options){},install:function(scope){var that=this;Base.each(['project','view','tool'],function(key){Base.define(scope,key,{configurable:true,get:function(){return that[key];}});});for(var key in this)
if(!/^_/.test(key)&&this[key])
scope[key]=this[key];},setup:function(element){paper=this;this.project=new Project(element);return this;},createCanvas:function(width,height){return CanvasProvider.getCanvas(width,height);},activate:function(){paper=this;},clear:function(){var projects=this.projects,tools=this.tools;for(var i=projects.length-1;i>=0;i--)
projects[i].remove();for(var i=tools.length-1;i>=0;i--)
tools[i].remove();},remove:function(){this.clear();delete PaperScope._scopes[this._id];},statics:new function(){function handleAttribute(name){name+='Attribute';return function(el,attr){return el[name](attr)||el[name]('data-paper-'+attr);};}
return{_scopes:{},_id:0,get:function(id){return this._scopes[id]||null;},getAttribute:handleAttribute('get'),hasAttribute:handleAttribute('has')};}});var PaperScopeItem=Base.extend(Emitter,{initialize:function(activate){this._scope=paper;this._index=this._scope[this._list].push(this)-1;if(activate||!this._scope[this._reference])
this.activate();},activate:function(){if(!this._scope)
return false;var prev=this._scope[this._reference];if(prev&&prev!==this)
prev.emit('deactivate');this._scope[this._reference]=this;this.emit('activate',prev);return true;},isActive:function(){return this._scope[this._reference]===this;},remove:function(){if(this._index==null)
return false;Base.splice(this._scope[this._list],null,this._index,1);if(this._scope[this._reference]==this)
this._scope[this._reference]=null;this._scope=null;return true;},getView:function(){return this._scope.getView();}});var CollisionDetection={findItemBoundsCollisions:function(items1,items2,tolerance){function getBounds(items){var bounds=new Array(items.length);for(var i=0;i<items.length;i++){var rect=items[i].getBounds();bounds[i]=[rect.left,rect.top,rect.right,rect.bottom];}
return bounds;}
var bounds1=getBounds(items1),bounds2=!items2||items2===items1?bounds1:getBounds(items2);return this.findBoundsCollisions(bounds1,bounds2,tolerance||0);},findCurveBoundsCollisions:function(curves1,curves2,tolerance,bothAxis){function getBounds(curves){var min=Math.min,max=Math.max,bounds=new Array(curves.length);for(var i=0;i<curves.length;i++){var v=curves[i];bounds[i]=[min(v[0],v[2],v[4],v[6]),min(v[1],v[3],v[5],v[7]),max(v[0],v[2],v[4],v[6]),max(v[1],v[3],v[5],v[7])];}
return bounds;}
var bounds1=getBounds(curves1),bounds2=!curves2||curves2===curves1?bounds1:getBounds(curves2);if(bothAxis){var hor=this.findBoundsCollisions(bounds1,bounds2,tolerance||0,false,true),ver=this.findBoundsCollisions(bounds1,bounds2,tolerance||0,true,true),list=[];for(var i=0,l=hor.length;i<l;i++){list[i]={hor:hor[i],ver:ver[i]};}
return list;}
return this.findBoundsCollisions(bounds1,bounds2,tolerance||0);},findBoundsCollisions:function(boundsA,boundsB,tolerance,sweepVertical,onlySweepAxisCollisions){var self=!boundsB||boundsA===boundsB,allBounds=self?boundsA:boundsA.concat(boundsB),lengthA=boundsA.length,lengthAll=allBounds.length;function binarySearch(indices,coord,value){var lo=0,hi=indices.length;while(lo<hi){var mid=(hi+lo)>>>1;if(allBounds[indices[mid]][coord]<value){lo=mid+1;}else{hi=mid;}}
return lo-1;}
var pri0=sweepVertical?1:0,pri1=pri0+2,sec0=sweepVertical?0:1,sec1=sec0+2;var allIndicesByPri0=new Array(lengthAll);for(var i=0;i<lengthAll;i++){allIndicesByPri0[i]=i;}
allIndicesByPri0.sort(function(i1,i2){return allBounds[i1][pri0]-allBounds[i2][pri0];});var activeIndicesByPri1=[],allCollisions=new Array(lengthA);for(var i=0;i<lengthAll;i++){var curIndex=allIndicesByPri0[i],curBounds=allBounds[curIndex],origIndex=self?curIndex:curIndex-lengthA,isCurrentA=curIndex<lengthA,isCurrentB=self||!isCurrentA,curCollisions=isCurrentA?[]:null;if(activeIndicesByPri1.length){var pruneCount=binarySearch(activeIndicesByPri1,pri1,curBounds[pri0]-tolerance)+1;activeIndicesByPri1.splice(0,pruneCount);if(self&&onlySweepAxisCollisions){curCollisions=curCollisions.concat(activeIndicesByPri1);for(var j=0;j<activeIndicesByPri1.length;j++){var activeIndex=activeIndicesByPri1[j];allCollisions[activeIndex].push(origIndex);}}else{var curSec1=curBounds[sec1],curSec0=curBounds[sec0];for(var j=0;j<activeIndicesByPri1.length;j++){var activeIndex=activeIndicesByPri1[j],activeBounds=allBounds[activeIndex],isActiveA=activeIndex<lengthA,isActiveB=self||activeIndex>=lengthA;if(onlySweepAxisCollisions||(isCurrentA&&isActiveB||isCurrentB&&isActiveA)&&(curSec1>=activeBounds[sec0]-tolerance&&curSec0<=activeBounds[sec1]+tolerance)){if(isCurrentA&&isActiveB){curCollisions.push(self?activeIndex:activeIndex-lengthA);}
if(isCurrentB&&isActiveA){allCollisions[activeIndex].push(origIndex);}}}}}
if(isCurrentA){if(boundsA===boundsB){curCollisions.push(curIndex);}
allCollisions[curIndex]=curCollisions;}
if(activeIndicesByPri1.length){var curPri1=curBounds[pri1],index=binarySearch(activeIndicesByPri1,pri1,curPri1);activeIndicesByPri1.splice(index+1,0,curIndex);}else{activeIndicesByPri1.push(curIndex);}}
for(var i=0;i<allCollisions.length;i++){var collisions=allCollisions[i];if(collisions){collisions.sort(function(i1,i2){return i1-i2;});}}
return allCollisions;}};var Formatter=Base.extend({initialize:function(precision){this.precision=Base.pick(precision,5);this.multiplier=Math.pow(10,this.precision);},number:function(val){return this.precision<16?Math.round(val*this.multiplier)/ this.multiplier:val;},pair:function(val1,val2,separator){return this.number(val1)+(separator||',')+this.number(val2);},point:function(val,separator){return this.number(val.x)+(separator||',')+this.number(val.y);},size:function(val,separator){return this.number(val.width)+(separator||',')
+this.number(val.height);},rectangle:function(val,separator){return this.point(val,separator)+(separator||',')
+this.size(val,separator);}});Formatter.instance=new Formatter();var Numerical=new function(){var abscissas=[[0.5773502691896257645091488],[0,0.7745966692414833770358531],[0.3399810435848562648026658,0.8611363115940525752239465],[0,0.5384693101056830910363144,0.9061798459386639927976269],[0.2386191860831969086305017,0.6612093864662645136613996,0.9324695142031520278123016],[0,0.4058451513773971669066064,0.7415311855993944398638648,0.9491079123427585245261897],[0.1834346424956498049394761,0.5255324099163289858177390,0.7966664774136267395915539,0.9602898564975362316835609],[0,0.3242534234038089290385380,0.6133714327005903973087020,0.8360311073266357942994298,0.9681602395076260898355762],[0.1488743389816312108848260,0.4333953941292471907992659,0.6794095682990244062343274,0.8650633666889845107320967,0.9739065285171717200779640],[0,0.2695431559523449723315320,0.5190961292068118159257257,0.7301520055740493240934163,0.8870625997680952990751578,0.9782286581460569928039380],[0.1252334085114689154724414,0.3678314989981801937526915,0.5873179542866174472967024,0.7699026741943046870368938,0.9041172563704748566784659,0.9815606342467192506905491],[0,0.2304583159551347940655281,0.4484927510364468528779129,0.6423493394403402206439846,0.8015780907333099127942065,0.9175983992229779652065478,0.9841830547185881494728294],[0.1080549487073436620662447,0.3191123689278897604356718,0.5152486363581540919652907,0.6872929048116854701480198,0.8272013150697649931897947,0.9284348836635735173363911,0.9862838086968123388415973],[0,0.2011940939974345223006283,0.3941513470775633698972074,0.5709721726085388475372267,0.7244177313601700474161861,0.8482065834104272162006483,0.9372733924007059043077589,0.9879925180204854284895657],[0.0950125098376374401853193,0.2816035507792589132304605,0.4580167776572273863424194,0.6178762444026437484466718,0.7554044083550030338951012,0.8656312023878317438804679,0.9445750230732325760779884,0.9894009349916499325961542]];var weights=[[1],[0.8888888888888888888888889,0.5555555555555555555555556],[0.6521451548625461426269361,0.3478548451374538573730639],[0.5688888888888888888888889,0.4786286704993664680412915,0.2369268850561890875142640],[0.4679139345726910473898703,0.3607615730481386075698335,0.1713244923791703450402961],[0.4179591836734693877551020,0.3818300505051189449503698,0.2797053914892766679014678,0.1294849661688696932706114],[0.3626837833783619829651504,0.3137066458778872873379622,0.2223810344533744705443560,0.1012285362903762591525314],[0.3302393550012597631645251,0.3123470770400028400686304,0.2606106964029354623187429,0.1806481606948574040584720,0.0812743883615744119718922],[0.2955242247147528701738930,0.2692667193099963550912269,0.2190863625159820439955349,0.1494513491505805931457763,0.0666713443086881375935688],[0.2729250867779006307144835,0.2628045445102466621806889,0.2331937645919904799185237,0.1862902109277342514260976,0.1255803694649046246346943,0.0556685671161736664827537],[0.2491470458134027850005624,0.2334925365383548087608499,0.2031674267230659217490645,0.1600783285433462263346525,0.1069393259953184309602547,0.0471753363865118271946160],[0.2325515532308739101945895,0.2262831802628972384120902,0.2078160475368885023125232,0.1781459807619457382800467,0.1388735102197872384636018,0.0921214998377284479144218,0.0404840047653158795200216],[0.2152638534631577901958764,0.2051984637212956039659241,0.1855383974779378137417166,0.1572031671581935345696019,0.1215185706879031846894148,0.0801580871597602098056333,0.0351194603317518630318329],[0.2025782419255612728806202,0.1984314853271115764561183,0.1861610000155622110268006,0.1662692058169939335532009,0.1395706779261543144478048,0.1071592204671719350118695,0.0703660474881081247092674,0.0307532419961172683546284],[0.1894506104550684962853967,0.1826034150449235888667637,0.1691565193950025381893121,0.1495959888165767320815017,0.1246289712555338720524763,0.0951585116824927848099251,0.0622535239386478928628438,0.0271524594117540948517806]];var abs=Math.abs,sqrt=Math.sqrt,pow=Math.pow,log2=Math.log2||function(x){return Math.log(x)*Math.LOG2E;},EPSILON=1e-12,MACHINE_EPSILON=1.12e-16;function clamp(value,min,max){return value<min?min:value>max?max:value;}
function getDiscriminant(a,b,c){function split(v){var x=v*134217729,y=v-x,hi=y+x,lo=v-hi;return[hi,lo];}
var D=b*b-a*c,E=b*b+a*c;if(abs(D)*3<E){var ad=split(a),bd=split(b),cd=split(c),p=b*b,dp=(bd[0]*bd[0]-p+2*bd[0]*bd[1])+bd[1]*bd[1],q=a*c,dq=(ad[0]*cd[0]-q+ad[0]*cd[1]+ad[1]*cd[0])
+ad[1]*cd[1];D=(p-q)+(dp-dq);}
return D;}
function getNormalizationFactor(){var norm=Math.max.apply(Math,arguments);return norm&&(norm<1e-8||norm>1e8)?pow(2,-Math.round(log2(norm))):0;}
return{EPSILON:EPSILON,MACHINE_EPSILON:MACHINE_EPSILON,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(sqrt(2)-1)/ 3,isZero:function(val){return val>=-EPSILON&&val<=EPSILON;},isMachineZero:function(val){return val>=-MACHINE_EPSILON&&val<=MACHINE_EPSILON;},clamp:clamp,integrate:function(f,a,b,n){var x=abscissas[n-2],w=weights[n-2],A=(b-a)*0.5,B=A+a,i=0,m=(n+1)>>1,sum=n&1?w[i++]*f(B):0;while(i<m){var Ax=A*x[i];sum+=w[i++]*(f(B+Ax)+f(B-Ax));}
return A*sum;},findRoot:function(f,df,x,a,b,n,tolerance){for(var i=0;i<n;i++){var fx=f(x),dx=fx / df(x),nx=x-dx;if(abs(dx)<tolerance){x=nx;break;}
if(fx>0){b=x;x=nx<=a?(a+b)*0.5:nx;}else{a=x;x=nx>=b?(a+b)*0.5:nx;}}
return clamp(x,a,b);},solveQuadratic:function(a,b,c,roots,min,max){var x1,x2=Infinity;if(abs(a)<EPSILON){if(abs(b)<EPSILON)
return abs(c)<EPSILON?-1:0;x1=-c / b;}else{b*=-0.5;var D=getDiscriminant(a,b,c);if(D&&abs(D)<MACHINE_EPSILON){var f=getNormalizationFactor(abs(a),abs(b),abs(c));if(f){a*=f;b*=f;c*=f;D=getDiscriminant(a,b,c);}}
if(D>=-MACHINE_EPSILON){var Q=D<0?0:sqrt(D),R=b+(b<0?-Q:Q);if(R===0){x1=c / a;x2=-x1;}else{x1=R / a;x2=c / R;}}}
var count=0,boundless=min==null,minB=min-EPSILON,maxB=max+EPSILON;if(isFinite(x1)&&(boundless||x1>minB&&x1<maxB))
roots[count++]=boundless?x1:clamp(x1,min,max);if(x2!==x1&&isFinite(x2)&&(boundless||x2>minB&&x2<maxB))
roots[count++]=boundless?x2:clamp(x2,min,max);return count;},solveCubic:function(a,b,c,d,roots,min,max){var f=getNormalizationFactor(abs(a),abs(b),abs(c),abs(d)),x,b1,c2,qd,q;if(f){a*=f;b*=f;c*=f;d*=f;}
function evaluate(x0){x=x0;var tmp=a*x;b1=tmp+b;c2=b1*x+c;qd=(tmp+b1)*x+c2;q=c2*x+d;}
if(abs(a)<EPSILON){a=b;b1=c;c2=d;x=Infinity;}else if(abs(d)<EPSILON){b1=b;c2=c;x=0;}else{evaluate(-(b / a)/ 3);var t=q / a,r=pow(abs(t),1/3),s=t<0?-1:1,td=-qd / a,rd=td>0?1.324717957244746*Math.max(r,sqrt(td)):r,x0=x-s*rd;if(x0!==x){do{evaluate(x0);x0=qd===0?x:x-q / qd /(1+MACHINE_EPSILON);}while(s*x0>s*x);if(abs(a)*x*x>abs(d / x)){c2=-d / x;b1=(c2-c)/ x;}}}
var count=Numerical.solveQuadratic(a,b1,c2,roots,min,max),boundless=min==null;if(isFinite(x)&&(count===0||count>0&&x!==roots[0]&&x!==roots[1])&&(boundless||x>min-EPSILON&&x<max+EPSILON))
roots[count++]=boundless?x:clamp(x,min,max);return count;}};};var UID={_id:1,_pools:{},get:function(name){if(name){var pool=this._pools[name];if(!pool)
pool=this._pools[name]={_id:1};return pool._id++;}else{return this._id++;}}};var Point=Base.extend({_class:'Point',_readIndex:true,initialize:function Point(arg0,arg1){var type=typeof arg0,reading=this.__read,read=0;if(type==='number'){var hasY=typeof arg1==='number';this._set(arg0,hasY?arg1:arg0);if(reading)
read=hasY?2:1;}else if(type==='undefined'||arg0===null){this._set(0,0);if(reading)
read=arg0===null?1:0;}else{var obj=type==='string'?arg0.split(/[\s,]+/)||[]:arg0;read=1;if(Array.isArray(obj)){this._set(+obj[0],+(obj.length>1?obj[1]:obj[0]));}else if('x'in obj){this._set(obj.x||0,obj.y||0);}else if('width'in obj){this._set(obj.width||0,obj.height||0);}else if('angle'in obj){this._set(obj.length||0,0);this.setAngle(obj.angle||0);}else{this._set(0,0);read=0;}}
if(reading)
this.__read=read;return this;},set:'#initialize',_set:function(x,y){this.x=x;this.y=y;return this;},equals:function(point){return this===point||point&&(this.x===point.x&&this.y===point.y||Array.isArray(point)&&this.x===point[0]&&this.y===point[1])||false;},clone:function(){return new Point(this.x,this.y);},toString:function(){var f=Formatter.instance;return'{ x: '+f.number(this.x)+', y: '+f.number(this.y)+' }';},_serialize:function(options){var f=options.formatter;return[f.number(this.x),f.number(this.y)];},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y);},setLength:function(length){if(this.isZero()){var angle=this._angle||0;this._set(Math.cos(angle)*length,Math.sin(angle)*length);}else{var scale=length / this.getLength();if(Numerical.isZero(scale))
this.getAngle();this._set(this.x*scale,this.y*scale);}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180 / Math.PI;},setAngle:function(angle){this.setAngleInRadians.call(this,angle*Math.PI / 180);},getAngleInDegrees:'#getAngle',setAngleInDegrees:'#setAngle',getAngleInRadians:function(){if(!arguments.length){return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);}else{var point=Point.read(arguments),div=this.getLength()*point.getLength();if(Numerical.isZero(div)){return NaN;}else{var a=this.dot(point)/ div;return Math.acos(a<-1?-1:a>1?1:a);}}},setAngleInRadians:function(angle){this._angle=angle;if(!this.isZero()){var length=this.getLength();this._set(Math.cos(angle)*length,Math.sin(angle)*length);}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3;}},{beans:false,getDirectedAngle:function(){var point=Point.read(arguments);return Math.atan2(this.cross(point),this.dot(point))*180 / Math.PI;},getDistance:function(){var args=arguments,point=Point.read(args),x=point.x-this.x,y=point.y-this.y,d=x*x+y*y,squared=Base.read(args);return squared?d:Math.sqrt(d);},normalize:function(length){if(length===undefined)
length=1;var current=this.getLength(),scale=current!==0?length / current:0,point=new Point(this.x*scale,this.y*scale);if(scale>=0)
point._angle=this._angle;return point;},rotate:function(angle,center){if(angle===0)
return this.clone();angle=angle*Math.PI / 180;var point=center?this.subtract(center):this,sin=Math.sin(angle),cos=Math.cos(angle);point=new Point(point.x*cos-point.y*sin,point.x*sin+point.y*cos);return center?point.add(center):point;},transform:function(matrix){return matrix?matrix._transformPoint(this):this;},add:function(){var point=Point.read(arguments);return new Point(this.x+point.x,this.y+point.y);},subtract:function(){var point=Point.read(arguments);return new Point(this.x-point.x,this.y-point.y);},multiply:function(){var point=Point.read(arguments);return new Point(this.x*point.x,this.y*point.y);},divide:function(){var point=Point.read(arguments);return new Point(this.x / point.x,this.y / point.y);},modulo:function(){var point=Point.read(arguments);return new Point(this.x%point.x,this.y%point.y);},negate:function(){return new Point(-this.x,-this.y);},isInside:function(){return Rectangle.read(arguments).contains(this);},isClose:function(){var args=arguments,point=Point.read(args),tolerance=Base.read(args);return this.getDistance(point)<=tolerance;},isCollinear:function(){var point=Point.read(arguments);return Point.isCollinear(this.x,this.y,point.x,point.y);},isColinear:'#isCollinear',isOrthogonal:function(){var point=Point.read(arguments);return Point.isOrthogonal(this.x,this.y,point.x,point.y);},isZero:function(){var isZero=Numerical.isZero;return isZero(this.x)&&isZero(this.y);},isNaN:function(){return isNaN(this.x)||isNaN(this.y);},isInQuadrant:function(q){return this.x*(q>1&&q<4?-1:1)>=0&&this.y*(q>2?-1:1)>=0;},dot:function(){var point=Point.read(arguments);return this.x*point.x+this.y*point.y;},cross:function(){var point=Point.read(arguments);return this.x*point.y-this.y*point.x;},project:function(){var point=Point.read(arguments),scale=point.isZero()?0:this.dot(point)/ point.dot(point);return new Point(point.x*scale,point.y*scale);},statics:{min:function(){var args=arguments,point1=Point.read(args),point2=Point.read(args);return new Point(Math.min(point1.x,point2.x),Math.min(point1.y,point2.y));},max:function(){var args=arguments,point1=Point.read(args),point2=Point.read(args);return new Point(Math.max(point1.x,point2.x),Math.max(point1.y,point2.y));},random:function(){return new Point(Math.random(),Math.random());},isCollinear:function(x1,y1,x2,y2){return Math.abs(x1*y2-y1*x2)<=Math.sqrt((x1*x1+y1*y1)*(x2*x2+y2*y2))*1e-8;},isOrthogonal:function(x1,y1,x2,y2){return Math.abs(x1*x2+y1*y2)<=Math.sqrt((x1*x1+y1*y1)*(x2*x2+y2*y2))*1e-8;}}},Base.each(['round','ceil','floor','abs'],function(key){var op=Math[key];this[key]=function(){return new Point(op(this.x),op(this.y));};},{}));var LinkedPoint=Point.extend({initialize:function Point(x,y,owner,setter){this._x=x;this._y=y;this._owner=owner;this._setter=setter;},_set:function(x,y,_dontNotify){this._x=x;this._y=y;if(!_dontNotify)
this._owner[this._setter](this);return this;},getX:function(){return this._x;},setX:function(x){this._x=x;this._owner[this._setter](this);},getY:function(){return this._y;},setY:function(y){this._y=y;this._owner[this._setter](this);},isSelected:function(){return!!(this._owner._selection&this._getSelection());},setSelected:function(selected){this._owner._changeSelection(this._getSelection(),selected);},_getSelection:function(){return this._setter==='setPosition'?4:0;}});var Size=Base.extend({_class:'Size',_readIndex:true,initialize:function Size(arg0,arg1){var type=typeof arg0,reading=this.__read,read=0;if(type==='number'){var hasHeight=typeof arg1==='number';this._set(arg0,hasHeight?arg1:arg0);if(reading)
read=hasHeight?2:1;}else if(type==='undefined'||arg0===null){this._set(0,0);if(reading)
read=arg0===null?1:0;}else{var obj=type==='string'?arg0.split(/[\s,]+/)||[]:arg0;read=1;if(Array.isArray(obj)){this._set(+obj[0],+(obj.length>1?obj[1]:obj[0]));}else if('width'in obj){this._set(obj.width||0,obj.height||0);}else if('x'in obj){this._set(obj.x||0,obj.y||0);}else{this._set(0,0);read=0;}}
if(reading)
this.__read=read;return this;},set:'#initialize',_set:function(width,height){this.width=width;this.height=height;return this;},equals:function(size){return size===this||size&&(this.width===size.width&&this.height===size.height||Array.isArray(size)&&this.width===size[0]&&this.height===size[1])||false;},clone:function(){return new Size(this.width,this.height);},toString:function(){var f=Formatter.instance;return'{ width: '+f.number(this.width)
+', height: '+f.number(this.height)+' }';},_serialize:function(options){var f=options.formatter;return[f.number(this.width),f.number(this.height)];},add:function(){var size=Size.read(arguments);return new Size(this.width+size.width,this.height+size.height);},subtract:function(){var size=Size.read(arguments);return new Size(this.width-size.width,this.height-size.height);},multiply:function(){var size=Size.read(arguments);return new Size(this.width*size.width,this.height*size.height);},divide:function(){var size=Size.read(arguments);return new Size(this.width / size.width,this.height / size.height);},modulo:function(){var size=Size.read(arguments);return new Size(this.width%size.width,this.height%size.height);},negate:function(){return new Size(-this.width,-this.height);},isZero:function(){var isZero=Numerical.isZero;return isZero(this.width)&&isZero(this.height);},isNaN:function(){return isNaN(this.width)||isNaN(this.height);},statics:{min:function(size1,size2){return new Size(Math.min(size1.width,size2.width),Math.min(size1.height,size2.height));},max:function(size1,size2){return new Size(Math.max(size1.width,size2.width),Math.max(size1.height,size2.height));},random:function(){return new Size(Math.random(),Math.random());}}},Base.each(['round','ceil','floor','abs'],function(key){var op=Math[key];this[key]=function(){return new Size(op(this.width),op(this.height));};},{}));var LinkedSize=Size.extend({initialize:function Size(width,height,owner,setter){this._width=width;this._height=height;this._owner=owner;this._setter=setter;},_set:function(width,height,_dontNotify){this._width=width;this._height=height;if(!_dontNotify)
this._owner[this._setter](this);return this;},getWidth:function(){return this._width;},setWidth:function(width){this._width=width;this._owner[this._setter](this);},getHeight:function(){return this._height;},setHeight:function(height){this._height=height;this._owner[this._setter](this);}});var Rectangle=Base.extend({_class:'Rectangle',_readIndex:true,beans:true,initialize:function Rectangle(arg0,arg1,arg2,arg3){var args=arguments,type=typeof arg0,read;if(type==='number'){this._set(arg0,arg1,arg2,arg3);read=4;}else if(type==='undefined'||arg0===null){this._set(0,0,0,0);read=arg0===null?1:0;}else if(args.length===1){if(Array.isArray(arg0)){this._set.apply(this,arg0);read=1;}else if(arg0.x!==undefined||arg0.width!==undefined){this._set(arg0.x||0,arg0.y||0,arg0.width||0,arg0.height||0);read=1;}else if(arg0.from===undefined&&arg0.to===undefined){this._set(0,0,0,0);if(Base.readSupported(args,this)){read=1;}}}
if(read===undefined){var frm=Point.readNamed(args,'from'),next=Base.peek(args),x=frm.x,y=frm.y,width,height;if(next&&next.x!==undefined||Base.hasNamed(args,'to')){var to=Point.readNamed(args,'to');width=to.x-x;height=to.y-y;if(width<0){x=to.x;width=-width;}
if(height<0){y=to.y;height=-height;}}else{var size=Size.read(args);width=size.width;height=size.height;}
this._set(x,y,width,height);read=args.__index;}
var filtered=args.__filtered;if(filtered)
this.__filtered=filtered;if(this.__read)
this.__read=read;return this;},set:'#initialize',_set:function(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height;return this;},clone:function(){return new Rectangle(this.x,this.y,this.width,this.height);},equals:function(rect){var rt=Base.isPlainValue(rect)?Rectangle.read(arguments):rect;return rt===this||rt&&this.x===rt.x&&this.y===rt.y&&this.width===rt.width&&this.height===rt.height||false;},toString:function(){var f=Formatter.instance;return'{ x: '+f.number(this.x)
+', y: '+f.number(this.y)
+', width: '+f.number(this.width)
+', height: '+f.number(this.height)
+' }';},_serialize:function(options){var f=options.formatter;return[f.number(this.x),f.number(this.y),f.number(this.width),f.number(this.height)];},getPoint:function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this.x,this.y,this,'setPoint');},setPoint:function(){var point=Point.read(arguments);this.x=point.x;this.y=point.y;},getSize:function(_dontLink){var ctor=_dontLink?Size:LinkedSize;return new ctor(this.width,this.height,this,'setSize');},_fw:1,_fh:1,setSize:function(){var size=Size.read(arguments),sx=this._sx,sy=this._sy,w=size.width,h=size.height;if(sx){this.x+=(this.width-w)*sx;}
if(sy){this.y+=(this.height-h)*sy;}
this.width=w;this.height=h;this._fw=this._fh=1;},getLeft:function(){return this.x;},setLeft:function(left){if(!this._fw){var amount=left-this.x;this.width-=this._sx===0.5?amount*2:amount;}
this.x=left;this._sx=this._fw=0;},getTop:function(){return this.y;},setTop:function(top){if(!this._fh){var amount=top-this.y;this.height-=this._sy===0.5?amount*2:amount;}
this.y=top;this._sy=this._fh=0;},getRight:function(){return this.x+this.width;},setRight:function(right){if(!this._fw){var amount=right-this.x;this.width=this._sx===0.5?amount*2:amount;}
this.x=right-this.width;this._sx=1;this._fw=0;},getBottom:function(){return this.y+this.height;},setBottom:function(bottom){if(!this._fh){var amount=bottom-this.y;this.height=this._sy===0.5?amount*2:amount;}
this.y=bottom-this.height;this._sy=1;this._fh=0;},getCenterX:function(){return this.x+this.width / 2;},setCenterX:function(x){if(this._fw||this._sx===0.5){this.x=x-this.width / 2;}else{if(this._sx){this.x+=(x-this.x)*2*this._sx;}
this.width=(x-this.x)*2;}
this._sx=0.5;this._fw=0;},getCenterY:function(){return this.y+this.height / 2;},setCenterY:function(y){if(this._fh||this._sy===0.5){this.y=y-this.height / 2;}else{if(this._sy){this.y+=(y-this.y)*2*this._sy;}
this.height=(y-this.y)*2;}
this._sy=0.5;this._fh=0;},getCenter:function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this.getCenterX(),this.getCenterY(),this,'setCenter');},setCenter:function(){var point=Point.read(arguments);this.setCenterX(point.x);this.setCenterY(point.y);return this;},getArea:function(){return this.width*this.height;},isEmpty:function(){return this.width===0||this.height===0;},contains:function(arg){return arg&&arg.width!==undefined||(Array.isArray(arg)?arg:arguments).length===4?this._containsRectangle(Rectangle.read(arguments)):this._containsPoint(Point.read(arguments));},_containsPoint:function(point){var x=point.x,y=point.y;return x>=this.x&&y>=this.y&&x<=this.x+this.width&&y<=this.y+this.height;},_containsRectangle:function(rect){var x=rect.x,y=rect.y;return x>=this.x&&y>=this.y&&x+rect.width<=this.x+this.width&&y+rect.height<=this.y+this.height;},intersects:function(){var rect=Rectangle.read(arguments),epsilon=Base.read(arguments)||0;return rect.x+rect.width>this.x-epsilon&&rect.y+rect.height>this.y-epsilon&&rect.x<this.x+this.width+epsilon&&rect.y<this.y+this.height+epsilon;},intersect:function(){var rect=Rectangle.read(arguments),x1=Math.max(this.x,rect.x),y1=Math.max(this.y,rect.y),x2=Math.min(this.x+this.width,rect.x+rect.width),y2=Math.min(this.y+this.height,rect.y+rect.height);return new Rectangle(x1,y1,x2-x1,y2-y1);},unite:function(){var rect=Rectangle.read(arguments),x1=Math.min(this.x,rect.x),y1=Math.min(this.y,rect.y),x2=Math.max(this.x+this.width,rect.x+rect.width),y2=Math.max(this.y+this.height,rect.y+rect.height);return new Rectangle(x1,y1,x2-x1,y2-y1);},include:function(){var point=Point.read(arguments);var x1=Math.min(this.x,point.x),y1=Math.min(this.y,point.y),x2=Math.max(this.x+this.width,point.x),y2=Math.max(this.y+this.height,point.y);return new Rectangle(x1,y1,x2-x1,y2-y1);},expand:function(){var amount=Size.read(arguments),hor=amount.width,ver=amount.height;return new Rectangle(this.x-hor / 2,this.y-ver / 2,this.width+hor,this.height+ver);},scale:function(hor,ver){return this.expand(this.width*hor-this.width,this.height*(ver===undefined?hor:ver)-this.height);}},Base.each([['Top','Left'],['Top','Right'],['Bottom','Left'],['Bottom','Right'],['Left','Center'],['Top','Center'],['Right','Center'],['Bottom','Center']],function(parts,index){var part=parts.join(''),xFirst=/^[RL]/.test(part);if(index>=4)
parts[1]+=xFirst?'Y':'X';var x=parts[xFirst?0:1],y=parts[xFirst?1:0],getX='get'+x,getY='get'+y,setX='set'+x,setY='set'+y,get='get'+part,set='set'+part;this[get]=function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this[getX](),this[getY](),this,set);};this[set]=function(){var point=Point.read(arguments);this[setX](point.x);this[setY](point.y);};},{beans:true}));var LinkedRectangle=Rectangle.extend({initialize:function Rectangle(x,y,width,height,owner,setter){this._set(x,y,width,height,true);this._owner=owner;this._setter=setter;},_set:function(x,y,width,height,_dontNotify){this._x=x;this._y=y;this._width=width;this._height=height;if(!_dontNotify)
this._owner[this._setter](this);return this;}},new function(){var proto=Rectangle.prototype;return Base.each(['x','y','width','height'],function(key){var part=Base.capitalize(key),internal='_'+key;this['get'+part]=function(){return this[internal];};this['set'+part]=function(value){this[internal]=value;if(!this._dontNotify)
this._owner[this._setter](this);};},Base.each(['Point','Size','Center','Left','Top','Right','Bottom','CenterX','CenterY','TopLeft','TopRight','BottomLeft','BottomRight','LeftCenter','TopCenter','RightCenter','BottomCenter'],function(key){var name='set'+key;this[name]=function(){this._dontNotify=true;proto[name].apply(this,arguments);this._dontNotify=false;this._owner[this._setter](this);};},{isSelected:function(){return!!(this._owner._selection&2);},setSelected:function(selected){var owner=this._owner;if(owner._changeSelection){owner._changeSelection(2,selected);}}}));});var Matrix=Base.extend({_class:'Matrix',initialize:function Matrix(arg,_dontNotify){var args=arguments,count=args.length,ok=true;if(count>=6){this._set.apply(this,args);}else if(count===1||count===2){if(arg instanceof Matrix){this._set(arg._a,arg._b,arg._c,arg._d,arg._tx,arg._ty,_dontNotify);}else if(Array.isArray(arg)){this._set.apply(this,_dontNotify?arg.concat([_dontNotify]):arg);}else{ok=false;}}else if(!count){this.reset();}else{ok=false;}
if(!ok){throw new Error('Unsupported matrix parameters');}
return this;},set:'#initialize',_set:function(a,b,c,d,tx,ty,_dontNotify){this._a=a;this._b=b;this._c=c;this._d=d;this._tx=tx;this._ty=ty;if(!_dontNotify)
this._changed();return this;},_serialize:function(options,dictionary){return Base.serialize(this.getValues(),options,true,dictionary);},_changed:function(){var owner=this._owner;if(owner){if(owner._applyMatrix){owner.transform(null,true);}else{owner._changed(25);}}},clone:function(){return new Matrix(this._a,this._b,this._c,this._d,this._tx,this._ty);},equals:function(mx){return mx===this||mx&&this._a===mx._a&&this._b===mx._b&&this._c===mx._c&&this._d===mx._d&&this._tx===mx._tx&&this._ty===mx._ty;},toString:function(){var f=Formatter.instance;return'[['+[f.number(this._a),f.number(this._c),f.number(this._tx)].join(', ')+'], ['
+[f.number(this._b),f.number(this._d),f.number(this._ty)].join(', ')+']]';},reset:function(_dontNotify){this._a=this._d=1;this._b=this._c=this._tx=this._ty=0;if(!_dontNotify)
this._changed();return this;},apply:function(recursively,_setApplyMatrix){var owner=this._owner;if(owner){owner.transform(null,Base.pick(recursively,true),_setApplyMatrix);return this.isIdentity();}
return false;},translate:function(){var point=Point.read(arguments),x=point.x,y=point.y;this._tx+=x*this._a+y*this._c;this._ty+=x*this._b+y*this._d;this._changed();return this;},scale:function(){var args=arguments,scale=Point.read(args),center=Point.read(args,0,{readNull:true});if(center)
this.translate(center);this._a*=scale.x;this._b*=scale.x;this._c*=scale.y;this._d*=scale.y;if(center)
this.translate(center.negate());this._changed();return this;},rotate:function(angle){angle*=Math.PI / 180;var center=Point.read(arguments,1),x=center.x,y=center.y,cos=Math.cos(angle),sin=Math.sin(angle),tx=x-x*cos+y*sin,ty=y-x*sin-y*cos,a=this._a,b=this._b,c=this._c,d=this._d;this._a=cos*a+sin*c;this._b=cos*b+sin*d;this._c=-sin*a+cos*c;this._d=-sin*b+cos*d;this._tx+=tx*a+ty*c;this._ty+=tx*b+ty*d;this._changed();return this;},shear:function(){var args=arguments,shear=Point.read(args),center=Point.read(args,0,{readNull:true});if(center)
this.translate(center);var a=this._a,b=this._b;this._a+=shear.y*this._c;this._b+=shear.y*this._d;this._c+=shear.x*a;this._d+=shear.x*b;if(center)
this.translate(center.negate());this._changed();return this;},skew:function(){var args=arguments,skew=Point.read(args),center=Point.read(args,0,{readNull:true}),toRadians=Math.PI / 180,shear=new Point(Math.tan(skew.x*toRadians),Math.tan(skew.y*toRadians));return this.shear(shear,center);},append:function(mx,_dontNotify){if(mx){var a1=this._a,b1=this._b,c1=this._c,d1=this._d,a2=mx._a,b2=mx._c,c2=mx._b,d2=mx._d,tx2=mx._tx,ty2=mx._ty;this._a=a2*a1+c2*c1;this._c=b2*a1+d2*c1;this._b=a2*b1+c2*d1;this._d=b2*b1+d2*d1;this._tx+=tx2*a1+ty2*c1;this._ty+=tx2*b1+ty2*d1;if(!_dontNotify)
this._changed();}
return this;},prepend:function(mx,_dontNotify){if(mx){var a1=this._a,b1=this._b,c1=this._c,d1=this._d,tx1=this._tx,ty1=this._ty,a2=mx._a,b2=mx._c,c2=mx._b,d2=mx._d,tx2=mx._tx,ty2=mx._ty;this._a=a2*a1+b2*b1;this._c=a2*c1+b2*d1;this._b=c2*a1+d2*b1;this._d=c2*c1+d2*d1;this._tx=a2*tx1+b2*ty1+tx2;this._ty=c2*tx1+d2*ty1+ty2;if(!_dontNotify)
this._changed();}
return this;},appended:function(mx){return this.clone().append(mx);},prepended:function(mx){return this.clone().prepend(mx);},invert:function(){var a=this._a,b=this._b,c=this._c,d=this._d,tx=this._tx,ty=this._ty,det=a*d-b*c,res=null;if(det&&!isNaN(det)&&isFinite(tx)&&isFinite(ty)){this._a=d / det;this._b=-b / det;this._c=-c / det;this._d=a / det;this._tx=(c*ty-d*tx)/ det;this._ty=(b*tx-a*ty)/ det;res=this;}
return res;},inverted:function(){return this.clone().invert();},concatenate:'#append',preConcatenate:'#prepend',chain:'#appended',_shiftless:function(){return new Matrix(this._a,this._b,this._c,this._d,0,0);},_orNullIfIdentity:function(){return this.isIdentity()?null:this;},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0;},isInvertible:function(){var det=this._a*this._d-this._c*this._b;return det&&!isNaN(det)&&isFinite(this._tx)&&isFinite(this._ty);},isSingular:function(){return!this.isInvertible();},transform:function(src,dst,count){return arguments.length<3?this._transformPoint(Point.read(arguments)):this._transformCoordinates(src,dst,count);},_transformPoint:function(point,dest,_dontNotify){var x=point.x,y=point.y;if(!dest)
dest=new Point();return dest._set(x*this._a+y*this._c+this._tx,x*this._b+y*this._d+this._ty,_dontNotify);},_transformCoordinates:function(src,dst,count){for(var i=0,max=2*count;i<max;i+=2){var x=src[i],y=src[i+1];dst[i]=x*this._a+y*this._c+this._tx;dst[i+1]=x*this._b+y*this._d+this._ty;}
return dst;},_transformCorners:function(rect){var x1=rect.x,y1=rect.y,x2=x1+rect.width,y2=y1+rect.height,coords=[x1,y1,x2,y1,x2,y2,x1,y2];return this._transformCoordinates(coords,coords,4);},_transformBounds:function(bounds,dest,_dontNotify){var coords=this._transformCorners(bounds),min=coords.slice(0,2),max=min.slice();for(var i=2;i<8;i++){var val=coords[i],j=i&1;if(val<min[j]){min[j]=val;}else if(val>max[j]){max[j]=val;}}
if(!dest)
dest=new Rectangle();return dest._set(min[0],min[1],max[0]-min[0],max[1]-min[1],_dontNotify);},inverseTransform:function(){return this._inverseTransform(Point.read(arguments));},_inverseTransform:function(point,dest,_dontNotify){var a=this._a,b=this._b,c=this._c,d=this._d,tx=this._tx,ty=this._ty,det=a*d-b*c,res=null;if(det&&!isNaN(det)&&isFinite(tx)&&isFinite(ty)){var x=point.x-this._tx,y=point.y-this._ty;if(!dest)
dest=new Point();res=dest._set((x*d-y*c)/ det,(y*a-x*b)/ det,_dontNotify);}
return res;},decompose:function(){var a=this._a,b=this._b,c=this._c,d=this._d,det=a*d-b*c,sqrt=Math.sqrt,atan2=Math.atan2,degrees=180 / Math.PI,rotate,scale,skew;if(a!==0||b!==0){var r=sqrt(a*a+b*b);rotate=Math.acos(a / r)*(b>0?1:-1);scale=[r,det / r];skew=[atan2(a*c+b*d,r*r),0];}else if(c!==0||d!==0){var s=sqrt(c*c+d*d);rotate=Math.asin(c / s)*(d>0?1:-1);scale=[det / s,s];skew=[0,atan2(a*c+b*d,s*s)];}else{rotate=0;skew=scale=[0,0];}
return{translation:this.getTranslation(),rotation:rotate*degrees,scaling:new Point(scale),skewing:new Point(skew[0]*degrees,skew[1]*degrees)};},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty];},getTranslation:function(){return new Point(this._tx,this._ty);},getScaling:function(){return this.decompose().scaling;},getRotation:function(){return this.decompose().rotation;},applyToContext:function(ctx){if(!this.isIdentity()){ctx.transform(this._a,this._b,this._c,this._d,this._tx,this._ty);}}},Base.each(['a','b','c','d','tx','ty'],function(key){var part=Base.capitalize(key),prop='_'+key;this['get'+part]=function(){return this[prop];};this['set'+part]=function(value){this[prop]=value;this._changed();};},{}));var Line=Base.extend({_class:'Line',initialize:function Line(arg0,arg1,arg2,arg3,arg4){var asVector=false;if(arguments.length>=4){this._px=arg0;this._py=arg1;this._vx=arg2;this._vy=arg3;asVector=arg4;}else{this._px=arg0.x;this._py=arg0.y;this._vx=arg1.x;this._vy=arg1.y;asVector=arg2;}
if(!asVector){this._vx-=this._px;this._vy-=this._py;}},getPoint:function(){return new Point(this._px,this._py);},getVector:function(){return new Point(this._vx,this._vy);},getLength:function(){return this.getVector().getLength();},intersect:function(line,isInfinite){return Line.intersect(this._px,this._py,this._vx,this._vy,line._px,line._py,line._vx,line._vy,true,isInfinite);},getSide:function(point,isInfinite){return Line.getSide(this._px,this._py,this._vx,this._vy,point.x,point.y,true,isInfinite);},getDistance:function(point){return Math.abs(this.getSignedDistance(point));},getSignedDistance:function(point){return Line.getSignedDistance(this._px,this._py,this._vx,this._vy,point.x,point.y,true);},isCollinear:function(line){return Point.isCollinear(this._vx,this._vy,line._vx,line._vy);},isOrthogonal:function(line){return Point.isOrthogonal(this._vx,this._vy,line._vx,line._vy);},statics:{intersect:function(p1x,p1y,v1x,v1y,p2x,p2y,v2x,v2y,asVector,isInfinite){if(!asVector){v1x-=p1x;v1y-=p1y;v2x-=p2x;v2y-=p2y;}
var cross=v1x*v2y-v1y*v2x;if(!Numerical.isMachineZero(cross)){var dx=p1x-p2x,dy=p1y-p2y,u1=(v2x*dy-v2y*dx)/ cross,u2=(v1x*dy-v1y*dx)/ cross,epsilon=1e-12,uMin=-epsilon,uMax=1+epsilon;if(isInfinite||uMin<u1&&u1<uMax&&uMin<u2&&u2<uMax){if(!isInfinite){u1=u1<=0?0:u1>=1?1:u1;}
return new Point(p1x+u1*v1x,p1y+u1*v1y);}}},getSide:function(px,py,vx,vy,x,y,asVector,isInfinite){if(!asVector){vx-=px;vy-=py;}
var v2x=x-px,v2y=y-py,ccw=v2x*vy-v2y*vx;if(!isInfinite&&Numerical.isMachineZero(ccw)){ccw=(v2x*vx+v2x*vx)/(vx*vx+vy*vy);if(ccw>=0&&ccw<=1)
ccw=0;}
return ccw<0?-1:ccw>0?1:0;},getSignedDistance:function(px,py,vx,vy,x,y,asVector){if(!asVector){vx-=px;vy-=py;}
return vx===0?(vy>0?x-px:px-x):vy===0?(vx<0?y-py:py-y):((x-px)*vy-(y-py)*vx)/(vy>vx?vy*Math.sqrt(1+(vx*vx)/(vy*vy)):vx*Math.sqrt(1+(vy*vy)/(vx*vx)));},getDistance:function(px,py,vx,vy,x,y,asVector){return Math.abs(Line.getSignedDistance(px,py,vx,vy,x,y,asVector));}}});var Project=PaperScopeItem.extend({_class:'Project',_list:'projects',_reference:'project',_compactSerialize:true,initialize:function Project(element){PaperScopeItem.call(this,true);this._children=[];this._namedChildren={};this._activeLayer=null;this._currentStyle=new Style(null,null,this);this._view=View.create(this,element||CanvasProvider.getCanvas(1,1));this._selectionItems={};this._selectionCount=0;this._updateVersion=0;},_serialize:function(options,dictionary){return Base.serialize(this._children,options,true,dictionary);},_changed:function(flags,item){if(flags&1){var view=this._view;if(view){view._needsUpdate=true;if(!view._requested&&view._autoUpdate)
view.requestUpdate();}}
var changes=this._changes;if(changes&&item){var changesById=this._changesById,id=item._id,entry=changesById[id];if(entry){entry.flags|=flags;}else{changes.push(changesById[id]={item:item,flags:flags});}}},clear:function(){var children=this._children;for(var i=children.length-1;i>=0;i--)
children[i].remove();},isEmpty:function(){return!this._children.length;},remove:function remove(){if(!remove.base.call(this))
return false;if(this._view)
this._view.remove();return true;},getView:function(){return this._view;},getCurrentStyle:function(){return this._currentStyle;},setCurrentStyle:function(style){this._currentStyle.set(style);},getIndex:function(){return this._index;},getOptions:function(){return this._scope.settings;},getLayers:function(){return this._children;},getActiveLayer:function(){return this._activeLayer||new Layer({project:this,insert:true});},getSymbolDefinitions:function(){var definitions=[],ids={};this.getItems({class:SymbolItem,match:function(item){var definition=item._definition,id=definition._id;if(!ids[id]){ids[id]=true;definitions.push(definition);}
return false;}});return definitions;},getSymbols:'getSymbolDefinitions',getSelectedItems:function(){var selectionItems=this._selectionItems,items=[];for(var id in selectionItems){var item=selectionItems[id],selection=item._selection;if((selection&1)&&item.isInserted()){items.push(item);}else if(!selection){this._updateSelection(item);}}
return items;},_updateSelection:function(item){var id=item._id,selectionItems=this._selectionItems;if(item._selection){if(selectionItems[id]!==item){this._selectionCount++;selectionItems[id]=item;}}else if(selectionItems[id]===item){this._selectionCount--;delete selectionItems[id];}},selectAll:function(){var children=this._children;for(var i=0,l=children.length;i<l;i++)
children[i].setFullySelected(true);},deselectAll:function(){var selectionItems=this._selectionItems;for(var i in selectionItems)
selectionItems[i].setFullySelected(false);},addLayer:function(layer){return this.insertLayer(undefined,layer);},insertLayer:function(index,layer){if(layer instanceof Layer){layer._remove(false,true);Base.splice(this._children,[layer],index,0);layer._setProject(this,true);var name=layer._name;if(name)
layer.setName(name);if(this._changes)
layer._changed(5);if(!this._activeLayer)
this._activeLayer=layer;}else{layer=null;}
return layer;},_insertItem:function(index,item,_created){item=this.insertLayer(index,item)||(this._activeLayer||this._insertItem(undefined,new Layer(Item.NO_INSERT),true)).insertChild(index,item);if(_created&&item.activate)
item.activate();return item;},getItems:function(options){return Item._getItems(this,options);},getItem:function(options){return Item._getItems(this,options,null,null,true)[0]||null;},importJSON:function(json){this.activate();var layer=this._activeLayer;return Base.importJSON(json,layer&&layer.isEmpty()&&layer);},removeOn:function(type){var sets=this._removeSets;if(sets){if(type==='mouseup')
sets.mousedrag=null;var set=sets[type];if(set){for(var id in set){var item=set[id];for(var key in sets){var other=sets[key];if(other&&other!=set)
delete other[item._id];}
item.remove();}
sets[type]=null;}}},draw:function(ctx,matrix,pixelRatio){this._updateVersion++;ctx.save();matrix.applyToContext(ctx);var children=this._children,param=new Base({offset:new Point(0,0),pixelRatio:pixelRatio,viewMatrix:matrix.isIdentity()?null:matrix,matrices:[new Matrix()],updateMatrix:true});for(var i=0,l=children.length;i<l;i++){children[i].draw(ctx,param);}
ctx.restore();if(this._selectionCount>0){ctx.save();ctx.strokeWidth=1;var items=this._selectionItems,size=this._scope.settings.handleSize,version=this._updateVersion;for(var id in items){items[id]._drawSelection(ctx,matrix,size,items,version);}
ctx.restore();}}});var Item=Base.extend(Emitter,{statics:{extend:function extend(src){if(src._serializeFields)
src._serializeFields=Base.set({},this.prototype._serializeFields,src._serializeFields);return extend.base.apply(this,arguments);},NO_INSERT:{insert:false}},_class:'Item',_name:null,_applyMatrix:true,_canApplyMatrix:true,_canScaleStroke:false,_pivot:null,_visible:true,_blendMode:'normal',_opacity:1,_locked:false,_guide:false,_clipMask:false,_selection:0,_selectBounds:true,_selectChildren:false,_serializeFields:{name:null,applyMatrix:null,matrix:new Matrix(),pivot:null,visible:true,blendMode:'normal',opacity:1,locked:false,guide:false,clipMask:false,selected:false,data:{}},_prioritize:['applyMatrix']},new function(){var handlers=['onMouseDown','onMouseUp','onMouseDrag','onClick','onDoubleClick','onMouseMove','onMouseEnter','onMouseLeave'];return Base.each(handlers,function(name){this._events[name]={install:function(type){this.getView()._countItemEvent(type,1);},uninstall:function(type){this.getView()._countItemEvent(type,-1);}};},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,true);},uninstall:function(){this.getView()._animateItem(this,false);}},onLoad:{},onError:{}},statics:{_itemHandlers:handlers}});},{initialize:function Item(){},_initialize:function(props,point){var hasProps=props&&Base.isPlainObject(props),internal=hasProps&&props.internal===true,matrix=this._matrix=new Matrix(),project=hasProps&&props.project||paper.project,settings=paper.settings;this._id=internal?null:UID.get();this._parent=this._index=null;this._applyMatrix=this._canApplyMatrix&&settings.applyMatrix;if(point)
matrix.translate(point);matrix._owner=this;this._style=new Style(project._currentStyle,this,project);if(internal||hasProps&&props.insert==false||!settings.insertItems&&!(hasProps&&props.insert===true)){this._setProject(project);}else{(hasProps&&props.parent||project)._insertItem(undefined,this,true);}
if(hasProps&&props!==Item.NO_INSERT){this.set(props,{internal:true,insert:true,project:true,parent:true});}
return hasProps;},_serialize:function(options,dictionary){var props={},that=this;function serialize(fields){for(var key in fields){var value=that[key];if(!Base.equals(value,key==='leading'?fields.fontSize*1.2:fields[key])){props[key]=Base.serialize(value,options,key!=='data',dictionary);}}}
serialize(this._serializeFields);if(!(this instanceof Group))
serialize(this._style._defaults);return[this._class,props];},_changed:function(flags){var symbol=this._symbol,cacheParent=this._parent||symbol,project=this._project;if(flags&8){this._bounds=this._position=this._decomposed=undefined;}
if(flags&16){this._globalMatrix=undefined;}
if(cacheParent&&(flags&72)){Item._clearBoundsCache(cacheParent);}
if(flags&2){Item._clearBoundsCache(this);}
if(project)
project._changed(flags,this);if(symbol)
symbol._changed(flags);},getId:function(){return this._id;},getName:function(){return this._name;},setName:function(name){if(this._name)
this._removeNamed();if(name===(+name)+'')
throw new Error('Names consisting only of numbers are not supported.');var owner=this._getOwner();if(name&&owner){var children=owner._children,namedChildren=owner._namedChildren;(namedChildren[name]=namedChildren[name]||[]).push(this);if(!(name in children))
children[name]=this;}
this._name=name||undefined;this._changed(256);},getStyle:function(){return this._style;},setStyle:function(style){this.getStyle().set(style);}},Base.each(['locked','visible','blendMode','opacity','guide'],function(name){var part=Base.capitalize(name),key='_'+name,flags={locked:256,visible:265};this['get'+part]=function(){return this[key];};this['set'+part]=function(value){if(value!=this[key]){this[key]=value;this._changed(flags[name]||257);}};},{}),{beans:true,getSelection:function(){return this._selection;},setSelection:function(selection){if(selection!==this._selection){this._selection=selection;var project=this._project;if(project){project._updateSelection(this);this._changed(257);}}},_changeSelection:function(flag,selected){var selection=this._selection;this.setSelection(selected?selection|flag:selection&~flag);},isSelected:function(){if(this._selectChildren){var children=this._children;for(var i=0,l=children.length;i<l;i++)
if(children[i].isSelected())
return true;}
return!!(this._selection&1);},setSelected:function(selected){if(this._selectChildren){var children=this._children;for(var i=0,l=children.length;i<l;i++)
children[i].setSelected(selected);}
this._changeSelection(1,selected);},isFullySelected:function(){var children=this._children,selected=!!(this._selection&1);if(children&&selected){for(var i=0,l=children.length;i<l;i++)
if(!children[i].isFullySelected())
return false;return true;}
return selected;},setFullySelected:function(selected){var children=this._children;if(children){for(var i=0,l=children.length;i<l;i++)
children[i].setFullySelected(selected);}
this._changeSelection(1,selected);},isClipMask:function(){return this._clipMask;},setClipMask:function(clipMask){if(this._clipMask!=(clipMask=!!clipMask)){this._clipMask=clipMask;if(clipMask){this.setFillColor(null);this.setStrokeColor(null);}
this._changed(257);if(this._parent)
this._parent._changed(2048);}},getData:function(){if(!this._data)
this._data={};return this._data;},setData:function(data){this._data=data;},getPosition:function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;var position=this._position||(this._position=this._getPositionFromBounds());return new ctor(position.x,position.y,this,'setPosition');},setPosition:function(){this.translate(Point.read(arguments).subtract(this.getPosition(true)));},_getPositionFromBounds:function(bounds){return this._pivot?this._matrix._transformPoint(this._pivot):(bounds||this.getBounds()).getCenter(true);},getPivot:function(){var pivot=this._pivot;return pivot?new LinkedPoint(pivot.x,pivot.y,this,'setPivot'):null;},setPivot:function(){this._pivot=Point.read(arguments,0,{clone:true,readNull:true});this._position=undefined;}},Base.each({getStrokeBounds:{stroke:true},getHandleBounds:{handle:true},getInternalBounds:{internal:true}},function(options,key){this[key]=function(matrix){return this.getBounds(matrix,options);};},{beans:true,getBounds:function(matrix,options){var hasMatrix=options||matrix instanceof Matrix,opts=Base.set({},hasMatrix?options:matrix,this._boundsOptions);if(!opts.stroke||this.getStrokeScaling())
opts.cacheItem=this;var rect=this._getCachedBounds(hasMatrix&&matrix,opts).rect;return!arguments.length?new LinkedRectangle(rect.x,rect.y,rect.width,rect.height,this,'setBounds'):rect;},setBounds:function(){var rect=Rectangle.read(arguments),bounds=this.getBounds(),_matrix=this._matrix,matrix=new Matrix(),center=rect.getCenter();matrix.translate(center);if(rect.width!=bounds.width||rect.height!=bounds.height){if(!_matrix.isInvertible()){_matrix.set(_matrix._backup||new Matrix().translate(_matrix.getTranslation()));bounds=this.getBounds();}
matrix.scale(bounds.width!==0?rect.width / bounds.width:0,bounds.height!==0?rect.height / bounds.height:0);}
center=bounds.getCenter();matrix.translate(-center.x,-center.y);this.transform(matrix);},_getBounds:function(matrix,options){var children=this._children;if(!children||!children.length)
return new Rectangle();Item._updateBoundsCache(this,options.cacheItem);return Item._getBounds(children,matrix,options);},_getBoundsCacheKey:function(options,internal){return[options.stroke?1:0,options.handle?1:0,internal?1:0].join('');},_getCachedBounds:function(matrix,options,noInternal){matrix=matrix&&matrix._orNullIfIdentity();var internal=options.internal&&!noInternal,cacheItem=options.cacheItem,_matrix=internal?null:this._matrix._orNullIfIdentity(),cacheKey=cacheItem&&(!matrix||matrix.equals(_matrix))&&this._getBoundsCacheKey(options,internal),bounds=this._bounds;Item._updateBoundsCache(this._parent||this._symbol,cacheItem);if(cacheKey&&bounds&&cacheKey in bounds){var cached=bounds[cacheKey];return{rect:cached.rect.clone(),nonscaling:cached.nonscaling};}
var res=this._getBounds(matrix||_matrix,options),rect=res.rect||res,style=this._style,nonscaling=res.nonscaling||style.hasStroke()&&!style.getStrokeScaling();if(cacheKey){if(!bounds){this._bounds=bounds={};}
var cached=bounds[cacheKey]={rect:rect.clone(),nonscaling:nonscaling,internal:internal};}
return{rect:rect,nonscaling:nonscaling};},_getStrokeMatrix:function(matrix,options){var parent=this.getStrokeScaling()?null:options&&options.internal?this:this._parent||this._symbol&&this._symbol._item,mx=parent?parent.getViewMatrix().invert():matrix;return mx&&mx._shiftless();},statics:{_updateBoundsCache:function(parent,item){if(parent&&item){var id=item._id,ref=parent._boundsCache=parent._boundsCache||{ids:{},list:[]};if(!ref.ids[id]){ref.list.push(item);ref.ids[id]=item;}}},_clearBoundsCache:function(item){var cache=item._boundsCache;if(cache){item._bounds=item._position=item._boundsCache=undefined;for(var i=0,list=cache.list,l=list.length;i<l;i++){var other=list[i];if(other!==item){other._bounds=other._position=undefined;if(other._boundsCache)
Item._clearBoundsCache(other);}}}},_getBounds:function(items,matrix,options){var x1=Infinity,x2=-x1,y1=x1,y2=x2,nonscaling=false;options=options||{};for(var i=0,l=items.length;i<l;i++){var item=items[i];if(item._visible&&!item.isEmpty(true)){var bounds=item._getCachedBounds(matrix&&matrix.appended(item._matrix),options,true),rect=bounds.rect;x1=Math.min(rect.x,x1);y1=Math.min(rect.y,y1);x2=Math.max(rect.x+rect.width,x2);y2=Math.max(rect.y+rect.height,y2);if(bounds.nonscaling)
nonscaling=true;}}
return{rect:isFinite(x1)?new Rectangle(x1,y1,x2-x1,y2-y1):new Rectangle(),nonscaling:nonscaling};}}}),{beans:true,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose());},getRotation:function(){var decomposed=this._decompose();return decomposed?decomposed.rotation:0;},setRotation:function(rotation){var current=this.getRotation();if(current!=null&&rotation!=null){var decomposed=this._decomposed;this.rotate(rotation-current);if(decomposed){decomposed.rotation=rotation;this._decomposed=decomposed;}}},getScaling:function(){var decomposed=this._decompose(),s=decomposed&&decomposed.scaling;return new LinkedPoint(s?s.x:1,s?s.y:1,this,'setScaling');},setScaling:function(){var current=this.getScaling(),scaling=Point.read(arguments,0,{clone:true,readNull:true});if(current&&scaling&&!current.equals(scaling)){var rotation=this.getRotation(),decomposed=this._decomposed,matrix=new Matrix(),isZero=Numerical.isZero;if(isZero(current.x)||isZero(current.y)){matrix.translate(decomposed.translation);if(rotation){matrix.rotate(rotation);}
matrix.scale(scaling.x,scaling.y);this._matrix.set(matrix);}else{var center=this.getPosition(true);matrix.translate(center);if(rotation)
matrix.rotate(rotation);matrix.scale(scaling.x / current.x,scaling.y / current.y);if(rotation)
matrix.rotate(-rotation);matrix.translate(center.negate());this.transform(matrix);}
if(decomposed){decomposed.scaling=scaling;this._decomposed=decomposed;}}},getMatrix:function(){return this._matrix;},setMatrix:function(){var matrix=this._matrix;matrix.set.apply(matrix,arguments);},getGlobalMatrix:function(_dontClone){var matrix=this._globalMatrix;if(matrix){var parent=this._parent;var parents=[];while(parent){if(!parent._globalMatrix){matrix=null;for(var i=0,l=parents.length;i<l;i++){parents[i]._globalMatrix=null;}
break;}
parents.push(parent);parent=parent._parent;}}
if(!matrix){matrix=this._globalMatrix=this._matrix.clone();var parent=this._parent;if(parent)
matrix.prepend(parent.getGlobalMatrix(true));}
return _dontClone?matrix:matrix.clone();},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix);},getApplyMatrix:function(){return this._applyMatrix;},setApplyMatrix:function(apply){if(this._applyMatrix=this._canApplyMatrix&&!!apply)
this.transform(null,true);},getTransformContent:'#getApplyMatrix',setTransformContent:'#setApplyMatrix',},{getProject:function(){return this._project;},_setProject:function(project,installEvents){if(this._project!==project){if(this._project)
this._installEvents(false);this._project=project;var children=this._children;for(var i=0,l=children&&children.length;i<l;i++)
children[i]._setProject(project);installEvents=true;}
if(installEvents)
this._installEvents(true);},getView:function(){return this._project._view;},_installEvents:function _installEvents(install){_installEvents.base.call(this,install);var children=this._children;for(var i=0,l=children&&children.length;i<l;i++)
children[i]._installEvents(install);},getLayer:function(){var parent=this;while(parent=parent._parent){if(parent instanceof Layer)
return parent;}
return null;},getParent:function(){return this._parent;},setParent:function(item){return item.addChild(this);},_getOwner:'#getParent',getChildren:function(){return this._children;},setChildren:function(items){this.removeChildren();this.addChildren(items);},getFirstChild:function(){return this._children&&this._children[0]||null;},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null;},getNextSibling:function(){var owner=this._getOwner();return owner&&owner._children[this._index+1]||null;},getPreviousSibling:function(){var owner=this._getOwner();return owner&&owner._children[this._index-1]||null;},getIndex:function(){return this._index;},equals:function(item){return item===this||item&&this._class===item._class&&this._style.equals(item._style)&&this._matrix.equals(item._matrix)&&this._locked===item._locked&&this._visible===item._visible&&this._blendMode===item._blendMode&&this._opacity===item._opacity&&this._clipMask===item._clipMask&&this._guide===item._guide&&this._equals(item)||false;},_equals:function(item){return Base.equals(this._children,item._children);},clone:function(options){var copy=new this.constructor(Item.NO_INSERT),children=this._children,insert=Base.pick(options?options.insert:undefined,options===undefined||options===true),deep=Base.pick(options?options.deep:undefined,true);if(children)
copy.copyAttributes(this);if(!children||deep)
copy.copyContent(this);if(!children)
copy.copyAttributes(this);if(insert)
copy.insertAbove(this);var name=this._name,parent=this._parent;if(name&&parent){var children=parent._children,orig=name,i=1;while(children[name])
name=orig+' '+(i++);if(name!==orig)
copy.setName(name);}
return copy;},copyContent:function(source){var children=source._children;for(var i=0,l=children&&children.length;i<l;i++){this.addChild(children[i].clone(false),true);}},copyAttributes:function(source,excludeMatrix){this.setStyle(source._style);var keys=['_locked','_visible','_blendMode','_opacity','_clipMask','_guide'];for(var i=0,l=keys.length;i<l;i++){var key=keys[i];if(source.hasOwnProperty(key))
this[key]=source[key];}
if(!excludeMatrix)
this._matrix.set(source._matrix,true);this.setApplyMatrix(source._applyMatrix);this.setPivot(source._pivot);this.setSelection(source._selection);var data=source._data,name=source._name;this._data=data?Base.clone(data):null;if(name)
this.setName(name);},rasterize:function(arg0,arg1){var resolution,insert,raster;if(Base.isPlainObject(arg0)){resolution=arg0.resolution;insert=arg0.insert;raster=arg0.raster;}else{resolution=arg0;insert=arg1;}
if(raster){raster.matrix.reset(true);}else{raster=new Raster(Item.NO_INSERT);}
var bounds=this.getStrokeBounds(),scale=(resolution||this.getView().getResolution())/ 72,topLeft=bounds.getTopLeft().floor(),bottomRight=bounds.getBottomRight().ceil(),boundsSize=new Size(bottomRight.subtract(topLeft)),rasterSize=boundsSize.multiply(scale);raster.setSize(rasterSize,true);if(!rasterSize.isZero()){var ctx=raster.getContext(true),matrix=new Matrix().scale(scale).translate(topLeft.negate());ctx.save();matrix.applyToContext(ctx);this.draw(ctx,new Base({matrices:[matrix]}));ctx.restore();}
raster.transform(new Matrix().translate(topLeft.add(boundsSize.divide(2))).scale(1 / scale));if(insert===undefined||insert){raster.insertAbove(this);}
return raster;},contains:function(){var matrix=this._matrix;return(matrix.isInvertible()&&!!this._contains(matrix._inverseTransform(Point.read(arguments))));},_contains:function(point){var children=this._children;if(children){for(var i=children.length-1;i>=0;i--){if(children[i].contains(point))
return true;}
return false;}
return point.isInside(this.getInternalBounds());},isInside:function(){return Rectangle.read(arguments).contains(this.getBounds());},_asPathItem:function(){return new Path.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:false,});},intersects:function(item,_matrix){if(!(item instanceof Item))
return false;return this._asPathItem().getIntersections(item._asPathItem(),null,_matrix,true).length>0;}},new function(){function hitTest(){var args=arguments;return this._hitTest(Point.read(args),HitResult.getOptions(args));}
function hitTestAll(){var args=arguments,point=Point.read(args),options=HitResult.getOptions(args),all=[];this._hitTest(point,new Base({all:all},options));return all;}
function hitTestChildren(point,options,viewMatrix,_exclude){var children=this._children;if(children){for(var i=children.length-1;i>=0;i--){var child=children[i];var res=child!==_exclude&&child._hitTest(point,options,viewMatrix);if(res&&!options.all)
return res;}}
return null;}
Project.inject({hitTest:hitTest,hitTestAll:hitTestAll,_hitTest:hitTestChildren});return{hitTest:hitTest,hitTestAll:hitTestAll,_hitTestChildren:hitTestChildren,};},{_hitTest:function(point,options,parentViewMatrix){if(this._locked||!this._visible||this._guide&&!options.guides||this.isEmpty()){return null;}
var matrix=this._matrix,viewMatrix=parentViewMatrix?parentViewMatrix.appended(matrix):this.getGlobalMatrix().prepend(this.getView()._matrix),tolerance=Math.max(options.tolerance,1e-12),tolerancePadding=options._tolerancePadding=new Size(Path._getStrokePadding(tolerance,matrix._shiftless().invert()));point=matrix._inverseTransform(point);if(!point||!this._children&&!this.getBounds({internal:true,stroke:true,handle:true}).expand(tolerancePadding.multiply(2))._containsPoint(point)){return null;}
var checkSelf=!(options.guides&&!this._guide||options.selected&&!this.isSelected()||options.type&&options.type!==Base.hyphenate(this._class)||options.class&&!(this instanceof options.class)),match=options.match,that=this,bounds,res;function filter(hit){if(hit&&match&&!match(hit))
hit=null;if(hit&&options.all)
options.all.push(hit);return hit;}
function checkPoint(type,part){var pt=part?bounds['get'+part]():that.getPosition();if(point.subtract(pt).divide(tolerancePadding).length<=1){return new HitResult(type,that,{name:part?Base.hyphenate(part):type,point:pt});}}
var checkPosition=options.position,checkCenter=options.center,checkBounds=options.bounds;if(checkSelf&&this._parent&&(checkPosition||checkCenter||checkBounds)){if(checkCenter||checkBounds){bounds=this.getInternalBounds();}
res=checkPosition&&checkPoint('position')||checkCenter&&checkPoint('center','Center');if(!res&&checkBounds){var points=['TopLeft','TopRight','BottomLeft','BottomRight','LeftCenter','TopCenter','RightCenter','BottomCenter'];for(var i=0;i<8&&!res;i++){res=checkPoint('bounds',points[i]);}}
res=filter(res);}
if(!res){res=this._hitTestChildren(point,options,viewMatrix)||checkSelf&&filter(this._hitTestSelf(point,options,viewMatrix,this.getStrokeScaling()?null:viewMatrix._shiftless().invert()))||null;}
if(res&&res.point){res.point=matrix.transform(res.point);}
return res;},_hitTestSelf:function(point,options){if(options.fill&&this.hasFill()&&this._contains(point))
return new HitResult('fill',this);},matches:function(name,compare){function matchObject(obj1,obj2){for(var i in obj1){if(obj1.hasOwnProperty(i)){var val1=obj1[i],val2=obj2[i];if(Base.isPlainObject(val1)&&Base.isPlainObject(val2)){if(!matchObject(val1,val2))
return false;}else if(!Base.equals(val1,val2)){return false;}}}
return true;}
var type=typeof name;if(type==='object'){for(var key in name){if(name.hasOwnProperty(key)&&!this.matches(key,name[key]))
return false;}
return true;}else if(type==='function'){return name(this);}else if(name==='match'){return compare(this);}else{var value=/^(empty|editable)$/.test(name)?this['is'+Base.capitalize(name)]():name==='type'?Base.hyphenate(this._class):this[name];if(name==='class'){if(typeof compare==='function')
return this instanceof compare;value=this._class;}
if(typeof compare==='function'){return!!compare(value);}else if(compare){if(compare.test){return compare.test(value);}else if(Base.isPlainObject(compare)){return matchObject(compare,value);}}
return Base.equals(value,compare);}},getItems:function(options){return Item._getItems(this,options,this._matrix);},getItem:function(options){return Item._getItems(this,options,this._matrix,null,true)[0]||null;},statics:{_getItems:function _getItems(item,options,matrix,param,firstOnly){if(!param){var obj=typeof options==='object'&&options,overlapping=obj&&obj.overlapping,inside=obj&&obj.inside,bounds=overlapping||inside,rect=bounds&&Rectangle.read([bounds]);param={items:[],recursive:obj&&obj.recursive!==false,inside:!!inside,overlapping:!!overlapping,rect:rect,path:overlapping&&new Path.Rectangle({rectangle:rect,insert:false})};if(obj){options=Base.filter({},options,{recursive:true,inside:true,overlapping:true});}}
var children=item._children,items=param.items,rect=param.rect;matrix=rect&&(matrix||new Matrix());for(var i=0,l=children&&children.length;i<l;i++){var child=children[i],childMatrix=matrix&&matrix.appended(child._matrix),add=true;if(rect){var bounds=child.getBounds(childMatrix);if(!rect.intersects(bounds))
continue;if(!(rect.contains(bounds)||param.overlapping&&(bounds.contains(rect)||param.path.intersects(child,childMatrix))))
add=false;}
if(add&&child.matches(options)){items.push(child);if(firstOnly)
break;}
if(param.recursive!==false){_getItems(child,options,childMatrix,param,firstOnly);}
if(firstOnly&&items.length>0)
break;}
return items;}}},{importJSON:function(json){var res=Base.importJSON(json,this);return res!==this?this.addChild(res):res;},addChild:function(item){return this.insertChild(undefined,item);},insertChild:function(index,item){var res=item?this.insertChildren(index,[item]):null;return res&&res[0];},addChildren:function(items){return this.insertChildren(this._children.length,items);},insertChildren:function(index,items){var children=this._children;if(children&&items&&items.length>0){items=Base.slice(items);var inserted={};for(var i=items.length-1;i>=0;i--){var item=items[i],id=item&&item._id;if(!item||inserted[id]){items.splice(i,1);}else{item._remove(false,true);inserted[id]=true;}}
Base.splice(children,items,index,0);var project=this._project,notifySelf=project._changes;for(var i=0,l=items.length;i<l;i++){var item=items[i],name=item._name;item._parent=this;item._setProject(project,true);if(name)
item.setName(name);if(notifySelf)
item._changed(5);}
this._changed(11);}else{items=null;}
return items;},_insertItem:'#insertChild',_insertAt:function(item,offset){var owner=item&&item._getOwner(),res=item!==this&&owner?this:null;if(res){res._remove(false,true);owner._insertItem(item._index+offset,res);}
return res;},insertAbove:function(item){return this._insertAt(item,1);},insertBelow:function(item){return this._insertAt(item,0);},sendToBack:function(){var owner=this._getOwner();return owner?owner._insertItem(0,this):null;},bringToFront:function(){var owner=this._getOwner();return owner?owner._insertItem(undefined,this):null;},appendTop:'#addChild',appendBottom:function(item){return this.insertChild(0,item);},moveAbove:'#insertAbove',moveBelow:'#insertBelow',addTo:function(owner){return owner._insertItem(undefined,this);},copyTo:function(owner){return this.clone(false).addTo(owner);},reduce:function(options){var children=this._children;if(children&&children.length===1){var child=children[0].reduce(options);if(this._parent){child.insertAbove(this);this.remove();}else{child.remove();}
return child;}
return this;},_removeNamed:function(){var owner=this._getOwner();if(owner){var children=owner._children,namedChildren=owner._namedChildren,name=this._name,namedArray=namedChildren[name],index=namedArray?namedArray.indexOf(this):-1;if(index!==-1){if(children[name]==this)
delete children[name];namedArray.splice(index,1);if(namedArray.length){children[name]=namedArray[0];}else{delete namedChildren[name];}}}},_remove:function(notifySelf,notifyParent){var owner=this._getOwner(),project=this._project,index=this._index;if(this._style)
this._style._dispose();if(owner){if(this._name)
this._removeNamed();if(index!=null){if(project._activeLayer===this)
project._activeLayer=this.getNextSibling()||this.getPreviousSibling();Base.splice(owner._children,null,index,1);}
this._installEvents(false);if(notifySelf&&project._changes)
this._changed(5);if(notifyParent)
owner._changed(11,this);this._parent=null;return true;}
return false;},remove:function(){return this._remove(true,true);},replaceWith:function(item){var ok=item&&item.insertBelow(this);if(ok)
this.remove();return ok;},removeChildren:function(start,end){if(!this._children)
return null;start=start||0;end=Base.pick(end,this._children.length);var removed=Base.splice(this._children,null,start,end-start);for(var i=removed.length-1;i>=0;i--){removed[i]._remove(true,false);}
if(removed.length>0)
this._changed(11);return removed;},clear:'#removeChildren',reverseChildren:function(){if(this._children){this._children.reverse();for(var i=0,l=this._children.length;i<l;i++)
this._children[i]._index=i;this._changed(11);}},isEmpty:function(recursively){var children=this._children;var numChildren=children?children.length:0;if(recursively){for(var i=0;i<numChildren;i++){if(!children[i].isEmpty(recursively)){return false;}}
return true;}
return!numChildren;},isEditable:function(){var item=this;while(item){if(!item._visible||item._locked)
return false;item=item._parent;}
return true;},hasFill:function(){return this.getStyle().hasFill();},hasStroke:function(){return this.getStyle().hasStroke();},hasShadow:function(){return this.getStyle().hasShadow();},_getOrder:function(item){function getList(item){var list=[];do{list.unshift(item);}while(item=item._parent);return list;}
var list1=getList(this),list2=getList(item);for(var i=0,l=Math.min(list1.length,list2.length);i<l;i++){if(list1[i]!=list2[i]){return list1[i]._index<list2[i]._index?1:-1;}}
return 0;},hasChildren:function(){return this._children&&this._children.length>0;},isInserted:function(){return this._parent?this._parent.isInserted():false;},isAbove:function(item){return this._getOrder(item)===-1;},isBelow:function(item){return this._getOrder(item)===1;},isParent:function(item){return this._parent===item;},isChild:function(item){return item&&item._parent===this;},isDescendant:function(item){var parent=this;while(parent=parent._parent){if(parent===item)
return true;}
return false;},isAncestor:function(item){return item?item.isDescendant(this):false;},isSibling:function(item){return this._parent===item._parent;},isGroupedWith:function(item){var parent=this._parent;while(parent){if(parent._parent&&/^(Group|Layer|CompoundPath)$/.test(parent._class)&&item.isDescendant(parent))
return true;parent=parent._parent;}
return false;},},Base.each(['rotate','scale','shear','skew'],function(key){var rotate=key==='rotate';this[key]=function(){var args=arguments,value=(rotate?Base:Point).read(args),center=Point.read(args,0,{readNull:true});return this.transform(new Matrix()[key](value,center||this.getPosition(true)));};},{translate:function(){var mx=new Matrix();return this.transform(mx.translate.apply(mx,arguments));},transform:function(matrix,_applyRecursively,_setApplyMatrix){var _matrix=this._matrix,transformMatrix=matrix&&!matrix.isIdentity(),applyMatrix=(_setApplyMatrix&&this._canApplyMatrix||this._applyMatrix&&(transformMatrix||!_matrix.isIdentity()||_applyRecursively&&this._children));if(!transformMatrix&&!applyMatrix)
return this;if(transformMatrix){if(!matrix.isInvertible()&&_matrix.isInvertible())
_matrix._backup=_matrix.getValues();_matrix.prepend(matrix,true);var style=this._style,fillColor=style.getFillColor(true),strokeColor=style.getStrokeColor(true);if(fillColor)
fillColor.transform(matrix);if(strokeColor)
strokeColor.transform(matrix);}
if(applyMatrix&&(applyMatrix=this._transformContent(_matrix,_applyRecursively,_setApplyMatrix))){var pivot=this._pivot;if(pivot)
_matrix._transformPoint(pivot,pivot,true);_matrix.reset(true);if(_setApplyMatrix&&this._canApplyMatrix)
this._applyMatrix=true;}
var bounds=this._bounds,position=this._position;if(transformMatrix||applyMatrix){this._changed(25);}
var decomp=transformMatrix&&bounds&&matrix.decompose();if(decomp&&decomp.skewing.isZero()&&decomp.rotation%90===0){for(var key in bounds){var cache=bounds[key];if(cache.nonscaling){delete bounds[key];}else if(applyMatrix||!cache.internal){var rect=cache.rect;matrix._transformBounds(rect,rect);}}
this._bounds=bounds;var cached=bounds[this._getBoundsCacheKey(this._boundsOptions||{})];if(cached){this._position=this._getPositionFromBounds(cached.rect);}}else if(transformMatrix&&position&&this._pivot){this._position=matrix._transformPoint(position,position);}
return this;},_transformContent:function(matrix,applyRecursively,setApplyMatrix){var children=this._children;if(children){for(var i=0,l=children.length;i<l;i++){children[i].transform(matrix,applyRecursively,setApplyMatrix);}
return true;}},globalToLocal:function(){return this.getGlobalMatrix(true)._inverseTransform(Point.read(arguments));},localToGlobal:function(){return this.getGlobalMatrix(true)._transformPoint(Point.read(arguments));},parentToLocal:function(){return this._matrix._inverseTransform(Point.read(arguments));},localToParent:function(){return this._matrix._transformPoint(Point.read(arguments));},fitBounds:function(rectangle,fill){rectangle=Rectangle.read(arguments);var bounds=this.getBounds(),itemRatio=bounds.height / bounds.width,rectRatio=rectangle.height / rectangle.width,scale=(fill?itemRatio>rectRatio:itemRatio<rectRatio)?rectangle.width / bounds.width:rectangle.height / bounds.height,newBounds=new Rectangle(new Point(),new Size(bounds.width*scale,bounds.height*scale));newBounds.setCenter(rectangle.getCenter());this.setBounds(newBounds);}}),{_setStyles:function(ctx,param,viewMatrix){var style=this._style,matrix=this._matrix;if(style.hasFill()){ctx.fillStyle=style.getFillColor().toCanvasStyle(ctx,matrix);}
if(style.hasStroke()){ctx.strokeStyle=style.getStrokeColor().toCanvasStyle(ctx,matrix);ctx.lineWidth=style.getStrokeWidth();var strokeJoin=style.getStrokeJoin(),strokeCap=style.getStrokeCap(),miterLimit=style.getMiterLimit();if(strokeJoin)
ctx.lineJoin=strokeJoin;if(strokeCap)
ctx.lineCap=strokeCap;if(miterLimit)
ctx.miterLimit=miterLimit;if(paper.support.nativeDash){var dashArray=style.getDashArray(),dashOffset=style.getDashOffset();if(dashArray&&dashArray.length){if('setLineDash'in ctx){ctx.setLineDash(dashArray);ctx.lineDashOffset=dashOffset;}else{ctx.mozDash=dashArray;ctx.mozDashOffset=dashOffset;}}}}
if(style.hasShadow()){var pixelRatio=param.pixelRatio||1,mx=viewMatrix._shiftless().prepend(new Matrix().scale(pixelRatio,pixelRatio)),blur=mx.transform(new Point(style.getShadowBlur(),0)),offset=mx.transform(this.getShadowOffset());ctx.shadowColor=style.getShadowColor().toCanvasStyle(ctx);ctx.shadowBlur=blur.getLength();ctx.shadowOffsetX=offset.x;ctx.shadowOffsetY=offset.y;}},draw:function(ctx,param,parentStrokeMatrix){var updateVersion=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)
return;var matrices=param.matrices,viewMatrix=param.viewMatrix,matrix=this._matrix,globalMatrix=matrices[matrices.length-1].appended(matrix);if(!globalMatrix.isInvertible())
return;viewMatrix=viewMatrix?viewMatrix.appended(globalMatrix):globalMatrix;matrices.push(globalMatrix);if(param.updateMatrix){this._globalMatrix=globalMatrix;}
var blendMode=this._blendMode,opacity=Numerical.clamp(this._opacity,0,1),normalBlend=blendMode==='normal',nativeBlend=BlendMode.nativeModes[blendMode],direct=normalBlend&&opacity===1||param.dontStart||param.clip||(nativeBlend||normalBlend&&opacity<1)&&this._canComposite(),pixelRatio=param.pixelRatio||1,mainCtx,itemOffset,prevOffset;if(!direct){var bounds=this.getStrokeBounds(viewMatrix);if(!bounds.width||!bounds.height){matrices.pop();return;}
prevOffset=param.offset;itemOffset=param.offset=bounds.getTopLeft().floor();mainCtx=ctx;ctx=CanvasProvider.getContext(bounds.getSize().ceil().add(1).multiply(pixelRatio));if(pixelRatio!==1)
ctx.scale(pixelRatio,pixelRatio);}
ctx.save();var strokeMatrix=parentStrokeMatrix?parentStrokeMatrix.appended(matrix):this._canScaleStroke&&!this.getStrokeScaling(true)&&viewMatrix,clip=!direct&&param.clipItem,transform=!strokeMatrix||clip;if(direct){ctx.globalAlpha=opacity;if(nativeBlend)
ctx.globalCompositeOperation=blendMode;}else if(transform){ctx.translate(-itemOffset.x,-itemOffset.y);}
if(transform){(direct?matrix:viewMatrix).applyToContext(ctx);}
if(clip){param.clipItem.draw(ctx,param.extend({clip:true}));}
if(strokeMatrix){ctx.setTransform(pixelRatio,0,0,pixelRatio,0,0);var offset=param.offset;if(offset)
ctx.translate(-offset.x,-offset.y);}
this._draw(ctx,param,viewMatrix,strokeMatrix);ctx.restore();matrices.pop();if(param.clip&&!param.dontFinish){ctx.clip(this.getFillRule());}
if(!direct){BlendMode.process(blendMode,ctx,mainCtx,opacity,itemOffset.subtract(prevOffset).multiply(pixelRatio));CanvasProvider.release(ctx);param.offset=prevOffset;}},_isUpdated:function(updateVersion){var parent=this._parent;if(parent instanceof CompoundPath)
return parent._isUpdated(updateVersion);var updated=this._updateVersion===updateVersion;if(!updated&&parent&&parent._visible&&parent._isUpdated(updateVersion)){this._updateVersion=updateVersion;updated=true;}
return updated;},_drawSelection:function(ctx,matrix,size,selectionItems,updateVersion){var selection=this._selection,itemSelected=selection&1,boundsSelected=selection&2||itemSelected&&this._selectBounds,positionSelected=selection&4;if(!this._drawSelected)
itemSelected=false;if((itemSelected||boundsSelected||positionSelected)&&this._isUpdated(updateVersion)){var layer,color=this.getSelectedColor(true)||(layer=this.getLayer())&&layer.getSelectedColor(true),mx=matrix.appended(this.getGlobalMatrix(true)),half=size / 2;ctx.strokeStyle=ctx.fillStyle=color?color.toCanvasStyle(ctx):'#009dec';if(itemSelected)
this._drawSelected(ctx,mx,selectionItems);if(positionSelected){var pos=this.getPosition(true),parent=this._parent,point=parent?parent.localToGlobal(pos):pos,x=point.x,y=point.y;ctx.beginPath();ctx.arc(x,y,half,0,Math.PI*2,true);ctx.stroke();var deltas=[[0,-1],[1,0],[0,1],[-1,0]],start=half,end=size+1;for(var i=0;i<4;i++){var delta=deltas[i],dx=delta[0],dy=delta[1];ctx.moveTo(x+dx*start,y+dy*start);ctx.lineTo(x+dx*end,y+dy*end);ctx.stroke();}}
if(boundsSelected){var coords=mx._transformCorners(this.getInternalBounds());ctx.beginPath();for(var i=0;i<8;i++){ctx[!i?'moveTo':'lineTo'](coords[i],coords[++i]);}
ctx.closePath();ctx.stroke();for(var i=0;i<8;i++){ctx.fillRect(coords[i]-half,coords[++i]-half,size,size);}}}},_canComposite:function(){return false;}},Base.each(['down','drag','up','move'],function(key){this['removeOn'+Base.capitalize(key)]=function(){var hash={};hash[key]=true;return this.removeOn(hash);};},{removeOn:function(obj){for(var name in obj){if(obj[name]){var key='mouse'+name,project=this._project,sets=project._removeSets=project._removeSets||{};sets[key]=sets[key]||{};sets[key][this._id]=this;}}
return this;}}),{tween:function(from,to,options){if(!options){options=to;to=from;from=null;if(!options){options=to;to=null;}}
var easing=options&&options.easing,start=options&&options.start,duration=options!=null&&(typeof options==='number'?options:options.duration),tween=new Tween(this,from,to,duration,easing,start);function onFrame(event){tween._handleFrame(event.time*1000);if(!tween.running){this.off('frame',onFrame);}}
if(duration){this.on('frame',onFrame);}
return tween;},tweenTo:function(to,options){return this.tween(null,to,options);},tweenFrom:function(from,options){return this.tween(from,null,options);}});var Group=Item.extend({_class:'Group',_selectBounds:false,_selectChildren:true,_serializeFields:{children:[]},initialize:function Group(arg){this._children=[];this._namedChildren={};if(!this._initialize(arg))
this.addChildren(Array.isArray(arg)?arg:arguments);},_changed:function _changed(flags){_changed.base.call(this,flags);if(flags&2050){this._clipItem=undefined;}},_getClipItem:function(){var clipItem=this._clipItem;if(clipItem===undefined){clipItem=null;var children=this._children;for(var i=0,l=children.length;i<l;i++){if(children[i]._clipMask){clipItem=children[i];break;}}
this._clipItem=clipItem;}
return clipItem;},isClipped:function(){return!!this._getClipItem();},setClipped:function(clipped){var child=this.getFirstChild();if(child)
child.setClipMask(clipped);},_getBounds:function _getBounds(matrix,options){var clipItem=this._getClipItem();return clipItem?clipItem._getCachedBounds(clipItem._matrix.prepended(matrix),Base.set({},options,{stroke:false})):_getBounds.base.call(this,matrix,options);},_hitTestChildren:function _hitTestChildren(point,options,viewMatrix){var clipItem=this._getClipItem();return(!clipItem||clipItem.contains(point))&&_hitTestChildren.base.call(this,point,options,viewMatrix,clipItem);},_draw:function(ctx,param){var clip=param.clip,clipItem=!clip&&this._getClipItem();param=param.extend({clipItem:clipItem,clip:false});if(clip){ctx.beginPath();param.dontStart=param.dontFinish=true;}else if(clipItem){clipItem.draw(ctx,param.extend({clip:true}));}
var children=this._children;for(var i=0,l=children.length;i<l;i++){var item=children[i];if(item!==clipItem)
item.draw(ctx,param);}}});var Layer=Group.extend({_class:'Layer',initialize:function Layer(){Group.apply(this,arguments);},_getOwner:function(){return this._parent||this._index!=null&&this._project;},isInserted:function isInserted(){return this._parent?isInserted.base.call(this):this._index!=null;},activate:function(){this._project._activeLayer=this;},_hitTestSelf:function(){}});var Shape=Item.extend({_class:'Shape',_applyMatrix:false,_canApplyMatrix:false,_canScaleStroke:true,_serializeFields:{type:null,size:null,radius:null},initialize:function Shape(props,point){this._initialize(props,point);},_equals:function(item){return this._type===item._type&&this._size.equals(item._size)&&Base.equals(this._radius,item._radius);},copyContent:function(source){this.setType(source._type);this.setSize(source._size);this.setRadius(source._radius);},getType:function(){return this._type;},setType:function(type){this._type=type;},getShape:'#getType',setShape:'#setType',getSize:function(){var size=this._size;return new LinkedSize(size.width,size.height,this,'setSize');},setSize:function(){var size=Size.read(arguments);if(!this._size){this._size=size.clone();}else if(!this._size.equals(size)){var type=this._type,width=size.width,height=size.height;if(type==='rectangle'){this._radius.set(Size.min(this._radius,size.divide(2).abs()));}else if(type==='circle'){width=height=(width+height)/ 2;this._radius=width / 2;}else if(type==='ellipse'){this._radius._set(width / 2,height / 2);}
this._size._set(width,height);this._changed(9);}},getRadius:function(){var rad=this._radius;return this._type==='circle'?rad:new LinkedSize(rad.width,rad.height,this,'setRadius');},setRadius:function(radius){var type=this._type;if(type==='circle'){if(radius===this._radius)
return;var size=radius*2;this._radius=radius;this._size._set(size,size);}else{radius=Size.read(arguments);if(!this._radius){this._radius=radius.clone();}else{if(this._radius.equals(radius))
return;this._radius.set(radius);if(type==='rectangle'){var size=Size.max(this._size,radius.multiply(2));this._size.set(size);}else if(type==='ellipse'){this._size._set(radius.width*2,radius.height*2);}}}
this._changed(9);},isEmpty:function(){return false;},toPath:function(insert){var path=new Path[Base.capitalize(this._type)]({center:new Point(),size:this._size,radius:this._radius,insert:false});path.copyAttributes(this);if(paper.settings.applyMatrix)
path.setApplyMatrix(true);if(insert===undefined||insert)
path.insertAbove(this);return path;},toShape:'#clone',_asPathItem:function(){return this.toPath(false);},_draw:function(ctx,param,viewMatrix,strokeMatrix){var style=this._style,hasFill=style.hasFill(),hasStroke=style.hasStroke(),dontPaint=param.dontFinish||param.clip,untransformed=!strokeMatrix;if(hasFill||hasStroke||dontPaint){var type=this._type,radius=this._radius,isCircle=type==='circle';if(!param.dontStart)
ctx.beginPath();if(untransformed&&isCircle){ctx.arc(0,0,radius,0,Math.PI*2,true);}else{var rx=isCircle?radius:radius.width,ry=isCircle?radius:radius.height,size=this._size,width=size.width,height=size.height;if(untransformed&&type==='rectangle'&&rx===0&&ry===0){ctx.rect(-width / 2,-height / 2,width,height);}else{var x=width / 2,y=height / 2,kappa=1-0.5522847498307936,cx=rx*kappa,cy=ry*kappa,c=[-x,-y+ry,-x,-y+cy,-x+cx,-y,-x+rx,-y,x-rx,-y,x-cx,-y,x,-y+cy,x,-y+ry,x,y-ry,x,y-cy,x-cx,y,x-rx,y,-x+rx,y,-x+cx,y,-x,y-cy,-x,y-ry];if(strokeMatrix)
strokeMatrix.transform(c,c,32);ctx.moveTo(c[0],c[1]);ctx.bezierCurveTo(c[2],c[3],c[4],c[5],c[6],c[7]);if(x!==rx)
ctx.lineTo(c[8],c[9]);ctx.bezierCurveTo(c[10],c[11],c[12],c[13],c[14],c[15]);if(y!==ry)
ctx.lineTo(c[16],c[17]);ctx.bezierCurveTo(c[18],c[19],c[20],c[21],c[22],c[23]);if(x!==rx)
ctx.lineTo(c[24],c[25]);ctx.bezierCurveTo(c[26],c[27],c[28],c[29],c[30],c[31]);}}
ctx.closePath();}
if(!dontPaint&&(hasFill||hasStroke)){this._setStyles(ctx,param,viewMatrix);if(hasFill){ctx.fill(style.getFillRule());ctx.shadowColor='rgba(0,0,0,0)';}
if(hasStroke)
ctx.stroke();}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke());},_getBounds:function(matrix,options){var rect=new Rectangle(this._size).setCenter(0,0),style=this._style,strokeWidth=options.stroke&&style.hasStroke()&&style.getStrokeWidth();if(matrix)
rect=matrix._transformBounds(rect);return strokeWidth?rect.expand(Path._getStrokePadding(strokeWidth,this._getStrokeMatrix(matrix,options))):rect;}},new function(){function getCornerCenter(that,point,expand){var radius=that._radius;if(!radius.isZero()){var halfSize=that._size.divide(2);for(var q=1;q<=4;q++){var dir=new Point(q>1&&q<4?-1:1,q>2?-1:1),corner=dir.multiply(halfSize),center=corner.subtract(dir.multiply(radius)),rect=new Rectangle(expand?corner.add(dir.multiply(expand)):corner,center);if(rect.contains(point))
return{point:center,quadrant:q};}}}
function isOnEllipseStroke(point,radius,padding,quadrant){var vector=point.divide(radius);return(!quadrant||vector.isInQuadrant(quadrant))&&vector.subtract(vector.normalize()).multiply(radius).divide(padding).length<=1;}
return{_contains:function _contains(point){if(this._type==='rectangle'){var center=getCornerCenter(this,point);return center?point.subtract(center.point).divide(this._radius).getLength()<=1:_contains.base.call(this,point);}else{return point.divide(this.size).getLength()<=0.5;}},_hitTestSelf:function _hitTestSelf(point,options,viewMatrix,strokeMatrix){var hit=false,style=this._style,hitStroke=options.stroke&&style.hasStroke(),hitFill=options.fill&&style.hasFill();if(hitStroke||hitFill){var type=this._type,radius=this._radius,strokeRadius=hitStroke?style.getStrokeWidth()/ 2:0,strokePadding=options._tolerancePadding.add(Path._getStrokePadding(strokeRadius,!style.getStrokeScaling()&&strokeMatrix));if(type==='rectangle'){var padding=strokePadding.multiply(2),center=getCornerCenter(this,point,padding);if(center){hit=isOnEllipseStroke(point.subtract(center.point),radius,strokePadding,center.quadrant);}else{var rect=new Rectangle(this._size).setCenter(0,0),outer=rect.expand(padding),inner=rect.expand(padding.negate());hit=outer._containsPoint(point)&&!inner._containsPoint(point);}}else{hit=isOnEllipseStroke(point,radius,strokePadding);}}
return hit?new HitResult(hitStroke?'stroke':'fill',this):_hitTestSelf.base.apply(this,arguments);}};},{statics:new function(){function createShape(type,point,size,radius,args){var item=Base.create(Shape.prototype);item._type=type;item._size=size;item._radius=radius;item._initialize(Base.getNamed(args),point);return item;}
return{Circle:function(){var args=arguments,center=Point.readNamed(args,'center'),radius=Base.readNamed(args,'radius');return createShape('circle',center,new Size(radius*2),radius,args);},Rectangle:function(){var args=arguments,rect=Rectangle.readNamed(args,'rectangle'),radius=Size.min(Size.readNamed(args,'radius'),rect.getSize(true).divide(2));return createShape('rectangle',rect.getCenter(true),rect.getSize(true),radius,args);},Ellipse:function(){var args=arguments,ellipse=Shape._readEllipse(args),radius=ellipse.radius;return createShape('ellipse',ellipse.center,radius.multiply(2),radius,args);},_readEllipse:function(args){var center,radius;if(Base.hasNamed(args,'radius')){center=Point.readNamed(args,'center');radius=Size.readNamed(args,'radius');}else{var rect=Rectangle.readNamed(args,'rectangle');center=rect.getCenter(true);radius=rect.getSize(true).divide(2);}
return{center:center,radius:radius};}};}});var Raster=Item.extend({_class:'Raster',_applyMatrix:false,_canApplyMatrix:false,_boundsOptions:{stroke:false,handle:false},_serializeFields:{crossOrigin:null,source:null},_prioritize:['crossOrigin'],_smoothing:'low',beans:true,initialize:function Raster(source,position){if(!this._initialize(source,position!==undefined&&Point.read(arguments))){var image,type=typeof source,object=type==='string'?document.getElementById(source):type==='object'?source:null;if(object&&object!==Item.NO_INSERT){if(object.getContext||object.naturalHeight!=null){image=object;}else if(object){var size=Size.read(arguments);if(!size.isZero()){image=CanvasProvider.getCanvas(size);}}}
if(image){this.setImage(image);}else{this.setSource(source);}}
if(!this._size){this._size=new Size();this._loaded=false;}},_equals:function(item){return this.getSource()===item.getSource();},copyContent:function(source){var image=source._image,canvas=source._canvas;if(image){this._setImage(image);}else if(canvas){var copyCanvas=CanvasProvider.getCanvas(source._size);copyCanvas.getContext('2d').drawImage(canvas,0,0);this._setImage(copyCanvas);}
this._crossOrigin=source._crossOrigin;},getSize:function(){var size=this._size;return new LinkedSize(size?size.width:0,size?size.height:0,this,'setSize');},setSize:function(_size,_clear){var size=Size.read(arguments);if(!size.equals(this._size)){if(size.width>0&&size.height>0){var element=!_clear&&this.getElement();this._setImage(CanvasProvider.getCanvas(size));if(element){this.getContext(true).drawImage(element,0,0,size.width,size.height);}}else{if(this._canvas)
CanvasProvider.release(this._canvas);this._size=size.clone();}}else if(_clear){this.clear();}},getWidth:function(){return this._size?this._size.width:0;},setWidth:function(width){this.setSize(width,this.getHeight());},getHeight:function(){return this._size?this._size.height:0;},setHeight:function(height){this.setSize(this.getWidth(),height);},getLoaded:function(){return this._loaded;},isEmpty:function(){var size=this._size;return!size||size.width===0&&size.height===0;},getResolution:function(){var matrix=this._matrix,orig=new Point(0,0).transform(matrix),u=new Point(1,0).transform(matrix).subtract(orig),v=new Point(0,1).transform(matrix).subtract(orig);return new Size(72 / u.getLength(),72 / v.getLength());},getPpi:'#getResolution',getImage:function(){return this._image;},setImage:function(image){var that=this;function emit(event){var view=that.getView(),type=event&&event.type||'load';if(view&&that.responds(type)){paper=view._scope;that.emit(type,new Event(event));}}
this._setImage(image);if(this._loaded){setTimeout(emit,0);}else if(image){DomEvent.add(image,{load:function(event){that._setImage(image);emit(event);},error:emit});}},_setImage:function(image){if(this._canvas)
CanvasProvider.release(this._canvas);if(image&&image.getContext){this._image=null;this._canvas=image;this._loaded=true;}else{this._image=image;this._canvas=null;this._loaded=!!(image&&image.src&&image.complete);}
this._size=new Size(image?image.naturalWidth||image.width:0,image?image.naturalHeight||image.height:0);this._context=null;this._changed(1033);},getCanvas:function(){if(!this._canvas){var ctx=CanvasProvider.getContext(this._size);try{if(this._image)
ctx.drawImage(this._image,0,0);this._canvas=ctx.canvas;}catch(e){CanvasProvider.release(ctx);}}
return this._canvas;},setCanvas:'#setImage',getContext:function(_change){if(!this._context)
this._context=this.getCanvas().getContext('2d');if(_change){this._image=null;this._changed(1025);}
return this._context;},setContext:function(context){this._context=context;},getSource:function(){var image=this._image;return image&&image.src||this.toDataURL();},setSource:function(src){var image=new self.Image(),crossOrigin=this._crossOrigin;if(crossOrigin)
image.crossOrigin=crossOrigin;if(src)
image.src=src;this.setImage(image);},getCrossOrigin:function(){var image=this._image;return image&&image.crossOrigin||this._crossOrigin||'';},setCrossOrigin:function(crossOrigin){this._crossOrigin=crossOrigin;var image=this._image;if(image)
image.crossOrigin=crossOrigin;},getSmoothing:function(){return this._smoothing;},setSmoothing:function(smoothing){this._smoothing=typeof smoothing==='string'?smoothing:smoothing?'low':'off';this._changed(257);},getElement:function(){return this._canvas||this._loaded&&this._image;}},{beans:false,getSubCanvas:function(){var rect=Rectangle.read(arguments),ctx=CanvasProvider.getContext(rect.getSize());ctx.drawImage(this.getCanvas(),rect.x,rect.y,rect.width,rect.height,0,0,rect.width,rect.height);return ctx.canvas;},getSubRaster:function(){var rect=Rectangle.read(arguments),raster=new Raster(Item.NO_INSERT);raster._setImage(this.getSubCanvas(rect));raster.translate(rect.getCenter().subtract(this.getSize().divide(2)));raster._matrix.prepend(this._matrix);raster.insertAbove(this);return raster;},toDataURL:function(){var image=this._image,src=image&&image.src;if(/^data:/.test(src))
return src;var canvas=this.getCanvas();return canvas?canvas.toDataURL.apply(canvas,arguments):null;},drawImage:function(image){var point=Point.read(arguments,1);this.getContext(true).drawImage(image,point.x,point.y);},getAverageColor:function(object){var bounds,path;if(!object){bounds=this.getBounds();}else if(object instanceof PathItem){path=object;bounds=object.getBounds();}else if(typeof object==='object'){if('width'in object){bounds=new Rectangle(object);}else if('x'in object){bounds=new Rectangle(object.x-0.5,object.y-0.5,1,1);}}
if(!bounds)
return null;var sampleSize=32,width=Math.min(bounds.width,sampleSize),height=Math.min(bounds.height,sampleSize);var ctx=Raster._sampleContext;if(!ctx){ctx=Raster._sampleContext=CanvasProvider.getContext(new Size(sampleSize));}else{ctx.clearRect(0,0,sampleSize+1,sampleSize+1);}
ctx.save();var matrix=new Matrix().scale(width / bounds.width,height / bounds.height).translate(-bounds.x,-bounds.y);matrix.applyToContext(ctx);if(path)
path.draw(ctx,new Base({clip:true,matrices:[matrix]}));this._matrix.applyToContext(ctx);var element=this.getElement(),size=this._size;if(element)
ctx.drawImage(element,-size.width / 2,-size.height / 2);ctx.restore();var pixels=ctx.getImageData(0.5,0.5,Math.ceil(width),Math.ceil(height)).data,channels=[0,0,0],total=0;for(var i=0,l=pixels.length;i<l;i+=4){var alpha=pixels[i+3];total+=alpha;alpha /=255;channels[0]+=pixels[i]*alpha;channels[1]+=pixels[i+1]*alpha;channels[2]+=pixels[i+2]*alpha;}
for(var i=0;i<3;i++)
channels[i]/=total;return total?Color.read(channels):null;},getPixel:function(){var point=Point.read(arguments);var data=this.getContext().getImageData(point.x,point.y,1,1).data;return new Color('rgb',[data[0]/ 255,data[1]/ 255,data[2]/ 255],data[3]/ 255);},setPixel:function(){var args=arguments,point=Point.read(args),color=Color.read(args),components=color._convert('rgb'),alpha=color._alpha,ctx=this.getContext(true),imageData=ctx.createImageData(1,1),data=imageData.data;data[0]=components[0]*255;data[1]=components[1]*255;data[2]=components[2]*255;data[3]=alpha!=null?alpha*255:255;ctx.putImageData(imageData,point.x,point.y);},clear:function(){var size=this._size;this.getContext(true).clearRect(0,0,size.width+1,size.height+1);},createImageData:function(){var size=Size.read(arguments);return this.getContext().createImageData(size.width,size.height);},getImageData:function(){var rect=Rectangle.read(arguments);if(rect.isEmpty())
rect=new Rectangle(this._size);return this.getContext().getImageData(rect.x,rect.y,rect.width,rect.height);},setImageData:function(data){var point=Point.read(arguments,1);this.getContext(true).putImageData(data,point.x,point.y);},_getBounds:function(matrix,options){var rect=new Rectangle(this._size).setCenter(0,0);return matrix?matrix._transformBounds(rect):rect;},_hitTestSelf:function(point){if(this._contains(point)){var that=this;return new HitResult('pixel',that,{offset:point.add(that._size.divide(2)).round(),color:{get:function(){return that.getPixel(this.offset);}}});}},_draw:function(ctx,param,viewMatrix){var element=this.getElement();if(element&&element.width>0&&element.height>0){ctx.globalAlpha=Numerical.clamp(this._opacity,0,1);this._setStyles(ctx,param,viewMatrix);var smoothing=this._smoothing,disabled=smoothing==='off';DomElement.setPrefixed(ctx,disabled?'imageSmoothingEnabled':'imageSmoothingQuality',disabled?false:smoothing);ctx.drawImage(element,-this._size.width / 2,-this._size.height / 2);}},_canComposite:function(){return true;}});var SymbolItem=Item.extend({_class:'SymbolItem',_applyMatrix:false,_canApplyMatrix:false,_boundsOptions:{stroke:true},_serializeFields:{symbol:null},initialize:function SymbolItem(arg0,arg1){if(!this._initialize(arg0,arg1!==undefined&&Point.read(arguments,1)))
this.setDefinition(arg0 instanceof SymbolDefinition?arg0:new SymbolDefinition(arg0));},_equals:function(item){return this._definition===item._definition;},copyContent:function(source){this.setDefinition(source._definition);},getDefinition:function(){return this._definition;},setDefinition:function(definition){this._definition=definition;this._changed(9);},getSymbol:'#getDefinition',setSymbol:'#setDefinition',isEmpty:function(){return this._definition._item.isEmpty();},_getBounds:function(matrix,options){var item=this._definition._item;return item._getCachedBounds(item._matrix.prepended(matrix),options);},_hitTestSelf:function(point,options,viewMatrix){var opts=options.extend({all:false});var res=this._definition._item._hitTest(point,opts,viewMatrix);if(res)
res.item=this;return res;},_draw:function(ctx,param){this._definition._item.draw(ctx,param);}});var SymbolDefinition=Base.extend({_class:'SymbolDefinition',initialize:function SymbolDefinition(item,dontCenter){this._id=UID.get();this.project=paper.project;if(item)
this.setItem(item,dontCenter);},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._class,this._item],options,false,dictionary);});},_changed:function(flags){if(flags&8)
Item._clearBoundsCache(this);if(flags&1)
this.project._changed(flags);},getItem:function(){return this._item;},setItem:function(item,_dontCenter){if(item._symbol)
item=item.clone();if(this._item)
this._item._symbol=null;this._item=item;item.remove();item.setSelected(false);if(!_dontCenter)
item.setPosition(new Point());item._symbol=this;this._changed(9);},getDefinition:'#getItem',setDefinition:'#setItem',place:function(position){return new SymbolItem(this,position);},clone:function(){return new SymbolDefinition(this._item.clone(false));},equals:function(symbol){return symbol===this||symbol&&this._item.equals(symbol._item)||false;}});var HitResult=Base.extend({_class:'HitResult',initialize:function HitResult(type,item,values){this.type=type;this.item=item;if(values)
this.inject(values);},statics:{getOptions:function(args){var options=args&&Base.read(args);return new Base({type:null,tolerance:paper.settings.hitTolerance,fill:!options,stroke:!options,segments:!options,handles:false,ends:false,position:false,center:false,bounds:false,guides:false,selected:false},options);}}});var Segment=Base.extend({_class:'Segment',beans:true,_selection:0,initialize:function Segment(arg0,arg1,arg2,arg3,arg4,arg5){var count=arguments.length,point,handleIn,handleOut,selection;if(count>0){if(arg0==null||typeof arg0==='object'){if(count===1&&arg0&&'point'in arg0){point=arg0.point;handleIn=arg0.handleIn;handleOut=arg0.handleOut;selection=arg0.selection;}else{point=arg0;handleIn=arg1;handleOut=arg2;selection=arg3;}}else{point=[arg0,arg1];handleIn=arg2!==undefined?[arg2,arg3]:null;handleOut=arg4!==undefined?[arg4,arg5]:null;}}
new SegmentPoint(point,this,'_point');new SegmentPoint(handleIn,this,'_handleIn');new SegmentPoint(handleOut,this,'_handleOut');if(selection)
this.setSelection(selection);},_serialize:function(options,dictionary){var point=this._point,selection=this._selection,obj=selection||this.hasHandles()?[point,this._handleIn,this._handleOut]:point;if(selection)
obj.push(selection);return Base.serialize(obj,options,true,dictionary);},_changed:function(point){var path=this._path;if(!path)
return;var curves=path._curves,index=this._index,curve;if(curves){if((!point||point===this._point||point===this._handleIn)&&(curve=index>0?curves[index-1]:path._closed?curves[curves.length-1]:null))
curve._changed();if((!point||point===this._point||point===this._handleOut)&&(curve=curves[index]))
curve._changed();}
path._changed(41);},getPoint:function(){return this._point;},setPoint:function(){this._point.set(Point.read(arguments));},getHandleIn:function(){return this._handleIn;},setHandleIn:function(){this._handleIn.set(Point.read(arguments));},getHandleOut:function(){return this._handleOut;},setHandleOut:function(){this._handleOut.set(Point.read(arguments));},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero();},isSmooth:function(){var handleIn=this._handleIn,handleOut=this._handleOut;return!handleIn.isZero()&&!handleOut.isZero()&&handleIn.isCollinear(handleOut);},clearHandles:function(){this._handleIn._set(0,0);this._handleOut._set(0,0);},getSelection:function(){return this._selection;},setSelection:function(selection){var oldSelection=this._selection,path=this._path;this._selection=selection=selection||0;if(path&&selection!==oldSelection){path._updateSelection(this,oldSelection,selection);path._changed(257);}},_changeSelection:function(flag,selected){var selection=this._selection;this.setSelection(selected?selection|flag:selection&~flag);},isSelected:function(){return!!(this._selection&7);},setSelected:function(selected){this._changeSelection(7,selected);},getIndex:function(){return this._index!==undefined?this._index:null;},getPath:function(){return this._path||null;},getCurve:function(){var path=this._path,index=this._index;if(path){if(index>0&&!path._closed&&index===path._segments.length-1)
index--;return path.getCurves()[index]||null;}
return null;},getLocation:function(){var curve=this.getCurve();return curve?new CurveLocation(curve,this===curve._segment1?0:1):null;},getNext:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index+1]||this._path._closed&&segments[0])||null;},smooth:function(options,_first,_last){var opts=options||{},type=opts.type,factor=opts.factor,prev=this.getPrevious(),next=this.getNext(),p0=(prev||this)._point,p1=this._point,p2=(next||this)._point,d1=p0.getDistance(p1),d2=p1.getDistance(p2);if(!type||type==='catmull-rom'){var a=factor===undefined?0.5:factor,d1_a=Math.pow(d1,a),d1_2a=d1_a*d1_a,d2_a=Math.pow(d2,a),d2_2a=d2_a*d2_a;if(!_first&&prev){var A=2*d2_2a+3*d2_a*d1_a+d1_2a,N=3*d2_a*(d2_a+d1_a);this.setHandleIn(N!==0?new Point((d2_2a*p0._x+A*p1._x-d1_2a*p2._x)/ N-p1._x,(d2_2a*p0._y+A*p1._y-d1_2a*p2._y)/ N-p1._y):new Point());}
if(!_last&&next){var A=2*d1_2a+3*d1_a*d2_a+d2_2a,N=3*d1_a*(d1_a+d2_a);this.setHandleOut(N!==0?new Point((d1_2a*p2._x+A*p1._x-d2_2a*p0._x)/ N-p1._x,(d1_2a*p2._y+A*p1._y-d2_2a*p0._y)/ N-p1._y):new Point());}}else if(type==='geometric'){if(prev&&next){var vector=p0.subtract(p2),t=factor===undefined?0.4:factor,k=t*d1 /(d1+d2);if(!_first)
this.setHandleIn(vector.multiply(k));if(!_last)
this.setHandleOut(vector.multiply(k-t));}}else{throw new Error('Smoothing method \''+type+'\' not supported.');}},getPrevious:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index-1]||this._path._closed&&segments[segments.length-1])||null;},isFirst:function(){return!this._index;},isLast:function(){var path=this._path;return path&&this._index===path._segments.length-1||false;},reverse:function(){var handleIn=this._handleIn,handleOut=this._handleOut,tmp=handleIn.clone();handleIn.set(handleOut);handleOut.set(tmp);},reversed:function(){return new Segment(this._point,this._handleOut,this._handleIn);},remove:function(){return this._path?!!this._path.removeSegment(this._index):false;},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut);},equals:function(segment){return segment===this||segment&&this._class===segment._class&&this._point.equals(segment._point)&&this._handleIn.equals(segment._handleIn)&&this._handleOut.equals(segment._handleOut)||false;},toString:function(){var parts=['point: '+this._point];if(!this._handleIn.isZero())
parts.push('handleIn: '+this._handleIn);if(!this._handleOut.isZero())
parts.push('handleOut: '+this._handleOut);return'{ '+parts.join(', ')+' }';},transform:function(matrix){this._transformCoordinates(matrix,new Array(6),true);this._changed();},interpolate:function(from,to,factor){var u=1-factor,v=factor,point1=from._point,point2=to._point,handleIn1=from._handleIn,handleIn2=to._handleIn,handleOut2=to._handleOut,handleOut1=from._handleOut;this._point._set(u*point1._x+v*point2._x,u*point1._y+v*point2._y,true);this._handleIn._set(u*handleIn1._x+v*handleIn2._x,u*handleIn1._y+v*handleIn2._y,true);this._handleOut._set(u*handleOut1._x+v*handleOut2._x,u*handleOut1._y+v*handleOut2._y,true);this._changed();},_transformCoordinates:function(matrix,coords,change){var point=this._point,handleIn=!change||!this._handleIn.isZero()?this._handleIn:null,handleOut=!change||!this._handleOut.isZero()?this._handleOut:null,x=point._x,y=point._y,i=2;coords[0]=x;coords[1]=y;if(handleIn){coords[i++]=handleIn._x+x;coords[i++]=handleIn._y+y;}
if(handleOut){coords[i++]=handleOut._x+x;coords[i++]=handleOut._y+y;}
if(matrix){matrix._transformCoordinates(coords,coords,i / 2);x=coords[0];y=coords[1];if(change){point._x=x;point._y=y;i=2;if(handleIn){handleIn._x=coords[i++]-x;handleIn._y=coords[i++]-y;}
if(handleOut){handleOut._x=coords[i++]-x;handleOut._y=coords[i++]-y;}}else{if(!handleIn){coords[i++]=x;coords[i++]=y;}
if(!handleOut){coords[i++]=x;coords[i++]=y;}}}
return coords;}});var SegmentPoint=Point.extend({initialize:function SegmentPoint(point,owner,key){var x,y,selected;if(!point){x=y=0;}else if((x=point[0])!==undefined){y=point[1];}else{var pt=point;if((x=pt.x)===undefined){pt=Point.read(arguments);x=pt.x;}
y=pt.y;selected=pt.selected;}
this._x=x;this._y=y;this._owner=owner;owner[key]=this;if(selected)
this.setSelected(true);},_set:function(x,y){this._x=x;this._y=y;this._owner._changed(this);return this;},getX:function(){return this._x;},setX:function(x){this._x=x;this._owner._changed(this);},getY:function(){return this._y;},setY:function(y){this._y=y;this._owner._changed(this);},isZero:function(){var isZero=Numerical.isZero;return isZero(this._x)&&isZero(this._y);},isSelected:function(){return!!(this._owner._selection&this._getSelection());},setSelected:function(selected){this._owner._changeSelection(this._getSelection(),selected);},_getSelection:function(){var owner=this._owner;return this===owner._point?1:this===owner._handleIn?2:this===owner._handleOut?4:0;}});var Curve=Base.extend({_class:'Curve',beans:true,initialize:function Curve(arg0,arg1,arg2,arg3,arg4,arg5,arg6,arg7){var count=arguments.length,seg1,seg2,point1,point2,handle1,handle2;if(count===3){this._path=arg0;seg1=arg1;seg2=arg2;}else if(!count){seg1=new Segment();seg2=new Segment();}else if(count===1){if('segment1'in arg0){seg1=new Segment(arg0.segment1);seg2=new Segment(arg0.segment2);}else if('point1'in arg0){point1=arg0.point1;handle1=arg0.handle1;handle2=arg0.handle2;point2=arg0.point2;}else if(Array.isArray(arg0)){point1=[arg0[0],arg0[1]];point2=[arg0[6],arg0[7]];handle1=[arg0[2]-arg0[0],arg0[3]-arg0[1]];handle2=[arg0[4]-arg0[6],arg0[5]-arg0[7]];}}else if(count===2){seg1=new Segment(arg0);seg2=new Segment(arg1);}else if(count===4){point1=arg0;handle1=arg1;handle2=arg2;point2=arg3;}else if(count===8){point1=[arg0,arg1];point2=[arg6,arg7];handle1=[arg2-arg0,arg3-arg1];handle2=[arg4-arg6,arg5-arg7];}
this._segment1=seg1||new Segment(point1,null,handle1);this._segment2=seg2||new Segment(point2,handle2,null);},_serialize:function(options,dictionary){return Base.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],options,true,dictionary);},_changed:function(){this._length=this._bounds=undefined;},clone:function(){return new Curve(this._segment1,this._segment2);},toString:function(){var parts=['point1: '+this._segment1._point];if(!this._segment1._handleOut.isZero())
parts.push('handle1: '+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())
parts.push('handle2: '+this._segment2._handleIn);parts.push('point2: '+this._segment2._point);return'{ '+parts.join(', ')+' }';},classify:function(){return Curve.classify(this.getValues());},remove:function(){var removed=false;if(this._path){var segment2=this._segment2,handleOut=segment2._handleOut;removed=segment2.remove();if(removed)
this._segment1._handleOut.set(handleOut);}
return removed;},getPoint1:function(){return this._segment1._point;},setPoint1:function(){this._segment1._point.set(Point.read(arguments));},getPoint2:function(){return this._segment2._point;},setPoint2:function(){this._segment2._point.set(Point.read(arguments));},getHandle1:function(){return this._segment1._handleOut;},setHandle1:function(){this._segment1._handleOut.set(Point.read(arguments));},getHandle2:function(){return this._segment2._handleIn;},setHandle2:function(){this._segment2._handleIn.set(Point.read(arguments));},getSegment1:function(){return this._segment1;},getSegment2:function(){return this._segment2;},getPath:function(){return this._path;},getIndex:function(){return this._segment1._index;},getNext:function(){var curves=this._path&&this._path._curves;return curves&&(curves[this._segment1._index+1]||this._path._closed&&curves[0])||null;},getPrevious:function(){var curves=this._path&&this._path._curves;return curves&&(curves[this._segment1._index-1]||this._path._closed&&curves[curves.length-1])||null;},isFirst:function(){return!this._segment1._index;},isLast:function(){var path=this._path;return path&&this._segment1._index===path._curves.length-1||false;},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected();},setSelected:function(selected){this.getPoint1().setSelected(selected);this.getHandle1().setSelected(selected);this.getHandle2().setSelected(selected);this.getPoint2().setSelected(selected);},getValues:function(matrix){return Curve.getValues(this._segment1,this._segment2,matrix);},getPoints:function(){var coords=this.getValues(),points=[];for(var i=0;i<8;i+=2)
points.push(new Point(coords[i],coords[i+1]));return points;}},{getLength:function(){if(this._length==null)
this._length=Curve.getLength(this.getValues(),0,1);return this._length;},getArea:function(){return Curve.getArea(this.getValues());},getLine:function(){return new Line(this._segment1._point,this._segment2._point);},getPart:function(from,to){return new Curve(Curve.getPart(this.getValues(),from,to));},getPartLength:function(from,to){return Curve.getLength(this.getValues(),from,to);},divideAt:function(location){return this.divideAtTime(location&&location.curve===this?location.time:this.getTimeAt(location));},divideAtTime:function(time,_setHandles){var tMin=1e-8,tMax=1-tMin,res=null;if(time>=tMin&&time<=tMax){var parts=Curve.subdivide(this.getValues(),time),left=parts[0],right=parts[1],setHandles=_setHandles||this.hasHandles(),seg1=this._segment1,seg2=this._segment2,path=this._path;if(setHandles){seg1._handleOut._set(left[2]-left[0],left[3]-left[1]);seg2._handleIn._set(right[4]-right[6],right[5]-right[7]);}
var x=left[6],y=left[7],segment=new Segment(new Point(x,y),setHandles&&new Point(left[4]-x,left[5]-y),setHandles&&new Point(right[2]-x,right[3]-y));if(path){path.insert(seg1._index+1,segment);res=this.getNext();}else{this._segment2=segment;this._changed();res=new Curve(segment,seg2);}}
return res;},splitAt:function(location){var path=this._path;return path?path.splitAt(location):null;},splitAtTime:function(time){return this.splitAt(this.getLocationAtTime(time));},divide:function(offset,isTime){return this.divideAtTime(offset===undefined?0.5:isTime?offset:this.getTimeAt(offset));},split:function(offset,isTime){return this.splitAtTime(offset===undefined?0.5:isTime?offset:this.getTimeAt(offset));},reversed:function(){return new Curve(this._segment2.reversed(),this._segment1.reversed());},clearHandles:function(){this._segment1._handleOut._set(0,0);this._segment2._handleIn._set(0,0);},statics:{getValues:function(segment1,segment2,matrix,straight){var p1=segment1._point,h1=segment1._handleOut,h2=segment2._handleIn,p2=segment2._point,x1=p1.x,y1=p1.y,x2=p2.x,y2=p2.y,values=straight?[x1,y1,x1,y1,x2,y2,x2,y2]:[x1,y1,x1+h1._x,y1+h1._y,x2+h2._x,y2+h2._y,x2,y2];if(matrix)
matrix._transformCoordinates(values,values,4);return values;},subdivide:function(v,t){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7];if(t===undefined)
t=0.5;var u=1-t,x4=u*x0+t*x1,y4=u*y0+t*y1,x5=u*x1+t*x2,y5=u*y1+t*y2,x6=u*x2+t*x3,y6=u*y2+t*y3,x7=u*x4+t*x5,y7=u*y4+t*y5,x8=u*x5+t*x6,y8=u*y5+t*y6,x9=u*x7+t*x8,y9=u*y7+t*y8;return[[x0,y0,x4,y4,x7,y7,x9,y9],[x9,y9,x8,y8,x6,y6,x3,y3]];},getMonoCurves:function(v,dir){var curves=[],io=dir?0:1,o0=v[io+0],o1=v[io+2],o2=v[io+4],o3=v[io+6];if((o0>=o1)===(o1>=o2)&&(o1>=o2)===(o2>=o3)||Curve.isStraight(v)){curves.push(v);}else{var a=3*(o1-o2)-o0+o3,b=2*(o0+o2)-4*o1,c=o1-o0,tMin=1e-8,tMax=1-tMin,roots=[],n=Numerical.solveQuadratic(a,b,c,roots,tMin,tMax);if(!n){curves.push(v);}else{roots.sort();var t=roots[0],parts=Curve.subdivide(v,t);curves.push(parts[0]);if(n>1){t=(roots[1]-t)/(1-t);parts=Curve.subdivide(parts[1],t);curves.push(parts[0]);}
curves.push(parts[1]);}}
return curves;},solveCubic:function(v,coord,val,roots,min,max){var v0=v[coord],v1=v[coord+2],v2=v[coord+4],v3=v[coord+6],res=0;if(!(v0<val&&v3<val&&v1<val&&v2<val||v0>val&&v3>val&&v1>val&&v2>val)){var c=3*(v1-v0),b=3*(v2-v1)-c,a=v3-v0-c-b;res=Numerical.solveCubic(a,b,c,v0-val,roots,min,max);}
return res;},getTimeOf:function(v,point){var p0=new Point(v[0],v[1]),p3=new Point(v[6],v[7]),epsilon=1e-12,geomEpsilon=1e-7,t=point.isClose(p0,epsilon)?0:point.isClose(p3,epsilon)?1:null;if(t===null){var coords=[point.x,point.y],roots=[];for(var c=0;c<2;c++){var count=Curve.solveCubic(v,c,coords[c],roots,0,1);for(var i=0;i<count;i++){var u=roots[i];if(point.isClose(Curve.getPoint(v,u),geomEpsilon))
return u;}}}
return point.isClose(p0,geomEpsilon)?0:point.isClose(p3,geomEpsilon)?1:null;},getNearestTime:function(v,point){if(Curve.isStraight(v)){var x0=v[0],y0=v[1],x3=v[6],y3=v[7],vx=x3-x0,vy=y3-y0,det=vx*vx+vy*vy;if(det===0)
return 0;var u=((point.x-x0)*vx+(point.y-y0)*vy)/ det;return u<1e-12?0:u>0.999999999999?1:Curve.getTimeOf(v,new Point(x0+u*vx,y0+u*vy));}
var count=100,minDist=Infinity,minT=0;function refine(t){if(t>=0&&t<=1){var dist=point.getDistance(Curve.getPoint(v,t),true);if(dist<minDist){minDist=dist;minT=t;return true;}}}
for(var i=0;i<=count;i++)
refine(i / count);var step=1 /(count*2);while(step>1e-8){if(!refine(minT-step)&&!refine(minT+step))
step /=2;}
return minT;},getPart:function(v,from,to){var flip=from>to;if(flip){var tmp=from;from=to;to=tmp;}
if(from>0)
v=Curve.subdivide(v,from)[1];if(to<1)
v=Curve.subdivide(v,(to-from)/(1-from))[0];return flip?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v;},isFlatEnough:function(v,flatness){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],ux=3*x1-2*x0-x3,uy=3*y1-2*y0-y3,vx=3*x2-2*x3-x0,vy=3*y2-2*y3-y0;return Math.max(ux*ux,vx*vx)+Math.max(uy*uy,vy*vy)<=16*flatness*flatness;},getArea:function(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7];return 3*((y3-y0)*(x1+x2)-(x3-x0)*(y1+y2)
+y1*(x0-x2)-x1*(y0-y2)
+y3*(x2+x0 / 3)-x3*(y2+y0 / 3))/ 20;},getBounds:function(v){var min=v.slice(0,2),max=min.slice(),roots=[0,0];for(var i=0;i<2;i++)
Curve._addBounds(v[i],v[i+2],v[i+4],v[i+6],i,0,min,max,roots);return new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1]);},_addBounds:function(v0,v1,v2,v3,coord,padding,min,max,roots){function add(value,padding){var left=value-padding,right=value+padding;if(left<min[coord])
min[coord]=left;if(right>max[coord])
max[coord]=right;}
padding /=2;var minPad=min[coord]+padding,maxPad=max[coord]-padding;if(v0<minPad||v1<minPad||v2<minPad||v3<minPad||v0>maxPad||v1>maxPad||v2>maxPad||v3>maxPad){if(v1<v0!=v1<v3&&v2<v0!=v2<v3){add(v0,0);add(v3,0);}else{var a=3*(v1-v2)-v0+v3,b=2*(v0+v2)-4*v1,c=v1-v0,count=Numerical.solveQuadratic(a,b,c,roots),tMin=1e-8,tMax=1-tMin;add(v3,0);for(var i=0;i<count;i++){var t=roots[i],u=1-t;if(tMin<=t&&t<=tMax)
add(u*u*u*v0
+3*u*u*t*v1
+3*u*t*t*v2
+t*t*t*v3,padding);}}}}}},Base.each(['getBounds','getStrokeBounds','getHandleBounds'],function(name){this[name]=function(){if(!this._bounds)
this._bounds={};var bounds=this._bounds[name];if(!bounds){bounds=this._bounds[name]=Path[name]([this._segment1,this._segment2],false,this._path);}
return bounds.clone();};},{}),Base.each({isStraight:function(p1,h1,h2,p2){if(h1.isZero()&&h2.isZero()){return true;}else{var v=p2.subtract(p1);if(v.isZero()){return false;}else if(v.isCollinear(h1)&&v.isCollinear(h2)){var l=new Line(p1,p2),epsilon=1e-7;if(l.getDistance(p1.add(h1))<epsilon&&l.getDistance(p2.add(h2))<epsilon){var div=v.dot(v),s1=v.dot(h1)/ div,s2=v.dot(h2)/ div;return s1>=0&&s1<=1&&s2<=0&&s2>=-1;}}}
return false;},isLinear:function(p1,h1,h2,p2){var third=p2.subtract(p1).divide(3);return h1.equals(third)&&h2.negate().equals(third);}},function(test,name){this[name]=function(epsilon){var seg1=this._segment1,seg2=this._segment2;return test(seg1._point,seg1._handleOut,seg2._handleIn,seg2._point,epsilon);};this.statics[name]=function(v,epsilon){var x0=v[0],y0=v[1],x3=v[6],y3=v[7];return test(new Point(x0,y0),new Point(v[2]-x0,v[3]-y0),new Point(v[4]-x3,v[5]-y3),new Point(x3,y3),epsilon);};},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero();},hasLength:function(epsilon){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(epsilon||0);},isCollinear:function(curve){return curve&&this.isStraight()&&curve.isStraight()&&this.getLine().isCollinear(curve.getLine());},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<1e-8;},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<1e-8;}}),{beans:false,getLocationAt:function(offset,_isTime){return this.getLocationAtTime(_isTime?offset:this.getTimeAt(offset));},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new CurveLocation(this,t):null;},getTimeAt:function(offset,start){return Curve.getTimeAt(this.getValues(),offset,start);},getParameterAt:'#getTimeAt',getTimesWithTangent:function(){var tangent=Point.read(arguments);return tangent.isZero()?[]:Curve.getTimesWithTangent(this.getValues(),tangent);},getOffsetAtTime:function(t){return this.getPartLength(0,t);},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(Point.read(arguments)));},getOffsetOf:function(){var loc=this.getLocationOf.apply(this,arguments);return loc?loc.getOffset():null;},getTimeOf:function(){return Curve.getTimeOf(this.getValues(),Point.read(arguments));},getParameterOf:'#getTimeOf',getNearestLocation:function(){var point=Point.read(arguments),values=this.getValues(),t=Curve.getNearestTime(values,point),pt=Curve.getPoint(values,t);return new CurveLocation(this,t,pt,null,point.getDistance(pt));},getNearestPoint:function(){var loc=this.getNearestLocation.apply(this,arguments);return loc?loc.getPoint():loc;}},new function(){var methods=['getPoint','getTangent','getNormal','getWeightedTangent','getWeightedNormal','getCurvature'];return Base.each(methods,function(name){this[name+'At']=function(location,_isTime){var values=this.getValues();return Curve[name](values,_isTime?location:Curve.getTimeAt(values,location));};this[name+'AtTime']=function(time){return Curve[name](this.getValues(),time);};},{statics:{_evaluateMethods:methods}});},new function(){function getLengthIntegrand(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],ax=9*(x1-x2)+3*(x3-x0),bx=6*(x0+x2)-12*x1,cx=3*(x1-x0),ay=9*(y1-y2)+3*(y3-y0),by=6*(y0+y2)-12*y1,cy=3*(y1-y0);return function(t){var dx=(ax*t+bx)*t+cx,dy=(ay*t+by)*t+cy;return Math.sqrt(dx*dx+dy*dy);};}
function getIterations(a,b){return Math.max(2,Math.min(16,Math.ceil(Math.abs(b-a)*32)));}
function evaluate(v,t,type,normalized){if(t==null||t<0||t>1)
return null;var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],isZero=Numerical.isZero;if(isZero(x1-x0)&&isZero(y1-y0)){x1=x0;y1=y0;}
if(isZero(x2-x3)&&isZero(y2-y3)){x2=x3;y2=y3;}
var cx=3*(x1-x0),bx=3*(x2-x1)-cx,ax=x3-x0-cx-bx,cy=3*(y1-y0),by=3*(y2-y1)-cy,ay=y3-y0-cy-by,x,y;if(type===0){x=t===0?x0:t===1?x3:((ax*t+bx)*t+cx)*t+x0;y=t===0?y0:t===1?y3:((ay*t+by)*t+cy)*t+y0;}else{var tMin=1e-8,tMax=1-tMin;if(t<tMin){x=cx;y=cy;}else if(t>tMax){x=3*(x3-x2);y=3*(y3-y2);}else{x=(3*ax*t+2*bx)*t+cx;y=(3*ay*t+2*by)*t+cy;}
if(normalized){if(x===0&&y===0&&(t<tMin||t>tMax)){x=x2-x1;y=y2-y1;}
var len=Math.sqrt(x*x+y*y);if(len){x /=len;y /=len;}}
if(type===3){var x2=6*ax*t+2*bx,y2=6*ay*t+2*by,d=Math.pow(x*x+y*y,3 / 2);x=d!==0?(x*y2-y*x2)/ d:0;y=0;}}
return type===2?new Point(y,-x):new Point(x,y);}
return{statics:{classify:function(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],a1=x0*(y3-y2)+y0*(x2-x3)+x3*y2-y3*x2,a2=x1*(y0-y3)+y1*(x3-x0)+x0*y3-y0*x3,a3=x2*(y1-y0)+y2*(x0-x1)+x1*y0-y1*x0,d3=3*a3,d2=d3-a2,d1=d2-a2+a1,l=Math.sqrt(d1*d1+d2*d2+d3*d3),s=l!==0?1 / l:0,isZero=Numerical.isZero,serpentine='serpentine';d1*=s;d2*=s;d3*=s;function type(type,t1,t2){var hasRoots=t1!==undefined,t1Ok=hasRoots&&t1>0&&t1<1,t2Ok=hasRoots&&t2>0&&t2<1;if(hasRoots&&(!(t1Ok||t2Ok)||type==='loop'&&!(t1Ok&&t2Ok))){type='arch';t1Ok=t2Ok=false;}
return{type:type,roots:t1Ok||t2Ok?t1Ok&&t2Ok?t1<t2?[t1,t2]:[t2,t1]:[t1Ok?t1:t2]:null};}
if(isZero(d1)){return isZero(d2)?type(isZero(d3)?'line':'quadratic'):type(serpentine,d3 /(3*d2));}
var d=3*d2*d2-4*d1*d3;if(isZero(d)){return type('cusp',d2 /(2*d1));}
var f1=d>0?Math.sqrt(d / 3):Math.sqrt(-d),f2=2*d1;return type(d>0?serpentine:'loop',(d2+f1)/ f2,(d2-f1)/ f2);},getLength:function(v,a,b,ds){if(a===undefined)
a=0;if(b===undefined)
b=1;if(Curve.isStraight(v)){var c=v;if(b<1){c=Curve.subdivide(c,b)[0];a /=b;}
if(a>0){c=Curve.subdivide(c,a)[1];}
var dx=c[6]-c[0],dy=c[7]-c[1];return Math.sqrt(dx*dx+dy*dy);}
return Numerical.integrate(ds||getLengthIntegrand(v),a,b,getIterations(a,b));},getTimeAt:function(v,offset,start){if(start===undefined)
start=offset<0?1:0;if(offset===0)
return start;var abs=Math.abs,epsilon=1e-12,forward=offset>0,a=forward?start:0,b=forward?1:start,ds=getLengthIntegrand(v),rangeLength=Curve.getLength(v,a,b,ds),diff=abs(offset)-rangeLength;if(abs(diff)<epsilon){return forward?b:a;}else if(diff>epsilon){return null;}
var guess=offset / rangeLength,length=0;function f(t){length+=Numerical.integrate(ds,start,t,getIterations(start,t));start=t;return length-offset;}
return Numerical.findRoot(f,ds,start+guess,a,b,32,1e-12);},getPoint:function(v,t){return evaluate(v,t,0,false);},getTangent:function(v,t){return evaluate(v,t,1,true);},getWeightedTangent:function(v,t){return evaluate(v,t,1,false);},getNormal:function(v,t){return evaluate(v,t,2,true);},getWeightedNormal:function(v,t){return evaluate(v,t,2,false);},getCurvature:function(v,t){return evaluate(v,t,3,false).x;},getPeaks:function(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],ax=-x0+3*x1-3*x2+x3,bx=3*x0-6*x1+3*x2,cx=-3*x0+3*x1,ay=-y0+3*y1-3*y2+y3,by=3*y0-6*y1+3*y2,cy=-3*y0+3*y1,tMin=1e-8,tMax=1-tMin,roots=[];Numerical.solveCubic(9*(ax*ax+ay*ay),9*(ax*bx+by*ay),2*(bx*bx+by*by)+3*(cx*ax+cy*ay),(cx*bx+by*cy),roots,tMin,tMax);return roots.sort();}}};},new function(){function addLocation(locations,include,c1,t1,c2,t2,overlap){var excludeStart=!overlap&&c1.getPrevious()===c2,excludeEnd=!overlap&&c1!==c2&&c1.getNext()===c2,tMin=1e-8,tMax=1-tMin;if(t1!==null&&t1>=(excludeStart?tMin:0)&&t1<=(excludeEnd?tMax:1)){if(t2!==null&&t2>=(excludeEnd?tMin:0)&&t2<=(excludeStart?tMax:1)){var loc1=new CurveLocation(c1,t1,null,overlap),loc2=new CurveLocation(c2,t2,null,overlap);loc1._intersection=loc2;loc2._intersection=loc1;if(!include||include(loc1)){CurveLocation.insert(locations,loc1,true);}}}}
function addCurveIntersections(v1,v2,c1,c2,locations,include,flip,recursion,calls,tMin,tMax,uMin,uMax){if(++calls>=4096||++recursion>=40)
return calls;var fatLineEpsilon=1e-9,q0x=v2[0],q0y=v2[1],q3x=v2[6],q3y=v2[7],getSignedDistance=Line.getSignedDistance,d1=getSignedDistance(q0x,q0y,q3x,q3y,v2[2],v2[3]),d2=getSignedDistance(q0x,q0y,q3x,q3y,v2[4],v2[5]),factor=d1*d2>0?3 / 4:4 / 9,dMin=factor*Math.min(0,d1,d2),dMax=factor*Math.max(0,d1,d2),dp0=getSignedDistance(q0x,q0y,q3x,q3y,v1[0],v1[1]),dp1=getSignedDistance(q0x,q0y,q3x,q3y,v1[2],v1[3]),dp2=getSignedDistance(q0x,q0y,q3x,q3y,v1[4],v1[5]),dp3=getSignedDistance(q0x,q0y,q3x,q3y,v1[6],v1[7]),hull=getConvexHull(dp0,dp1,dp2,dp3),top=hull[0],bottom=hull[1],tMinClip,tMaxClip;if(d1===0&&d2===0&&dp0===0&&dp1===0&&dp2===0&&dp3===0||(tMinClip=clipConvexHull(top,bottom,dMin,dMax))==null||(tMaxClip=clipConvexHull(top.reverse(),bottom.reverse(),dMin,dMax))==null)
return calls;var tMinNew=tMin+(tMax-tMin)*tMinClip,tMaxNew=tMin+(tMax-tMin)*tMaxClip;if(Math.max(uMax-uMin,tMaxNew-tMinNew)<fatLineEpsilon){var t=(tMinNew+tMaxNew)/ 2,u=(uMin+uMax)/ 2;addLocation(locations,include,flip?c2:c1,flip?u:t,flip?c1:c2,flip?t:u);}else{v1=Curve.getPart(v1,tMinClip,tMaxClip);var uDiff=uMax-uMin;if(tMaxClip-tMinClip>0.8){if(tMaxNew-tMinNew>uDiff){var parts=Curve.subdivide(v1,0.5),t=(tMinNew+tMaxNew)/ 2;calls=addCurveIntersections(v2,parts[0],c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,tMinNew,t);calls=addCurveIntersections(v2,parts[1],c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,t,tMaxNew);}else{var parts=Curve.subdivide(v2,0.5),u=(uMin+uMax)/ 2;calls=addCurveIntersections(parts[0],v1,c2,c1,locations,include,!flip,recursion,calls,uMin,u,tMinNew,tMaxNew);calls=addCurveIntersections(parts[1],v1,c2,c1,locations,include,!flip,recursion,calls,u,uMax,tMinNew,tMaxNew);}}else{if(uDiff===0||uDiff>=fatLineEpsilon){calls=addCurveIntersections(v2,v1,c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,tMinNew,tMaxNew);}else{calls=addCurveIntersections(v1,v2,c1,c2,locations,include,flip,recursion,calls,tMinNew,tMaxNew,uMin,uMax);}}}
return calls;}
function getConvexHull(dq0,dq1,dq2,dq3){var p0=[0,dq0],p1=[1 / 3,dq1],p2=[2 / 3,dq2],p3=[1,dq3],dist1=dq1-(2*dq0+dq3)/ 3,dist2=dq2-(dq0+2*dq3)/ 3,hull;if(dist1*dist2<0){hull=[[p0,p1,p3],[p0,p2,p3]];}else{var distRatio=dist1 / dist2;hull=[distRatio>=2?[p0,p1,p3]:distRatio<=0.5?[p0,p2,p3]:[p0,p1,p2,p3],[p0,p3]];}
return(dist1||dist2)<0?hull.reverse():hull;}
function clipConvexHull(hullTop,hullBottom,dMin,dMax){if(hullTop[0][1]<dMin){return clipConvexHullPart(hullTop,true,dMin);}else if(hullBottom[0][1]>dMax){return clipConvexHullPart(hullBottom,false,dMax);}else{return hullTop[0][0];}}
function clipConvexHullPart(part,top,threshold){var px=part[0][0],py=part[0][1];for(var i=1,l=part.length;i<l;i++){var qx=part[i][0],qy=part[i][1];if(top?qy>=threshold:qy<=threshold){return qy===threshold?qx:px+(threshold-py)*(qx-px)/(qy-py);}
px=qx;py=qy;}
return null;}
function getCurveLineIntersections(v,px,py,vx,vy){var isZero=Numerical.isZero;if(isZero(vx)&&isZero(vy)){var t=Curve.getTimeOf(v,new Point(px,py));return t===null?[]:[t];}
var angle=Math.atan2(-vy,vx),sin=Math.sin(angle),cos=Math.cos(angle),rv=[],roots=[];for(var i=0;i<8;i+=2){var x=v[i]-px,y=v[i+1]-py;rv.push(x*cos-y*sin,x*sin+y*cos);}
Curve.solveCubic(rv,1,0,roots,0,1);return roots;}
function addCurveLineIntersections(v1,v2,c1,c2,locations,include,flip){var x1=v2[0],y1=v2[1],x2=v2[6],y2=v2[7],roots=getCurveLineIntersections(v1,x1,y1,x2-x1,y2-y1);for(var i=0,l=roots.length;i<l;i++){var t1=roots[i],p1=Curve.getPoint(v1,t1),t2=Curve.getTimeOf(v2,p1);if(t2!==null){addLocation(locations,include,flip?c2:c1,flip?t2:t1,flip?c1:c2,flip?t1:t2);}}}
function addLineIntersection(v1,v2,c1,c2,locations,include){var pt=Line.intersect(v1[0],v1[1],v1[6],v1[7],v2[0],v2[1],v2[6],v2[7]);if(pt){addLocation(locations,include,c1,Curve.getTimeOf(v1,pt),c2,Curve.getTimeOf(v2,pt));}}
function getCurveIntersections(v1,v2,c1,c2,locations,include){var epsilon=1e-12,min=Math.min,max=Math.max;if(max(v1[0],v1[2],v1[4],v1[6])+epsilon>min(v2[0],v2[2],v2[4],v2[6])&&min(v1[0],v1[2],v1[4],v1[6])-epsilon<max(v2[0],v2[2],v2[4],v2[6])&&max(v1[1],v1[3],v1[5],v1[7])+epsilon>min(v2[1],v2[3],v2[5],v2[7])&&min(v1[1],v1[3],v1[5],v1[7])-epsilon<max(v2[1],v2[3],v2[5],v2[7])){var overlaps=getOverlaps(v1,v2);if(overlaps){for(var i=0;i<2;i++){var overlap=overlaps[i];addLocation(locations,include,c1,overlap[0],c2,overlap[1],true);}}else{var straight1=Curve.isStraight(v1),straight2=Curve.isStraight(v2),straight=straight1&&straight2,flip=straight1&&!straight2,before=locations.length;(straight?addLineIntersection:straight1||straight2?addCurveLineIntersections:addCurveIntersections)(flip?v2:v1,flip?v1:v2,flip?c2:c1,flip?c1:c2,locations,include,flip,0,0,0,1,0,1);if(!straight||locations.length===before){for(var i=0;i<4;i++){var t1=i>>1,t2=i&1,i1=t1*6,i2=t2*6,p1=new Point(v1[i1],v1[i1+1]),p2=new Point(v2[i2],v2[i2+1]);if(p1.isClose(p2,epsilon)){addLocation(locations,include,c1,t1,c2,t2);}}}}}
return locations;}
function getSelfIntersection(v1,c1,locations,include){var info=Curve.classify(v1);if(info.type==='loop'){var roots=info.roots;addLocation(locations,include,c1,roots[0],c1,roots[1]);}
return locations;}
function getIntersections(curves1,curves2,include,matrix1,matrix2,_returnFirst){var epsilon=1e-7,self=!curves2;if(self)
curves2=curves1;var length1=curves1.length,length2=curves2.length,values1=new Array(length1),values2=self?values1:new Array(length2),locations=[];for(var i=0;i<length1;i++){values1[i]=curves1[i].getValues(matrix1);}
if(!self){for(var i=0;i<length2;i++){values2[i]=curves2[i].getValues(matrix2);}}
var boundsCollisions=CollisionDetection.findCurveBoundsCollisions(values1,values2,epsilon);for(var index1=0;index1<length1;index1++){var curve1=curves1[index1],v1=values1[index1];if(self){getSelfIntersection(v1,curve1,locations,include);}
var collisions1=boundsCollisions[index1];if(collisions1){for(var j=0;j<collisions1.length;j++){if(_returnFirst&&locations.length)
return locations;var index2=collisions1[j];if(!self||index2>index1){var curve2=curves2[index2],v2=values2[index2];getCurveIntersections(v1,v2,curve1,curve2,locations,include);}}}}
return locations;}
function getOverlaps(v1,v2){function getSquaredLineLength(v){var x=v[6]-v[0],y=v[7]-v[1];return x*x+y*y;}
var abs=Math.abs,getDistance=Line.getDistance,timeEpsilon=1e-8,geomEpsilon=1e-7,straight1=Curve.isStraight(v1),straight2=Curve.isStraight(v2),straightBoth=straight1&&straight2,flip=getSquaredLineLength(v1)<getSquaredLineLength(v2),l1=flip?v2:v1,l2=flip?v1:v2,px=l1[0],py=l1[1],vx=l1[6]-px,vy=l1[7]-py;if(getDistance(px,py,vx,vy,l2[0],l2[1],true)<geomEpsilon&&getDistance(px,py,vx,vy,l2[6],l2[7],true)<geomEpsilon){if(!straightBoth&&getDistance(px,py,vx,vy,l1[2],l1[3],true)<geomEpsilon&&getDistance(px,py,vx,vy,l1[4],l1[5],true)<geomEpsilon&&getDistance(px,py,vx,vy,l2[2],l2[3],true)<geomEpsilon&&getDistance(px,py,vx,vy,l2[4],l2[5],true)<geomEpsilon){straight1=straight2=straightBoth=true;}}else if(straightBoth){return null;}
if(straight1^straight2){return null;}
var v=[v1,v2],pairs=[];for(var i=0;i<4&&pairs.length<2;i++){var i1=i&1,i2=i1^1,t1=i>>1,t2=Curve.getTimeOf(v[i1],new Point(v[i2][t1?6:0],v[i2][t1?7:1]));if(t2!=null){var pair=i1?[t1,t2]:[t2,t1];if(!pairs.length||abs(pair[0]-pairs[0][0])>timeEpsilon&&abs(pair[1]-pairs[0][1])>timeEpsilon){pairs.push(pair);}}
if(i>2&&!pairs.length)
break;}
if(pairs.length!==2){pairs=null;}else if(!straightBoth){var o1=Curve.getPart(v1,pairs[0][0],pairs[1][0]),o2=Curve.getPart(v2,pairs[0][1],pairs[1][1]);if(abs(o2[2]-o1[2])>geomEpsilon||abs(o2[3]-o1[3])>geomEpsilon||abs(o2[4]-o1[4])>geomEpsilon||abs(o2[5]-o1[5])>geomEpsilon)
pairs=null;}
return pairs;}
function getTimesWithTangent(v,tangent){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7],normalized=tangent.normalize(),tx=normalized.x,ty=normalized.y,ax=3*x3-9*x2+9*x1-3*x0,ay=3*y3-9*y2+9*y1-3*y0,bx=6*x2-12*x1+6*x0,by=6*y2-12*y1+6*y0,cx=3*x1-3*x0,cy=3*y1-3*y0,den=2*ax*ty-2*ay*tx,times=[];if(Math.abs(den)<Numerical.CURVETIME_EPSILON){var num=ax*cy-ay*cx,den=ax*by-ay*bx;if(den!=0){var t=-num / den;if(t>=0&&t<=1)times.push(t);}}else{var delta=(bx*bx-4*ax*cx)*ty*ty+
(-2*bx*by+4*ay*cx+4*ax*cy)*tx*ty+
(by*by-4*ay*cy)*tx*tx,k=bx*ty-by*tx;if(delta>=0&&den!=0){var d=Math.sqrt(delta),t0=-(k+d)/ den,t1=(-k+d)/ den;if(t0>=0&&t0<=1)times.push(t0);if(t1>=0&&t1<=1)times.push(t1);}}
return times;}
return{getIntersections:function(curve){var v1=this.getValues(),v2=curve&&curve!==this&&curve.getValues();return v2?getCurveIntersections(v1,v2,this,curve,[]):getSelfIntersection(v1,this,[]);},statics:{getOverlaps:getOverlaps,getIntersections:getIntersections,getCurveLineIntersections:getCurveLineIntersections,getTimesWithTangent:getTimesWithTangent}};});var CurveLocation=Base.extend({_class:'CurveLocation',initialize:function CurveLocation(curve,time,point,_overlap,_distance){if(time>=0.99999999){var next=curve.getNext();if(next){time=0;curve=next;}}
this._setCurve(curve);this._time=time;this._point=point||curve.getPointAtTime(time);this._overlap=_overlap;this._distance=_distance;this._intersection=this._next=this._previous=null;},_setPath:function(path){this._path=path;this._version=path?path._version:0;},_setCurve:function(curve){this._setPath(curve._path);this._curve=curve;this._segment=null;this._segment1=curve._segment1;this._segment2=curve._segment2;},_setSegment:function(segment){var curve=segment.getCurve();if(curve){this._setCurve(curve);}else{this._setPath(segment._path);this._segment1=segment;this._segment2=null;}
this._segment=segment;this._time=segment===this._segment1?0:1;this._point=segment._point.clone();},getSegment:function(){var segment=this._segment;if(!segment){var curve=this.getCurve(),time=this.getTime();if(time===0){segment=curve._segment1;}else if(time===1){segment=curve._segment2;}else if(time!=null){segment=curve.getPartLength(0,time)<curve.getPartLength(time,1)?curve._segment1:curve._segment2;}
this._segment=segment;}
return segment;},getCurve:function(){var path=this._path,that=this;if(path&&path._version!==this._version){this._time=this._offset=this._curveOffset=this._curve=null;}
function trySegment(segment){var curve=segment&&segment.getCurve();if(curve&&(that._time=curve.getTimeOf(that._point))!=null){that._setCurve(curve);return curve;}}
return this._curve||trySegment(this._segment)||trySegment(this._segment1)||trySegment(this._segment2.getPrevious());},getPath:function(){var curve=this.getCurve();return curve&&curve._path;},getIndex:function(){var curve=this.getCurve();return curve&&curve.getIndex();},getTime:function(){var curve=this.getCurve(),time=this._time;return curve&&time==null?this._time=curve.getTimeOf(this._point):time;},getParameter:'#getTime',getPoint:function(){return this._point;},getOffset:function(){var offset=this._offset;if(offset==null){offset=0;var path=this.getPath(),index=this.getIndex();if(path&&index!=null){var curves=path.getCurves();for(var i=0;i<index;i++)
offset+=curves[i].getLength();}
this._offset=offset+=this.getCurveOffset();}
return offset;},getCurveOffset:function(){var offset=this._curveOffset;if(offset==null){var curve=this.getCurve(),time=this.getTime();this._curveOffset=offset=time!=null&&curve&&curve.getPartLength(0,time);}
return offset;},getIntersection:function(){return this._intersection;},getDistance:function(){return this._distance;},divide:function(){var curve=this.getCurve(),res=curve&&curve.divideAtTime(this.getTime());if(res){this._setSegment(res._segment1);}
return res;},split:function(){var curve=this.getCurve(),path=curve._path,res=curve&&curve.splitAtTime(this.getTime());if(res){this._setSegment(path.getLastSegment());}
return res;},equals:function(loc,_ignoreOther){var res=this===loc;if(!res&&loc instanceof CurveLocation){var c1=this.getCurve(),c2=loc.getCurve(),p1=c1._path,p2=c2._path;if(p1===p2){var abs=Math.abs,epsilon=1e-7,diff=abs(this.getOffset()-loc.getOffset()),i1=!_ignoreOther&&this._intersection,i2=!_ignoreOther&&loc._intersection;res=(diff<epsilon||p1&&abs(p1.getLength()-diff)<epsilon)&&(!i1&&!i2||i1&&i2&&i1.equals(i2,true));}}
return res;},toString:function(){var parts=[],point=this.getPoint(),f=Formatter.instance;if(point)
parts.push('point: '+point);var index=this.getIndex();if(index!=null)
parts.push('index: '+index);var time=this.getTime();if(time!=null)
parts.push('time: '+f.number(time));if(this._distance!=null)
parts.push('distance: '+f.number(this._distance));return'{ '+parts.join(', ')+' }';},isTouching:function(){var inter=this._intersection;if(inter&&this.getTangent().isCollinear(inter.getTangent())){var curve1=this.getCurve(),curve2=inter.getCurve();return!(curve1.isStraight()&&curve2.isStraight()&&curve1.getLine().intersect(curve2.getLine()));}
return false;},isCrossing:function(){var inter=this._intersection;if(!inter)
return false;var t1=this.getTime(),t2=inter.getTime(),tMin=1e-8,tMax=1-tMin,t1Inside=t1>=tMin&&t1<=tMax,t2Inside=t2>=tMin&&t2<=tMax;if(t1Inside&&t2Inside)
return!this.isTouching();var c2=this.getCurve(),c1=c2&&t1<tMin?c2.getPrevious():c2,c4=inter.getCurve(),c3=c4&&t2<tMin?c4.getPrevious():c4;if(t1>tMax)
c2=c2.getNext();if(t2>tMax)
c4=c4.getNext();if(!c1||!c2||!c3||!c4)
return false;var offsets=[];function addOffsets(curve,end){var v=curve.getValues(),roots=Curve.classify(v).roots||Curve.getPeaks(v),count=roots.length,offset=Curve.getLength(v,end&&count?roots[count-1]:0,!end&&count?roots[0]:1);offsets.push(count?offset:offset / 32);}
function isInRange(angle,min,max){return min<max?angle>min&&angle<max:angle>min||angle<max;}
if(!t1Inside){addOffsets(c1,true);addOffsets(c2,false);}
if(!t2Inside){addOffsets(c3,true);addOffsets(c4,false);}
var pt=this.getPoint(),offset=Math.min.apply(Math,offsets),v2=t1Inside?c2.getTangentAtTime(t1):c2.getPointAt(offset).subtract(pt),v1=t1Inside?v2.negate():c1.getPointAt(-offset).subtract(pt),v4=t2Inside?c4.getTangentAtTime(t2):c4.getPointAt(offset).subtract(pt),v3=t2Inside?v4.negate():c3.getPointAt(-offset).subtract(pt),a1=v1.getAngle(),a2=v2.getAngle(),a3=v3.getAngle(),a4=v4.getAngle();return!!(t1Inside?(isInRange(a1,a3,a4)^isInRange(a2,a3,a4))&&(isInRange(a1,a4,a3)^isInRange(a2,a4,a3)):(isInRange(a3,a1,a2)^isInRange(a4,a1,a2))&&(isInRange(a3,a2,a1)^isInRange(a4,a2,a1)));},hasOverlap:function(){return!!this._overlap;}},Base.each(Curve._evaluateMethods,function(name){var get=name+'At';this[name]=function(){var curve=this.getCurve(),time=this.getTime();return time!=null&&curve&&curve[get](time,true);};},{preserve:true}),new function(){function insert(locations,loc,merge){var length=locations.length,l=0,r=length-1;function search(index,dir){for(var i=index+dir;i>=-1&&i<=length;i+=dir){var loc2=locations[((i%length)+length)%length];if(!loc.getPoint().isClose(loc2.getPoint(),1e-7))
break;if(loc.equals(loc2))
return loc2;}
return null;}
while(l<=r){var m=(l+r)>>>1,loc2=locations[m],found;if(merge&&(found=loc.equals(loc2)?loc2:(search(m,-1)||search(m,1)))){if(loc._overlap){found._overlap=found._intersection._overlap=true;}
return found;}
var path1=loc.getPath(),path2=loc2.getPath(),diff=path1!==path2?path1._id-path2._id:(loc.getIndex()+loc.getTime())
-(loc2.getIndex()+loc2.getTime());if(diff<0){r=m-1;}else{l=m+1;}}
locations.splice(l,0,loc);return loc;}
return{statics:{insert:insert,expand:function(locations){var expanded=locations.slice();for(var i=locations.length-1;i>=0;i--){insert(expanded,locations[i]._intersection,false);}
return expanded;}}};});var PathItem=Item.extend({_class:'PathItem',_selectBounds:false,_canScaleStroke:true,beans:true,initialize:function PathItem(){},statics:{create:function(arg){var data,segments,compound;if(Base.isPlainObject(arg)){segments=arg.segments;data=arg.pathData;}else if(Array.isArray(arg)){segments=arg;}else if(typeof arg==='string'){data=arg;}
if(segments){var first=segments[0];compound=first&&Array.isArray(first[0]);}else if(data){compound=(data.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(data);}
var ctor=compound?CompoundPath:Path;return new ctor(arg);}},_asPathItem:function(){return this;},isClockwise:function(){return this.getArea()>=0;},setClockwise:function(clockwise){if(this.isClockwise()!=(clockwise=!!clockwise))
this.reverse();},setPathData:function(data){var parts=data&&data.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),coords,relative=false,previous,control,current=new Point(),start=new Point();function getCoord(index,coord){var val=+coords[index];if(relative)
val+=current[coord];return val;}
function getPoint(index){return new Point(getCoord(index,'x'),getCoord(index+1,'y'));}
this.clear();for(var i=0,l=parts&&parts.length;i<l;i++){var part=parts[i],command=part[0],lower=command.toLowerCase();coords=part.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var length=coords&&coords.length;relative=command===lower;if(previous==='z'&&!/[mz]/.test(lower))
this.moveTo(current);switch(lower){case'm':case'l':var move=lower==='m';for(var j=0;j<length;j+=2){this[move?'moveTo':'lineTo'](current=getPoint(j));if(move){start=current;move=false;}}
control=current;break;case'h':case'v':var coord=lower==='h'?'x':'y';current=current.clone();for(var j=0;j<length;j++){current[coord]=getCoord(j,coord);this.lineTo(current);}
control=current;break;case'c':for(var j=0;j<length;j+=6){this.cubicCurveTo(getPoint(j),control=getPoint(j+2),current=getPoint(j+4));}
break;case's':for(var j=0;j<length;j+=4){this.cubicCurveTo(/[cs]/.test(previous)?current.multiply(2).subtract(control):current,control=getPoint(j),current=getPoint(j+2));previous=lower;}
break;case'q':for(var j=0;j<length;j+=4){this.quadraticCurveTo(control=getPoint(j),current=getPoint(j+2));}
break;case't':for(var j=0;j<length;j+=2){this.quadraticCurveTo(control=(/[qt]/.test(previous)?current.multiply(2).subtract(control):current),current=getPoint(j));previous=lower;}
break;case'a':for(var j=0;j<length;j+=7){this.arcTo(current=getPoint(j+5),new Size(+coords[j],+coords[j+1]),+coords[j+2],+coords[j+4],+coords[j+3]);}
break;case'z':this.closePath(1e-12);current=start;break;}
previous=lower;}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke());},_contains:function(point){var winding=point.isInside(this.getBounds({internal:true,handle:true}))?this._getWinding(point):{};return winding.onPath||!!(this.getFillRule()==='evenodd'?winding.windingL&1||winding.windingR&1:winding.winding);},getIntersections:function(path,include,_matrix,_returnFirst){var self=this===path||!path,matrix1=this._matrix._orNullIfIdentity(),matrix2=self?matrix1:(_matrix||path._matrix)._orNullIfIdentity();return self||this.getBounds(matrix1).intersects(path.getBounds(matrix2),1e-12)?Curve.getIntersections(this.getCurves(),!self&&path.getCurves(),include,matrix1,matrix2,_returnFirst):[];},getCrossings:function(path){return this.getIntersections(path,function(inter){return inter.isCrossing();});},getNearestLocation:function(){var point=Point.read(arguments),curves=this.getCurves(),minDist=Infinity,minLoc=null;for(var i=0,l=curves.length;i<l;i++){var loc=curves[i].getNearestLocation(point);if(loc._distance<minDist){minDist=loc._distance;minLoc=loc;}}
return minLoc;},getNearestPoint:function(){var loc=this.getNearestLocation.apply(this,arguments);return loc?loc.getPoint():loc;},interpolate:function(from,to,factor){var isPath=!this._children,name=isPath?'_segments':'_children',itemsFrom=from[name],itemsTo=to[name],items=this[name];if(!itemsFrom||!itemsTo||itemsFrom.length!==itemsTo.length){throw new Error('Invalid operands in interpolate() call: '+
from+', '+to);}
var current=items.length,length=itemsTo.length;if(current<length){var ctor=isPath?Segment:Path;for(var i=current;i<length;i++){this.add(new ctor());}}else if(current>length){this[isPath?'removeSegments':'removeChildren'](length,current);}
for(var i=0;i<length;i++){items[i].interpolate(itemsFrom[i],itemsTo[i],factor);}
if(isPath){this.setClosed(from._closed);this._changed(9);}},compare:function(path){var ok=false;if(path){var paths1=this._children||[this],paths2=path._children?path._children.slice():[path],length1=paths1.length,length2=paths2.length,matched=[],count=0;ok=true;var boundsOverlaps=CollisionDetection.findItemBoundsCollisions(paths1,paths2,Numerical.GEOMETRIC_EPSILON);for(var i1=length1-1;i1>=0&&ok;i1--){var path1=paths1[i1];ok=false;var pathBoundsOverlaps=boundsOverlaps[i1];if(pathBoundsOverlaps){for(var i2=pathBoundsOverlaps.length-1;i2>=0&&!ok;i2--){if(path1.compare(paths2[pathBoundsOverlaps[i2]])){if(!matched[pathBoundsOverlaps[i2]]){matched[pathBoundsOverlaps[i2]]=true;count++;}
ok=true;}}}}
ok=ok&&count===length2;}
return ok;},});var Path=PathItem.extend({_class:'Path',_serializeFields:{segments:[],closed:false},initialize:function Path(arg){this._closed=false;this._segments=[];this._version=0;var args=arguments,segments=Array.isArray(arg)?typeof arg[0]==='object'?arg:args:arg&&(arg.size===undefined&&(arg.x!==undefined||arg.point!==undefined))?args:null;if(segments&&segments.length>0){this.setSegments(segments);}else{this._curves=undefined;this._segmentSelection=0;if(!segments&&typeof arg==='string'){this.setPathData(arg);arg=null;}}
this._initialize(!segments&&arg);},_equals:function(item){return this._closed===item._closed&&Base.equals(this._segments,item._segments);},copyContent:function(source){this.setSegments(source._segments);this._closed=source._closed;},_changed:function _changed(flags){_changed.base.call(this,flags);if(flags&8){this._length=this._area=undefined;if(flags&32){this._version++;}else if(this._curves){for(var i=0,l=this._curves.length;i<l;i++)
this._curves[i]._changed();}}else if(flags&64){this._bounds=undefined;}},getStyle:function(){var parent=this._parent;return(parent instanceof CompoundPath?parent:this)._style;},getSegments:function(){return this._segments;},setSegments:function(segments){var fullySelected=this.isFullySelected(),length=segments&&segments.length;this._segments.length=0;this._segmentSelection=0;this._curves=undefined;if(length){var last=segments[length-1];if(typeof last==='boolean'){this.setClosed(last);length--;}
this._add(Segment.readList(segments,0,{},length));}
if(fullySelected)
this.setFullySelected(true);},getFirstSegment:function(){return this._segments[0];},getLastSegment:function(){return this._segments[this._segments.length-1];},getCurves:function(){var curves=this._curves,segments=this._segments;if(!curves){var length=this._countCurves();curves=this._curves=new Array(length);for(var i=0;i<length;i++)
curves[i]=new Curve(this,segments[i],segments[i+1]||segments[0]);}
return curves;},getFirstCurve:function(){return this.getCurves()[0];},getLastCurve:function(){var curves=this.getCurves();return curves[curves.length-1];},isClosed:function(){return this._closed;},setClosed:function(closed){if(this._closed!=(closed=!!closed)){this._closed=closed;if(this._curves){var length=this._curves.length=this._countCurves();if(closed)
this._curves[length-1]=new Curve(this,this._segments[length-1],this._segments[0]);}
this._changed(41);}}},{beans:true,getPathData:function(_matrix,_precision){var segments=this._segments,length=segments.length,f=new Formatter(_precision),coords=new Array(6),first=true,curX,curY,prevX,prevY,inX,inY,outX,outY,parts=[];function addSegment(segment,skipLine){segment._transformCoordinates(_matrix,coords);curX=coords[0];curY=coords[1];if(first){parts.push('M'+f.pair(curX,curY));first=false;}else{inX=coords[2];inY=coords[3];if(inX===curX&&inY===curY&&outX===prevX&&outY===prevY){if(!skipLine){var dx=curX-prevX,dy=curY-prevY;parts.push(dx===0?'v'+f.number(dy):dy===0?'h'+f.number(dx):'l'+f.pair(dx,dy));}}else{parts.push('c'+f.pair(outX-prevX,outY-prevY)
+' '+f.pair(inX-prevX,inY-prevY)
+' '+f.pair(curX-prevX,curY-prevY));}}
prevX=curX;prevY=curY;outX=coords[4];outY=coords[5];}
if(!length)
return'';for(var i=0;i<length;i++)
addSegment(segments[i]);if(this._closed&&length>0){addSegment(segments[0],true);parts.push('z');}
return parts.join('');},isEmpty:function(){return!this._segments.length;},_transformContent:function(matrix){var segments=this._segments,coords=new Array(6);for(var i=0,l=segments.length;i<l;i++)
segments[i]._transformCoordinates(matrix,coords,true);return true;},_add:function(segs,index){var segments=this._segments,curves=this._curves,amount=segs.length,append=index==null,index=append?segments.length:index;for(var i=0;i<amount;i++){var segment=segs[i];if(segment._path)
segment=segs[i]=segment.clone();segment._path=this;segment._index=index+i;if(segment._selection)
this._updateSelection(segment,0,segment._selection);}
if(append){Base.push(segments,segs);}else{segments.splice.apply(segments,[index,0].concat(segs));for(var i=index+amount,l=segments.length;i<l;i++)
segments[i]._index=i;}
if(curves){var total=this._countCurves(),start=index>0&&index+amount-1===total?index-1:index,insert=start,end=Math.min(start+amount,total);if(segs._curves){curves.splice.apply(curves,[start,0].concat(segs._curves));insert+=segs._curves.length;}
for(var i=insert;i<end;i++)
curves.splice(i,0,new Curve(this,null,null));this._adjustCurves(start,end);}
this._changed(41);return segs;},_adjustCurves:function(start,end){var segments=this._segments,curves=this._curves,curve;for(var i=start;i<end;i++){curve=curves[i];curve._path=this;curve._segment1=segments[i];curve._segment2=segments[i+1]||segments[0];curve._changed();}
if(curve=curves[this._closed&&!start?segments.length-1:start-1]){curve._segment2=segments[start]||segments[0];curve._changed();}
if(curve=curves[end]){curve._segment1=segments[end];curve._changed();}},_countCurves:function(){var length=this._segments.length;return!this._closed&&length>0?length-1:length;},add:function(segment1){var args=arguments;return args.length>1&&typeof segment1!=='number'?this._add(Segment.readList(args)):this._add([Segment.read(args)])[0];},insert:function(index,segment1){var args=arguments;return args.length>2&&typeof segment1!=='number'?this._add(Segment.readList(args,1),index):this._add([Segment.read(args,1)],index)[0];},addSegment:function(){return this._add([Segment.read(arguments)])[0];},insertSegment:function(index){return this._add([Segment.read(arguments,1)],index)[0];},addSegments:function(segments){return this._add(Segment.readList(segments));},insertSegments:function(index,segments){return this._add(Segment.readList(segments),index);},removeSegment:function(index){return this.removeSegments(index,index+1)[0]||null;},removeSegments:function(start,end,_includeCurves){start=start||0;end=Base.pick(end,this._segments.length);var segments=this._segments,curves=this._curves,count=segments.length,removed=segments.splice(start,end-start),amount=removed.length;if(!amount)
return removed;for(var i=0;i<amount;i++){var segment=removed[i];if(segment._selection)
this._updateSelection(segment,segment._selection,0);segment._index=segment._path=null;}
for(var i=start,l=segments.length;i<l;i++)
segments[i]._index=i;if(curves){var index=start>0&&end===count+(this._closed?1:0)?start-1:start,curves=curves.splice(index,amount);for(var i=curves.length-1;i>=0;i--)
curves[i]._path=null;if(_includeCurves)
removed._curves=curves.slice(1);this._adjustCurves(index,index);}
this._changed(41);return removed;},clear:'#removeSegments',hasHandles:function(){var segments=this._segments;for(var i=0,l=segments.length;i<l;i++){if(segments[i].hasHandles())
return true;}
return false;},clearHandles:function(){var segments=this._segments;for(var i=0,l=segments.length;i<l;i++)
segments[i].clearHandles();},getLength:function(){if(this._length==null){var curves=this.getCurves(),length=0;for(var i=0,l=curves.length;i<l;i++)
length+=curves[i].getLength();this._length=length;}
return this._length;},getArea:function(){var area=this._area;if(area==null){var segments=this._segments,closed=this._closed;area=0;for(var i=0,l=segments.length;i<l;i++){var last=i+1===l;area+=Curve.getArea(Curve.getValues(segments[i],segments[last?0:i+1],null,last&&!closed));}
this._area=area;}
return area;},isFullySelected:function(){var length=this._segments.length;return this.isSelected()&&length>0&&this._segmentSelection===length*7;},setFullySelected:function(selected){if(selected)
this._selectSegments(true);this.setSelected(selected);},setSelection:function setSelection(selection){if(!(selection&1))
this._selectSegments(false);setSelection.base.call(this,selection);},_selectSegments:function(selected){var segments=this._segments,length=segments.length,selection=selected?7:0;this._segmentSelection=selection*length;for(var i=0;i<length;i++)
segments[i]._selection=selection;},_updateSelection:function(segment,oldSelection,newSelection){segment._selection=newSelection;var selection=this._segmentSelection+=newSelection-oldSelection;if(selection>0)
this.setSelected(true);},divideAt:function(location){var loc=this.getLocationAt(location),curve;return loc&&(curve=loc.getCurve().divideAt(loc.getCurveOffset()))?curve._segment1:null;},splitAt:function(location){var loc=this.getLocationAt(location),index=loc&&loc.index,time=loc&&loc.time,tMin=1e-8,tMax=1-tMin;if(time>tMax){index++;time=0;}
var curves=this.getCurves();if(index>=0&&index<curves.length){if(time>=tMin){curves[index++].divideAtTime(time);}
var segs=this.removeSegments(index,this._segments.length,true),path;if(this._closed){this.setClosed(false);path=this;}else{path=new Path(Item.NO_INSERT);path.insertAbove(this);path.copyAttributes(this);}
path._add(segs,0);this.addSegment(segs[0]);return path;}
return null;},split:function(index,time){var curve,location=time===undefined?index:(curve=this.getCurves()[index])&&curve.getLocationAtTime(time);return location!=null?this.splitAt(location):null;},join:function(path,tolerance){var epsilon=tolerance||0;if(path&&path!==this){var segments=path._segments,last1=this.getLastSegment(),last2=path.getLastSegment();if(!last2)
return this;if(last1&&last1._point.isClose(last2._point,epsilon))
path.reverse();var first2=path.getFirstSegment();if(last1&&last1._point.isClose(first2._point,epsilon)){last1.setHandleOut(first2._handleOut);this._add(segments.slice(1));}else{var first1=this.getFirstSegment();if(first1&&first1._point.isClose(first2._point,epsilon))
path.reverse();last2=path.getLastSegment();if(first1&&first1._point.isClose(last2._point,epsilon)){first1.setHandleIn(last2._handleIn);this._add(segments.slice(0,segments.length-1),0);}else{this._add(segments.slice());}}
if(path._closed)
this._add([segments[0]]);path.remove();}
var first=this.getFirstSegment(),last=this.getLastSegment();if(first!==last&&first._point.isClose(last._point,epsilon)){first.setHandleIn(last._handleIn);last.remove();this.setClosed(true);}
return this;},reduce:function(options){var curves=this.getCurves(),simplify=options&&options.simplify,tolerance=simplify?1e-7:0;for(var i=curves.length-1;i>=0;i--){var curve=curves[i];if(!curve.hasHandles()&&(!curve.hasLength(tolerance)||simplify&&curve.isCollinear(curve.getNext())))
curve.remove();}
return this;},reverse:function(){this._segments.reverse();for(var i=0,l=this._segments.length;i<l;i++){var segment=this._segments[i];var handleIn=segment._handleIn;segment._handleIn=segment._handleOut;segment._handleOut=handleIn;segment._index=i;}
this._curves=null;this._changed(9);},flatten:function(flatness){var flattener=new PathFlattener(this,flatness||0.25,256,true),parts=flattener.parts,length=parts.length,segments=[];for(var i=0;i<length;i++){segments.push(new Segment(parts[i].curve.slice(0,2)));}
if(!this._closed&&length>0){segments.push(new Segment(parts[length-1].curve.slice(6)));}
this.setSegments(segments);},simplify:function(tolerance){var segments=new PathFitter(this).fit(tolerance||2.5);if(segments)
this.setSegments(segments);return!!segments;},smooth:function(options){var that=this,opts=options||{},type=opts.type||'asymmetric',segments=this._segments,length=segments.length,closed=this._closed;function getIndex(value,_default){var index=value&&value.index;if(index!=null){var path=value.path;if(path&&path!==that)
throw new Error(value._class+' '+index+' of '+path
+' is not part of '+that);if(_default&&value instanceof Curve)
index++;}else{index=typeof value==='number'?value:_default;}
return Math.min(index<0&&closed?index%length:index<0?index+length:index,length-1);}
var loop=closed&&opts.from===undefined&&opts.to===undefined,from=getIndex(opts.from,0),to=getIndex(opts.to,length-1);if(from>to){if(closed){from-=length;}else{var tmp=from;from=to;to=tmp;}}
if(/^(?:asymmetric|continuous)$/.test(type)){var asymmetric=type==='asymmetric',min=Math.min,amount=to-from+1,n=amount-1,padding=loop?min(amount,4):1,paddingLeft=padding,paddingRight=padding,knots=[];if(!closed){paddingLeft=min(1,from);paddingRight=min(1,length-to-1);}
n+=paddingLeft+paddingRight;if(n<=1)
return;for(var i=0,j=from-paddingLeft;i<=n;i++,j++){knots[i]=segments[(j<0?j+length:j)%length]._point;}
var x=knots[0]._x+2*knots[1]._x,y=knots[0]._y+2*knots[1]._y,f=2,n_1=n-1,rx=[x],ry=[y],rf=[f],px=[],py=[];for(var i=1;i<n;i++){var internal=i<n_1,a=internal?1:asymmetric?1:2,b=internal?4:asymmetric?2:7,u=internal?4:asymmetric?3:8,v=internal?2:asymmetric?0:1,m=a / f;f=rf[i]=b-m;x=rx[i]=u*knots[i]._x+v*knots[i+1]._x-m*x;y=ry[i]=u*knots[i]._y+v*knots[i+1]._y-m*y;}
px[n_1]=rx[n_1]/ rf[n_1];py[n_1]=ry[n_1]/ rf[n_1];for(var i=n-2;i>=0;i--){px[i]=(rx[i]-px[i+1])/ rf[i];py[i]=(ry[i]-py[i+1])/ rf[i];}
px[n]=(3*knots[n]._x-px[n_1])/ 2;py[n]=(3*knots[n]._y-py[n_1])/ 2;for(var i=paddingLeft,max=n-paddingRight,j=from;i<=max;i++,j++){var segment=segments[j<0?j+length:j],pt=segment._point,hx=px[i]-pt._x,hy=py[i]-pt._y;if(loop||i<max)
segment.setHandleOut(hx,hy);if(loop||i>paddingLeft)
segment.setHandleIn(-hx,-hy);}}else{for(var i=from;i<=to;i++){segments[i<0?i+length:i].smooth(opts,!loop&&i===from,!loop&&i===to);}}},toShape:function(insert){if(!this._closed)
return null;var segments=this._segments,type,size,radius,topCenter;function isCollinear(i,j){var seg1=segments[i],seg2=seg1.getNext(),seg3=segments[j],seg4=seg3.getNext();return seg1._handleOut.isZero()&&seg2._handleIn.isZero()&&seg3._handleOut.isZero()&&seg4._handleIn.isZero()&&seg2._point.subtract(seg1._point).isCollinear(seg4._point.subtract(seg3._point));}
function isOrthogonal(i){var seg2=segments[i],seg1=seg2.getPrevious(),seg3=seg2.getNext();return seg1._handleOut.isZero()&&seg2._handleIn.isZero()&&seg2._handleOut.isZero()&&seg3._handleIn.isZero()&&seg2._point.subtract(seg1._point).isOrthogonal(seg3._point.subtract(seg2._point));}
function isArc(i){var seg1=segments[i],seg2=seg1.getNext(),handle1=seg1._handleOut,handle2=seg2._handleIn,kappa=0.5522847498307936;if(handle1.isOrthogonal(handle2)){var pt1=seg1._point,pt2=seg2._point,corner=new Line(pt1,handle1,true).intersect(new Line(pt2,handle2,true),true);return corner&&Numerical.isZero(handle1.getLength()/
corner.subtract(pt1).getLength()-kappa)&&Numerical.isZero(handle2.getLength()/
corner.subtract(pt2).getLength()-kappa);}
return false;}
function getDistance(i,j){return segments[i]._point.getDistance(segments[j]._point);}
if(!this.hasHandles()&&segments.length===4&&isCollinear(0,2)&&isCollinear(1,3)&&isOrthogonal(1)){type=Shape.Rectangle;size=new Size(getDistance(0,3),getDistance(0,1));topCenter=segments[1]._point.add(segments[2]._point).divide(2);}else if(segments.length===8&&isArc(0)&&isArc(2)&&isArc(4)&&isArc(6)&&isCollinear(1,5)&&isCollinear(3,7)){type=Shape.Rectangle;size=new Size(getDistance(1,6),getDistance(0,3));radius=size.subtract(new Size(getDistance(0,7),getDistance(1,2))).divide(2);topCenter=segments[3]._point.add(segments[4]._point).divide(2);}else if(segments.length===4&&isArc(0)&&isArc(1)&&isArc(2)&&isArc(3)){if(Numerical.isZero(getDistance(0,2)-getDistance(1,3))){type=Shape.Circle;radius=getDistance(0,2)/ 2;}else{type=Shape.Ellipse;radius=new Size(getDistance(2,0)/ 2,getDistance(3,1)/ 2);}
topCenter=segments[1]._point;}
if(type){var center=this.getPosition(true),shape=new type({center:center,size:size,radius:radius,insert:false});shape.copyAttributes(this,true);shape._matrix.prepend(this._matrix);shape.rotate(topCenter.subtract(center).getAngle()+90);if(insert===undefined||insert)
shape.insertAbove(this);return shape;}
return null;},toPath:'#clone',compare:function compare(path){if(!path||path instanceof CompoundPath)
return compare.base.call(this,path);var curves1=this.getCurves(),curves2=path.getCurves(),length1=curves1.length,length2=curves2.length;if(!length1||!length2){return length1==length2;}
var v1=curves1[0].getValues(),values2=[],pos1=0,pos2,end1=0,end2;for(var i=0;i<length2;i++){var v2=curves2[i].getValues();values2.push(v2);var overlaps=Curve.getOverlaps(v1,v2);if(overlaps){pos2=!i&&overlaps[0][0]>0?length2-1:i;end2=overlaps[0][1];break;}}
var abs=Math.abs,epsilon=1e-8,v2=values2[pos2],start2;while(v1&&v2){var overlaps=Curve.getOverlaps(v1,v2);if(overlaps){var t1=overlaps[0][0];if(abs(t1-end1)<epsilon){end1=overlaps[1][0];if(end1===1){v1=++pos1<length1?curves1[pos1].getValues():null;end1=0;}
var t2=overlaps[0][1];if(abs(t2-end2)<epsilon){if(!start2)
start2=[pos2,t2];end2=overlaps[1][1];if(end2===1){if(++pos2>=length2)
pos2=0;v2=values2[pos2]||curves2[pos2].getValues();end2=0;}
if(!v1){return start2[0]===pos2&&start2[1]===end2;}
continue;}}}
break;}
return false;},_hitTestSelf:function(point,options,viewMatrix,strokeMatrix){var that=this,style=this.getStyle(),segments=this._segments,numSegments=segments.length,closed=this._closed,tolerancePadding=options._tolerancePadding,strokePadding=tolerancePadding,join,cap,miterLimit,area,loc,res,hitStroke=options.stroke&&style.hasStroke(),hitFill=options.fill&&style.hasFill(),hitCurves=options.curves,strokeRadius=hitStroke?style.getStrokeWidth()/ 2:hitFill&&options.tolerance>0||hitCurves?0:null;if(strokeRadius!==null){if(strokeRadius>0){join=style.getStrokeJoin();cap=style.getStrokeCap();miterLimit=style.getMiterLimit();strokePadding=strokePadding.add(Path._getStrokePadding(strokeRadius,strokeMatrix));}else{join=cap='round';}}
function isCloseEnough(pt,padding){return point.subtract(pt).divide(padding).length<=1;}
function checkSegmentPoint(seg,pt,name){if(!options.selected||pt.isSelected()){var anchor=seg._point;if(pt!==anchor)
pt=pt.add(anchor);if(isCloseEnough(pt,strokePadding)){return new HitResult(name,that,{segment:seg,point:pt});}}}
function checkSegmentPoints(seg,ends){return(ends||options.segments)&&checkSegmentPoint(seg,seg._point,'segment')||(!ends&&options.handles)&&(checkSegmentPoint(seg,seg._handleIn,'handle-in')||checkSegmentPoint(seg,seg._handleOut,'handle-out'));}
function addToArea(point){area.add(point);}
function checkSegmentStroke(segment){var isJoin=closed||segment._index>0&&segment._index<numSegments-1;if((isJoin?join:cap)==='round'){return isCloseEnough(segment._point,strokePadding);}else{area=new Path({internal:true,closed:true});if(isJoin){if(!segment.isSmooth()){Path._addBevelJoin(segment,join,strokeRadius,miterLimit,null,strokeMatrix,addToArea,true);}}else if(cap==='square'){Path._addSquareCap(segment,cap,strokeRadius,null,strokeMatrix,addToArea,true);}
if(!area.isEmpty()){var loc;return area.contains(point)||(loc=area.getNearestLocation(point))&&isCloseEnough(loc.getPoint(),tolerancePadding);}}}
if(options.ends&&!options.segments&&!closed){if(res=checkSegmentPoints(segments[0],true)||checkSegmentPoints(segments[numSegments-1],true))
return res;}else if(options.segments||options.handles){for(var i=0;i<numSegments;i++)
if(res=checkSegmentPoints(segments[i]))
return res;}
if(strokeRadius!==null){loc=this.getNearestLocation(point);if(loc){var time=loc.getTime();if(time===0||time===1&&numSegments>1){if(!checkSegmentStroke(loc.getSegment()))
loc=null;}else if(!isCloseEnough(loc.getPoint(),strokePadding)){loc=null;}}
if(!loc&&join==='miter'&&numSegments>1){for(var i=0;i<numSegments;i++){var segment=segments[i];if(point.getDistance(segment._point)<=miterLimit*strokeRadius&&checkSegmentStroke(segment)){loc=segment.getLocation();break;}}}}
return!loc&&hitFill&&this._contains(point)||loc&&!hitStroke&&!hitCurves?new HitResult('fill',this):loc?new HitResult(hitStroke?'stroke':'curve',this,{location:loc,point:loc.getPoint()}):null;}},Base.each(Curve._evaluateMethods,function(name){this[name+'At']=function(offset){var loc=this.getLocationAt(offset);return loc&&loc[name]();};},{beans:false,getLocationOf:function(){var point=Point.read(arguments),curves=this.getCurves();for(var i=0,l=curves.length;i<l;i++){var loc=curves[i].getLocationOf(point);if(loc)
return loc;}
return null;},getOffsetOf:function(){var loc=this.getLocationOf.apply(this,arguments);return loc?loc.getOffset():null;},getLocationAt:function(offset){if(typeof offset==='number'){var curves=this.getCurves(),length=0;for(var i=0,l=curves.length;i<l;i++){var start=length,curve=curves[i];length+=curve.getLength();if(length>offset){return curve.getLocationAt(offset-start);}}
if(curves.length>0&&offset<=this.getLength()){return new CurveLocation(curves[curves.length-1],1);}}else if(offset&&offset.getPath&&offset.getPath()===this){return offset;}
return null;},getOffsetsWithTangent:function(){var tangent=Point.read(arguments);if(tangent.isZero()){return[];}
var offsets=[];var curveStart=0;var curves=this.getCurves();for(var i=0,l=curves.length;i<l;i++){var curve=curves[i];var curveTimes=curve.getTimesWithTangent(tangent);for(var j=0,m=curveTimes.length;j<m;j++){var offset=curveStart+curve.getOffsetAtTime(curveTimes[j]);if(offsets.indexOf(offset)<0){offsets.push(offset);}}
curveStart+=curve.length;}
return offsets;}}),new function(){function drawHandles(ctx,segments,matrix,size){if(size<=0)return;var half=size / 2,miniSize=size-2,miniHalf=half-1,coords=new Array(6),pX,pY;function drawHandle(index){var hX=coords[index],hY=coords[index+1];if(pX!=hX||pY!=hY){ctx.beginPath();ctx.moveTo(pX,pY);ctx.lineTo(hX,hY);ctx.stroke();ctx.beginPath();ctx.arc(hX,hY,half,0,Math.PI*2,true);ctx.fill();}}
for(var i=0,l=segments.length;i<l;i++){var segment=segments[i],selection=segment._selection;segment._transformCoordinates(matrix,coords);pX=coords[0];pY=coords[1];if(selection&2)
drawHandle(2);if(selection&4)
drawHandle(4);ctx.fillRect(pX-half,pY-half,size,size);if(miniSize>0&&!(selection&1)){var fillStyle=ctx.fillStyle;ctx.fillStyle='#ffffff';ctx.fillRect(pX-miniHalf,pY-miniHalf,miniSize,miniSize);ctx.fillStyle=fillStyle;}}}
function drawSegments(ctx,path,matrix){var segments=path._segments,length=segments.length,coords=new Array(6),first=true,curX,curY,prevX,prevY,inX,inY,outX,outY;function drawSegment(segment){if(matrix){segment._transformCoordinates(matrix,coords);curX=coords[0];curY=coords[1];}else{var point=segment._point;curX=point._x;curY=point._y;}
if(first){ctx.moveTo(curX,curY);first=false;}else{if(matrix){inX=coords[2];inY=coords[3];}else{var handle=segment._handleIn;inX=curX+handle._x;inY=curY+handle._y;}
if(inX===curX&&inY===curY&&outX===prevX&&outY===prevY){ctx.lineTo(curX,curY);}else{ctx.bezierCurveTo(outX,outY,inX,inY,curX,curY);}}
prevX=curX;prevY=curY;if(matrix){outX=coords[4];outY=coords[5];}else{var handle=segment._handleOut;outX=prevX+handle._x;outY=prevY+handle._y;}}
for(var i=0;i<length;i++)
drawSegment(segments[i]);if(path._closed&&length>0)
drawSegment(segments[0]);}
return{_draw:function(ctx,param,viewMatrix,strokeMatrix){var dontStart=param.dontStart,dontPaint=param.dontFinish||param.clip,style=this.getStyle(),hasFill=style.hasFill(),hasStroke=style.hasStroke(),dashArray=style.getDashArray(),dashLength=!paper.support.nativeDash&&hasStroke&&dashArray&&dashArray.length;if(!dontStart)
ctx.beginPath();if(hasFill||hasStroke&&!dashLength||dontPaint){drawSegments(ctx,this,strokeMatrix);if(this._closed)
ctx.closePath();}
function getOffset(i){return dashArray[((i%dashLength)+dashLength)%dashLength];}
if(!dontPaint&&(hasFill||hasStroke)){this._setStyles(ctx,param,viewMatrix);if(hasFill){ctx.fill(style.getFillRule());ctx.shadowColor='rgba(0,0,0,0)';}
if(hasStroke){if(dashLength){if(!dontStart)
ctx.beginPath();var flattener=new PathFlattener(this,0.25,32,false,strokeMatrix),length=flattener.length,from=-style.getDashOffset(),to,i=0;while(from>0){from-=getOffset(i--)+getOffset(i--);}
while(from<length){to=from+getOffset(i++);if(from>0||to>0)
flattener.drawPart(ctx,Math.max(from,0),Math.max(to,0));from=to+getOffset(i++);}}
ctx.stroke();}}},_drawSelected:function(ctx,matrix){ctx.beginPath();drawSegments(ctx,this,matrix);ctx.stroke();drawHandles(ctx,this._segments,matrix,paper.settings.handleSize);}};},new function(){function getCurrentSegment(that){var segments=that._segments;if(!segments.length)
throw new Error('Use a moveTo() command first');return segments[segments.length-1];}
return{moveTo:function(){var segments=this._segments;if(segments.length===1)
this.removeSegment(0);if(!segments.length)
this._add([new Segment(Point.read(arguments))]);},moveBy:function(){throw new Error('moveBy() is unsupported on Path items.');},lineTo:function(){this._add([new Segment(Point.read(arguments))]);},cubicCurveTo:function(){var args=arguments,handle1=Point.read(args),handle2=Point.read(args),to=Point.read(args),current=getCurrentSegment(this);current.setHandleOut(handle1.subtract(current._point));this._add([new Segment(to,handle2.subtract(to))]);},quadraticCurveTo:function(){var args=arguments,handle=Point.read(args),to=Point.read(args),current=getCurrentSegment(this)._point;this.cubicCurveTo(handle.add(current.subtract(handle).multiply(1 / 3)),handle.add(to.subtract(handle).multiply(1 / 3)),to);},curveTo:function(){var args=arguments,through=Point.read(args),to=Point.read(args),t=Base.pick(Base.read(args),0.5),t1=1-t,current=getCurrentSegment(this)._point,handle=through.subtract(current.multiply(t1*t1)).subtract(to.multiply(t*t)).divide(2*t*t1);if(handle.isNaN())
throw new Error('Cannot put a curve through points with parameter = '+t);this.quadraticCurveTo(handle,to);},arcTo:function(){var args=arguments,abs=Math.abs,sqrt=Math.sqrt,current=getCurrentSegment(this),from=current._point,to=Point.read(args),through,peek=Base.peek(args),clockwise=Base.pick(peek,true),center,extent,vector,matrix;if(typeof clockwise==='boolean'){var middle=from.add(to).divide(2),through=middle.add(middle.subtract(from).rotate(clockwise?-90:90));}else if(Base.remain(args)<=2){through=to;to=Point.read(args);}else if(!from.equals(to)){var radius=Size.read(args),isZero=Numerical.isZero;if(isZero(radius.width)||isZero(radius.height))
return this.lineTo(to);var rotation=Base.read(args),clockwise=!!Base.read(args),large=!!Base.read(args),middle=from.add(to).divide(2),pt=from.subtract(middle).rotate(-rotation),x=pt.x,y=pt.y,rx=abs(radius.width),ry=abs(radius.height),rxSq=rx*rx,rySq=ry*ry,xSq=x*x,ySq=y*y;var factor=sqrt(xSq / rxSq+ySq / rySq);if(factor>1){rx*=factor;ry*=factor;rxSq=rx*rx;rySq=ry*ry;}
factor=(rxSq*rySq-rxSq*ySq-rySq*xSq)/
(rxSq*ySq+rySq*xSq);if(abs(factor)<1e-12)
factor=0;if(factor<0)
throw new Error('Cannot create an arc with the given arguments');center=new Point(rx*y / ry,-ry*x / rx).multiply((large===clockwise?-1:1)*sqrt(factor)).rotate(rotation).add(middle);matrix=new Matrix().translate(center).rotate(rotation).scale(rx,ry);vector=matrix._inverseTransform(from);extent=vector.getDirectedAngle(matrix._inverseTransform(to));if(!clockwise&&extent>0)
extent-=360;else if(clockwise&&extent<0)
extent+=360;}
if(through){var l1=new Line(from.add(through).divide(2),through.subtract(from).rotate(90),true),l2=new Line(through.add(to).divide(2),to.subtract(through).rotate(90),true),line=new Line(from,to),throughSide=line.getSide(through);center=l1.intersect(l2,true);if(!center){if(!throughSide)
return this.lineTo(to);throw new Error('Cannot create an arc with the given arguments');}
vector=from.subtract(center);extent=vector.getDirectedAngle(to.subtract(center));var centerSide=line.getSide(center,true);if(centerSide===0){extent=throughSide*abs(extent);}else if(throughSide===centerSide){extent+=extent<0?360:-360;}}
if(extent){var epsilon=1e-7,ext=abs(extent),count=ext>=360?4:Math.ceil((ext-epsilon)/ 90),inc=extent / count,half=inc*Math.PI / 360,z=4 / 3*Math.sin(half)/(1+Math.cos(half)),segments=[];for(var i=0;i<=count;i++){var pt=to,out=null;if(i<count){out=vector.rotate(90).multiply(z);if(matrix){pt=matrix._transformPoint(vector);out=matrix._transformPoint(vector.add(out)).subtract(pt);}else{pt=center.add(vector);}}
if(!i){current.setHandleOut(out);}else{var _in=vector.rotate(-90).multiply(z);if(matrix){_in=matrix._transformPoint(vector.add(_in)).subtract(pt);}
segments.push(new Segment(pt,_in,out));}
vector=vector.rotate(inc);}
this._add(segments);}},lineBy:function(){var to=Point.read(arguments),current=getCurrentSegment(this)._point;this.lineTo(current.add(to));},curveBy:function(){var args=arguments,through=Point.read(args),to=Point.read(args),parameter=Base.read(args),current=getCurrentSegment(this)._point;this.curveTo(current.add(through),current.add(to),parameter);},cubicCurveBy:function(){var args=arguments,handle1=Point.read(args),handle2=Point.read(args),to=Point.read(args),current=getCurrentSegment(this)._point;this.cubicCurveTo(current.add(handle1),current.add(handle2),current.add(to));},quadraticCurveBy:function(){var args=arguments,handle=Point.read(args),to=Point.read(args),current=getCurrentSegment(this)._point;this.quadraticCurveTo(current.add(handle),current.add(to));},arcBy:function(){var args=arguments,current=getCurrentSegment(this)._point,point=current.add(Point.read(args)),clockwise=Base.pick(Base.peek(args),true);if(typeof clockwise==='boolean'){this.arcTo(point,clockwise);}else{this.arcTo(point,current.add(Point.read(args)));}},closePath:function(tolerance){this.setClosed(true);this.join(this,tolerance);}};},{_getBounds:function(matrix,options){var method=options.handle?'getHandleBounds':options.stroke?'getStrokeBounds':'getBounds';return Path[method](this._segments,this._closed,this,matrix,options);},statics:{getBounds:function(segments,closed,path,matrix,options,strokePadding){var first=segments[0];if(!first)
return new Rectangle();var coords=new Array(6),prevCoords=first._transformCoordinates(matrix,new Array(6)),min=prevCoords.slice(0,2),max=min.slice(),roots=new Array(2);function processSegment(segment){segment._transformCoordinates(matrix,coords);for(var i=0;i<2;i++){Curve._addBounds(prevCoords[i],prevCoords[i+4],coords[i+2],coords[i],i,strokePadding?strokePadding[i]:0,min,max,roots);}
var tmp=prevCoords;prevCoords=coords;coords=tmp;}
for(var i=1,l=segments.length;i<l;i++)
processSegment(segments[i]);if(closed)
processSegment(first);return new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1]);},getStrokeBounds:function(segments,closed,path,matrix,options){var style=path.getStyle(),stroke=style.hasStroke(),strokeWidth=style.getStrokeWidth(),strokeMatrix=stroke&&path._getStrokeMatrix(matrix,options),strokePadding=stroke&&Path._getStrokePadding(strokeWidth,strokeMatrix),bounds=Path.getBounds(segments,closed,path,matrix,options,strokePadding);if(!stroke)
return bounds;var strokeRadius=strokeWidth / 2,join=style.getStrokeJoin(),cap=style.getStrokeCap(),miterLimit=style.getMiterLimit(),joinBounds=new Rectangle(new Size(strokePadding));function addPoint(point){bounds=bounds.include(point);}
function addRound(segment){bounds=bounds.unite(joinBounds.setCenter(segment._point.transform(matrix)));}
function addJoin(segment,join){if(join==='round'||segment.isSmooth()){addRound(segment);}else{Path._addBevelJoin(segment,join,strokeRadius,miterLimit,matrix,strokeMatrix,addPoint);}}
function addCap(segment,cap){if(cap==='round'){addRound(segment);}else{Path._addSquareCap(segment,cap,strokeRadius,matrix,strokeMatrix,addPoint);}}
var length=segments.length-(closed?0:1);if(length>0){for(var i=1;i<length;i++){addJoin(segments[i],join);}
if(closed){addJoin(segments[0],join);}else{addCap(segments[0],cap);addCap(segments[segments.length-1],cap);}}
return bounds;},_getStrokePadding:function(radius,matrix){if(!matrix)
return[radius,radius];var hor=new Point(radius,0).transform(matrix),ver=new Point(0,radius).transform(matrix),phi=hor.getAngleInRadians(),a=hor.getLength(),b=ver.getLength();var sin=Math.sin(phi),cos=Math.cos(phi),tan=Math.tan(phi),tx=Math.atan2(b*tan,a),ty=Math.atan2(b,tan*a);return[Math.abs(a*Math.cos(tx)*cos+b*Math.sin(tx)*sin),Math.abs(b*Math.sin(ty)*cos+a*Math.cos(ty)*sin)];},_addBevelJoin:function(segment,join,radius,miterLimit,matrix,strokeMatrix,addPoint,isArea){var curve2=segment.getCurve(),curve1=curve2.getPrevious(),point=curve2.getPoint1().transform(matrix),normal1=curve1.getNormalAtTime(1).multiply(radius).transform(strokeMatrix),normal2=curve2.getNormalAtTime(0).multiply(radius).transform(strokeMatrix),angle=normal1.getDirectedAngle(normal2);if(angle<0||angle>=180){normal1=normal1.negate();normal2=normal2.negate();}
if(isArea)
addPoint(point);addPoint(point.add(normal1));if(join==='miter'){var corner=new Line(point.add(normal1),new Point(-normal1.y,normal1.x),true).intersect(new Line(point.add(normal2),new Point(-normal2.y,normal2.x),true),true);if(corner&&point.getDistance(corner)<=miterLimit*radius){addPoint(corner);}}
addPoint(point.add(normal2));},_addSquareCap:function(segment,cap,radius,matrix,strokeMatrix,addPoint,isArea){var point=segment._point.transform(matrix),loc=segment.getLocation(),normal=loc.getNormal().multiply(loc.getTime()===0?radius:-radius).transform(strokeMatrix);if(cap==='square'){if(isArea){addPoint(point.subtract(normal));addPoint(point.add(normal));}
point=point.add(normal.rotate(-90));}
addPoint(point.add(normal));addPoint(point.subtract(normal));},getHandleBounds:function(segments,closed,path,matrix,options){var style=path.getStyle(),stroke=options.stroke&&style.hasStroke(),strokePadding,joinPadding;if(stroke){var strokeMatrix=path._getStrokeMatrix(matrix,options),strokeRadius=style.getStrokeWidth()/ 2,joinRadius=strokeRadius;if(style.getStrokeJoin()==='miter')
joinRadius=strokeRadius*style.getMiterLimit();if(style.getStrokeCap()==='square')
joinRadius=Math.max(joinRadius,strokeRadius*Math.SQRT2);strokePadding=Path._getStrokePadding(strokeRadius,strokeMatrix);joinPadding=Path._getStrokePadding(joinRadius,strokeMatrix);}
var coords=new Array(6),x1=Infinity,x2=-x1,y1=x1,y2=x2;for(var i=0,l=segments.length;i<l;i++){var segment=segments[i];segment._transformCoordinates(matrix,coords);for(var j=0;j<6;j+=2){var padding=!j?joinPadding:strokePadding,paddingX=padding?padding[0]:0,paddingY=padding?padding[1]:0,x=coords[j],y=coords[j+1],xn=x-paddingX,xx=x+paddingX,yn=y-paddingY,yx=y+paddingY;if(xn<x1)x1=xn;if(xx>x2)x2=xx;if(yn<y1)y1=yn;if(yx>y2)y2=yx;}}
return new Rectangle(x1,y1,x2-x1,y2-y1);}}});Path.inject({statics:new function(){var kappa=0.5522847498307936,ellipseSegments=[new Segment([-1,0],[0,kappa],[0,-kappa]),new Segment([0,-1],[-kappa,0],[kappa,0]),new Segment([1,0],[0,-kappa],[0,kappa]),new Segment([0,1],[kappa,0],[-kappa,0])];function createPath(segments,closed,args){var props=Base.getNamed(args),path=new Path(props&&props.insert==false&&Item.NO_INSERT);path._add(segments);path._closed=closed;return path.set(props,{insert:true});}
function createEllipse(center,radius,args){var segments=new Array(4);for(var i=0;i<4;i++){var segment=ellipseSegments[i];segments[i]=new Segment(segment._point.multiply(radius).add(center),segment._handleIn.multiply(radius),segment._handleOut.multiply(radius));}
return createPath(segments,true,args);}
return{Line:function(){var args=arguments;return createPath([new Segment(Point.readNamed(args,'from')),new Segment(Point.readNamed(args,'to'))],false,args);},Circle:function(){var args=arguments,center=Point.readNamed(args,'center'),radius=Base.readNamed(args,'radius');return createEllipse(center,new Size(radius),args);},Rectangle:function(){var args=arguments,rect=Rectangle.readNamed(args,'rectangle'),radius=Size.readNamed(args,'radius',0,{readNull:true}),bl=rect.getBottomLeft(true),tl=rect.getTopLeft(true),tr=rect.getTopRight(true),br=rect.getBottomRight(true),segments;if(!radius||radius.isZero()){segments=[new Segment(bl),new Segment(tl),new Segment(tr),new Segment(br)];}else{radius=Size.min(radius,rect.getSize(true).divide(2));var rx=radius.width,ry=radius.height,hx=rx*kappa,hy=ry*kappa;segments=[new Segment(bl.add(rx,0),null,[-hx,0]),new Segment(bl.subtract(0,ry),[0,hy]),new Segment(tl.add(0,ry),null,[0,-hy]),new Segment(tl.add(rx,0),[-hx,0],null),new Segment(tr.subtract(rx,0),null,[hx,0]),new Segment(tr.add(0,ry),[0,-hy],null),new Segment(br.subtract(0,ry),null,[0,hy]),new Segment(br.subtract(rx,0),[hx,0])];}
return createPath(segments,true,args);},RoundRectangle:'#Rectangle',Ellipse:function(){var args=arguments,ellipse=Shape._readEllipse(args);return createEllipse(ellipse.center,ellipse.radius,args);},Oval:'#Ellipse',Arc:function(){var args=arguments,from=Point.readNamed(args,'from'),through=Point.readNamed(args,'through'),to=Point.readNamed(args,'to'),props=Base.getNamed(args),path=new Path(props&&props.insert==false&&Item.NO_INSERT);path.moveTo(from);path.arcTo(through,to);return path.set(props);},RegularPolygon:function(){var args=arguments,center=Point.readNamed(args,'center'),sides=Base.readNamed(args,'sides'),radius=Base.readNamed(args,'radius'),step=360 / sides,three=sides%3===0,vector=new Point(0,three?-radius:radius),offset=three?-1:0.5,segments=new Array(sides);for(var i=0;i<sides;i++)
segments[i]=new Segment(center.add(vector.rotate((i+offset)*step)));return createPath(segments,true,args);},Star:function(){var args=arguments,center=Point.readNamed(args,'center'),points=Base.readNamed(args,'points')*2,radius1=Base.readNamed(args,'radius1'),radius2=Base.readNamed(args,'radius2'),step=360 / points,vector=new Point(0,-1),segments=new Array(points);for(var i=0;i<points;i++)
segments[i]=new Segment(center.add(vector.rotate(step*i).multiply(i%2?radius2:radius1)));return createPath(segments,true,args);}};}});var CompoundPath=PathItem.extend({_class:'CompoundPath',_serializeFields:{children:[]},beans:true,initialize:function CompoundPath(arg){this._children=[];this._namedChildren={};if(!this._initialize(arg)){if(typeof arg==='string'){this.setPathData(arg);}else{this.addChildren(Array.isArray(arg)?arg:arguments);}}},insertChildren:function insertChildren(index,items){var list=items,first=list[0];if(first&&typeof first[0]==='number')
list=[list];for(var i=items.length-1;i>=0;i--){var item=list[i];if(list===items&&!(item instanceof Path))
list=Base.slice(list);if(Array.isArray(item)){list[i]=new Path({segments:item,insert:false});}else if(item instanceof CompoundPath){list.splice.apply(list,[i,1].concat(item.removeChildren()));item.remove();}}
return insertChildren.base.call(this,index,list);},reduce:function reduce(options){var children=this._children;for(var i=children.length-1;i>=0;i--){var path=children[i].reduce(options);if(path.isEmpty())
path.remove();}
if(!children.length){var path=new Path(Item.NO_INSERT);path.copyAttributes(this);path.insertAbove(this);this.remove();return path;}
return reduce.base.call(this);},isClosed:function(){var children=this._children;for(var i=0,l=children.length;i<l;i++){if(!children[i]._closed)
return false;}
return true;},setClosed:function(closed){var children=this._children;for(var i=0,l=children.length;i<l;i++){children[i].setClosed(closed);}},getFirstSegment:function(){var first=this.getFirstChild();return first&&first.getFirstSegment();},getLastSegment:function(){var last=this.getLastChild();return last&&last.getLastSegment();},getCurves:function(){var children=this._children,curves=[];for(var i=0,l=children.length;i<l;i++){Base.push(curves,children[i].getCurves());}
return curves;},getFirstCurve:function(){var first=this.getFirstChild();return first&&first.getFirstCurve();},getLastCurve:function(){var last=this.getLastChild();return last&&last.getLastCurve();},getArea:function(){var children=this._children,area=0;for(var i=0,l=children.length;i<l;i++)
area+=children[i].getArea();return area;},getLength:function(){var children=this._children,length=0;for(var i=0,l=children.length;i<l;i++)
length+=children[i].getLength();return length;},getPathData:function(_matrix,_precision){var children=this._children,paths=[];for(var i=0,l=children.length;i<l;i++){var child=children[i],mx=child._matrix;paths.push(child.getPathData(_matrix&&!mx.isIdentity()?_matrix.appended(mx):_matrix,_precision));}
return paths.join('');},_hitTestChildren:function _hitTestChildren(point,options,viewMatrix){return _hitTestChildren.base.call(this,point,options.class===Path||options.type==='path'?options:Base.set({},options,{fill:false}),viewMatrix);},_draw:function(ctx,param,viewMatrix,strokeMatrix){var children=this._children;if(!children.length)
return;param=param.extend({dontStart:true,dontFinish:true});ctx.beginPath();for(var i=0,l=children.length;i<l;i++)
children[i].draw(ctx,param,strokeMatrix);if(!param.clip){this._setStyles(ctx,param,viewMatrix);var style=this._style;if(style.hasFill()){ctx.fill(style.getFillRule());ctx.shadowColor='rgba(0,0,0,0)';}
if(style.hasStroke())
ctx.stroke();}},_drawSelected:function(ctx,matrix,selectionItems){var children=this._children;for(var i=0,l=children.length;i<l;i++){var child=children[i],mx=child._matrix;if(!selectionItems[child._id]){child._drawSelected(ctx,mx.isIdentity()?matrix:matrix.appended(mx));}}}},new function(){function getCurrentPath(that,check){var children=that._children;if(check&&!children.length)
throw new Error('Use a moveTo() command first');return children[children.length-1];}
return Base.each(['lineTo','cubicCurveTo','quadraticCurveTo','curveTo','arcTo','lineBy','cubicCurveBy','quadraticCurveBy','curveBy','arcBy'],function(key){this[key]=function(){var path=getCurrentPath(this,true);path[key].apply(path,arguments);};},{moveTo:function(){var current=getCurrentPath(this),path=current&&current.isEmpty()?current:new Path(Item.NO_INSERT);if(path!==current)
this.addChild(path);path.moveTo.apply(path,arguments);},moveBy:function(){var current=getCurrentPath(this,true),last=current&&current.getLastSegment(),point=Point.read(arguments);this.moveTo(last?point.add(last._point):point);},closePath:function(tolerance){getCurrentPath(this,true).closePath(tolerance);}});},Base.each(['reverse','flatten','simplify','smooth'],function(key){this[key]=function(param){var children=this._children,res;for(var i=0,l=children.length;i<l;i++){res=children[i][key](param)||res;}
return res;};},{}));PathItem.inject(new function(){var min=Math.min,max=Math.max,abs=Math.abs,operators={unite:{'1':true,'2':true},intersect:{'2':true},subtract:{'1':true},exclude:{'1':true,'-1':true}};function getPaths(path){return path._children||[path];}
function preparePath(path,resolve){var res=path.clone(false).reduce({simplify:true}).transform(null,true,true);if(resolve){var paths=getPaths(res);for(var i=0,l=paths.length;i<l;i++){var path=paths[i];if(!path._closed&&!path.isEmpty()){path.closePath(1e-12);path.getFirstSegment().setHandleIn(0,0);path.getLastSegment().setHandleOut(0,0);}}
res=res.resolveCrossings().reorient(res.getFillRule()==='nonzero',true);}
return res;}
function createResult(paths,simplify,path1,path2,options){var result=new CompoundPath(Item.NO_INSERT);result.addChildren(paths,true);result=result.reduce({simplify:simplify});if(!(options&&options.insert==false)){result.insertAbove(path2&&path1.isSibling(path2)&&path1.getIndex()<path2.getIndex()?path2:path1);}
result.copyAttributes(path1,true);return result;}
function filterIntersection(inter){return inter.hasOverlap()||inter.isCrossing();}
function traceBoolean(path1,path2,operation,options){if(options&&(options.trace==false||options.stroke)&&/^(subtract|intersect)$/.test(operation))
return splitBoolean(path1,path2,operation);var _path1=preparePath(path1,true),_path2=path2&&path1!==path2&&preparePath(path2,true),operator=operators[operation];operator[operation]=true;if(_path2&&(operator.subtract||operator.exclude)^(_path2.isClockwise()^_path1.isClockwise()))
_path2.reverse();var crossings=divideLocations(CurveLocation.expand(_path1.getIntersections(_path2,filterIntersection))),paths1=getPaths(_path1),paths2=_path2&&getPaths(_path2),segments=[],curves=[],paths;function collectPaths(paths){for(var i=0,l=paths.length;i<l;i++){var path=paths[i];Base.push(segments,path._segments);Base.push(curves,path.getCurves());path._overlapsOnly=true;}}
function getCurves(indices){var list=[];for(var i=0,l=indices&&indices.length;i<l;i++){list.push(curves[indices[i]]);}
return list;}
if(crossings.length){collectPaths(paths1);if(paths2)
collectPaths(paths2);var curvesValues=new Array(curves.length);for(var i=0,l=curves.length;i<l;i++){curvesValues[i]=curves[i].getValues();}
var curveCollisions=CollisionDetection.findCurveBoundsCollisions(curvesValues,curvesValues,0,true);var curveCollisionsMap={};for(var i=0;i<curves.length;i++){var curve=curves[i],id=curve._path._id,map=curveCollisionsMap[id]=curveCollisionsMap[id]||{};map[curve.getIndex()]={hor:getCurves(curveCollisions[i].hor),ver:getCurves(curveCollisions[i].ver)};}
for(var i=0,l=crossings.length;i<l;i++){propagateWinding(crossings[i]._segment,_path1,_path2,curveCollisionsMap,operator);}
for(var i=0,l=segments.length;i<l;i++){var segment=segments[i],inter=segment._intersection;if(!segment._winding){propagateWinding(segment,_path1,_path2,curveCollisionsMap,operator);}
if(!(inter&&inter._overlap))
segment._path._overlapsOnly=false;}
paths=tracePaths(segments,operator);}else{paths=reorientPaths(paths2?paths1.concat(paths2):paths1.slice(),function(w){return!!operator[w];});}
return createResult(paths,true,path1,path2,options);}
function splitBoolean(path1,path2,operation){var _path1=preparePath(path1),_path2=preparePath(path2),crossings=_path1.getIntersections(_path2,filterIntersection),subtract=operation==='subtract',divide=operation==='divide',added={},paths=[];function addPath(path){if(!added[path._id]&&(divide||_path2.contains(path.getPointAt(path.getLength()/ 2))^subtract)){paths.unshift(path);return added[path._id]=true;}}
for(var i=crossings.length-1;i>=0;i--){var path=crossings[i].split();if(path){if(addPath(path))
path.getFirstSegment().setHandleIn(0,0);_path1.getLastSegment().setHandleOut(0,0);}}
addPath(_path1);return createResult(paths,false,path1,path2);}
function linkIntersections(from,to){var prev=from;while(prev){if(prev===to)
return;prev=prev._previous;}
while(from._next&&from._next!==to)
from=from._next;if(!from._next){while(to._previous)
to=to._previous;from._next=to;to._previous=from;}}
function clearCurveHandles(curves){for(var i=curves.length-1;i>=0;i--)
curves[i].clearHandles();}
function reorientPaths(paths,isInside,clockwise){var length=paths&&paths.length;if(length){var lookup=Base.each(paths,function(path,i){this[path._id]={container:null,winding:path.isClockwise()?1:-1,index:i};},{}),sorted=paths.slice().sort(function(a,b){return abs(b.getArea())-abs(a.getArea());}),first=sorted[0];var collisions=CollisionDetection.findItemBoundsCollisions(sorted,null,Numerical.GEOMETRIC_EPSILON);if(clockwise==null)
clockwise=first.isClockwise();for(var i=0;i<length;i++){var path1=sorted[i],entry1=lookup[path1._id],containerWinding=0,indices=collisions[i];if(indices){var point=null;for(var j=indices.length-1;j>=0;j--){if(indices[j]<i){point=point||path1.getInteriorPoint();var path2=sorted[indices[j]];if(path2.contains(point)){var entry2=lookup[path2._id];containerWinding=entry2.winding;entry1.winding+=containerWinding;entry1.container=entry2.exclude?entry2.container:path2;break;}}}}
if(isInside(entry1.winding)===isInside(containerWinding)){entry1.exclude=true;paths[entry1.index]=null;}else{var container=entry1.container;path1.setClockwise(container?!container.isClockwise():clockwise);}}}
return paths;}
function divideLocations(locations,include,clearLater){var results=include&&[],tMin=1e-8,tMax=1-tMin,clearHandles=false,clearCurves=clearLater||[],clearLookup=clearLater&&{},renormalizeLocs,prevCurve,prevTime;function getId(curve){return curve._path._id+'.'+curve._segment1._index;}
for(var i=(clearLater&&clearLater.length)-1;i>=0;i--){var curve=clearLater[i];if(curve._path)
clearLookup[getId(curve)]=true;}
for(var i=locations.length-1;i>=0;i--){var loc=locations[i],time=loc._time,origTime=time,exclude=include&&!include(loc),curve=loc._curve,segment;if(curve){if(curve!==prevCurve){clearHandles=!curve.hasHandles()||clearLookup&&clearLookup[getId(curve)];renormalizeLocs=[];prevTime=null;prevCurve=curve;}else if(prevTime>=tMin){time /=prevTime;}}
if(exclude){if(renormalizeLocs)
renormalizeLocs.push(loc);continue;}else if(include){results.unshift(loc);}
prevTime=origTime;if(time<tMin){segment=curve._segment1;}else if(time>tMax){segment=curve._segment2;}else{var newCurve=curve.divideAtTime(time,true);if(clearHandles)
clearCurves.push(curve,newCurve);segment=newCurve._segment1;for(var j=renormalizeLocs.length-1;j>=0;j--){var l=renormalizeLocs[j];l._time=(l._time-time)/(1-time);}}
loc._setSegment(segment);var inter=segment._intersection,dest=loc._intersection;if(inter){linkIntersections(inter,dest);var other=inter;while(other){linkIntersections(other._intersection,inter);other=other._next;}}else{segment._intersection=dest;}}
if(!clearLater)
clearCurveHandles(clearCurves);return results||locations;}
function getWinding(point,curves,dir,closed,dontFlip){var curvesList=Array.isArray(curves)?curves:curves[dir?'hor':'ver'];var ia=dir?1:0,io=ia^1,pv=[point.x,point.y],pa=pv[ia],po=pv[io],windingEpsilon=1e-9,qualityEpsilon=1e-6,paL=pa-windingEpsilon,paR=pa+windingEpsilon,windingL=0,windingR=0,pathWindingL=0,pathWindingR=0,onPath=false,onAnyPath=false,quality=1,roots=[],vPrev,vClose;function addWinding(v){var o0=v[io+0],o3=v[io+6];if(po<min(o0,o3)||po>max(o0,o3)){return;}
var a0=v[ia+0],a1=v[ia+2],a2=v[ia+4],a3=v[ia+6];if(o0===o3){if(a0<paR&&a3>paL||a3<paR&&a0>paL){onPath=true;}
return;}
var t=po===o0?0:po===o3?1:paL>max(a0,a1,a2,a3)||paR<min(a0,a1,a2,a3)?1:Curve.solveCubic(v,io,po,roots,0,1)>0?roots[0]:1,a=t===0?a0:t===1?a3:Curve.getPoint(v,t)[dir?'y':'x'],winding=o0>o3?1:-1,windingPrev=vPrev[io]>vPrev[io+6]?1:-1,a3Prev=vPrev[ia+6];if(po!==o0){if(a<paL){pathWindingL+=winding;}else if(a>paR){pathWindingR+=winding;}else{onPath=true;}
if(a>pa-qualityEpsilon&&a<pa+qualityEpsilon)
quality /=2;}else{if(winding!==windingPrev){if(a0<paL){pathWindingL+=winding;}else if(a0>paR){pathWindingR+=winding;}}else if(a0!=a3Prev){if(a3Prev<paR&&a>paR){pathWindingR+=winding;onPath=true;}else if(a3Prev>paL&&a<paL){pathWindingL+=winding;onPath=true;}}
quality /=4;}
vPrev=v;return!dontFlip&&a>paL&&a<paR&&Curve.getTangent(v,t)[dir?'x':'y']===0&&getWinding(point,curves,!dir,closed,true);}
function handleCurve(v){var o0=v[io+0],o1=v[io+2],o2=v[io+4],o3=v[io+6];if(po<=max(o0,o1,o2,o3)&&po>=min(o0,o1,o2,o3)){var a0=v[ia+0],a1=v[ia+2],a2=v[ia+4],a3=v[ia+6],monoCurves=paL>max(a0,a1,a2,a3)||paR<min(a0,a1,a2,a3)?[v]:Curve.getMonoCurves(v,dir),res;for(var i=0,l=monoCurves.length;i<l;i++){if(res=addWinding(monoCurves[i]))
return res;}}}
for(var i=0,l=curvesList.length;i<l;i++){var curve=curvesList[i],path=curve._path,v=curve.getValues(),res;if(!i||curvesList[i-1]._path!==path){vPrev=null;if(!path._closed){vClose=Curve.getValues(path.getLastCurve().getSegment2(),curve.getSegment1(),null,!closed);if(vClose[io]!==vClose[io+6]){vPrev=vClose;}}
if(!vPrev){vPrev=v;var prev=path.getLastCurve();while(prev&&prev!==curve){var v2=prev.getValues();if(v2[io]!==v2[io+6]){vPrev=v2;break;}
prev=prev.getPrevious();}}}
if(res=handleCurve(v))
return res;if(i+1===l||curvesList[i+1]._path!==path){if(vClose&&(res=handleCurve(vClose)))
return res;if(onPath&&!pathWindingL&&!pathWindingR){pathWindingL=pathWindingR=path.isClockwise(closed)^dir?1:-1;}
windingL+=pathWindingL;windingR+=pathWindingR;pathWindingL=pathWindingR=0;if(onPath){onAnyPath=true;onPath=false;}
vClose=null;}}
windingL=abs(windingL);windingR=abs(windingR);return{winding:max(windingL,windingR),windingL:windingL,windingR:windingR,quality:quality,onPath:onAnyPath};}
function propagateWinding(segment,path1,path2,curveCollisionsMap,operator){var chain=[],start=segment,totalLength=0,winding;do{var curve=segment.getCurve();if(curve){var length=curve.getLength();chain.push({segment:segment,curve:curve,length:length});totalLength+=length;}
segment=segment.getNext();}while(segment&&!segment._intersection&&segment!==start);var offsets=[0.5,0.25,0.75],winding={winding:0,quality:-1},tMin=1e-3,tMax=1-tMin;for(var i=0;i<offsets.length&&winding.quality<0.5;i++){var length=totalLength*offsets[i];for(var j=0,l=chain.length;j<l;j++){var entry=chain[j],curveLength=entry.length;if(length<=curveLength){var curve=entry.curve,path=curve._path,parent=path._parent,operand=parent instanceof CompoundPath?parent:path,t=Numerical.clamp(curve.getTimeAt(length),tMin,tMax),pt=curve.getPointAtTime(t),dir=abs(curve.getTangentAtTime(t).y)<Math.SQRT1_2;var wind=null;if(operator.subtract&&path2){var otherPath=operand===path1?path2:path1,pathWinding=otherPath._getWinding(pt,dir,true);if(operand===path1&&pathWinding.winding||operand===path2&&!pathWinding.winding){if(pathWinding.quality<1){continue;}else{wind={winding:0,quality:1};}}}
wind=wind||getWinding(pt,curveCollisionsMap[path._id][curve.getIndex()],dir,true);if(wind.quality>winding.quality)
winding=wind;break;}
length-=curveLength;}}
for(var j=chain.length-1;j>=0;j--){chain[j].segment._winding=winding;}}
function tracePaths(segments,operator){var paths=[],starts;function isValid(seg){var winding;return!!(seg&&!seg._visited&&(!operator||operator[(winding=seg._winding||{}).winding]&&!(operator.unite&&winding.winding===2&&winding.windingL&&winding.windingR)));}
function isStart(seg){if(seg){for(var i=0,l=starts.length;i<l;i++){if(seg===starts[i])
return true;}}
return false;}
function visitPath(path){var segments=path._segments;for(var i=0,l=segments.length;i<l;i++){segments[i]._visited=true;}}
function getCrossingSegments(segment,collectStarts){var inter=segment._intersection,start=inter,crossings=[];if(collectStarts)
starts=[segment];function collect(inter,end){while(inter&&inter!==end){var other=inter._segment,path=other&&other._path;if(path){var next=other.getNext()||path.getFirstSegment(),nextInter=next._intersection;if(other!==segment&&(isStart(other)||isStart(next)||next&&(isValid(other)&&(isValid(next)||nextInter&&isValid(nextInter._segment))))){crossings.push(other);}
if(collectStarts)
starts.push(other);}
inter=inter._next;}}
if(inter){collect(inter);while(inter&&inter._previous)
inter=inter._previous;collect(inter,start);}
return crossings;}
segments.sort(function(seg1,seg2){var inter1=seg1._intersection,inter2=seg2._intersection,over1=!!(inter1&&inter1._overlap),over2=!!(inter2&&inter2._overlap),path1=seg1._path,path2=seg2._path;return over1^over2?over1?1:-1:!inter1^!inter2?inter1?1:-1:path1!==path2?path1._id-path2._id:seg1._index-seg2._index;});for(var i=0,l=segments.length;i<l;i++){var seg=segments[i],valid=isValid(seg),path=null,finished=false,closed=true,branches=[],branch,visited,handleIn;if(valid&&seg._path._overlapsOnly){var path1=seg._path,path2=seg._intersection._segment._path;if(path1.compare(path2)){if(path1.getArea())
paths.push(path1.clone(false));visitPath(path1);visitPath(path2);valid=false;}}
while(valid){var first=!path,crossings=getCrossingSegments(seg,first),other=crossings.shift(),finished=!first&&(isStart(seg)||isStart(other)),cross=!finished&&other;if(first){path=new Path(Item.NO_INSERT);branch=null;}
if(finished){if(seg.isFirst()||seg.isLast())
closed=seg._path._closed;seg._visited=true;break;}
if(cross&&branch){branches.push(branch);branch=null;}
if(!branch){if(cross)
crossings.push(seg);branch={start:path._segments.length,crossings:crossings,visited:visited=[],handleIn:handleIn};}
if(cross)
seg=other;if(!isValid(seg)){path.removeSegments(branch.start);for(var j=0,k=visited.length;j<k;j++){visited[j]._visited=false;}
visited.length=0;do{seg=branch&&branch.crossings.shift();if(!seg||!seg._path){seg=null;branch=branches.pop();if(branch){visited=branch.visited;handleIn=branch.handleIn;}}}while(branch&&!isValid(seg));if(!seg)
break;}
var next=seg.getNext();path.add(new Segment(seg._point,handleIn,next&&seg._handleOut));seg._visited=true;visited.push(seg);seg=next||seg._path.getFirstSegment();handleIn=next&&next._handleIn;}
if(finished){if(closed){path.getFirstSegment().setHandleIn(handleIn);path.setClosed(closed);}
if(path.getArea()!==0){paths.push(path);}}}
return paths;}
return{_getWinding:function(point,dir,closed){return getWinding(point,this.getCurves(),dir,closed);},unite:function(path,options){return traceBoolean(this,path,'unite',options);},intersect:function(path,options){return traceBoolean(this,path,'intersect',options);},subtract:function(path,options){return traceBoolean(this,path,'subtract',options);},exclude:function(path,options){return traceBoolean(this,path,'exclude',options);},divide:function(path,options){return options&&(options.trace==false||options.stroke)?splitBoolean(this,path,'divide'):createResult([this.subtract(path,options),this.intersect(path,options)],true,this,path,options);},resolveCrossings:function(){var children=this._children,paths=children||[this];function hasOverlap(seg,path){var inter=seg&&seg._intersection;return inter&&inter._overlap&&inter._path===path;}
var hasOverlaps=false,hasCrossings=false,intersections=this.getIntersections(null,function(inter){return inter.hasOverlap()&&(hasOverlaps=true)||inter.isCrossing()&&(hasCrossings=true);}),clearCurves=hasOverlaps&&hasCrossings&&[];intersections=CurveLocation.expand(intersections);if(hasOverlaps){var overlaps=divideLocations(intersections,function(inter){return inter.hasOverlap();},clearCurves);for(var i=overlaps.length-1;i>=0;i--){var overlap=overlaps[i],path=overlap._path,seg=overlap._segment,prev=seg.getPrevious(),next=seg.getNext();if(hasOverlap(prev,path)&&hasOverlap(next,path)){seg.remove();prev._handleOut._set(0,0);next._handleIn._set(0,0);if(prev!==seg&&!prev.getCurve().hasLength()){next._handleIn.set(prev._handleIn);prev.remove();}}}}
if(hasCrossings){divideLocations(intersections,hasOverlaps&&function(inter){var curve1=inter.getCurve(),seg1=inter.getSegment(),other=inter._intersection,curve2=other._curve,seg2=other._segment;if(curve1&&curve2&&curve1._path&&curve2._path)
return true;if(seg1)
seg1._intersection=null;if(seg2)
seg2._intersection=null;},clearCurves);if(clearCurves)
clearCurveHandles(clearCurves);paths=tracePaths(Base.each(paths,function(path){Base.push(this,path._segments);},[]));}
var length=paths.length,item;if(length>1&&children){if(paths!==children)
this.setChildren(paths);item=this;}else if(length===1&&!children){if(paths[0]!==this)
this.setSegments(paths[0].removeSegments());item=this;}
if(!item){item=new CompoundPath(Item.NO_INSERT);item.addChildren(paths);item=item.reduce();item.copyAttributes(this);this.replaceWith(item);}
return item;},reorient:function(nonZero,clockwise){var children=this._children;if(children&&children.length){this.setChildren(reorientPaths(this.removeChildren(),function(w){return!!(nonZero?w:w&1);},clockwise));}else if(clockwise!==undefined){this.setClockwise(clockwise);}
return this;},getInteriorPoint:function(){var bounds=this.getBounds(),point=bounds.getCenter(true);if(!this.contains(point)){var curves=this.getCurves(),y=point.y,intercepts=[],roots=[];for(var i=0,l=curves.length;i<l;i++){var v=curves[i].getValues(),o0=v[1],o1=v[3],o2=v[5],o3=v[7];if(y>=min(o0,o1,o2,o3)&&y<=max(o0,o1,o2,o3)){var monoCurves=Curve.getMonoCurves(v);for(var j=0,m=monoCurves.length;j<m;j++){var mv=monoCurves[j],mo0=mv[1],mo3=mv[7];if((mo0!==mo3)&&(y>=mo0&&y<=mo3||y>=mo3&&y<=mo0)){var x=y===mo0?mv[0]:y===mo3?mv[6]:Curve.solveCubic(mv,1,y,roots,0,1)===1?Curve.getPoint(mv,roots[0]).x:(mv[0]+mv[6])/ 2;intercepts.push(x);}}}}
if(intercepts.length>1){intercepts.sort(function(a,b){return a-b;});point.x=(intercepts[0]+intercepts[1])/ 2;}}
return point;}};});var PathFlattener=Base.extend({_class:'PathFlattener',initialize:function(path,flatness,maxRecursion,ignoreStraight,matrix){var curves=[],parts=[],length=0,minSpan=1 /(maxRecursion||32),segments=path._segments,segment1=segments[0],segment2;function addCurve(segment1,segment2){var curve=Curve.getValues(segment1,segment2,matrix);curves.push(curve);computeParts(curve,segment1._index,0,1);}
function computeParts(curve,index,t1,t2){if((t2-t1)>minSpan&&!(ignoreStraight&&Curve.isStraight(curve))&&!Curve.isFlatEnough(curve,flatness||0.25)){var halves=Curve.subdivide(curve,0.5),tMid=(t1+t2)/ 2;computeParts(halves[0],index,t1,tMid);computeParts(halves[1],index,tMid,t2);}else{var dx=curve[6]-curve[0],dy=curve[7]-curve[1],dist=Math.sqrt(dx*dx+dy*dy);if(dist>0){length+=dist;parts.push({offset:length,curve:curve,index:index,time:t2,});}}}
for(var i=1,l=segments.length;i<l;i++){segment2=segments[i];addCurve(segment1,segment2);segment1=segment2;}
if(path._closed)
addCurve(segment2||segment1,segments[0]);this.curves=curves;this.parts=parts;this.length=length;this.index=0;},_get:function(offset){var parts=this.parts,length=parts.length,start,i,j=this.index;for(;;){i=j;if(!j||parts[--j].offset<offset)
break;}
for(;i<length;i++){var part=parts[i];if(part.offset>=offset){this.index=i;var prev=parts[i-1],prevTime=prev&&prev.index===part.index?prev.time:0,prevOffset=prev?prev.offset:0;return{index:part.index,time:prevTime+(part.time-prevTime)*(offset-prevOffset)/(part.offset-prevOffset)};}}
return{index:parts[length-1].index,time:1};},drawPart:function(ctx,from,to){var start=this._get(from),end=this._get(to);for(var i=start.index,l=end.index;i<=l;i++){var curve=Curve.getPart(this.curves[i],i===start.index?start.time:0,i===end.index?end.time:1);if(i===start.index)
ctx.moveTo(curve[0],curve[1]);ctx.bezierCurveTo.apply(ctx,curve.slice(2));}}},Base.each(Curve._evaluateMethods,function(name){this[name+'At']=function(offset){var param=this._get(offset);return Curve[name](this.curves[param.index],param.time);};},{}));var PathFitter=Base.extend({initialize:function(path){var points=this.points=[],segments=path._segments,closed=path._closed;for(var i=0,prev,l=segments.length;i<l;i++){var point=segments[i].point;if(!prev||!prev.equals(point)){points.push(prev=point.clone());}}
if(closed){points.unshift(points[points.length-1]);points.push(points[1]);}
this.closed=closed;},fit:function(error){var points=this.points,length=points.length,segments=null;if(length>0){segments=[new Segment(points[0])];if(length>1){this.fitCubic(segments,error,0,length-1,points[1].subtract(points[0]),points[length-2].subtract(points[length-1]));if(this.closed){segments.shift();segments.pop();}}}
return segments;},fitCubic:function(segments,error,first,last,tan1,tan2){var points=this.points;if(last-first===1){var pt1=points[first],pt2=points[last],dist=pt1.getDistance(pt2)/ 3;this.addCurve(segments,[pt1,pt1.add(tan1.normalize(dist)),pt2.add(tan2.normalize(dist)),pt2]);return;}
var uPrime=this.chordLengthParameterize(first,last),maxError=Math.max(error,error*error),split,parametersInOrder=true;for(var i=0;i<=4;i++){var curve=this.generateBezier(first,last,uPrime,tan1,tan2);var max=this.findMaxError(first,last,curve,uPrime);if(max.error<error&&parametersInOrder){this.addCurve(segments,curve);return;}
split=max.index;if(max.error>=maxError)
break;parametersInOrder=this.reparameterize(first,last,uPrime,curve);maxError=max.error;}
var tanCenter=points[split-1].subtract(points[split+1]);this.fitCubic(segments,error,first,split,tan1,tanCenter);this.fitCubic(segments,error,split,last,tanCenter.negate(),tan2);},addCurve:function(segments,curve){var prev=segments[segments.length-1];prev.setHandleOut(curve[1].subtract(curve[0]));segments.push(new Segment(curve[3],curve[2].subtract(curve[3])));},generateBezier:function(first,last,uPrime,tan1,tan2){var epsilon=1e-12,abs=Math.abs,points=this.points,pt1=points[first],pt2=points[last],C=[[0,0],[0,0]],X=[0,0];for(var i=0,l=last-first+1;i<l;i++){var u=uPrime[i],t=1-u,b=3*u*t,b0=t*t*t,b1=b*t,b2=b*u,b3=u*u*u,a1=tan1.normalize(b1),a2=tan2.normalize(b2),tmp=points[first+i].subtract(pt1.multiply(b0+b1)).subtract(pt2.multiply(b2+b3));C[0][0]+=a1.dot(a1);C[0][1]+=a1.dot(a2);C[1][0]=C[0][1];C[1][1]+=a2.dot(a2);X[0]+=a1.dot(tmp);X[1]+=a2.dot(tmp);}
var detC0C1=C[0][0]*C[1][1]-C[1][0]*C[0][1],alpha1,alpha2;if(abs(detC0C1)>epsilon){var detC0X=C[0][0]*X[1]-C[1][0]*X[0],detXC1=X[0]*C[1][1]-X[1]*C[0][1];alpha1=detXC1 / detC0C1;alpha2=detC0X / detC0C1;}else{var c0=C[0][0]+C[0][1],c1=C[1][0]+C[1][1];alpha1=alpha2=abs(c0)>epsilon?X[0]/ c0:abs(c1)>epsilon?X[1]/ c1:0;}
var segLength=pt2.getDistance(pt1),eps=epsilon*segLength,handle1,handle2;if(alpha1<eps||alpha2<eps){alpha1=alpha2=segLength / 3;}else{var line=pt2.subtract(pt1);handle1=tan1.normalize(alpha1);handle2=tan2.normalize(alpha2);if(handle1.dot(line)-handle2.dot(line)>segLength*segLength){alpha1=alpha2=segLength / 3;handle1=handle2=null;}}
return[pt1,pt1.add(handle1||tan1.normalize(alpha1)),pt2.add(handle2||tan2.normalize(alpha2)),pt2];},reparameterize:function(first,last,u,curve){for(var i=first;i<=last;i++){u[i-first]=this.findRoot(curve,this.points[i],u[i-first]);}
for(var i=1,l=u.length;i<l;i++){if(u[i]<=u[i-1])
return false;}
return true;},findRoot:function(curve,point,u){var curve1=[],curve2=[];for(var i=0;i<=2;i++){curve1[i]=curve[i+1].subtract(curve[i]).multiply(3);}
for(var i=0;i<=1;i++){curve2[i]=curve1[i+1].subtract(curve1[i]).multiply(2);}
var pt=this.evaluate(3,curve,u),pt1=this.evaluate(2,curve1,u),pt2=this.evaluate(1,curve2,u),diff=pt.subtract(point),df=pt1.dot(pt1)+diff.dot(pt2);return Numerical.isMachineZero(df)?u:u-diff.dot(pt1)/ df;},evaluate:function(degree,curve,t){var tmp=curve.slice();for(var i=1;i<=degree;i++){for(var j=0;j<=degree-i;j++){tmp[j]=tmp[j].multiply(1-t).add(tmp[j+1].multiply(t));}}
return tmp[0];},chordLengthParameterize:function(first,last){var u=[0];for(var i=first+1;i<=last;i++){u[i-first]=u[i-first-1]
+this.points[i].getDistance(this.points[i-1]);}
for(var i=1,m=last-first;i<=m;i++){u[i]/=u[m];}
return u;},findMaxError:function(first,last,curve,u){var index=Math.floor((last-first+1)/ 2),maxDist=0;for(var i=first+1;i<last;i++){var P=this.evaluate(3,curve,u[i-first]);var v=P.subtract(this.points[i]);var dist=v.x*v.x+v.y*v.y;if(dist>=maxDist){maxDist=dist;index=i;}}
return{error:maxDist,index:index};}});var TextItem=Item.extend({_class:'TextItem',_applyMatrix:false,_canApplyMatrix:false,_serializeFields:{content:null},_boundsOptions:{stroke:false,handle:false},initialize:function TextItem(arg){this._content='';this._lines=[];var hasProps=arg&&Base.isPlainObject(arg)&&arg.x===undefined&&arg.y===undefined;this._initialize(hasProps&&arg,!hasProps&&Point.read(arguments));},_equals:function(item){return this._content===item._content;},copyContent:function(source){this.setContent(source._content);},getContent:function(){return this._content;},setContent:function(content){this._content=''+content;this._lines=this._content.split(/\r\n|\n|\r/mg);this._changed(521);},isEmpty:function(){return!this._content;},getCharacterStyle:'#getStyle',setCharacterStyle:'#setStyle',getParagraphStyle:'#getStyle',setParagraphStyle:'#setStyle'});var PointText=TextItem.extend({_class:'PointText',initialize:function PointText(){TextItem.apply(this,arguments);},getPoint:function(){var point=this._matrix.getTranslation();return new LinkedPoint(point.x,point.y,this,'setPoint');},setPoint:function(){var point=Point.read(arguments);this.translate(point.subtract(this._matrix.getTranslation()));},_draw:function(ctx,param,viewMatrix){if(!this._content)
return;this._setStyles(ctx,param,viewMatrix);var lines=this._lines,style=this._style,hasFill=style.hasFill(),hasStroke=style.hasStroke(),leading=style.getLeading(),shadowColor=ctx.shadowColor;ctx.font=style.getFontStyle();ctx.textAlign=style.getJustification();for(var i=0,l=lines.length;i<l;i++){ctx.shadowColor=shadowColor;var line=lines[i];if(hasFill){ctx.fillText(line,0,0);ctx.shadowColor='rgba(0,0,0,0)';}
if(hasStroke)
ctx.strokeText(line,0,0);ctx.translate(0,leading);}},_getBounds:function(matrix,options){var style=this._style,lines=this._lines,numLines=lines.length,justification=style.getJustification(),leading=style.getLeading(),width=this.getView().getTextWidth(style.getFontStyle(),lines),x=0;if(justification!=='left')
x-=width /(justification==='center'?2:1);var rect=new Rectangle(x,numLines?-0.75*leading:0,width,numLines*leading);return matrix?matrix._transformBounds(rect,rect):rect;}});var Color=Base.extend(new function(){var types={gray:['gray'],rgb:['red','green','blue'],hsb:['hue','saturation','brightness'],hsl:['hue','saturation','lightness'],gradient:['gradient','origin','destination','highlight']};var componentParsers={},namedColors={transparent:[0,0,0,0]},colorCtx;function fromCSS(string){var match=string.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||string.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),type='rgb',components;if(match){var amount=match[4]?4:3;components=new Array(amount);for(var i=0;i<amount;i++){var value=match[i+1];components[i]=parseInt(value.length==1?value+value:value,16)/ 255;}}else if(match=string.match(/^(rgb|hsl)a?\((.*)\)$/)){type=match[1];components=match[2].trim().split(/[,\s]+/g);var isHSL=type==='hsl';for(var i=0,l=Math.min(components.length,4);i<l;i++){var component=components[i];var value=parseFloat(component);if(isHSL){if(i===0){var unit=component.match(/([a-z]*)$/)[1];value*=({turn:360,rad:180 / Math.PI,grad:0.9}[unit]||1);}else if(i<3){value /=100;}}else if(i<3){value /=/%$/.test(component)?100:255;}
components[i]=value;}}else{var color=namedColors[string];if(!color){if(window){if(!colorCtx){colorCtx=CanvasProvider.getContext(1,1);colorCtx.globalCompositeOperation='copy';}
colorCtx.fillStyle='rgba(0,0,0,0)';colorCtx.fillStyle=string;colorCtx.fillRect(0,0,1,1);var data=colorCtx.getImageData(0,0,1,1).data;color=namedColors[string]=[data[0]/ 255,data[1]/ 255,data[2]/ 255];}else{color=[0,0,0];}}
components=color.slice();}
return[type,components];}
var hsbIndices=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];var converters={'rgb-hsb':function(r,g,b){var max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,h=delta===0?0:(max==r?(g-b)/ delta+(g<b?6:0):max==g?(b-r)/ delta+2:(r-g)/ delta+4)*60;return[h,max===0?0:delta / max,max];},'hsb-rgb':function(h,s,b){h=(((h / 60)%6)+6)%6;var i=Math.floor(h),f=h-i,i=hsbIndices[i],v=[b,b*(1-s),b*(1-s*f),b*(1-s*(1-f))];return[v[i[0]],v[i[1]],v[i[2]]];},'rgb-hsl':function(r,g,b){var max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,achromatic=delta===0,h=achromatic?0:(max==r?(g-b)/ delta+(g<b?6:0):max==g?(b-r)/ delta+2:(r-g)/ delta+4)*60,l=(max+min)/ 2,s=achromatic?0:l<0.5?delta /(max+min):delta /(2-max-min);return[h,s,l];},'hsl-rgb':function(h,s,l){h=(((h / 360)%1)+1)%1;if(s===0)
return[l,l,l];var t3s=[h+1 / 3,h,h-1 / 3],t2=l<0.5?l*(1+s):l+s-l*s,t1=2*l-t2,c=[];for(var i=0;i<3;i++){var t3=t3s[i];if(t3<0)t3+=1;if(t3>1)t3-=1;c[i]=6*t3<1?t1+(t2-t1)*6*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*((2 / 3)-t3)*6:t1;}
return c;},'rgb-gray':function(r,g,b){return[r*0.2989+g*0.587+b*0.114];},'gray-rgb':function(g){return[g,g,g];},'gray-hsb':function(g){return[0,0,g];},'gray-hsl':function(g){return[0,0,g];},'gradient-rgb':function(){return[];},'rgb-gradient':function(){return[];}};return Base.each(types,function(properties,type){componentParsers[type]=[];Base.each(properties,function(name,index){var part=Base.capitalize(name),hasOverlap=/^(hue|saturation)$/.test(name),parser=componentParsers[type][index]=type==='gradient'?name==='gradient'?function(value){var current=this._components[0];value=Gradient.read(Array.isArray(value)?value:arguments,0,{readNull:true});if(current!==value){if(current)
current._removeOwner(this);if(value)
value._addOwner(this);}
return value;}:function(){return Point.read(arguments,0,{readNull:name==='highlight',clone:true});}:function(value){return value==null||isNaN(value)?0:+value;};this['get'+part]=function(){return this._type===type||hasOverlap&&/^hs[bl]$/.test(this._type)?this._components[index]:this._convert(type)[index];};this['set'+part]=function(value){if(this._type!==type&&!(hasOverlap&&/^hs[bl]$/.test(this._type))){this._components=this._convert(type);this._properties=types[type];this._type=type;}
this._components[index]=parser.call(this,value);this._changed();};},this);},{_class:'Color',_readIndex:true,initialize:function Color(arg){var args=arguments,reading=this.__read,read=0,type,components,alpha,values;if(Array.isArray(arg)){args=arg;arg=args[0];}
var argType=arg!=null&&typeof arg;if(argType==='string'&&arg in types){type=arg;arg=args[1];if(Array.isArray(arg)){components=arg;alpha=args[2];}else{if(reading)
read=1;args=Base.slice(args,1);argType=typeof arg;}}
if(!components){values=argType==='number'?args:argType==='object'&&arg.length!=null?arg:null;if(values){if(!type)
type=values.length>=3?'rgb':'gray';var length=types[type].length;alpha=values[length];if(reading){read+=values===arguments?length+(alpha!=null?1:0):1;}
if(values.length>length)
values=Base.slice(values,0,length);}else if(argType==='string'){var converted=fromCSS(arg);type=converted[0];components=converted[1];if(components.length===4){alpha=components[3];components.length--;}}else if(argType==='object'){if(arg.constructor===Color){type=arg._type;components=arg._components.slice();alpha=arg._alpha;if(type==='gradient'){for(var i=1,l=components.length;i<l;i++){var point=components[i];if(point)
components[i]=point.clone();}}}else if(arg.constructor===Gradient){type='gradient';values=args;}else{type='hue'in arg?'lightness'in arg?'hsl':'hsb':'gradient'in arg||'stops'in arg||'radial'in arg?'gradient':'gray'in arg?'gray':'rgb';var properties=types[type],parsers=componentParsers[type];this._components=components=[];for(var i=0,l=properties.length;i<l;i++){var value=arg[properties[i]];if(value==null&&!i&&type==='gradient'&&'stops'in arg){value={stops:arg.stops,radial:arg.radial};}
value=parsers[i].call(this,value);if(value!=null)
components[i]=value;}
alpha=arg.alpha;}}
if(reading&&type)
read=1;}
this._type=type||'rgb';if(!components){this._components=components=[];var parsers=componentParsers[this._type];for(var i=0,l=parsers.length;i<l;i++){var value=parsers[i].call(this,values&&values[i]);if(value!=null)
components[i]=value;}}
this._components=components;this._properties=types[this._type];this._alpha=alpha;if(reading)
this.__read=read;return this;},set:'#initialize',_serialize:function(options,dictionary){var components=this.getComponents();return Base.serialize(/^(gray|rgb)$/.test(this._type)?components:[this._type].concat(components),options,true,dictionary);},_changed:function(){this._canvasStyle=null;if(this._owner){if(this._setter){this._owner[this._setter](this);}else{this._owner._changed(129);}}},_convert:function(type){var converter;return this._type===type?this._components.slice():(converter=converters[this._type+'-'+type])?converter.apply(this,this._components):converters['rgb-'+type].apply(this,converters[this._type+'-rgb'].apply(this,this._components));},convert:function(type){return new Color(type,this._convert(type),this._alpha);},getType:function(){return this._type;},setType:function(type){this._components=this._convert(type);this._properties=types[type];this._type=type;},getComponents:function(){var components=this._components.slice();if(this._alpha!=null)
components.push(this._alpha);return components;},getAlpha:function(){return this._alpha!=null?this._alpha:1;},setAlpha:function(alpha){this._alpha=alpha==null?null:Math.min(Math.max(alpha,0),1);this._changed();},hasAlpha:function(){return this._alpha!=null;},equals:function(color){var col=Base.isPlainValue(color,true)?Color.read(arguments):color;return col===this||col&&this._class===col._class&&this._type===col._type&&this.getAlpha()===col.getAlpha()&&Base.equals(this._components,col._components)||false;},toString:function(){var properties=this._properties,parts=[],isGradient=this._type==='gradient',f=Formatter.instance;for(var i=0,l=properties.length;i<l;i++){var value=this._components[i];if(value!=null)
parts.push(properties[i]+': '
+(isGradient?value:f.number(value)));}
if(this._alpha!=null)
parts.push('alpha: '+f.number(this._alpha));return'{ '+parts.join(', ')+' }';},toCSS:function(hex){var components=this._convert('rgb'),alpha=hex||this._alpha==null?1:this._alpha;function convert(val){return Math.round((val<0?0:val>1?1:val)*255);}
components=[convert(components[0]),convert(components[1]),convert(components[2])];if(alpha<1)
components.push(alpha<0?0:alpha);return hex?'#'+((1<<24)+(components[0]<<16)
+(components[1]<<8)
+components[2]).toString(16).slice(1):(components.length==4?'rgba(':'rgb(')
+components.join(',')+')';},toCanvasStyle:function(ctx,matrix){if(this._canvasStyle)
return this._canvasStyle;if(this._type!=='gradient')
return this._canvasStyle=this.toCSS();var components=this._components,gradient=components[0],stops=gradient._stops,origin=components[1],destination=components[2],highlight=components[3],inverse=matrix&&matrix.inverted(),canvasGradient;if(inverse){origin=inverse._transformPoint(origin);destination=inverse._transformPoint(destination);if(highlight)
highlight=inverse._transformPoint(highlight);}
if(gradient._radial){var radius=destination.getDistance(origin);if(highlight){var vector=highlight.subtract(origin);if(vector.getLength()>radius)
highlight=origin.add(vector.normalize(radius-0.1));}
var start=highlight||origin;canvasGradient=ctx.createRadialGradient(start.x,start.y,0,origin.x,origin.y,radius);}else{canvasGradient=ctx.createLinearGradient(origin.x,origin.y,destination.x,destination.y);}
for(var i=0,l=stops.length;i<l;i++){var stop=stops[i],offset=stop._offset;canvasGradient.addColorStop(offset==null?i /(l-1):offset,stop._color.toCanvasStyle());}
return this._canvasStyle=canvasGradient;},transform:function(matrix){if(this._type==='gradient'){var components=this._components;for(var i=1,l=components.length;i<l;i++){var point=components[i];matrix._transformPoint(point,point,true);}
this._changed();}},statics:{_types:types,random:function(){var random=Math.random;return new Color(random(),random(),random());},_setOwner:function(color,owner,setter){if(color){if(color._owner&&owner&&color._owner!==owner){color=color.clone();}
if(!color._owner^!owner){color._owner=owner||null;color._setter=setter||null;}}
return color;}}});},new function(){var operators={add:function(a,b){return a+b;},subtract:function(a,b){return a-b;},multiply:function(a,b){return a*b;},divide:function(a,b){return a / b;}};return Base.each(operators,function(operator,name){this[name]=function(color){color=Color.read(arguments);var type=this._type,components1=this._components,components2=color._convert(type);for(var i=0,l=components1.length;i<l;i++)
components2[i]=operator(components1[i],components2[i]);return new Color(type,components2,this._alpha!=null?operator(this._alpha,color.getAlpha()):null);};},{});});var Gradient=Base.extend({_class:'Gradient',initialize:function Gradient(stops,radial){this._id=UID.get();if(stops&&Base.isPlainObject(stops)){this.set(stops);stops=radial=null;}
if(this._stops==null){this.setStops(stops||['white','black']);}
if(this._radial==null){this.setRadial(typeof radial==='string'&&radial==='radial'||radial||false);}},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._stops,this._radial],options,true,dictionary);});},_changed:function(){for(var i=0,l=this._owners&&this._owners.length;i<l;i++){this._owners[i]._changed();}},_addOwner:function(color){if(!this._owners)
this._owners=[];this._owners.push(color);},_removeOwner:function(color){var index=this._owners?this._owners.indexOf(color):-1;if(index!=-1){this._owners.splice(index,1);if(!this._owners.length)
this._owners=undefined;}},clone:function(){var stops=[];for(var i=0,l=this._stops.length;i<l;i++){stops[i]=this._stops[i].clone();}
return new Gradient(stops,this._radial);},getStops:function(){return this._stops;},setStops:function(stops){if(stops.length<2){throw new Error('Gradient stop list needs to contain at least two stops.');}
var _stops=this._stops;if(_stops){for(var i=0,l=_stops.length;i<l;i++)
_stops[i]._owner=undefined;}
_stops=this._stops=GradientStop.readList(stops,0,{clone:true});for(var i=0,l=_stops.length;i<l;i++)
_stops[i]._owner=this;this._changed();},getRadial:function(){return this._radial;},setRadial:function(radial){this._radial=radial;this._changed();},equals:function(gradient){if(gradient===this)
return true;if(gradient&&this._class===gradient._class){var stops1=this._stops,stops2=gradient._stops,length=stops1.length;if(length===stops2.length){for(var i=0;i<length;i++){if(!stops1[i].equals(stops2[i]))
return false;}
return true;}}
return false;}});var GradientStop=Base.extend({_class:'GradientStop',initialize:function GradientStop(arg0,arg1){var color=arg0,offset=arg1;if(typeof arg0==='object'&&arg1===undefined){if(Array.isArray(arg0)&&typeof arg0[0]!=='number'){color=arg0[0];offset=arg0[1];}else if('color'in arg0||'offset'in arg0||'rampPoint'in arg0){color=arg0.color;offset=arg0.offset||arg0.rampPoint||0;}}
this.setColor(color);this.setOffset(offset);},clone:function(){return new GradientStop(this._color.clone(),this._offset);},_serialize:function(options,dictionary){var color=this._color,offset=this._offset;return Base.serialize(offset==null?[color]:[color,offset],options,true,dictionary);},_changed:function(){if(this._owner)
this._owner._changed(129);},getOffset:function(){return this._offset;},setOffset:function(offset){this._offset=offset;this._changed();},getRampPoint:'#getOffset',setRampPoint:'#setOffset',getColor:function(){return this._color;},setColor:function(){Color._setOwner(this._color,null);this._color=Color._setOwner(Color.read(arguments,0),this,'setColor');this._changed();},equals:function(stop){return stop===this||stop&&this._class===stop._class&&this._color.equals(stop._color)&&this._offset==stop._offset||false;}});var Style=Base.extend(new function(){var itemDefaults={fillColor:null,fillRule:'nonzero',strokeColor:null,strokeWidth:1,strokeCap:'butt',strokeJoin:'miter',strokeScaling:true,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new Point(),selectedColor:null},groupDefaults=Base.set({},itemDefaults,{fontFamily:'sans-serif',fontWeight:'normal',fontSize:12,leading:null,justification:'left'}),textDefaults=Base.set({},groupDefaults,{fillColor:new Color()}),flags={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},item={beans:true},fields={_class:'Style',beans:true,initialize:function Style(style,_owner,_project){this._values={};this._owner=_owner;this._project=_owner&&_owner._project||_project||paper.project;this._defaults=!_owner||_owner instanceof Group?groupDefaults:_owner instanceof TextItem?textDefaults:itemDefaults;if(style)
this.set(style);}};Base.each(groupDefaults,function(value,key){var isColor=/Color$/.test(key),isPoint=key==='shadowOffset',part=Base.capitalize(key),flag=flags[key],set='set'+part,get='get'+part;fields[set]=function(value){var owner=this._owner,children=owner&&owner._children,applyToChildren=children&&children.length>0&&!(owner instanceof CompoundPath);if(applyToChildren){for(var i=0,l=children.length;i<l;i++)
children[i]._style[set](value);}
if((key==='selectedColor'||!applyToChildren)&&key in this._defaults){var old=this._values[key];if(old!==value){if(isColor){if(old){Color._setOwner(old,null);old._canvasStyle=null;}
if(value&&value.constructor===Color){value=Color._setOwner(value,owner,applyToChildren&&set);}}
this._values[key]=value;if(owner)
owner._changed(flag||129);}}};fields[get]=function(_dontMerge){var owner=this._owner,children=owner&&owner._children,applyToChildren=children&&children.length>0&&!(owner instanceof CompoundPath),value;if(applyToChildren&&!_dontMerge){for(var i=0,l=children.length;i<l;i++){var childValue=children[i]._style[get]();if(!i){value=childValue;}else if(!Base.equals(value,childValue)){return undefined;}}}else if(key in this._defaults){var value=this._values[key];if(value===undefined){value=this._defaults[key];if(value&&value.clone){value=value.clone();}}else{var ctor=isColor?Color:isPoint?Point:null;if(ctor&&!(value&&value.constructor===ctor)){this._values[key]=value=ctor.read([value],0,{readNull:true,clone:true});}}}
if(value&&isColor){value=Color._setOwner(value,owner,applyToChildren&&set);}
return value;};item[get]=function(_dontMerge){return this._style[get](_dontMerge);};item[set]=function(value){this._style[set](value);};});Base.each({Font:'FontFamily',WindingRule:'FillRule'},function(value,key){var get='get'+key,set='set'+key;fields[get]=item[get]='#get'+value;fields[set]=item[set]='#set'+value;});Item.inject(item);return fields;},{set:function(style){var isStyle=style instanceof Style,values=isStyle?style._values:style;if(values){for(var key in values){if(key in this._defaults){var value=values[key];this[key]=value&&isStyle&&value.clone?value.clone():value;}}}},equals:function(style){function compare(style1,style2,secondary){var values1=style1._values,values2=style2._values,defaults2=style2._defaults;for(var key in values1){var value1=values1[key],value2=values2[key];if(!(secondary&&key in values2)&&!Base.equals(value1,value2===undefined?defaults2[key]:value2))
return false;}
return true;}
return style===this||style&&this._class===style._class&&compare(this,style)&&compare(style,this,true)||false;},_dispose:function(){var color;color=this.getFillColor();if(color)color._canvasStyle=null;color=this.getStrokeColor();if(color)color._canvasStyle=null;color=this.getShadowColor();if(color)color._canvasStyle=null;},hasFill:function(){var color=this.getFillColor();return!!color&&color.alpha>0;},hasStroke:function(){var color=this.getStrokeColor();return!!color&&color.alpha>0&&this.getStrokeWidth()>0;},hasShadow:function(){var color=this.getShadowColor();return!!color&&color.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero());},getView:function(){return this._project._view;},getFontStyle:function(){var fontSize=this.getFontSize();return this.getFontWeight()
+' '+fontSize+(/[a-z]/i.test(fontSize+'')?' ':'px ')
+this.getFontFamily();},getFont:'#getFontFamily',setFont:'#setFontFamily',getLeading:function getLeading(){var leading=getLeading.base.call(this),fontSize=this.getFontSize();if(/pt|em|%|px/.test(fontSize))
fontSize=this.getView().getPixelSize(fontSize);return leading!=null?leading:fontSize*1.2;}});var DomElement=new function(){function handlePrefix(el,name,set,value){var prefixes=['','webkit','moz','Moz','ms','o'],suffix=name[0].toUpperCase()+name.substring(1);for(var i=0;i<6;i++){var prefix=prefixes[i],key=prefix?prefix+suffix:name;if(key in el){if(set){el[key]=value;}else{return el[key];}
break;}}}
return{getStyles:function(el){var doc=el&&el.nodeType!==9?el.ownerDocument:el,view=doc&&doc.defaultView;return view&&view.getComputedStyle(el,'');},getBounds:function(el,viewport){var doc=el.ownerDocument,body=doc.body,html=doc.documentElement,rect;try{rect=el.getBoundingClientRect();}catch(e){rect={left:0,top:0,width:0,height:0};}
var x=rect.left-(html.clientLeft||body.clientLeft||0),y=rect.top-(html.clientTop||body.clientTop||0);if(!viewport){var view=doc.defaultView;x+=view.pageXOffset||html.scrollLeft||body.scrollLeft;y+=view.pageYOffset||html.scrollTop||body.scrollTop;}
return new Rectangle(x,y,rect.width,rect.height);},getViewportBounds:function(el){var doc=el.ownerDocument,view=doc.defaultView,html=doc.documentElement;return new Rectangle(0,0,view.innerWidth||html.clientWidth,view.innerHeight||html.clientHeight);},getOffset:function(el,viewport){return DomElement.getBounds(el,viewport).getPoint();},getSize:function(el){return DomElement.getBounds(el,true).getSize();},isInvisible:function(el){return DomElement.getSize(el).equals(new Size(0,0));},isInView:function(el){return!DomElement.isInvisible(el)&&DomElement.getViewportBounds(el).intersects(DomElement.getBounds(el,true));},isInserted:function(el){return document.body.contains(el);},getPrefixed:function(el,name){return el&&handlePrefix(el,name);},setPrefixed:function(el,name,value){if(typeof name==='object'){for(var key in name)
handlePrefix(el,key,true,name[key]);}else{handlePrefix(el,name,true,value);}}};};var DomEvent={add:function(el,events){if(el){for(var type in events){var func=events[type],parts=type.split(/[\s,]+/g);for(var i=0,l=parts.length;i<l;i++){var name=parts[i];var options=(el===document&&(name==='touchstart'||name==='touchmove'))?{passive:false}:false;el.addEventListener(name,func,options);}}}},remove:function(el,events){if(el){for(var type in events){var func=events[type],parts=type.split(/[\s,]+/g);for(var i=0,l=parts.length;i<l;i++)
el.removeEventListener(parts[i],func,false);}}},getPoint:function(event){var pos=event.targetTouches?event.targetTouches.length?event.targetTouches[0]:event.changedTouches[0]:event;return new Point(pos.pageX||pos.clientX+document.documentElement.scrollLeft,pos.pageY||pos.clientY+document.documentElement.scrollTop);},getTarget:function(event){return event.target||event.srcElement;},getRelatedTarget:function(event){return event.relatedTarget||event.toElement;},getOffset:function(event,target){return DomEvent.getPoint(event).subtract(DomElement.getOffset(target||DomEvent.getTarget(event)));}};DomEvent.requestAnimationFrame=new function(){var nativeRequest=DomElement.getPrefixed(window,'requestAnimationFrame'),requested=false,callbacks=[],timer;function handleCallbacks(){var functions=callbacks;callbacks=[];for(var i=0,l=functions.length;i<l;i++)
functions[i]();requested=nativeRequest&&callbacks.length;if(requested)
nativeRequest(handleCallbacks);}
return function(callback){callbacks.push(callback);if(nativeRequest){if(!requested){nativeRequest(handleCallbacks);requested=true;}}else if(!timer){timer=setInterval(handleCallbacks,1000 / 60);}};};var View=Base.extend(Emitter,{_class:'View',initialize:function View(project,element){function getSize(name){return element[name]||parseInt(element.getAttribute(name),10);}
function getCanvasSize(){var size=DomElement.getSize(element);return size.isNaN()||size.isZero()?new Size(getSize('width'),getSize('height')):size;}
var size;if(window&&element){this._id=element.getAttribute('id');if(this._id==null)
element.setAttribute('id',this._id='paper-view-'+View._id++);DomEvent.add(element,this._viewEvents);var none='none';DomElement.setPrefixed(element.style,{userDrag:none,userSelect:none,touchCallout:none,contentZooming:none,tapHighlightColor:'rgba(0,0,0,0)'});if(PaperScope.hasAttribute(element,'resize')){var that=this;DomEvent.add(window,this._windowEvents={resize:function(){that.setViewSize(getCanvasSize());}});}
size=getCanvasSize();if(PaperScope.hasAttribute(element,'stats')&&typeof Stats!=='undefined'){this._stats=new Stats();var stats=this._stats.domElement,style=stats.style,offset=DomElement.getOffset(element);style.position='absolute';style.left=offset.x+'px';style.top=offset.y+'px';document.body.appendChild(stats);}}else{size=new Size(element);element=null;}
this._project=project;this._scope=project._scope;this._element=element;if(!this._pixelRatio)
this._pixelRatio=window&&window.devicePixelRatio||1;this._setElementSize(size.width,size.height);this._viewSize=size;View._views.push(this);View._viewsById[this._id]=this;(this._matrix=new Matrix())._owner=this;if(!View._focused)
View._focused=this;this._frameItems={};this._frameItemCount=0;this._itemEvents={native:{},virtual:{}};this._autoUpdate=!paper.agent.node;this._needsUpdate=false;},remove:function(){if(!this._project)
return false;if(View._focused===this)
View._focused=null;View._views.splice(View._views.indexOf(this),1);delete View._viewsById[this._id];var project=this._project;if(project._view===this)
project._view=null;DomEvent.remove(this._element,this._viewEvents);DomEvent.remove(window,this._windowEvents);this._element=this._project=null;this.off('frame');this._animate=false;this._frameItems={};return true;},_events:Base.each(Item._itemHandlers.concat(['onResize','onKeyDown','onKeyUp']),function(name){this[name]={};},{onFrame:{install:function(){this.play();},uninstall:function(){this.pause();}}}),_animate:false,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate;},setAutoUpdate:function(autoUpdate){this._autoUpdate=autoUpdate;if(autoUpdate)
this.requestUpdate();},update:function(){},draw:function(){this.update();},requestUpdate:function(){if(!this._requested){var that=this;DomEvent.requestAnimationFrame(function(){that._requested=false;if(that._animate){that.requestUpdate();var element=that._element;if((!DomElement.getPrefixed(document,'hidden')||PaperScope.getAttribute(element,'keepalive')==='true')&&DomElement.isInView(element)){that._handleFrame();}}
if(that._autoUpdate)
that.update();});this._requested=true;}},play:function(){this._animate=true;this.requestUpdate();},pause:function(){this._animate=false;},_handleFrame:function(){paper=this._scope;var now=Date.now()/ 1000,delta=this._last?now-this._last:0;this._last=now;this.emit('frame',new Base({delta:delta,time:this._time+=delta,count:this._count++}));if(this._stats)
this._stats.update();},_animateItem:function(item,animate){var items=this._frameItems;if(animate){items[item._id]={item:item,time:0,count:0};if(++this._frameItemCount===1)
this.on('frame',this._handleFrameItems);}else{delete items[item._id];if(--this._frameItemCount===0){this.off('frame',this._handleFrameItems);}}},_handleFrameItems:function(event){for(var i in this._frameItems){var entry=this._frameItems[i];entry.item.emit('frame',new Base(event,{time:entry.time+=event.delta,count:entry.count++}));}},_changed:function(){this._project._changed(4097);this._bounds=this._decomposed=undefined;},getElement:function(){return this._element;},getPixelRatio:function(){return this._pixelRatio;},getResolution:function(){return this._pixelRatio*72;},getViewSize:function(){var size=this._viewSize;return new LinkedSize(size.width,size.height,this,'setViewSize');},setViewSize:function(){var size=Size.read(arguments),delta=size.subtract(this._viewSize);if(delta.isZero())
return;this._setElementSize(size.width,size.height);this._viewSize.set(size);this._changed();this.emit('resize',{size:size,delta:delta});if(this._autoUpdate){this.update();}},_setElementSize:function(width,height){var element=this._element;if(element){if(element.width!==width)
element.width=width;if(element.height!==height)
element.height=height;}},getBounds:function(){if(!this._bounds)
this._bounds=this._matrix.inverted()._transformBounds(new Rectangle(new Point(),this._viewSize));return this._bounds;},getSize:function(){return this.getBounds().getSize();},isVisible:function(){return DomElement.isInView(this._element);},isInserted:function(){return DomElement.isInserted(this._element);},getPixelSize:function(size){var element=this._element,pixels;if(element){var parent=element.parentNode,temp=document.createElement('div');temp.style.fontSize=size;parent.appendChild(temp);pixels=parseFloat(DomElement.getStyles(temp).fontSize);parent.removeChild(temp);}else{pixels=parseFloat(pixels);}
return pixels;},getTextWidth:function(font,lines){return 0;}},Base.each(['rotate','scale','shear','skew'],function(key){var rotate=key==='rotate';this[key]=function(){var args=arguments,value=(rotate?Base:Point).read(args),center=Point.read(args,0,{readNull:true});return this.transform(new Matrix()[key](value,center||this.getCenter(true)));};},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose());},translate:function(){var mx=new Matrix();return this.transform(mx.translate.apply(mx,arguments));},getCenter:function(){return this.getBounds().getCenter();},setCenter:function(){var center=Point.read(arguments);this.translate(this.getCenter().subtract(center));},getZoom:function(){var scaling=this._decompose().scaling;return(scaling.x+scaling.y)/ 2;},setZoom:function(zoom){this.transform(new Matrix().scale(zoom / this.getZoom(),this.getCenter()));},getRotation:function(){return this._decompose().rotation;},setRotation:function(rotation){var current=this.getRotation();if(current!=null&&rotation!=null){this.rotate(rotation-current);}},getScaling:function(){var scaling=this._decompose().scaling;return new LinkedPoint(scaling.x,scaling.y,this,'setScaling');},setScaling:function(){var current=this.getScaling(),scaling=Point.read(arguments,0,{clone:true,readNull:true});if(current&&scaling){this.scale(scaling.x / current.x,scaling.y / current.y);}},getMatrix:function(){return this._matrix;},setMatrix:function(){var matrix=this._matrix;matrix.set.apply(matrix,arguments);},transform:function(matrix){this._matrix.append(matrix);},scrollBy:function(){this.translate(Point.read(arguments).negate());}}),{projectToView:function(){return this._matrix._transformPoint(Point.read(arguments));},viewToProject:function(){return this._matrix._inverseTransform(Point.read(arguments));},getEventPoint:function(event){return this.viewToProject(DomEvent.getOffset(event,this._element));},},{statics:{_views:[],_viewsById:{},_id:0,create:function(project,element){if(document&&typeof element==='string')
element=document.getElementById(element);var ctor=window?CanvasView:View;return new ctor(project,element);}}},new function(){if(!window)
return;var prevFocus,tempFocus,dragging=false,mouseDown=false;function getView(event){var target=DomEvent.getTarget(event);return target.getAttribute&&View._viewsById[target.getAttribute('id')];}
function updateFocus(){var view=View._focused;if(!view||!view.isVisible()){for(var i=0,l=View._views.length;i<l;i++){if((view=View._views[i]).isVisible()){View._focused=tempFocus=view;break;}}}}
function handleMouseMove(view,event,point){view._handleMouseEvent('mousemove',event,point);}
var navigator=window.navigator,mousedown,mousemove,mouseup;if(navigator.pointerEnabled||navigator.msPointerEnabled){mousedown='pointerdown MSPointerDown';mousemove='pointermove MSPointerMove';mouseup='pointerup pointercancel MSPointerUp MSPointerCancel';}else{mousedown='touchstart';mousemove='touchmove';mouseup='touchend touchcancel';if(!('ontouchstart'in window&&navigator.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i))){mousedown+=' mousedown';mousemove+=' mousemove';mouseup+=' mouseup';}}
var viewEvents={},docEvents={mouseout:function(event){var view=View._focused,target=DomEvent.getRelatedTarget(event);if(view&&(!target||target.nodeName==='HTML')){var offset=DomEvent.getOffset(event,view._element),x=offset.x,abs=Math.abs,ax=abs(x),max=1<<25,diff=ax-max;offset.x=abs(diff)<ax?diff*(x<0?-1:1):x;handleMouseMove(view,event,view.viewToProject(offset));}},scroll:updateFocus};viewEvents[mousedown]=function(event){var view=View._focused=getView(event);if(!dragging){dragging=true;view._handleMouseEvent('mousedown',event);}};docEvents[mousemove]=function(event){var view=View._focused;if(!mouseDown){var target=getView(event);if(target){if(view!==target){if(view)
handleMouseMove(view,event);if(!prevFocus)
prevFocus=view;view=View._focused=tempFocus=target;}}else if(tempFocus&&tempFocus===view){if(prevFocus&&!prevFocus.isInserted())
prevFocus=null;view=View._focused=prevFocus;prevFocus=null;updateFocus();}}
if(view)
handleMouseMove(view,event);};docEvents[mousedown]=function(){mouseDown=true;};docEvents[mouseup]=function(event){var view=View._focused;if(view&&dragging)
view._handleMouseEvent('mouseup',event);mouseDown=dragging=false;};DomEvent.add(document,docEvents);DomEvent.add(window,{load:updateFocus});var called=false,prevented=false,fallbacks={doubleclick:'click',mousedrag:'mousemove'},wasInView=false,overView,downPoint,lastPoint,downItem,overItem,dragItem,clickItem,clickTime,dblClick;function emitMouseEvent(obj,target,type,event,point,prevPoint,stopItem){var stopped=false,mouseEvent;function emit(obj,type){if(obj.responds(type)){if(!mouseEvent){mouseEvent=new MouseEvent(type,event,point,target||obj,prevPoint?point.subtract(prevPoint):null);}
if(obj.emit(type,mouseEvent)){called=true;if(mouseEvent.prevented)
prevented=true;if(mouseEvent.stopped)
return stopped=true;}}else{var fallback=fallbacks[type];if(fallback)
return emit(obj,fallback);}}
while(obj&&obj!==stopItem){if(emit(obj,type))
break;obj=obj._parent;}
return stopped;}
function emitMouseEvents(view,hitItem,type,event,point,prevPoint){view._project.removeOn(type);prevented=called=false;return(dragItem&&emitMouseEvent(dragItem,null,type,event,point,prevPoint)||hitItem&&hitItem!==dragItem&&!hitItem.isDescendant(dragItem)&&emitMouseEvent(hitItem,null,type==='mousedrag'?'mousemove':type,event,point,prevPoint,dragItem)||emitMouseEvent(view,dragItem||hitItem||view,type,event,point,prevPoint));}
var itemEventsMap={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:viewEvents,_handleMouseEvent:function(type,event,point){var itemEvents=this._itemEvents,hitItems=itemEvents.native[type],nativeMove=type==='mousemove',tool=this._scope.tool,view=this;function responds(type){return itemEvents.virtual[type]||view.responds(type)||tool&&tool.responds(type);}
if(nativeMove&&dragging&&responds('mousedrag'))
type='mousedrag';if(!point)
point=this.getEventPoint(event);var inView=this.getBounds().contains(point),hit=hitItems&&inView&&view._project.hitTest(point,{tolerance:0,fill:true,stroke:true}),hitItem=hit&&hit.item||null,handle=false,mouse={};mouse[type.substr(5)]=true;if(hitItems&&hitItem!==overItem){if(overItem){emitMouseEvent(overItem,null,'mouseleave',event,point);}
if(hitItem){emitMouseEvent(hitItem,null,'mouseenter',event,point);}
overItem=hitItem;}
if(wasInView^inView){emitMouseEvent(this,null,inView?'mouseenter':'mouseleave',event,point);overView=inView?this:null;handle=true;}
if((inView||mouse.drag)&&!point.equals(lastPoint)){emitMouseEvents(this,hitItem,nativeMove?type:'mousemove',event,point,lastPoint);handle=true;}
wasInView=inView;if(mouse.down&&inView||mouse.up&&downPoint){emitMouseEvents(this,hitItem,type,event,point,downPoint);if(mouse.down){dblClick=hitItem===clickItem&&(Date.now()-clickTime<300);downItem=clickItem=hitItem;if(!prevented&&hitItem){var item=hitItem;while(item&&!item.responds('mousedrag'))
item=item._parent;if(item)
dragItem=hitItem;}
downPoint=point;}else if(mouse.up){if(!prevented&&hitItem===downItem){clickTime=Date.now();emitMouseEvents(this,hitItem,dblClick?'doubleclick':'click',event,point,downPoint);dblClick=false;}
downItem=dragItem=null;}
wasInView=false;handle=true;}
lastPoint=point;if(handle&&tool){called=tool._handleMouseEvent(type,event,point,mouse)||called;}
if(event.cancelable!==false&&(called&&!mouse.move||mouse.down&&responds('mouseup'))){event.preventDefault();}},_handleKeyEvent:function(type,event,key,character){var scope=this._scope,tool=scope.tool,keyEvent;function emit(obj){if(obj.responds(type)){paper=scope;obj.emit(type,keyEvent=keyEvent||new KeyEvent(type,event,key,character));}}
if(this.isVisible()){emit(this);if(tool&&tool.responds(type))
emit(tool);}},_countItemEvent:function(type,sign){var itemEvents=this._itemEvents,native=itemEvents.native,virtual=itemEvents.virtual;for(var key in itemEventsMap){native[key]=(native[key]||0)
+(itemEventsMap[key][type]||0)*sign;}
virtual[type]=(virtual[type]||0)+sign;},statics:{updateFocus:updateFocus,_resetState:function(){dragging=mouseDown=called=wasInView=false;prevFocus=tempFocus=overView=downPoint=lastPoint=downItem=overItem=dragItem=clickItem=clickTime=dblClick=null;}}};});var CanvasView=View.extend({_class:'CanvasView',initialize:function CanvasView(project,canvas){if(!(canvas instanceof window.HTMLCanvasElement)){var size=Size.read(arguments,1);if(size.isZero())
throw new Error('Cannot create CanvasView with the provided argument: '
+Base.slice(arguments,1));canvas=CanvasProvider.getCanvas(size);}
var ctx=this._context=canvas.getContext('2d');ctx.save();this._pixelRatio=1;if(!/^off|false$/.test(PaperScope.getAttribute(canvas,'hidpi'))){var deviceRatio=window.devicePixelRatio||1,backingStoreRatio=DomElement.getPrefixed(ctx,'backingStorePixelRatio')||1;this._pixelRatio=deviceRatio / backingStoreRatio;}
View.call(this,project,canvas);this._needsUpdate=true;},remove:function remove(){this._context.restore();return remove.base.call(this);},_setElementSize:function _setElementSize(width,height){var pixelRatio=this._pixelRatio;_setElementSize.base.call(this,width*pixelRatio,height*pixelRatio);if(pixelRatio!==1){var element=this._element,ctx=this._context;if(!PaperScope.hasAttribute(element,'resize')){var style=element.style;style.width=width+'px';style.height=height+'px';}
ctx.restore();ctx.save();ctx.scale(pixelRatio,pixelRatio);}},getContext:function(){return this._context;},getPixelSize:function getPixelSize(size){var agent=paper.agent,pixels;if(agent&&agent.firefox){pixels=getPixelSize.base.call(this,size);}else{var ctx=this._context,prevFont=ctx.font;ctx.font=size+' serif';pixels=parseFloat(ctx.font);ctx.font=prevFont;}
return pixels;},getTextWidth:function(font,lines){var ctx=this._context,prevFont=ctx.font,width=0;ctx.font=font;for(var i=0,l=lines.length;i<l;i++)
width=Math.max(width,ctx.measureText(lines[i]).width);ctx.font=prevFont;return width;},update:function(){if(!this._needsUpdate)
return false;var project=this._project,ctx=this._context,size=this._viewSize;ctx.clearRect(0,0,size.width+1,size.height+1);if(project)
project.draw(ctx,this._matrix,this._pixelRatio);this._needsUpdate=false;return true;}});var Event=Base.extend({_class:'Event',initialize:function Event(event){this.event=event;this.type=event&&event.type;},prevented:false,stopped:false,preventDefault:function(){this.prevented=true;this.event.preventDefault();},stopPropagation:function(){this.stopped=true;this.event.stopPropagation();},stop:function(){this.stopPropagation();this.preventDefault();},getTimeStamp:function(){return this.event.timeStamp;},getModifiers:function(){return Key.modifiers;}});var KeyEvent=Event.extend({_class:'KeyEvent',initialize:function KeyEvent(type,event,key,character){this.type=type;this.event=event;this.key=key;this.character=character;},toString:function(){return"{ type: '"+this.type
+"', key: '"+this.key
+"', character: '"+this.character
+"', modifiers: "+this.getModifiers()
+" }";}});var Key=new function(){var keyLookup={'\t':'tab',' ':'space','\b':'backspace','\x7f':'delete','Spacebar':'space','Del':'delete','Win':'meta','Esc':'escape'},charLookup={'tab':'\t','space':' ','enter':'\r'},keyMap={},charMap={},metaFixMap,downKey,modifiers=new Base({shift:false,control:false,alt:false,meta:false,capsLock:false,space:false}).inject({option:{get:function(){return this.alt;}},command:{get:function(){var agent=paper&&paper.agent;return agent&&agent.mac?this.meta:this.control;}}});function getKey(event){var key=event.key||event.keyIdentifier;key=/^U\+/.test(key)?String.fromCharCode(parseInt(key.substr(2),16)):/^Arrow[A-Z]/.test(key)?key.substr(5):key==='Unidentified'||key===undefined?String.fromCharCode(event.keyCode):key;return keyLookup[key]||(key.length>1?Base.hyphenate(key):key.toLowerCase());}
function handleKey(down,key,character,event){var type=down?'keydown':'keyup',view=View._focused,name;keyMap[key]=down;if(down){charMap[key]=character;}else{delete charMap[key];}
if(key.length>1&&(name=Base.camelize(key))in modifiers){modifiers[name]=down;var agent=paper&&paper.agent;if(name==='meta'&&agent&&agent.mac){if(down){metaFixMap={};}else{for(var k in metaFixMap){if(k in charMap)
handleKey(false,k,metaFixMap[k],event);}
metaFixMap=null;}}}else if(down&&metaFixMap){metaFixMap[key]=character;}
if(view){view._handleKeyEvent(down?'keydown':'keyup',event,key,character);}}
DomEvent.add(document,{keydown:function(event){var key=getKey(event),agent=paper&&paper.agent;if(key.length>1||agent&&(agent.chrome&&(event.altKey||agent.mac&&event.metaKey||!agent.mac&&event.ctrlKey))){handleKey(true,key,charLookup[key]||(key.length>1?'':key),event);}else{downKey=key;}},keypress:function(event){if(downKey){var key=getKey(event),code=event.charCode,character=code>=32?String.fromCharCode(code):key.length>1?'':key;if(key!==downKey){key=character.toLowerCase();}
handleKey(true,key,character,event);downKey=null;}},keyup:function(event){var key=getKey(event);if(key in charMap)
handleKey(false,key,charMap[key],event);}});DomEvent.add(window,{blur:function(event){for(var key in charMap)
handleKey(false,key,charMap[key],event);}});return{modifiers:modifiers,isDown:function(key){return!!keyMap[key];}};};var MouseEvent=Event.extend({_class:'MouseEvent',initialize:function MouseEvent(type,event,point,target,delta){this.type=type;this.event=event;this.point=point;this.target=target;this.delta=delta;},toString:function(){return"{ type: '"+this.type
+"', point: "+this.point
+', target: '+this.target
+(this.delta?', delta: '+this.delta:'')
+', modifiers: '+this.getModifiers()
+' }';}});var ToolEvent=Event.extend({_class:'ToolEvent',_item:null,initialize:function ToolEvent(tool,type,event){this.tool=tool;this.type=type;this.event=event;},_choosePoint:function(point,toolPoint){return point?point:toolPoint?toolPoint.clone():null;},getPoint:function(){return this._choosePoint(this._point,this.tool._point);},setPoint:function(point){this._point=point;},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint);},setLastPoint:function(lastPoint){this._lastPoint=lastPoint;},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint);},setDownPoint:function(downPoint){this._downPoint=downPoint;},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint){return this.tool._point.add(this.tool._lastPoint).divide(2);}
return this._middlePoint;},setMiddlePoint:function(middlePoint){this._middlePoint=middlePoint;},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta;},setDelta:function(delta){this._delta=delta;},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?'_downCount':'_moveCount'];},setCount:function(count){this.tool[/^mouse(down|up)$/.test(this.type)?'downCount':'count']=count;},getItem:function(){if(!this._item){var result=this.tool._scope.project.hitTest(this.getPoint());if(result){var item=result.item,parent=item._parent;while(/^(Group|CompoundPath)$/.test(parent._class)){item=parent;parent=parent._parent;}
this._item=item;}}
return this._item;},setItem:function(item){this._item=item;},toString:function(){return'{ type: '+this.type
+', point: '+this.getPoint()
+', count: '+this.getCount()
+', modifiers: '+this.getModifiers()
+' }';}});var Tool=PaperScopeItem.extend({_class:'Tool',_list:'tools',_reference:'tool',_events:['onMouseDown','onMouseUp','onMouseDrag','onMouseMove','onActivate','onDeactivate','onEditOptions','onKeyDown','onKeyUp'],initialize:function Tool(props){PaperScopeItem.call(this);this._moveCount=-1;this._downCount=-1;this.set(props);},getMinDistance:function(){return this._minDistance;},setMinDistance:function(minDistance){this._minDistance=minDistance;if(minDistance!=null&&this._maxDistance!=null&&minDistance>this._maxDistance){this._maxDistance=minDistance;}},getMaxDistance:function(){return this._maxDistance;},setMaxDistance:function(maxDistance){this._maxDistance=maxDistance;if(this._minDistance!=null&&maxDistance!=null&&maxDistance<this._minDistance){this._minDistance=maxDistance;}},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null;},setFixedDistance:function(distance){this._minDistance=this._maxDistance=distance;},_handleMouseEvent:function(type,event,point,mouse){paper=this._scope;if(mouse.drag&&!this.responds(type))
type='mousemove';var move=mouse.move||mouse.drag,responds=this.responds(type),minDistance=this.minDistance,maxDistance=this.maxDistance,called=false,tool=this;function update(minDistance,maxDistance){var pt=point,toolPoint=move?tool._point:(tool._downPoint||pt);if(move){if(tool._moveCount>=0&&pt.equals(toolPoint)){return false;}
if(toolPoint&&(minDistance!=null||maxDistance!=null)){var vector=pt.subtract(toolPoint),distance=vector.getLength();if(distance<(minDistance||0))
return false;if(maxDistance){pt=toolPoint.add(vector.normalize(Math.min(distance,maxDistance)));}}
tool._moveCount++;}
tool._point=pt;tool._lastPoint=toolPoint||pt;if(mouse.down){tool._moveCount=-1;tool._downPoint=pt;tool._downCount++;}
return true;}
function emit(){if(responds){called=tool.emit(type,new ToolEvent(tool,type,event))||called;}}
if(mouse.down){update();emit();}else if(mouse.up){update(null,maxDistance);emit();}else if(responds){while(update(minDistance,maxDistance))
emit();}
return called;}});var Tween=Base.extend(Emitter,{_class:'Tween',statics:{easings:new Base({linear:function(t){return t;},easeInQuad:function(t){return t*t;},easeOutQuad:function(t){return t*(2-t);},easeInOutQuad:function(t){return t<0.5?2*t*t:-1+2*(2-t)*t;},easeInCubic:function(t){return t*t*t;},easeOutCubic:function(t){return--t*t*t+1;},easeInOutCubic:function(t){return t<0.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1;},easeInQuart:function(t){return t*t*t*t;},easeOutQuart:function(t){return 1-(--t)*t*t*t;},easeInOutQuart:function(t){return t<0.5?8*t*t*t*t:1-8*(--t)*t*t*t;},easeInQuint:function(t){return t*t*t*t*t;},easeOutQuint:function(t){return 1+ --t*t*t*t*t;},easeInOutQuint:function(t){return t<0.5?16*t*t*t*t*t:1+16*(--t)*t*t*t*t;}})},initialize:function Tween(object,from,to,duration,easing,start){this.object=object;var type=typeof easing;var isFunction=type==='function';this.type=isFunction?type:type==='string'?easing:'linear';this.easing=isFunction?easing:Tween.easings[this.type];this.duration=duration;this.running=false;this._then=null;this._startTime=null;var state=from||to;this._keys=state?Object.keys(state):[];this._parsedKeys=this._parseKeys(this._keys);this._from=state&&this._getState(from);this._to=state&&this._getState(to);if(start!==false){this.start();}},then:function(then){this._then=then;return this;},start:function(){this._startTime=null;this.running=true;return this;},stop:function(){this.running=false;return this;},update:function(progress){if(this.running){if(progress>=1){progress=1;this.running=false;}
var factor=this.easing(progress),keys=this._keys,getValue=function(value){return typeof value==='function'?value(factor,progress):value;};for(var i=0,l=keys&&keys.length;i<l;i++){var key=keys[i],from=getValue(this._from[key]),to=getValue(this._to[key]),value=(from&&to&&from.__add&&to.__add)?to.__subtract(from).__multiply(factor).__add(from):((to-from)*factor)+from;this._setProperty(this._parsedKeys[key],value);}
if(this.responds('update')){this.emit('update',new Base({progress:progress,factor:factor}));}
if(!this.running&&this._then){this._then(this.object);}}
return this;},_events:{onUpdate:{}},_handleFrame:function(time){var startTime=this._startTime,progress=startTime?(time-startTime)/ this.duration:0;if(!startTime){this._startTime=time;}
this.update(progress);},_getState:function(state){var keys=this._keys,result={};for(var i=0,l=keys.length;i<l;i++){var key=keys[i],path=this._parsedKeys[key],current=this._getProperty(path),value;if(state){var resolved=this._resolveValue(current,state[key]);this._setProperty(path,resolved);value=this._getProperty(path);value=value&&value.clone?value.clone():value;this._setProperty(path,current);}else{value=current&&current.clone?current.clone():current;}
result[key]=value;}
return result;},_resolveValue:function(current,value){if(value){if(Array.isArray(value)&&value.length===2){var operator=value[0];return(operator&&operator.match&&operator.match(/^[+\-\*\/]=/))?this._calculate(current,operator[0],value[1]):value;}else if(typeof value==='string'){var match=value.match(/^[+\-*/]=(.*)/);if(match){var parsed=JSON.parse(match[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(current,value[0],parsed);}}}
return value;},_calculate:function(left,operator,right){return paper.PaperScript.calculateBinary(left,operator,right);},_parseKeys:function(keys){var parsed={};for(var i=0,l=keys.length;i<l;i++){var key=keys[i],path=key.replace(/\.([^.]*)/g,'/$1').replace(/\[['"]?([^'"\]]*)['"]?\]/g,'/$1');parsed[key]=path.split('/');}
return parsed;},_getProperty:function(path,offset){var obj=this.object;for(var i=0,l=path.length-(offset||0);i<l&&obj;i++){obj=obj[path[i]];}
return obj;},_setProperty:function(path,value){var dest=this._getProperty(path,1);if(dest){dest[path[path.length-1]]=value;}}});var Http={request:function(options){var xhr=new self.XMLHttpRequest();xhr.open((options.method||'get').toUpperCase(),options.url,Base.pick(options.async,true));if(options.mimeType)
xhr.overrideMimeType(options.mimeType);xhr.onload=function(){var status=xhr.status;if(status===0||status===200){if(options.onLoad){options.onLoad.call(xhr,xhr.responseText);}}else{xhr.onerror();}};xhr.onerror=function(){var status=xhr.status,message='Could not load "'+options.url+'" (Status: '
+status+')';if(options.onError){options.onError(message,status);}else{throw new Error(message);}};return xhr.send(null);}};var CanvasProvider=Base.exports.CanvasProvider={canvases:[],getCanvas:function(width,height){if(!window)
return null;var canvas,clear=true;if(typeof width==='object'){height=width.height;width=width.width;}
if(this.canvases.length){canvas=this.canvases.pop();}else{canvas=document.createElement('canvas');clear=false;}
var ctx=canvas.getContext('2d');if(!ctx){throw new Error('Canvas '+canvas+' is unable to provide a 2D context.');}
if(canvas.width===width&&canvas.height===height){if(clear)
ctx.clearRect(0,0,width+1,height+1);}else{canvas.width=width;canvas.height=height;}
ctx.save();return canvas;},getContext:function(width,height){var canvas=this.getCanvas(width,height);return canvas?canvas.getContext('2d'):null;},release:function(obj){var canvas=obj&&obj.canvas?obj.canvas:obj;if(canvas&&canvas.getContext){canvas.getContext('2d').restore();this.canvases.push(canvas);}}};var BlendMode=new function(){var min=Math.min,max=Math.max,abs=Math.abs,sr,sg,sb,sa,br,bg,bb,ba,dr,dg,db;function getLum(r,g,b){return 0.2989*r+0.587*g+0.114*b;}
function setLum(r,g,b,l){var d=l-getLum(r,g,b);dr=r+d;dg=g+d;db=b+d;var l=getLum(dr,dg,db),mn=min(dr,dg,db),mx=max(dr,dg,db);if(mn<0){var lmn=l-mn;dr=l+(dr-l)*l / lmn;dg=l+(dg-l)*l / lmn;db=l+(db-l)*l / lmn;}
if(mx>255){var ln=255-l,mxl=mx-l;dr=l+(dr-l)*ln / mxl;dg=l+(dg-l)*ln / mxl;db=l+(db-l)*ln / mxl;}}
function getSat(r,g,b){return max(r,g,b)-min(r,g,b);}
function setSat(r,g,b,s){var col=[r,g,b],mx=max(r,g,b),mn=min(r,g,b),md;mn=mn===r?0:mn===g?1:2;mx=mx===r?0:mx===g?1:2;md=min(mn,mx)===0?max(mn,mx)===1?2:1:0;if(col[mx]>col[mn]){col[md]=(col[md]-col[mn])*s /(col[mx]-col[mn]);col[mx]=s;}else{col[md]=col[mx]=0;}
col[mn]=0;dr=col[0];dg=col[1];db=col[2];}
var modes={multiply:function(){dr=br*sr / 255;dg=bg*sg / 255;db=bb*sb / 255;},screen:function(){dr=br+sr-(br*sr / 255);dg=bg+sg-(bg*sg / 255);db=bb+sb-(bb*sb / 255);},overlay:function(){dr=br<128?2*br*sr / 255:255-2*(255-br)*(255-sr)/ 255;dg=bg<128?2*bg*sg / 255:255-2*(255-bg)*(255-sg)/ 255;db=bb<128?2*bb*sb / 255:255-2*(255-bb)*(255-sb)/ 255;},'soft-light':function(){var t=sr*br / 255;dr=t+br*(255-(255-br)*(255-sr)/ 255-t)/ 255;t=sg*bg / 255;dg=t+bg*(255-(255-bg)*(255-sg)/ 255-t)/ 255;t=sb*bb / 255;db=t+bb*(255-(255-bb)*(255-sb)/ 255-t)/ 255;},'hard-light':function(){dr=sr<128?2*sr*br / 255:255-2*(255-sr)*(255-br)/ 255;dg=sg<128?2*sg*bg / 255:255-2*(255-sg)*(255-bg)/ 255;db=sb<128?2*sb*bb / 255:255-2*(255-sb)*(255-bb)/ 255;},'color-dodge':function(){dr=br===0?0:sr===255?255:min(255,255*br /(255-sr));dg=bg===0?0:sg===255?255:min(255,255*bg /(255-sg));db=bb===0?0:sb===255?255:min(255,255*bb /(255-sb));},'color-burn':function(){dr=br===255?255:sr===0?0:max(0,255-(255-br)*255 / sr);dg=bg===255?255:sg===0?0:max(0,255-(255-bg)*255 / sg);db=bb===255?255:sb===0?0:max(0,255-(255-bb)*255 / sb);},darken:function(){dr=br<sr?br:sr;dg=bg<sg?bg:sg;db=bb<sb?bb:sb;},lighten:function(){dr=br>sr?br:sr;dg=bg>sg?bg:sg;db=bb>sb?bb:sb;},difference:function(){dr=br-sr;if(dr<0)
dr=-dr;dg=bg-sg;if(dg<0)
dg=-dg;db=bb-sb;if(db<0)
db=-db;},exclusion:function(){dr=br+sr*(255-br-br)/ 255;dg=bg+sg*(255-bg-bg)/ 255;db=bb+sb*(255-bb-bb)/ 255;},hue:function(){setSat(sr,sg,sb,getSat(br,bg,bb));setLum(dr,dg,db,getLum(br,bg,bb));},saturation:function(){setSat(br,bg,bb,getSat(sr,sg,sb));setLum(dr,dg,db,getLum(br,bg,bb));},luminosity:function(){setLum(br,bg,bb,getLum(sr,sg,sb));},color:function(){setLum(sr,sg,sb,getLum(br,bg,bb));},add:function(){dr=min(br+sr,255);dg=min(bg+sg,255);db=min(bb+sb,255);},subtract:function(){dr=max(br-sr,0);dg=max(bg-sg,0);db=max(bb-sb,0);},average:function(){dr=(br+sr)/ 2;dg=(bg+sg)/ 2;db=(bb+sb)/ 2;},negation:function(){dr=255-abs(255-sr-br);dg=255-abs(255-sg-bg);db=255-abs(255-sb-bb);}};var nativeModes=this.nativeModes=Base.each(['source-over','source-in','source-out','source-atop','destination-over','destination-in','destination-out','destination-atop','lighter','darker','copy','xor'],function(mode){this[mode]=true;},{});var ctx=CanvasProvider.getContext(1,1);if(ctx){Base.each(modes,function(func,mode){var darken=mode==='darken',ok=false;ctx.save();try{ctx.fillStyle=darken?'#300':'#a00';ctx.fillRect(0,0,1,1);ctx.globalCompositeOperation=mode;if(ctx.globalCompositeOperation===mode){ctx.fillStyle=darken?'#a00':'#300';ctx.fillRect(0,0,1,1);ok=ctx.getImageData(0,0,1,1).data[0]!==darken?170:51;}}catch(e){}
ctx.restore();nativeModes[mode]=ok;});CanvasProvider.release(ctx);}
this.process=function(mode,srcContext,dstContext,alpha,offset){var srcCanvas=srcContext.canvas,normal=mode==='normal';if(normal||nativeModes[mode]){dstContext.save();dstContext.setTransform(1,0,0,1,0,0);dstContext.globalAlpha=alpha;if(!normal)
dstContext.globalCompositeOperation=mode;dstContext.drawImage(srcCanvas,offset.x,offset.y);dstContext.restore();}else{var process=modes[mode];if(!process)
return;var dstData=dstContext.getImageData(offset.x,offset.y,srcCanvas.width,srcCanvas.height),dst=dstData.data,src=srcContext.getImageData(0,0,srcCanvas.width,srcCanvas.height).data;for(var i=0,l=dst.length;i<l;i+=4){sr=src[i];br=dst[i];sg=src[i+1];bg=dst[i+1];sb=src[i+2];bb=dst[i+2];sa=src[i+3];ba=dst[i+3];process();var a1=sa*alpha / 255,a2=1-a1;dst[i]=a1*dr+a2*br;dst[i+1]=a1*dg+a2*bg;dst[i+2]=a1*db+a2*bb;dst[i+3]=sa*alpha+a2*ba;}
dstContext.putImageData(dstData,offset.x,offset.y);}};};var SvgElement=new function(){var svg='http://www.w3.org/2000/svg',xmlns='http://www.w3.org/2000/xmlns',xlink='http://www.w3.org/1999/xlink',attributeNamespace={href:xlink,xlink:xmlns,xmlns:xmlns+'/','xmlns:xlink':xmlns+'/'};function create(tag,attributes,formatter){return set(document.createElementNS(svg,tag),attributes,formatter);}
function get(node,name){var namespace=attributeNamespace[name],value=namespace?node.getAttributeNS(namespace,name):node.getAttribute(name);return value==='null'?null:value;}
function set(node,attributes,formatter){for(var name in attributes){var value=attributes[name],namespace=attributeNamespace[name];if(typeof value==='number'&&formatter)
value=formatter.number(value);if(namespace){node.setAttributeNS(namespace,name,value);}else{node.setAttribute(name,value);}}
return node;}
return{svg:svg,xmlns:xmlns,xlink:xlink,create:create,get:get,set:set};};var SvgStyles=Base.each({fillColor:['fill','color'],fillRule:['fill-rule','string'],strokeColor:['stroke','color'],strokeWidth:['stroke-width','number'],strokeCap:['stroke-linecap','string'],strokeJoin:['stroke-linejoin','string'],strokeScaling:['vector-effect','lookup',{true:'none',false:'non-scaling-stroke'},function(item,value){return!value&&(item instanceof PathItem||item instanceof Shape||item instanceof TextItem);}],miterLimit:['stroke-miterlimit','number'],dashArray:['stroke-dasharray','array'],dashOffset:['stroke-dashoffset','number'],fontFamily:['font-family','string'],fontWeight:['font-weight','string'],fontSize:['font-size','number'],justification:['text-anchor','lookup',{left:'start',center:'middle',right:'end'}],opacity:['opacity','number'],blendMode:['mix-blend-mode','style']},function(entry,key){var part=Base.capitalize(key),lookup=entry[2];this[key]={type:entry[1],property:key,attribute:entry[0],toSVG:lookup,fromSVG:lookup&&Base.each(lookup,function(value,name){this[value]=name;},{}),exportFilter:entry[3],get:'get'+part,set:'set'+part};},{});new function(){var formatter;function getTransform(matrix,coordinates,center){var attrs=new Base(),trans=matrix.getTranslation();if(coordinates){var point;if(matrix.isInvertible()){matrix=matrix._shiftless();point=matrix._inverseTransform(trans);trans=null;}else{point=new Point();}
attrs[center?'cx':'x']=point.x;attrs[center?'cy':'y']=point.y;}
if(!matrix.isIdentity()){var decomposed=matrix.decompose();if(decomposed){var parts=[],angle=decomposed.rotation,scale=decomposed.scaling,skew=decomposed.skewing;if(trans&&!trans.isZero())
parts.push('translate('+formatter.point(trans)+')');if(angle)
parts.push('rotate('+formatter.number(angle)+')');if(!Numerical.isZero(scale.x-1)||!Numerical.isZero(scale.y-1))
parts.push('scale('+formatter.point(scale)+')');if(skew.x)
parts.push('skewX('+formatter.number(skew.x)+')');if(skew.y)
parts.push('skewY('+formatter.number(skew.y)+')');attrs.transform=parts.join(' ');}else{attrs.transform='matrix('+matrix.getValues().join(',')+')';}}
return attrs;}
function exportGroup(item,options){var attrs=getTransform(item._matrix),children=item._children;var node=SvgElement.create('g',attrs,formatter);for(var i=0,l=children.length;i<l;i++){var child=children[i];var childNode=exportSVG(child,options);if(childNode){if(child.isClipMask()){var clip=SvgElement.create('clipPath');clip.appendChild(childNode);setDefinition(child,clip,'clip');SvgElement.set(node,{'clip-path':'url(#'+clip.id+')'});}else{node.appendChild(childNode);}}}
return node;}
function exportRaster(item,options){var attrs=getTransform(item._matrix,true),size=item.getSize(),image=item.getImage();attrs.x-=size.width / 2;attrs.y-=size.height / 2;attrs.width=size.width;attrs.height=size.height;attrs.href=options.embedImages==false&&image&&image.src||item.toDataURL();return SvgElement.create('image',attrs,formatter);}
function exportPath(item,options){var matchShapes=options.matchShapes;if(matchShapes){var shape=item.toShape(false);if(shape)
return exportShape(shape,options);}
var segments=item._segments,length=segments.length,type,attrs=getTransform(item._matrix);if(matchShapes&&length>=2&&!item.hasHandles()){if(length>2){type=item._closed?'polygon':'polyline';var parts=[];for(var i=0;i<length;i++){parts.push(formatter.point(segments[i]._point));}
attrs.points=parts.join(' ');}else{type='line';var start=segments[0]._point,end=segments[1]._point;attrs.set({x1:start.x,y1:start.y,x2:end.x,y2:end.y});}}else{type='path';attrs.d=item.getPathData(null,options.precision);}
return SvgElement.create(type,attrs,formatter);}
function exportShape(item){var type=item._type,radius=item._radius,attrs=getTransform(item._matrix,true,type!=='rectangle');if(type==='rectangle'){type='rect';var size=item._size,width=size.width,height=size.height;attrs.x-=width / 2;attrs.y-=height / 2;attrs.width=width;attrs.height=height;if(radius.isZero())
radius=null;}
if(radius){if(type==='circle'){attrs.r=radius;}else{attrs.rx=radius.width;attrs.ry=radius.height;}}
return SvgElement.create(type,attrs,formatter);}
function exportCompoundPath(item,options){var attrs=getTransform(item._matrix);var data=item.getPathData(null,options.precision);if(data)
attrs.d=data;return SvgElement.create('path',attrs,formatter);}
function exportSymbolItem(item,options){var attrs=getTransform(item._matrix,true),definition=item._definition,node=getDefinition(definition,'symbol'),definitionItem=definition._item,bounds=definitionItem.getStrokeBounds();if(!node){node=SvgElement.create('symbol',{viewBox:formatter.rectangle(bounds)});node.appendChild(exportSVG(definitionItem,options));setDefinition(definition,node,'symbol');}
attrs.href='#'+node.id;attrs.x+=bounds.x;attrs.y+=bounds.y;attrs.width=bounds.width;attrs.height=bounds.height;attrs.overflow='visible';return SvgElement.create('use',attrs,formatter);}
function exportGradient(color){var gradientNode=getDefinition(color,'color');if(!gradientNode){var gradient=color.getGradient(),radial=gradient._radial,origin=color.getOrigin(),destination=color.getDestination(),attrs;if(radial){attrs={cx:origin.x,cy:origin.y,r:origin.getDistance(destination)};var highlight=color.getHighlight();if(highlight){attrs.fx=highlight.x;attrs.fy=highlight.y;}}else{attrs={x1:origin.x,y1:origin.y,x2:destination.x,y2:destination.y};}
attrs.gradientUnits='userSpaceOnUse';gradientNode=SvgElement.create((radial?'radial':'linear')
+'Gradient',attrs,formatter);var stops=gradient._stops;for(var i=0,l=stops.length;i<l;i++){var stop=stops[i],stopColor=stop._color,alpha=stopColor.getAlpha(),offset=stop._offset;attrs={offset:offset==null?i /(l-1):offset};if(stopColor)
attrs['stop-color']=stopColor.toCSS(true);if(alpha<1)
attrs['stop-opacity']=alpha;gradientNode.appendChild(SvgElement.create('stop',attrs,formatter));}
setDefinition(color,gradientNode,'color');}
return'url(#'+gradientNode.id+')';}
function exportText(item){var node=SvgElement.create('text',getTransform(item._matrix,true),formatter);node.textContent=item._content;return node;}
var exporters={Group:exportGroup,Layer:exportGroup,Raster:exportRaster,Path:exportPath,Shape:exportShape,CompoundPath:exportCompoundPath,SymbolItem:exportSymbolItem,PointText:exportText};function applyStyle(item,node,isRoot){var attrs={},parent=!isRoot&&item.getParent(),style=[];if(item._name!=null)
attrs.id=item._name;Base.each(SvgStyles,function(entry){var get=entry.get,type=entry.type,value=item[get]();if(entry.exportFilter?entry.exportFilter(item,value):!parent||!Base.equals(parent[get](),value)){if(type==='color'&&value!=null){var alpha=value.getAlpha();if(alpha<1)
attrs[entry.attribute+'-opacity']=alpha;}
if(type==='style'){style.push(entry.attribute+': '+value);}else{attrs[entry.attribute]=value==null?'none':type==='color'?value.gradient?exportGradient(value,item):value.toCSS(true):type==='array'?value.join(','):type==='lookup'?entry.toSVG[value]:value;}}});if(style.length)
attrs.style=style.join(';');if(attrs.opacity===1)
delete attrs.opacity;if(!item._visible)
attrs.visibility='hidden';return SvgElement.set(node,attrs,formatter);}
var definitions;function getDefinition(item,type){if(!definitions)
definitions={ids:{},svgs:{}};return item&&definitions.svgs[type+'-'
+(item._id||item.__id||(item.__id=UID.get('svg')))];}
function setDefinition(item,node,type){if(!definitions)
getDefinition();var typeId=definitions.ids[type]=(definitions.ids[type]||0)+1;node.id=type+'-'+typeId;definitions.svgs[type+'-'+(item._id||item.__id)]=node;}
function exportDefinitions(node,options){var svg=node,defs=null;if(definitions){svg=node.nodeName.toLowerCase()==='svg'&&node;for(var i in definitions.svgs){if(!defs){if(!svg){svg=SvgElement.create('svg');svg.appendChild(node);}
defs=svg.insertBefore(SvgElement.create('defs'),svg.firstChild);}
defs.appendChild(definitions.svgs[i]);}
definitions=null;}
return options.asString?new self.XMLSerializer().serializeToString(svg):svg;}
function exportSVG(item,options,isRoot){var exporter=exporters[item._class],node=exporter&&exporter(item,options);if(node){var onExport=options.onExport;if(onExport)
node=onExport(item,node,options)||node;var data=JSON.stringify(item._data);if(data&&data!=='{}'&&data!=='null')
node.setAttribute('data-paper-data',data);}
return node&&applyStyle(item,node,isRoot);}
function setOptions(options){if(!options)
options={};formatter=new Formatter(options.precision);return options;}
Item.inject({exportSVG:function(options){options=setOptions(options);return exportDefinitions(exportSVG(this,options,true),options);}});Project.inject({exportSVG:function(options){options=setOptions(options);var children=this._children,view=this.getView(),bounds=Base.pick(options.bounds,'view'),mx=options.matrix||bounds==='view'&&view._matrix,matrix=mx&&Matrix.read([mx]),rect=bounds==='view'?new Rectangle([0,0],view.getViewSize()):bounds==='content'?Item._getBounds(children,matrix,{stroke:true}).rect:Rectangle.read([bounds],0,{readNull:true}),attrs={version:'1.1',xmlns:SvgElement.svg,'xmlns:xlink':SvgElement.xlink,};if(rect){attrs.width=rect.width;attrs.height=rect.height;if(rect.x||rect.x===0||rect.y||rect.y===0)
attrs.viewBox=formatter.rectangle(rect);}
var node=SvgElement.create('svg',attrs,formatter),parent=node;if(matrix&&!matrix.isIdentity()){parent=node.appendChild(SvgElement.create('g',getTransform(matrix),formatter));}
for(var i=0,l=children.length;i<l;i++){parent.appendChild(exportSVG(children[i],options,true));}
return exportDefinitions(node,options);}});};new function(){var definitions={},rootSize;function getValue(node,name,isString,allowNull,allowPercent,defaultValue){var value=SvgElement.get(node,name)||defaultValue,res=value==null?allowNull?null:isString?'':0:isString?value:parseFloat(value);return /%\s*$/.test(value)?(res / 100)*(allowPercent?1:rootSize[/x|^width/.test(name)?'width':'height']):res;}
function getPoint(node,x,y,allowNull,allowPercent,defaultX,defaultY){x=getValue(node,x||'x',false,allowNull,allowPercent,defaultX);y=getValue(node,y||'y',false,allowNull,allowPercent,defaultY);return allowNull&&(x==null||y==null)?null:new Point(x,y);}
function getSize(node,w,h,allowNull,allowPercent){w=getValue(node,w||'width',false,allowNull,allowPercent);h=getValue(node,h||'height',false,allowNull,allowPercent);return allowNull&&(w==null||h==null)?null:new Size(w,h);}
function convertValue(value,type,lookup){return value==='none'?null:type==='number'?parseFloat(value):type==='array'?value?value.split(/[\s,]+/g).map(parseFloat):[]:type==='color'?getDefinition(value)||value:type==='lookup'?lookup[value]:value;}
function importGroup(node,type,options,isRoot){var nodes=node.childNodes,isClip=type==='clippath',isDefs=type==='defs',item=new Group(),project=item._project,currentStyle=project._currentStyle,children=[];if(!isClip&&!isDefs){item=applyAttributes(item,node,isRoot);project._currentStyle=item._style.clone();}
if(isRoot){var defs=node.querySelectorAll('defs');for(var i=0,l=defs.length;i<l;i++){importNode(defs[i],options,false);}}
for(var i=0,l=nodes.length;i<l;i++){var childNode=nodes[i],child;if(childNode.nodeType===1&&!/^defs$/i.test(childNode.nodeName)&&(child=importNode(childNode,options,false))&&!(child instanceof SymbolDefinition))
children.push(child);}
item.addChildren(children);if(isClip)
item=applyAttributes(item.reduce(),node,isRoot);project._currentStyle=currentStyle;if(isClip||isDefs){item.remove();item=null;}
return item;}
function importPoly(node,type){var coords=node.getAttribute('points').match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),points=[];for(var i=0,l=coords.length;i<l;i+=2)
points.push(new Point(parseFloat(coords[i]),parseFloat(coords[i+1])));var path=new Path(points);if(type==='polygon')
path.closePath();return path;}
function importPath(node){return PathItem.create(node.getAttribute('d'));}
function importGradient(node,type){var id=(getValue(node,'href',true)||'').substring(1),radial=type==='radialgradient',gradient;if(id){gradient=definitions[id].getGradient();if(gradient._radial^radial){gradient=gradient.clone();gradient._radial=radial;}}else{var nodes=node.childNodes,stops=[];for(var i=0,l=nodes.length;i<l;i++){var child=nodes[i];if(child.nodeType===1)
stops.push(applyAttributes(new GradientStop(),child));}
gradient=new Gradient(stops,radial);}
var origin,destination,highlight,scaleToBounds=getValue(node,'gradientUnits',true)!=='userSpaceOnUse';if(radial){origin=getPoint(node,'cx','cy',false,scaleToBounds,'50%','50%');destination=origin.add(getValue(node,'r',false,false,scaleToBounds,'50%'),0);highlight=getPoint(node,'fx','fy',true,scaleToBounds);}else{origin=getPoint(node,'x1','y1',false,scaleToBounds,'0%','0%');destination=getPoint(node,'x2','y2',false,scaleToBounds,'100%','0%');}
var color=applyAttributes(new Color(gradient,origin,destination,highlight),node);color._scaleToBounds=scaleToBounds;return null;}
var importers={'#document':function(node,type,options,isRoot){var nodes=node.childNodes;for(var i=0,l=nodes.length;i<l;i++){var child=nodes[i];if(child.nodeType===1)
return importNode(child,options,isRoot);}},g:importGroup,svg:importGroup,clippath:importGroup,polygon:importPoly,polyline:importPoly,path:importPath,lineargradient:importGradient,radialgradient:importGradient,image:function(node){var raster=new Raster(getValue(node,'href',true));raster.on('load',function(){var size=getSize(node);this.setSize(size);var center=getPoint(node).add(size.divide(2));this._matrix.append(new Matrix().translate(center));});return raster;},symbol:function(node,type,options,isRoot){return new SymbolDefinition(importGroup(node,type,options,isRoot),true);},defs:importGroup,use:function(node){var id=(getValue(node,'href',true)||'').substring(1),definition=definitions[id],point=getPoint(node);return definition?definition instanceof SymbolDefinition?definition.place(point):definition.clone().translate(point):null;},circle:function(node){return new Shape.Circle(getPoint(node,'cx','cy'),getValue(node,'r'));},ellipse:function(node){return new Shape.Ellipse({center:getPoint(node,'cx','cy'),radius:getSize(node,'rx','ry')});},rect:function(node){return new Shape.Rectangle(new Rectangle(getPoint(node),getSize(node)),getSize(node,'rx','ry'));},line:function(node){return new Path.Line(getPoint(node,'x1','y1'),getPoint(node,'x2','y2'));},text:function(node){var text=new PointText(getPoint(node).add(getPoint(node,'dx','dy')));text.setContent(node.textContent.trim()||'');return text;},switch:importGroup};function applyTransform(item,value,name,node){if(item.transform){var transforms=(node.getAttribute(name)||'').split(/\)\s*/g),matrix=new Matrix();for(var i=0,l=transforms.length;i<l;i++){var transform=transforms[i];if(!transform)
break;var parts=transform.split(/\(\s*/),command=parts[0],v=parts[1].split(/[\s,]+/g);for(var j=0,m=v.length;j<m;j++)
v[j]=parseFloat(v[j]);switch(command){case'matrix':matrix.append(new Matrix(v[0],v[1],v[2],v[3],v[4],v[5]));break;case'rotate':matrix.rotate(v[0],v[1]||0,v[2]||0);break;case'translate':matrix.translate(v[0],v[1]||0);break;case'scale':matrix.scale(v);break;case'skewX':matrix.skew(v[0],0);break;case'skewY':matrix.skew(0,v[0]);break;}}
item.transform(matrix);}}
function applyOpacity(item,value,name){var key=name==='fill-opacity'?'getFillColor':'getStrokeColor',color=item[key]&&item[key]();if(color)
color.setAlpha(parseFloat(value));}
var attributes=Base.set(Base.each(SvgStyles,function(entry){this[entry.attribute]=function(item,value){if(item[entry.set]){item[entry.set](convertValue(value,entry.type,entry.fromSVG));if(entry.type==='color'){var color=item[entry.get]();if(color){if(color._scaleToBounds){var bounds=item.getBounds();color.transform(new Matrix().translate(bounds.getPoint()).scale(bounds.getSize()));}}}}};},{}),{id:function(item,value){definitions[value]=item;if(item.setName)
item.setName(value);},'clip-path':function(item,value){var clip=getDefinition(value);if(clip){clip=clip.clone();clip.setClipMask(true);if(item instanceof Group){item.insertChild(0,clip);}else{return new Group(clip,item);}}},gradientTransform:applyTransform,transform:applyTransform,'fill-opacity':applyOpacity,'stroke-opacity':applyOpacity,visibility:function(item,value){if(item.setVisible)
item.setVisible(value==='visible');},display:function(item,value){if(item.setVisible)
item.setVisible(value!==null);},'stop-color':function(item,value){if(item.setColor)
item.setColor(value);},'stop-opacity':function(item,value){if(item._color)
item._color.setAlpha(parseFloat(value));},offset:function(item,value){if(item.setOffset){var percent=value.match(/(.*)%$/);item.setOffset(percent?percent[1]/ 100:parseFloat(value));}},viewBox:function(item,value,name,node,styles){var rect=new Rectangle(convertValue(value,'array')),size=getSize(node,null,null,true),group,matrix;if(item instanceof Group){var scale=size?size.divide(rect.getSize()):1,matrix=new Matrix().scale(scale).translate(rect.getPoint().negate());group=item;}else if(item instanceof SymbolDefinition){if(size)
rect.setSize(size);group=item._item;}
if(group){if(getAttribute(node,'overflow',styles)!=='visible'){var clip=new Shape.Rectangle(rect);clip.setClipMask(true);group.addChild(clip);}
if(matrix)
group.transform(matrix);}}});function getAttribute(node,name,styles){var attr=node.attributes[name],value=attr&&attr.value;if(!value&&node.style){var style=Base.camelize(name);value=node.style[style];if(!value&&styles.node[style]!==styles.parent[style])
value=styles.node[style];}
return!value?undefined:value==='none'?null:value;}
function applyAttributes(item,node,isRoot){var parent=node.parentNode,styles={node:DomElement.getStyles(node)||{},parent:!isRoot&&!/^defs$/i.test(parent.tagName)&&DomElement.getStyles(parent)||{}};Base.each(attributes,function(apply,name){var value=getAttribute(node,name,styles);item=value!==undefined&&apply(item,value,name,node,styles)||item;});return item;}
function getDefinition(value){var match=value&&value.match(/\((?:["'#]*)([^"')]+)/),name=match&&match[1],res=name&&definitions[window?name.replace(window.location.href.split('#')[0]+'#',''):name];if(res&&res._scaleToBounds){res=res.clone();res._scaleToBounds=true;}
return res;}
function importNode(node,options,isRoot){var type=node.nodeName.toLowerCase(),isElement=type!=='#document',body=document.body,container,parent,next;if(isRoot&&isElement){rootSize=paper.getView().getSize();rootSize=getSize(node,null,null,true)||rootSize;container=SvgElement.create('svg',{style:'stroke-width: 1px; stroke-miterlimit: 10'});parent=node.parentNode;next=node.nextSibling;container.appendChild(node);body.appendChild(container);}
var settings=paper.settings,applyMatrix=settings.applyMatrix,insertItems=settings.insertItems;settings.applyMatrix=false;settings.insertItems=false;var importer=importers[type],item=importer&&importer(node,type,options,isRoot)||null;settings.insertItems=insertItems;settings.applyMatrix=applyMatrix;if(item){if(isElement&&!(item instanceof Group))
item=applyAttributes(item,node,isRoot);var onImport=options.onImport,data=isElement&&node.getAttribute('data-paper-data');if(onImport)
item=onImport(node,item,options)||item;if(options.expandShapes&&item instanceof Shape){item.remove();item=item.toPath();}
if(data)
item._data=JSON.parse(data);}
if(container){body.removeChild(container);if(parent){if(next){parent.insertBefore(node,next);}else{parent.appendChild(node);}}}
if(isRoot){definitions={};if(item&&Base.pick(options.applyMatrix,applyMatrix))
item.matrix.apply(true,true);}
return item;}
function importSVG(source,options,owner){if(!source)
return null;options=typeof options==='function'?{onLoad:options}:options||{};var scope=paper,item=null;function onLoad(svg){try{var node=typeof svg==='object'?svg:new self.DOMParser().parseFromString(svg.trim(),'image/svg+xml');if(!node.nodeName){node=null;throw new Error('Unsupported SVG source: '+source);}
paper=scope;item=importNode(node,options,true);if(!options||options.insert!==false){owner._insertItem(undefined,item);}
var onLoad=options.onLoad;if(onLoad)
onLoad(item,svg);}catch(e){onError(e);}}
function onError(message,status){var onError=options.onError;if(onError){onError(message,status);}else{throw new Error(message);}}
if(typeof source==='string'&&!/^[\s\S]*</.test(source)){var node=document.getElementById(source);if(node){onLoad(node);}else{Http.request({url:source,async:true,onLoad:onLoad,onError:onError});}}else if(typeof File!=='undefined'&&source instanceof File){var reader=new FileReader();reader.onload=function(){onLoad(reader.result);};reader.onerror=function(){onError(reader.error);};return reader.readAsText(source);}else{onLoad(source);}
return item;}
Item.inject({importSVG:function(node,options){return importSVG(node,options,this);}});Project.inject({importSVG:function(node,options){this.activate();return importSVG(node,options,this);}});};var paper=new(PaperScope.inject(Base.exports,{Base:Base,Numerical:Numerical,Key:Key,DomEvent:DomEvent,DomElement:DomElement,document:document,window:window,Symbol:SymbolDefinition,PlacedSymbol:SymbolItem}))();if(paper.agent.node){require('./node/extend.js')(paper);}
if(typeof define==='function'&&define.amd){define('paper',paper);}else if(typeof module==='object'&&module){module.exports=paper;}
return paper;}.call(this,typeof self==='object'?self:null);
;
ED_BOOKMARK_TYPE_FREEHAND=302;var freebm={drawing:false,_lastPath:undefined,canvas:$(),_defaultDrawToolData:{color:'#000',opacity:1,width:3,round:'round',cap:'round',blendmode:'normal',iseraser:false},drawToolData:undefined,drawOrigin:{x:0,y:0,scale:1},_curPageId:undefined,_isSingleRightSpread:false,_needDrawPage:false,init:function()
{var self=this;jtrace('------- INIT FREEHAND ------');$(document).on("edPageChangeEnded",self,self._pageChangeEnded);$(document).on("edStartingPageSet",self,function(e,page){self.onPageLoaded(e,page)});self.canvas=$('<canvas>').attr({width:window.eddata.head.pageWidth*2,height:window.eddata.head.pageHeight}).addClass('freehandbm ed_overtake_touches gpuAcc').css({position:'absolute',top:'0px',left:'0px'});var self=this;self.canvas.data('drawing_tool',new paper.Tool());paper.setup(self.canvas[0]);self.canvas.data('drawing_project_index',paper.projects.length-1);self.drawPage(undefined,undefined,'freehand init');},onPageLoaded:function(e,page)
{var self=e.data;self.drawPage(page,undefined,'onPageLoaded');},_pageChangeEnded:function(e)
{var self=e.data;jtrace('Page change ended e',e);setTimeout("freebm.drawPage(undefined,undefined,'_pageChangeEnded');",70);},drawPage:function(page,draw_tool_opened,from_where)
{var self=this;if(window.edgl.argo.indexOf('*exit_fhbm*')!=-1){console.log('exit_fhbm');return;}
var arr_pgids_check=[];if(page>0){if(window.eddata.pages[page-1]){arr_pgids_check.push(window.eddata.pages[page-1].id);}
if(eddata.appearance.edition_style=='facingpages'){if(window.eddata.pages[page-2]){arr_pgids_check.push(window.eddata.pages[page-2].id);}
if(window.eddata.pages[page-0]){arr_pgids_check.push(window.eddata.pages[page-0].id);}}}
if(tlbr.currentPageIndex>0){if(window.eddata.pages[tlbr.currentPageIndex-1]){console.log(window.eddata.pages[tlbr.currentPageIndex-1])
arr_pgids_check.push(window.eddata.pages[tlbr.currentPageIndex-1].id);}
if(eddata.appearance.edition_style=='facingpages'){if(window.eddata.pages[tlbr.currentPageIndex-2]){console.log(window.eddata.pages[tlbr.currentPageIndex-2])
arr_pgids_check.push(window.eddata.pages[tlbr.currentPageIndex-2].id);}
if(window.eddata.pages[tlbr.currentPageIndex-0]){console.log(window.eddata.pages[tlbr.currentPageIndex-0])
arr_pgids_check.push(window.eddata.pages[tlbr.currentPageIndex-0].id);}}}
var page_contain_freehandbm=false;for(var i in EDO.bookmarks)
{if(!EDO.bookmarks.hasOwnProperty(i)){continue}
if(EDO.bookmarks[i].del!=1&&EDO.bookmarks[i].tip==ED_BOOKMARK_TYPE_FREEHAND&&arr_pgids_check.indexOf(EDO.bookmarks[i].page_id)!=-1)
{page_contain_freehandbm=true;break;}}
if(!page_contain_freehandbm){if(draw_tool_opened){if(self._needDrawPage){}else{return;}}else{self._needDrawPage=true;return;}}else{if(draw_tool_opened){return;}}
self._needDrawPage=false;var pageLoaded=tlbr.currentPageIndex>-1||parseInt(page,10)>-1;jtrace('Draw freehand '+(pageLoaded?'':'... skip, page not loaded'));if(/*!tlbr.userBookmarks ||*/!pageLoaded){return}
paper.project.activeLayer.removeChildren();setTimeout(function()
{var isRightSpread;var pageIndex=tlbr.currentPageIndex-1;self._isSingleRightSpread=(eddata.appearance.edition_style=='facingpages'&&pageIndex>0&&pageIndex%2==0&&$('#'+window.eddata.pages[tlbr.currentPageIndex-1].divid).parents('.pagesHolder').first().children('.imageRendering').length==1);jtrace('_isSingleRightSpread ='+self._isSingleRightSpread);self._curPageId=window.eddata.pages[tlbr.currentPageIndex-(self._isSingleRightSpread?2:1)].id;var pageData=window.eddata.pages[tlbr.currentPageIndex-1];var pageHolder=$('#'+pageData.divid);if(!pageHolder.length){jtrace('no page holder!!!!!!!!!!!!!');}
self.canvas.css({opacity:0.01}).delay(1000).transition({opacity:1},500).appendTo(pageHolder.parents('.pagesHolder').first());setTimeout(function(){paper.project._needsUpdate=true;paper.project.view.update();},1000);self.canvas.css({left:self._isSingleRightSpread?-self.canvas.width()/2:0});var isDrawing=Boolean(self.drawToolData);if(isDrawing){self.finishDraw();}
for(var i in EDO.bookmarks)
{if(!EDO.bookmarks.hasOwnProperty(i)){continue}
if(EDO.bookmarks[i].del!=1&&EDO.bookmarks[i].tip==ED_BOOKMARK_TYPE_FREEHAND&&EDO.bookmarks[i].page_id==self._curPageId)
{self._lastPath=new paper.Path();self._lastPath.importJSON(EDO.bookmarks[i].bookmark_path);self._lastPath.data.bident=EDO.bookmarks[i].bident;}}
if(isDrawing){self.startDraw();}},10);},startDraw:function(drawToolData)
{var self=this;if(!self.canvas.length){jtrace('Bookmarks arent loaded yet.');return}
if(!self.drawToolData)
{self._initDrawingToolEvents();self.canvas.addClass('editing');var pageData=window.eddata.pages[tlbr.currentPageIndex-1];pageData.iscroll[0].options.handleSingleDrags=false;}
self.drawToolData=$.extend({},self._defaultDrawToolData,drawToolData);},_initDrawingToolEvents:function()
{var self=this;if(!self.canvas.length||self.canvas.data('drawing_events_initialized')){jtrace('events already initialized');return}
self.canvas.data('drawing_events_initialized',true);self.canvas.mouseenter(function(){paper.projects[self.canvas.data('drawing_project_index')].activate();});var tool=self.canvas.data('drawing_tool');function penSupport(event,onlyevent=false){var detectPenSupport=$("#fb_pen_support").prop("checked")?true:false;if(!detectPenSupport){return true;}
try{event=event.event;var pen=false;var evn=['touchstart','touchmove','touchend','touchcancel'];var prs=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];var alw=evn.includes(event.type);var frc=[];var tch=[];if(onlyevent&&alw){pen=true;}else if(alw){for(var e in event.touches){if(event.touches[e].force){frc.push(parseFloat(event.touches[e].force));tch.push(prs.includes(parseFloat(event.touches[e].force))?0:1);if(!prs.includes(parseFloat(event.touches[e].force))){pen=true;}}}}
return(pen?true:false);}catch(e){return true;}}
function pressDown(event){jtrace('press down');var doDraw=event.event.button==0||(event.event.touches&&event.event.touches.length==1);if(!penSupport(event)){return true;};if(!doDraw){return true;}
var pageData=window.eddata.pages[tlbr.currentPageIndex-1];var pageHolder=$('#'+pageData.divid);self.drawOrigin={x:pageHolder.offset().left,y:pageHolder.offset().top,scale:pageData.iscroll[0].scale}
if(self._lastPath){self._lastPath.selected=false;}
self._lastPath=new paper.Path();self._lastPath.data.bident=bident_randomString();self._lastPath.strokeColor=self.drawToolData.color;self._lastPath.strokeWidth=self.drawToolData.width;self._lastPath.strokeCap=self.drawToolData.cap;self._lastPath.strokeJoin=self.drawToolData.joint;self._lastPath.opacity=self.drawToolData.opacity;self._lastPath.blendMode=self.drawToolData.blendmode;}
function pressMove(event){}
function pressDrag(event){var doDraw=event.event.button==0||(event.event.touches&&event.event.touches.length==1);if(!penSupport(event)){return true;};if(!doDraw){return true;}
if(self.selectedItem)
{if(!mouseDownPoint)
mouseDownPoint=self.selectedItem.position;self.setCursorHandClose();var scale=self.drawOrigin.scale,x=self.drawOrigin.x+self.selectedItem.position.x+event.delta.x;y=self.drawOrigin.y+self.selectedItem.position.y+event.delta.y;self.selectedItem.position=new paper.Point(x,y);}
else if(self._lastPath)
{var pt={x:event.point.x / self.drawOrigin.scale,y:event.point.y / self.drawOrigin.scale}
self._lastPath.add(pt);}
else
{jtrace('no shape');}}
function pressUp(event){if(!penSupport(event,true)){return true;};if(self.selectedItem){}else{if(self.drawToolData.iseraser)
{var paths=paper.project.activeLayer.children;var db={},count=0;var len=paths.length;for(var i=len-1;i>=0;i--)
{if(objConstructorName(paths[i]).toLowerCase()=='path'&&self._lastPath.getIntersections(paths[i]).length)
{var bident=paths[i]._data.bident;jtrace('remove '+bident);paths[i].remove();for(var j=EDO.bookmarks.length-1;j>=0;j--)
{if(EDO.bookmarks[j].bident==bident)
{EDO.bookmarks.splice(j,1);}}
db[bident]={del:"1"};count++;}}
if(count){user_bookmarks_add_edit_delete(db);}
self._lastPath.remove();return;}
self._lastPath.simplify();self._lastPath.remove();var strPath=self._lastPath.exportJSON({asString:false,precision:1});var bident=bident_randomString();self._lastPath=new paper.Path();self._lastPath.importJSON(strPath);self._lastPath.data.bident=bident;var obj={};obj[bident]={page_id:self._curPageId,tip:ED_BOOKMARK_TYPE_FREEHAND,bookmark_path:strPath}
user_bookmarks_add_edit_delete(obj);obj[bident].bident=bident;EDO.bookmarks.push(obj[bident]);}}
tool.onMouseDown=function(event){pressDown(event);}
tool.onMouseMove=function(event){pressMove(event);}
tool.onMouseDrag=function(event){pressDrag(event);}
tool.onMouseUp=function(event){pressUp(event);}
if(window.localStorage.getItem('forcepensupport')){if(window.localStorage.getItem('forcepensupport')==='1'){$('#fb_pen_support').prop('checked',true);}}
$('#fb_pen_support').change(function(){console.log("checked: ",this.checked);window.localStorage.setItem('forcepensupport',this.checked?'1':'0');});},finishDraw:function()
{var self=this;jtrace('Finish draw');var pageData=window.eddata.pages[tlbr.currentPageIndex-1];self.canvas.removeClass('editing');pageData.iscroll[0].options.handleSingleDrags=true;delete self.drawToolData;},}
;
/*! eDitionTextbox v5.1.1 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(window,document,Math){var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000 / 60);};var utils=(function(){var me={};var _elementStyle=document.createElement('div').style;var _vendor=(function(){var vendors=['t','webkitT','MozT','msT','OT'],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+'ransform';if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);}
return false;})();function _prefixStyle(style){if(_vendor===false)return false;if(_vendor==='')return style;return _vendor+style.charAt(0).toUpperCase()+style.substr(1);}
me.getTime=Date.now||function getTime(){return new Date().getTime();};me.extend=function(target,obj){for(var i in obj){target[i]=obj[i];}};me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture);};me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture);};me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/ time,destination,duration;deceleration=deceleration===undefined?0.0006:deceleration;destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);duration=speed / deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-(wrapperSize / 2.5*(speed / 8)):lowerMargin;distance=Math.abs(destination-current);duration=distance / speed;}else if(destination>0){destination=wrapperSize?wrapperSize / 2.5*(speed / 8):0;distance=Math.abs(current)+destination;duration=distance / speed;}
return{destination:Math.round(destination),duration:duration};};var _transform=_prefixStyle('transform');me.extend(me,{hasTransform:_transform!==false,hasPerspective:_prefixStyle('perspective')in _elementStyle,hasTouch:'ontouchstart'in window,hasPointer:navigator.msPointerEnabled,hasTransition:_prefixStyle('transition')in _elementStyle});me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle('transitionTimingFunction'),transitionDuration:_prefixStyle('transitionDuration'),transitionDelay:_prefixStyle('transitionDelay'),transformOrigin:_prefixStyle('transformOrigin')});me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className);};me.addClass=function(e,c){if(me.hasClass(e,c)){return;}
var newclass=e.className.split(' ');newclass.push(c);e.className=newclass.join(' ');};me.removeClass=function(e,c){if(!me.hasClass(e,c)){return;}
var re=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');e.className=e.className.replace(re,' ');};me.offset=function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop;}
return{left:left,top:top};};me.preventDefaultException=function(el,exceptions){for(var i in exceptions){if(exceptions[i].test(el[i])){return true;}}
return false;};me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});me.extend(me.ease={},{quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k);}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return Math.sqrt(1-(--k*k));}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1;}},bounce:{style:'',fn:function(k){if((k /=1)<(1 / 2.75)){return 7.5625*k*k;}else if(k<(2 / 2.75)){return 7.5625*(k-=(1.5 / 2.75))*k+0.75;}else if(k<(2.5 / 2.75)){return 7.5625*(k-=(2.25 / 2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625 / 2.75))*k+0.984375;}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0;}
if(k==1){return 1;}
return(e*Math.pow(2,-10*k)*Math.sin((k-f / 4)*(2*Math.PI)/ f)+1);}}});me.tap=function(e,eventName){var ev=document.createEvent('Event');ev.initEvent(eventName,true,true);ev.pageX=e.pageX;ev.pageY=e.pageY;e.target.dispatchEvent(ev);};me.click=function(e){var target=e.target,ev;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName)){ev=document.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._constructed=true;target.dispatchEvent(ev);}};return me;})();function eDitionTextbox(el,options){this.wrapper=typeof el=='string'?document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.refreshed=false;this.scrollerStyle=this.scroller.style;currentWrapper=this;this.options={zoomMin:1,zoomMax:4,startZoom:1,resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,useCenterOfUnzoomedElement:false,bounce:true,bounceTime:600,bounceEasing:'',scrollIndicatorColor:'rgba(0,0,0,0.5)',preventDefault:true,resizePolling:60,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var i in options){this.options[i]=options[i];}
this.translateZ=this.options.HWCompositing&&utils.hasPerspective?' translateZ(0)':'';this.options.useTransition=utils.hasTransition&&this.options.useTransition;this.options.useTransform=utils.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=='string'?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap='tap';}
if(this.options.shrinkScrollbars=='scale'){this.options.useTransition=false;}
this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this.scale=Math.min(Math.max(this.options.startZoom,this.options.zoomMin),this.options.zoomMax);this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable();}
eDitionTextbox.prototype={version:'5.1.1',_init:function(){this._initEvents();if(this.options.zoom){this._initZoom();}
if(this.options.scrollbars||this.options.indicators){this._initIndicators();}
if(this.options.mouseWheel){this._initWheel();}
if(this.options.snap){this._initSnap();}
if(this.options.keyBindings){this._initKeys();}},destroy:function(){this._initEvents(true);this._execEvent('destroy');},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return;}
this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent('scrollEnd');}},_start:function(e){if(utils.eventType[e.type]!=1){if(e.button!==0){return;}}
if(!this.enabled||(this.initiated&&utils.eventType[e.type]!==this.initiated)){return;}
ed._is_textbox_mouse_down=true;if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
try
{if(typeof(e.touches)!='undefined')
{if(e.touches.length>1)
{window.ed.isiscrollroll=false;}
else if(e.touches.length==1)
{try
{if(this.options.scrollY){window.ed.isiscrollroll=true;}}catch(e){window.ed.isiscrollroll=true;}}}}catch(e){}
var point=e.touches?e.touches[0]:e,pos;this.initiated=utils.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=utils.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this._execEvent('scrollEnd');}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent('scrollEnd');}
this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this._execEvent('beforeScrollStart');},_move:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime(),newX,newY,absDistX,absDistY;this.pointX=point.pageX;this.pointY=point.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return;}
if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked='h';}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked='v';}else{this.directionLocked='n';}}
if(this.directionLocked=='h'){if(this.options.eventPassthrough=='vertical'){e.preventDefault();}else if(this.options.eventPassthrough=='horizontal'){this.initiated=false;return;}
deltaY=0;}else if(this.directionLocked=='v'){if(this.options.eventPassthrough=='horizontal'){e.preventDefault();}else if(this.options.eventPassthrough=='vertical'){this.initiated=false;return;}
deltaX=0;}
deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX / 3:newX>0?0:this.maxScrollX;}
if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY / 3:newY>0?0:this.maxScrollY;}
this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent('scrollStart');}
this.moved=true;this._translate(newX,newY);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y;}},_end:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
ed._is_textbox_mouse_down=false;if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing='';this.isInTransition=0;this.initiated=0;this.endTime=utils.getTime();if(this.resetPosition(this.options.bounceTime)){return;}
this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){utils.tap(e,this.options.tap);}
if(this.options.click){utils.click(e);}
this._execEvent('scrollCancel');return;}
if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100){this._execEvent('flick');return;}
if(this.options.momentum&&duration<300){momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=Math.max(momentumX.duration,momentumY.duration);this.isInTransition=1;}
if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap;time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1000),Math.min(Math.abs(newY-snap.y),1000)),300);newX=snap.x;newY=snap.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing;}
if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=utils.ease.quadratic;}
this.scrollTo(newX,newY,time,easing);return;}
this._execEvent('scrollEnd');},_resize:function(){var that=this;clearTimeout(this.resizeTimeout);},resetPosition:function(time){var x=this.x,y=this.y;time=time||0;if(!this.hasHorizontalScroll||this.x>0){x=0;}else if(this.x<this.maxScrollX){x=this.maxScrollX;}
if(!this.hasVerticalScroll||this.y>0){y=0;}else if(this.y<this.maxScrollY){y=this.maxScrollY;}
if(x==this.x&&y==this.y){return false;}
this.scrollTo(x,y,time,this.options.bounceEasing);return true;},disable:function(){this.enabled=false;},enable:function(){this.enabled=true;},refresh:function(){var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=Math.round(this.scroller.offsetWidth*this.scale);this.scrollerHeight=Math.round(this.scroller.offsetHeight*this.scale);this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth;}
if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight;}
this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=utils.offset(this.wrapper);this._execEvent('refresh');this.resetPosition();},on:function(type,fn){if(!this._events[type]){this._events[type]=[];}
this._events[type].push(fn);},off:function(type,fn){if(!this._events[type]){return;}
var index=this._events[type].indexOf(fn);if(index>-1){this._events[type].splice(index,1);}},_execEvent:function(type){if(!this._events[type]){return;}
var i=0,l=this._events[type].length;if(!l){return;}
for(;i<l;i++){this._events[type][i].apply(this,[].slice.call(arguments,1));}},scrollBy:function(x,y,time,easing){x=this.x+x;y=this.y+y;time=time||0;this.scrollTo(x,y,time,easing);},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular;this.isInTransition=this.options.useTransition&&time>0;if(!time||(this.options.useTransition&&easing.style)){this._transitionTimingFunction(easing.style);this._transitionTime(time);this._translate(x,y);}else{this._animate(x,y,time,easing.fn);}},scrollToElement:function(el,time,offsetX,offsetY,easing){el=el.nodeType?el:this.scroller.querySelector(el);if(!el){return;}
var pos=utils.offset(el);pos.left-=this.wrapperOffset.left;pos.top-=this.wrapperOffset.top;if(offsetX===true){offsetX=Math.round(el.offsetWidth / 2-this.wrapper.offsetWidth / 2);}
if(offsetY===true){offsetY=Math.round(el.offsetHeight / 2-this.wrapper.offsetHeight / 2);}
pos.left-=offsetX||0;pos.top-=offsetY||0;pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;time=time===undefined||time===null||time==='auto'?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;this.scrollTo(pos.left,pos.top,time,easing);},_transitionTime:function(time){time=time||0;this.scrollerStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.scrollerStyle[utils.style.transitionDuration]='0.001s';}
if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(time);}}},_transitionTimingFunction:function(easing){this.scrollerStyle[utils.style.transitionTimingFunction]=easing;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(easing);}}},_translate:function(x,y){if(this.options.useTransform){this.scrollerStyle[utils.style.transform]='translate('+x+'px,'+y+'px) scale('+this.scale+') '+this.translateZ;}else{x=Math.round(x);y=Math.round(y);this.scrollerStyle.left=x+'px';this.scrollerStyle.top=y+'px';}
this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition();}}},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,'orientationchange',this);eventType(window,'resize',this);if(this.options.click){eventType(this.wrapper,'click',this,true);}
if(!this.options.disableMouse){eventType(this.wrapper,'mousedown',this);eventType(target,'mousemove',this);eventType(target,'mousecancel',this);eventType(target,'mouseup',this);}
if(utils.hasPointer&&!this.options.disablePointer){eventType(this.wrapper,'MSPointerDown',this);eventType(target,'MSPointerMove',this);eventType(target,'MSPointerCancel',this);eventType(target,'MSPointerUp',this);}
if(utils.hasTouch&&!this.options.disableTouch){eventType(this.wrapper,'touchstart',this);eventType(target,'touchmove',this);eventType(target,'touchcancel',this);eventType(target,'touchend',this);}
eventType(this.scroller,'transitionend',this);eventType(this.scroller,'webkitTransitionEnd',this);eventType(this.scroller,'oTransitionEnd',this);eventType(this.scroller,'MSTransitionEnd',this);},getComputedPosition:function(){var matrix=window.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){matrix=matrix[utils.style.transform].split(')')[0].split(', ');x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5]);}else{x=+matrix.left.replace(/[^-\d.]/g,'');y=+matrix.top.replace(/[^-\d.]/g,'');}
return{x:x,y:y};},_initIndicators:function(){var interactive=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!='string',indicators=[],indicator;var that=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar('v',interactive,this.options.scrollbars,this.options.scrollIndicatorColor),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}
if(this.options.scrollX){indicator={el:createDefaultScrollbar('h',interactive,this.options.scrollbars,this.options.scrollIndicatorColor),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}}
if(this.options.indicators){indicators=indicators.concat(this.options.indicators);}
try
{for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]));}}catch(e){}
function _indicatorsMap(fn,caller){try
{for(var i=that.indicators.length;i--;){fn.call(that.indicators[i]);}}catch(e){}}
if(this.options.fadeScrollbars){this.on('scrollEnd',function(){window.ed.isiscrollroll=false;_indicatorsMap(function(){this.fade();},this);});this.on('scrollCancel',function(){window.ed.isiscrollroll=false;_indicatorsMap(function(){this.fade();},this);});this.on('scrollStart',function(){_indicatorsMap(function(){this.fade(1);},this);});this.on('beforeScrollStart',function(){_indicatorsMap(function(){this.fade(1,true);},this);});}
this.on('refresh',function(){_indicatorsMap(function(){this.refresh();},this);});this.on('destroy',function(){_indicatorsMap(function(){this.destroy();},this);delete this.indicators;});},_initZoom:function(){this.scrollerStyle[utils.style.transformOrigin]='0 0';},_zoomStart:function(e){var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY);this.touchesDistanceStart=Math.sqrt(c1*c1+c2*c2);this.startScale=this.scale;this.originX=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/ 2+this.wrapperOffset.left-this.x;this.originY=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/ 2+this.wrapperOffset.top-this.y;this._execEvent('zoomStart');},_zoom:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY),distance=Math.sqrt(c1*c1+c2*c2),scale=1 / this.touchesDistanceStart*distance*this.startScale,lastScale,x,y;this.scaled=true;if(scale<this.options.zoomMin){scale=0.5*this.options.zoomMin*Math.pow(2.0,scale / this.options.zoomMin);}else if(scale>this.options.zoomMax){scale=2.0*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax / scale);}
lastScale=scale / this.startScale;x=this.originX-this.originX*lastScale+this.startX;y=this.originY-this.originY*lastScale+this.startY;this.scale=scale;this.scrollTo(x,y,0);},_zoomEnd:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var newX,newY,lastScale;this.isInTransition=0;this.initiated=0;if(this.scale>this.options.zoomMax){this.scale=this.options.zoomMax;}else if(this.scale<this.options.zoomMin){this.scale=this.options.zoomMin;}
this.refresh();lastScale=this.scale / this.startScale;newX=this.originX-this.originX*lastScale+this.startX;newY=this.originY-this.originY*lastScale+this.startY;if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
if(this.x!=newX||this.y!=newY){this.scrollTo(newX,newY,this.options.bounceTime);}
this.scaled=false;this._execEvent('zoomEnd');},zoom:function(scale,x,y,time){if(scale<this.options.zoomMin){scale=this.options.zoomMin;}else if(scale>this.options.zoomMax){scale=this.options.zoomMax;}
if(scale==this.scale){return;}
var relScale=scale / this.scale;x=x===undefined?this.wrapperWidth / 2:x;y=y===undefined?this.wrapperHeight / 2:y;time=time===undefined?300:time;x=x+this.wrapperOffset.left-this.x;y=y+this.wrapperOffset.top-this.y;x=x-x*relScale+this.x;y=y-y*relScale+this.y;this.scale=scale;this.refresh();if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
this.scrollTo(x,y,time);},_wheelZoom:function(e){var wheelDeltaY,deltaScale,that=this;clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('zoomEnd');},400);if('deltaX'in e){wheelDeltaY=-e.deltaY / Math.abs(e.deltaY);}else if('wheelDeltaX'in e){wheelDeltaY=e.wheelDeltaY / Math.abs(e.wheelDeltaY);}else if('wheelDelta'in e){wheelDeltaY=e.wheelDelta / Math.abs(e.wheelDelta);}else if('detail'in e){wheelDeltaY=-e.detail / Math.abs(e.wheelDelta);}else{return;}
deltaScale=this.scale+wheelDeltaY / 5;this.zoom(deltaScale,e.pageX,e.pageY,0);},_initWheel:function(){utils.addEvent(this.wrapper,'wheel',this);utils.addEvent(this.wrapper,'mousewheel',this);utils.addEvent(this.wrapper,'DOMMouseScroll',this);this.on('destroy',function(){utils.removeEvent(this.wrapper,'wheel',this);utils.removeEvent(this.wrapper,'mousewheel',this);utils.removeEvent(this.wrapper,'DOMMouseScroll',this);});},_wheel:function(e){if(!this.enabled){return;}
var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent('scrollStart');}
if(this.options.scrollY)
{e.preventDefault();e.stopPropagation();}
clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('scrollEnd');that.wheelTimeout=undefined;},400);if('deltaX'in e){wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY;}else if('wheelDeltaX'in e){wheelDeltaX=e.wheelDeltaX / 120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY / 120*this.options.mouseWheelSpeed;}else if('wheelDelta'in e){wheelDeltaX=wheelDeltaY=e.wheelDelta / 120*this.options.mouseWheelSpeed;}else if('detail'in e){wheelDeltaX=wheelDeltaY=-e.detail / 3*this.options.mouseWheelSpeed;}else{return;}
wheelDeltaX*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){wheelDeltaX=wheelDeltaY;wheelDeltaY=0;}
if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(wheelDeltaX>0){newX--;}else if(wheelDeltaX<0){newX++;}
if(wheelDeltaY>0){newY--;}else if(wheelDeltaY<0){newY++;}
this.goToPage(newX,newY);return;}
newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
this.scrollTo(newX,newY,0);},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=='string'){this.options.snap=this.scroller.querySelectorAll(this.options.snap);}
this.on('refresh',function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return;}
if(this.options.snap===true){cx=Math.round(stepX / 2);cy=Math.round(stepY / 2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++;}
x-=stepX;i++;}}else{el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++;}
if(!this.pages[m]){this.pages[m]=[];}
x=Math.max(-el[i].offsetLeft,this.maxScrollX);y=Math.max(-el[i].offsetTop,this.maxScrollY);cx=x-Math.round(el[i].offsetWidth / 2);cy=y-Math.round(el[i].offsetHeight / 2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++;}}}
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold;}else{this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold);}});this.on('flick',function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1000),Math.min(Math.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time);});},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0};}
var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage;}
if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break;}}
l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break;}}
if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0;}else if(i>=this.pages.length){i=this.pages.length-1;}
x=this.pages[i][0].x;}
if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0;}else if(m>=this.pages[0].length){m=this.pages[0].length-1;}
y=this.pages[0][m].y;}
return{x:x,y:y,pageX:i,pageY:m};},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1;}else if(x<0){x=0;}
if(y>=this.pages[x].length){y=this.pages[x].length-1;}else if(y<0){y=0;}
var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=time===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1000),Math.min(Math.abs(posY-this.y),1000)),300):time;this.currentPage={x:posX,y:posY,pageX:x,pageY:y};this.scrollTo(posX,posY,time,easing);},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++;}
this.goToPage(x,y,time,easing);},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--;}
this.goToPage(x,y,time,easing);},_initKeys:function(e){var keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=='object'){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=='string'){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0);}}}else{this.options.keyBindings={};}
for(i in keys){this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];}
utils.addEvent(window,'keydown',this);this.on('destroy',function(){utils.removeEvent(window,'keydown',this);});},_key:function(e){if(!this.enabled){return;}
var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=0.250,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this.isInTransition=false;}
this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=snap?1:this.wrapperWidth;}else{newY+=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=snap?1:this.wrapperWidth;}else{newY-=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX;newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return;}
if(snap){this.goToPage(newX,newY);return;}
if(newX>0){newX=0;this.keyAcceleration=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0;}
if(newY>0){newY=0;this.keyAcceleration=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0;}
this.scrollTo(newX,newY,0);this.keyTime=now;},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;function step(){var now=utils.getTime(),newX,newY,easing;if(now>=destTime){that.isAnimating=false;that._translate(destX,destY);if(!that.resetPosition(that.options.bounceTime)){that._execEvent('scrollEnd');}
return;}
now=(now-startTime)/ duration;easing=easingFn(now);newX=(destX-startX)*easing+startX;newY=(destY-startY)*easing+startY;that._translate(newX,newY);if(that.isAnimating){rAF(step);}}
this.isAnimating=true;step();},handleEvent:function(e){var wasFired=false;switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._execEvent('zoomStart');try
{if(this.options.scrollY){window.ed.isiscrollroll=true;try
{}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 1856; column: 136;  :: '+v);}}}catch(e){window.ed.isiscrollroll=true;}
wasFired=true;break;case'wheel':case'DOMMouseScroll':case'mousewheel':this._execEvent('zoomStart');wasFired=true;break;}
if(!this.enabled)
{if(wasFired)
{this._execEvent('zoomEnd');}
return false;}
switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._start(e);if(this.options.zoom&&e.touches&&e.touches.length>1){this._zoomStart(e);}
break;case'touchmove':case'MSPointerMove':case'mousemove':if(this.options.zoom&&e.touches&&e.touches[1]){this._zoom(e);return;}
this._move(e);break;case'touchend':case'MSPointerUp':case'mouseup':case'touchcancel':case'MSPointerCancel':case'mousecancel':window.ed.isiscrollroll=false;if(this.scaled){this._zoomEnd(e);return;}
this._end(e);break;case'orientationchange':case'resize':break;case'transitionend':case'webkitTransitionEnd':case'oTransitionEnd':case'MSTransitionEnd':this._transitionEnd(e);break;case'wheel':case'DOMMouseScroll':case'mousewheel':if(this.options.wheelAction=='zoom'){this._wheelZoom(e);return;}
this._wheel(e);break;case'keydown':this._key(e);break;}}};function createDefaultScrollbar(direction,interactive,type,color){var scrollbar=document.createElement('div'),indicator=document.createElement('div');if(type===true){scrollbar.style.cssText='position:absolute;z-index:9999';indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:'+color+';border:1px solid rgba(255,255,255,0.4);border-radius:3px';}
indicator.className='eDitionTextboxIndicator';if(direction=='h'){if(type===true){scrollbar.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';indicator.style.height='100%';}
scrollbar.className='eDitionTextboxHorizontalScrollbar';}else{if(type===true){scrollbar.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';indicator.style.width='100%';}
scrollbar.className='eDitionTextboxVerticalScrollbar';}
scrollbar.style.cssText+=';overflow:hidden';if(!interactive){scrollbar.style.pointerEvents='none';}
scrollbar.appendChild(indicator);return scrollbar;}
function Indicator(scroller,options){this.wrapper=typeof options.el=='string'?document.querySelector(options.el):options.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in options){this.options[i]=options[i];}
this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){utils.addEvent(this.indicator,'touchstart',this);utils.addEvent(window,'touchend',this);}
if(!this.options.disablePointer){utils.addEvent(this.indicator,'MSPointerDown',this);utils.addEvent(window,'MSPointerUp',this);}
if(!this.options.disableMouse){utils.addEvent(this.indicator,'mousedown',this);utils.addEvent(window,'mouseup',this);}}
if(this.options.fade){this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?'0.001s':'0ms';this.wrapperStyle.opacity='0';}}
Indicator.prototype={handleEvent:function(e){switch(e.type){case'touchstart':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'MSPointerUp':case'mouseup':case'touchcancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;}},destroy:function(){if(this.options.interactive){utils.removeEvent(this.indicator,'touchstart',this);utils.removeEvent(this.indicator,'MSPointerDown',this);utils.removeEvent(this.indicator,'mousedown',this);utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,'MSPointerMove',this);utils.removeEvent(window,'mousemove',this);utils.removeEvent(window,'touchend',this);utils.removeEvent(window,'MSPointerUp',this);utils.removeEvent(window,'mouseup',this);}
if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper);}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=utils.getTime();if(!this.options.disableTouch){utils.addEvent(window,'touchmove',this);}
if(!this.options.disablePointer){utils.addEvent(window,'MSPointerMove',this);}
if(!this.options.disableMouse){utils.addEvent(window,'mousemove',this);}
this.scroller._execEvent('beforeScrollStart');},_move:function(e){var point=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=utils.getTime();if(!this.moved){this.scroller._execEvent('scrollStart');}
this.moved=true;deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);e.preventDefault();e.stopPropagation();},_end:function(e){if(!this.initiated){return;}
this.initiated=false;e.preventDefault();e.stopPropagation();utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,'MSPointerMove',this);utils.removeEvent(window,'mousemove',this);if(this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1000),Math.min(Math.abs(this.scroller.y-snap.y),1000)),300);if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=snap;this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing);}}
if(this.moved){this.scroller._execEvent('scrollEnd');}},transitionTime:function(time){time=time||0;this.indicatorStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.indicatorStyle[utils.style.transitionDuration]='0.001s';}},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing;},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none';}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none';}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none';}
if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){utils.addClass(this.wrapper,'eDitionTextboxBothScrollbars');utils.removeClass(this.wrapper,'eDitionTextboxLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='8px';}else{this.wrapper.style.bottom='8px';}}}else{utils.removeClass(this.wrapper,'eDitionTextboxBothScrollbars');utils.addClass(this.wrapper,'eDitionTextboxLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='2px';}else{this.wrapper.style.bottom='2px';}}}
var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth /(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+'px';}else{this.indicatorWidth=this.indicator.clientWidth;}
this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=='clip'){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8;}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX;}
this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX / this.scroller.maxScrollX));}
if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight /(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+'px';}else{this.indicatorHeight=this.indicator.clientHeight;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=='clip'){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8;}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY / this.scroller.maxScrollY));}
this.updatePosition();},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+'px';}
x=this.minBoundaryX;}else if(x>this.maxBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+'px';x=this.maxPosX+this.indicatorWidth-this.width;}else{x=this.maxBoundaryX;}}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+'px';}
if(y<this.minBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+'px';}
y=this.minBoundaryY;}else if(y>this.maxBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+'px';y=this.maxPosY+this.indicatorHeight-this.height;}else{y=this.maxBoundaryY;}}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+'px';}}
this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ;}else{this.indicatorStyle.left=x+'px';this.indicatorStyle.top=y+'px';}},_pos:function(x,y){if(x<0){x=0;}else if(x>this.maxPosX){x=this.maxPosX;}
if(y<0){y=0;}else if(y>this.maxPosY){y=this.maxPosY;}
x=this.options.listenX?Math.round(x / this.sizeRatioX):this.scroller.x;y=this.options.listenY?Math.round(y / this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y);},fade:function(val,hold){if(hold&&!this.visible){return;}
clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?'1':'0';this.wrapperStyle[utils.style.transitionDuration]=time+'ms';this.fadeTimeout=setTimeout((function(val){this.wrapperStyle.opacity=val;this.visible=+val;}).bind(this,val),delay);}};eDitionTextbox.utils=utils;if(typeof module!='undefined'&&module.exports){module.exports=eDitionTextbox;}else{window.eDitionTextbox=eDitionTextbox;}})(window,document,Math);
;
function setCustomToolbarColor(elemid){}
function isDekstopChrome(){var resvar=false;try{if((/chrome/i.test(navigator.userAgent.toLowerCase()))){if((!(/mobile/i.test(navigator.userAgent.toLowerCase())))&&(!(/ipad/i.test(navigator.userAgent.toLowerCase())))&&(!(/ipod/i.test(navigator.userAgent.toLowerCase())))&&(!(/iphone/i.test(navigator.userAgent.toLowerCase())))&&(!(/rim/i.test(navigator.userAgent.toLowerCase())))&&(!(/android/i.test(navigator.userAgent.toLowerCase())))&&(!(/blackberry/i.test(navigator.userAgent.toLowerCase())))&&(!(/ics/i.test(navigator.userAgent.toLowerCase())))){if(typeof(isAndroid)=='undefined'){var isAndroid=false;}if(!isAndroid){resvar=true;}}}}catch(e){console.log('Iscroll -> '+e.message);resvar=false;}return resvar;}(function(e,t){function A(e){if(i==="")return e;e=e.charAt(0).toUpperCase()+e.substr(1);return i+e}var n=Math,r=t.createElement("div").style,i=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,i=e.length;for(;n<i;n++){t=e[n]+"ransform";if(t in r){return e[n].substr(0,e[n].length-1)}}return false}(),s=i?"-"+i.toLowerCase()+"-":"",o=A("transform"),u=A("transitionProperty"),a=A("transitionDuration"),f=A("transformOrigin"),l=A("transitionTimingFunction"),c=A("transitionDelay"),h=/android/gi.test(navigator.appVersion),p=/iphone|ipad/gi.test(navigator.appVersion),d=/hp-tablet/gi.test(navigator.appVersion),v=A("perspective")in r,m="ontouchstart"in e&&!d&&!isDekstopChrome(),g=i!==false,y=A("transition")in r,b="onorientationchange"in e?"orientationchange":"resize",w=m?"touchstart":"mousedown",E=m?"touchmove":"mousemove",S=m?"touchend":"mouseup",x=m?"touchcancel":"mouseup",T=function(){if(i===false)return false;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[i]}(),N=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),C=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),k=v?" translateZ(0)":"",L=function(n,r){var i=this,c;i.wrapper=typeof n=="object"?n:t.getElementById(n);i.wrapper.style.overflow="hidden";i.scroller=i.wrapper.children[0];i.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,customScrollBarCSS:"background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.5);",customScrollBarBackgroundCSS:"",customScrollBarRadius:3,topOffset:0,checkDOMChanges:false,handleClick:true,hScrollbar:true,vScrollbar:true,fixedScrollbar:h,hideScrollbar:p,fadeScrollbar:p&&v,scrollbarClass:"",zoom:false,zoomMin:0.1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){try
{if(window.ed._isDesktopBrowser)
{window.ed.isiscrollroll=true;}
if(e.target.tagName.toLowerCase()!='select'&&e.target.tagName.toLowerCase()!='input'&&e.target.tagName.toLowerCase()!='textarea')
{e.preventDefault()}}catch(e)
{e.preventDefault()}},onScrollStart:function(){if(window.ed._isDesktopBrowser)
{window.ed.isiscrollroll=true;}},onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:function(){window.ed.isiscrollroll=false;},onTouchEnd:function(){window.ed.isiscrollroll=false;},onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(c in r)i.options[c]=r[c];i.x=i.options.x;i.y=i.options.y;i.options.useTransform=g&&i.options.useTransform;i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar;i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar;i.options.zoom=i.options.useTransform&&i.options.zoom;i.options.useTransition=y&&i.options.useTransition;if(i.options.zoom&&h){k=""}i.scroller.style[u]=i.options.useTransform?s+"transform":"top left";i.scroller.style[a]="0";i.scroller.style[f]="0 0";if(i.options.useTransition)i.scroller.style[l]="cubic-bezier(0.33,0.66,0.66,1)";if(i.options.useTransform)i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px)"+k;else i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px";if(i.options.useTransition)i.options.fixedScrollbar=true;i.refresh();i._bind(b,e);i._bind(w);if(!m){if(i.options.wheelAction!="none"){i._bind("DOMMouseScroll");i._bind("mousewheel")}}if(i.options.checkDOMChanges)i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500)};L.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case w:if(!m&&e.button!==0)return;t._start(e);break;case E:t._move(e);break;case S:case x:t._end(e);break;case b:t._resize();break;case"DOMMouseScroll":case"mousewheel":t._wheel(e);break;case T:t._transitionEnd(e);break}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var r=this,i;if(!r[e+"Scrollbar"]){if(r[e+"ScrollbarWrapper"]){if(g)r[e+"ScrollbarIndicator"].style[o]="";r[e+"ScrollbarWrapper"].parentNode.removeChild(r[e+"ScrollbarWrapper"]);r[e+"ScrollbarWrapper"]=null;r[e+"ScrollbarIndicator"]=null}return}if(!r[e+"ScrollbarWrapper"]){i=t.createElement("div");if(r.options.scrollbarClass)i.className=r.options.scrollbarClass+e.toUpperCase();else i.style.cssText="position:absolute;z-index:100;"+r.options.customScrollBarBackgroundCSS+(e=="h"?"height:7px;bottom:1px;left:2px;right:"+(r.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(r.hScrollbar?"7":"2")+"px;top:2px;right:1px");i.style.cssText+=";pointer-events:none;"+s+"transition-property:opacity;"+s+"transition-duration:"+(r.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(r.options.hideScrollbar?"0":"1");r.wrapper.appendChild(i);r[e+"ScrollbarWrapper"]=i;i=t.createElement("div");if(!r.options.scrollbarClass){i.style.cssText="position:absolute;z-index:100;"+r.options.customScrollBarCSS+""+s+"background-clip:padding-box;"+s+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+s+"border-radius:"+r.options.customScrollBarRadius.toString()+"px;border-radius:"+r.options.customScrollBarRadius.toString()+"px"}i.style.cssText+=";pointer-events:none;"+s+"transition-property:"+s+"transform;"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+s+"transition-duration:0;"+s+"transform: translate(0,0)"+k;if(r.options.useTransition)i.style.cssText+=";"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)";r[e+"ScrollbarWrapper"].appendChild(i);r[e+"ScrollbarIndicator"]=i}if(e=="h"){r.hScrollbarSize=r.hScrollbarWrapper.clientWidth;r.hScrollbarIndicatorSize=n.max(n.round(r.hScrollbarSize*r.hScrollbarSize/r.scrollerW),8);r.hScrollbarIndicator.style.width=r.hScrollbarIndicatorSize+"px";r.hScrollbarMaxScroll=r.hScrollbarSize-r.hScrollbarIndicatorSize;r.hScrollbarProp=r.hScrollbarMaxScroll/r.maxScrollX}else{r.vScrollbarSize=r.vScrollbarWrapper.clientHeight;r.vScrollbarIndicatorSize=n.max(n.round(r.vScrollbarSize*r.vScrollbarSize/r.scrollerH),8);r.vScrollbarIndicator.style.height=r.vScrollbarIndicatorSize+"px";r.vScrollbarMaxScroll=r.vScrollbarSize-r.vScrollbarIndicatorSize;r.vScrollbarProp=r.vScrollbarMaxScroll/r.maxScrollY}r._scrollbarPos(e,true)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},h?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0;t=this.vScroll?t:0;if(this.options.useTransform){this.scroller.style[o]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+k}else{e=n.round(e);t=n.round(t);this.scroller.style.left=e+"px";this.scroller.style.top=t+"px"}this.x=e;this.y=t;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(e,t){var r=this,i=e=="h"?r.x:r.y,s;if(!r[e+"Scrollbar"])return;i=r[e+"ScrollbarProp"]*i;if(i<0){if(!r.options.fixedScrollbar){s=r[e+"ScrollbarIndicatorSize"]+n.round(i*3);if(s<8)s=8;r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"}i=0}else if(i>r[e+"ScrollbarMaxScroll"]){if(!r.options.fixedScrollbar){s=r[e+"ScrollbarIndicatorSize"]-n.round((i-r[e+"ScrollbarMaxScroll"])*3);if(s<8)s=8;r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px";i=r[e+"ScrollbarMaxScroll"]+(r[e+"ScrollbarIndicatorSize"]-s)}else{i=r[e+"ScrollbarMaxScroll"]}}r[e+"ScrollbarWrapper"].style[c]="0";r[e+"ScrollbarWrapper"].style.opacity=t&&r.options.hideScrollbar?"0":"1";r[e+"ScrollbarIndicator"].style[o]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+k},_start:function(t){var r=this,i=m?t.touches[0]:t,s,u,a,f,l;try{if(typeof(t.touches)!='undefined'){if(t.touches.length>1){window.ed.isiscrollroll=false;}else if(t.touches.length==1){window.ed.isiscrollroll=true;}}else{window.ed.isiscrollroll=true;}}catch(e){}if(!r.enabled)return;if(r.options.onBeforeScrollStart)r.options.onBeforeScrollStart.call(r,t);if(r.options.useTransition||r.options.zoom)r._transitionTime(0);r.moved=false;r.animating=false;r.zoomed=false;r.distX=0;r.distY=0;r.absDistX=0;r.absDistY=0;r.dirX=0;r.dirY=0;if(r.options.zoom&&m&&t.touches.length>1){f=n.abs(t.touches[0].pageX-t.touches[1].pageX);l=n.abs(t.touches[0].pageY-t.touches[1].pageY);r.touchesDistStart=n.sqrt(f*f+l*l);r.originX=n.abs(t.touches[0].pageX+t.touches[1].pageX-r.wrapperOffsetLeft*2)/2-r.x;r.originY=n.abs(t.touches[0].pageY+t.touches[1].pageY-r.wrapperOffsetTop*2)/2-r.y;if(r.options.onZoomStart)r.options.onZoomStart.call(r,t)}if(r.options.momentum){if(r.options.useTransform){s=getComputedStyle(r.scroller,null)[o].replace(/[^0-9\-.,]/g,"").split(",");u=+(s[12]||s[4]);a=+(s[13]||s[5])}else{u=+getComputedStyle(r.scroller,null).left.replace(/[^0-9-]/g,"");a=+getComputedStyle(r.scroller,null).top.replace(/[^0-9-]/g,"")}if(u!=r.x||a!=r.y){if(r.options.useTransition)r._unbind(T);else C(r.aniTime);r.steps=[];r._pos(u,a);if(r.options.onScrollEnd)r.options.onScrollEnd.call(r)}}r.absStartX=r.x;r.absStartY=r.y;r.startX=r.x;r.startY=r.y;r.pointX=i.pageX;r.pointY=i.pageY;r.startTime=t.timeStamp||Date.now();if(r.options.onScrollStart)r.options.onScrollStart.call(r,t);r._bind(E,e);r._bind(S,e);r._bind(x,e)},_move:function(e){var t=this,r=m?e.touches[0]:e,i=r.pageX-t.pointX,s=r.pageY-t.pointY,u=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();if(t.options.onBeforeScrollMove)t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&m&&e.touches.length>1){f=n.abs(e.touches[0].pageX-e.touches[1].pageX);l=n.abs(e.touches[0].pageY-e.touches[1].pageY);t.touchesDist=n.sqrt(f*f+l*l);t.zoomed=true;c=1/t.touchesDistStart*t.touchesDist*this.scale;if(c<t.options.zoomMin)c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin);else if(c>t.options.zoomMax)c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c);t.lastScale=c/this.scale;u=this.originX-this.originX*t.lastScale+this.x,a=this.originY-this.originY*t.lastScale+this.y;this.scroller.style[o]="translate("+u+"px,"+a+"px) scale("+c+")"+k;if(t.options.onZoom)t.options.onZoom.call(t,e);return}t.pointX=r.pageX;t.pointY=r.pageY;if(u>0||u<t.maxScrollX){u=t.options.bounce?t.x+i/2:u>=0||t.maxScrollX>=0?0:t.maxScrollX}if(a>t.minScrollY||a<t.maxScrollY){a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY}t.distX+=i;t.distY+=s;t.absDistX=n.abs(t.distX);t.absDistY=n.abs(t.distY);if(t.absDistX<6&&t.absDistY<6){return}if(t.options.lockDirection){if(t.absDistX>t.absDistY+5){a=t.y;s=0}else if(t.absDistY>t.absDistX+5){u=t.x;i=0}}t.moved=true;t._pos(u,a);t.dirX=i>0?-1:i<0?1:0;t.dirY=s>0?-1:s<0?1:0;if(h-t.startTime>300){t.startTime=h;t.startX=t.x;t.startY=t.y}if(t.options.onScrollMove)t.options.onScrollMove.call(t,e)},_end:function(r){if(m&&r.touches.length!==0)return;var i=this,s=m?r.changedTouches[0]:r,u,f,l={dist:0,time:0},c={dist:0,time:0},h=(r.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,g,y,b,w;i._unbind(E,e);i._unbind(S,e);i._unbind(x,e);if(i.options.onBeforeScrollEnd)i.options.onBeforeScrollEnd.call(i,r);if(i.zoomed){w=i.scale*i.lastScale;w=Math.max(i.options.zoomMin,w);w=Math.min(i.options.zoomMax,w);i.lastScale=w/i.scale;i.scale=w;i.x=i.originX-i.originX*i.lastScale+i.x;i.y=i.originY-i.originY*i.lastScale+i.y;i.scroller.style[a]="200ms";i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+k;i.zoomed=false;i.refresh();if(i.options.onZoomEnd)i.options.onZoomEnd.call(i,r);return}if(!i.moved){if(m){if(i.doubleTapTimer&&i.options.zoom){clearTimeout(i.doubleTapTimer);i.doubleTapTimer=null;if(i.options.onZoomStart)i.options.onZoomStart.call(i,r);i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1);if(i.options.onZoomEnd){setTimeout(function(){i.options.onZoomEnd.call(i,r)},200)}}else if(this.options.handleClick){i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null;u=s.target;while(u.nodeType!=1)u=u.parentNode;if(u.tagName!="SELECT"&&u.tagName!="INPUT"&&u.tagName!="TEXTAREA"){f=t.createEvent("MouseEvents");f.initMouseEvent("click",true,true,r.view,1,s.screenX,s.screenY,s.clientX,s.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,0,null);f._fake=true;u.dispatchEvent(f)}},i.options.zoom?250:0)}}i._resetPos(400);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,r);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l;c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c;p=i.x+l.dist;d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=n.max(n.max(l.time,c.time),10);if(i.options.snap){v=p-i.absStartX;g=d-i.absStartY;if(n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold){i.scrollTo(i.absStartX,i.absStartY,200)}else{b=i._snap(p,d);p=b.x;d=b.y;y=n.max(b.time,y)}}i.scrollTo(n.round(p),n.round(d),y);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,r);return}if(i.options.snap){v=p-i.absStartX;g=d-i.absStartY;if(n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold)i.scrollTo(i.absStartX,i.absStartY,200);else{b=i._snap(i.x,i.y);if(b.x!=i.x||b.y!=i.y)i.scrollTo(b.x,b.y,b.time)}if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,r);return}i._resetPos(200);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,r)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){if(t.moved){t.moved=false;if(t.options.onScrollEnd)t.options.onScrollEnd.call(t)}if(t.hScrollbar&&t.options.hideScrollbar){if(i=="webkit")t.hScrollbarWrapper.style[c]="300ms";t.hScrollbarWrapper.style.opacity="0"}if(t.vScrollbar&&t.options.hideScrollbar){if(i=="webkit")t.vScrollbarWrapper.style[c]="300ms";t.vScrollbarWrapper.style.opacity="0"}return}t.scrollTo(n,r,e||0)},_wheel:function(e){window.ed.isiscrollWheelRoll=true;window.setTimeout("window.ed.isiscrollWheelRoll=false;",1);var t=this,n,r,i,s,o;if("wheelDeltaX"in e){n=e.wheelDeltaX/4;r=e.wheelDeltaY/4}else if("wheelDelta"in e){n=r=e.wheelDelta/12}else if("detail"in e){n=r=-e.detail*12}else{return}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0));if(o<t.options.zoomMin)o=t.options.zoomMin;if(o>t.options.zoomMax)o=t.options.zoomMax;if(o!=t.scale){if(!t.wheelZoomCount&&t.options.onZoomStart)t.options.onZoomStart.call(t,e);t.wheelZoomCount++;t.zoom(e.pageX,e.pageY,o,400);setTimeout(function(){t.wheelZoomCount--;if(!t.wheelZoomCount&&t.options.onZoomEnd)t.options.onZoomEnd.call(t,e)},400)}return}i=t.x+n;s=t.y+r;if(i>0)i=0;else if(i<t.maxScrollX)i=t.maxScrollX;if(s>t.minScrollY)s=t.minScrollY;else if(s<t.maxScrollY)s=t.maxScrollY;if(t.maxScrollY<0){t.scrollTo(i,s,0)}},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(T);t._startAni()},_startAni:function(){var e=this,t=e.x,r=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift();if(s.x==t&&s.y==r)s.time=0;e.animating=true;e.moved=true;if(e.options.useTransition){e._transitionTime(s.time);e._pos(s.x,s.y);e.animating=false;if(s.time)e._bind(T);else e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y);e.animating=false;if(e.options.onAnimationEnd)e.options.onAnimationEnd.call(e);e._startAni();return}a=(a-i)/s.time-1;o=n.sqrt(1-a*a);f=(s.x-t)*o+t;l=(s.y-r)*o+r;e._pos(f,l);if(e.animating)e.aniTime=N(u)};u()},_transitionTime:function(e){e+="ms";this.scroller.style[a]=e;if(this.hScrollbar)this.hScrollbarIndicator.style[a]=e;if(this.vScrollbar)this.vScrollbarIndicator.style[a]=e},_momentum:function(e,t,r,i,s){var o=6e-4,u=n.abs(e)/t,a=u*u/(2*o),f=0,l=0;if(e>0&&a>r){l=s/(6/(a/u*o));r=r+l;u=u*r/a;a=r}else if(e<0&&a>i){l=s/(6/(a/u*o));i=i+l;u=u*i/a;a=i}a=a*(e<0?-1:1);f=u/o;return{dist:a,time:n.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;n-=e.offsetTop}if(e!=this.wrapper){t*=this.scale;n*=this.scale}return{left:t,top:n}},_snap:function(e,t){var r=this,i,s,o,u,a,f;o=r.pagesX.length-1;for(i=0,s=r.pagesX.length;i<s;i++){if(e>=r.pagesX[i]){o=i;break}}if(o==r.currPageX&&o>0&&r.dirX<0)o--;e=r.pagesX[o];a=n.abs(e-r.pagesX[r.currPageX]);a=a?n.abs(r.x-e)/a*500:0;r.currPageX=o;o=r.pagesY.length-1;for(i=0;i<o;i++){if(t>=r.pagesY[i]){o=i;break}}if(o==r.currPageY&&o>0&&r.dirY<0)o--;t=r.pagesY[o];f=n.abs(t-r.pagesY[r.currPageY]);f=f?n.abs(r.y-t)/f*500:0;r.currPageY=o;u=n.round(n.max(a,f))||200;return{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var t=this;t.scroller.style[o]="";t.hScrollbar=false;t.vScrollbar=false;t._scrollbar("h");t._scrollbar("v");t._unbind(b,e);t._unbind(w);t._unbind(E,e);t._unbind(S,e);t._unbind(x,e);if(!t.options.hasTouch){t._unbind("DOMMouseScroll");t._unbind("mousewheel")}if(t.options.useTransition)t._unbind(T);if(t.options.checkDOMChanges)clearInterval(t.checkDOMTime);if(t.options.onDestroy)t.options.onDestroy.call(t)},refresh:function(){var e=this,t,r,i,s,o=0,u=0;if(e.scale<e.options.zoomMin)e.scale=e.options.zoomMin;e.wrapperW=e.wrapper.clientWidth||1;e.wrapperH=e.wrapper.clientHeight||1;e.minScrollY=-e.options.topOffset||0;e.scrollerW=n.round(e.scroller.offsetWidth*e.scale);e.scrollerH=n.round((e.scroller.offsetHeight+e.minScrollY)*e.scale);e.maxScrollX=e.wrapperW-e.scrollerW;e.maxScrollY=e.wrapperH-e.scrollerH+e.minScrollY;e.dirX=0;e.dirY=0;if(e.options.onRefresh)e.options.onRefresh.call(e);e.hScroll=e.options.hScroll&&e.maxScrollX<0;e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH);e.hScrollbar=e.hScroll&&e.options.hScrollbar;e.vScrollbar=e.vScroll&&e.options.vScrollbar&&e.scrollerH>e.wrapperH;t=e._offset(e.wrapper);e.wrapperOffsetLeft=-t.left;e.wrapperOffsetTop=-t.top;if(typeof e.options.snap=="string"){e.pagesX=[];e.pagesY=[];s=e.scroller.querySelectorAll(e.options.snap);for(r=0,i=s.length;r<i;r++){o=e._offset(s[r]);o.left+=e.wrapperOffsetLeft;o.top+=e.wrapperOffsetTop;e.pagesX[r]=o.left<e.maxScrollX?e.maxScrollX:o.left*e.scale;e.pagesY[r]=o.top<e.maxScrollY?e.maxScrollY:o.top*e.scale}}else if(e.options.snap){e.pagesX=[];while(o>=e.maxScrollX){e.pagesX[u]=o;o=o-e.wrapperW;u++}if(e.maxScrollX%e.wrapperW)e.pagesX[e.pagesX.length]=e.maxScrollX-e.pagesX[e.pagesX.length-1]+e.pagesX[e.pagesX.length-1];o=0;u=0;e.pagesY=[];while(o>=e.maxScrollY){e.pagesY[u]=o;o=o-e.wrapperH;u++}if(e.maxScrollY%e.wrapperH)e.pagesY[e.pagesY.length]=e.maxScrollY-e.pagesY[e.pagesY.length-1]+e.pagesY[e.pagesY.length-1]}e._scrollbar("h");e._scrollbar("v");if(!e.zoomed){e.scroller.style[a]="0";e._resetPos(400)}},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop();if(!s.length)s=[{x:e,y:t,time:n,relative:r}];for(o=0,u=s.length;o<u;o++){if(s[o].relative){s[o].x=i.x-s[o].x;s[o].y=i.y-s[o].y}i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0})}i._startAni()},scrollToElement:function(e,t){var r=this,i;e=e.nodeType?e:r.scroller.querySelector(e);if(!e)return;i=r._offset(e);i.left+=r.wrapperOffsetLeft;i.top+=r.wrapperOffsetTop;i.left=i.left>0?0:i.left<r.maxScrollX?r.maxScrollX:i.left;i.top=i.top>r.minScrollY?r.minScrollY:i.top<r.maxScrollY?r.maxScrollY:i.top;t=t===undefined?n.max(n.abs(i.left)*2,n.abs(i.top)*2):t;r.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n;if(r.options.onScrollStart)r.options.onScrollStart.call(r);if(r.options.snap){e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e;t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t;e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e;t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t;r.currPageX=e;r.currPageY=t;i=r.pagesX[e];s=r.pagesY[t]}else{i=-r.wrapperW*e;s=-r.wrapperH*t;if(i<r.maxScrollX)i=r.maxScrollX;if(s<r.maxScrollY)s=r.maxScrollY}r.scrollTo(i,s,n)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(E,e);this._unbind(S,e);this._unbind(x,e)},enable:function(){this.enabled=true},stop:function(){if(this.options.useTransition)this._unbind(T);else C(this.aniTime);this.steps=[];this.moved=false;this.animating=false},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=true;r=r===undefined?200:r;e=e-i.wrapperOffsetLeft-i.x;t=t-i.wrapperOffsetTop-i.y;i.x=e-e*s+i.x;i.y=t-t*s+i.y;i.scale=n;i.refresh();i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x;i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y;i.scroller.style[a]=r+"ms";i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+k;i.zoomed=false},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};r=null;if(typeof exports!=="undefined")exports.iScroll=L;else e.iScroll=L})(window,document);
;
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(window,document,Math){var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000 / 60);};var utils=(function(){var me={};var _elementStyle=document.createElement('div').style;var _vendor=(function(){var vendors=['t','webkitT','MozT','msT','OT'],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+'ransform';if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);}
return false;})();function _prefixStyle(style){if(_vendor===false)return false;if(_vendor==='')return style;return _vendor+style.charAt(0).toUpperCase()+style.substr(1);}
me.getTime=Date.now||function getTime(){return new Date().getTime();};me.extend=function(target,obj){for(var i in obj){target[i]=obj[i];}};me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture);};me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture);};me.prefixPointerEvent=function(pointerEvent){return window.MSPointerEvent?'MSPointer'+pointerEvent.charAt(9).toUpperCase()+pointerEvent.substr(10):pointerEvent;};me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/ time,destination,duration;deceleration=deceleration===undefined?0.0006:deceleration;destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);duration=speed / deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-(wrapperSize / 2.5*(speed / 8)):lowerMargin;distance=Math.abs(destination-current);duration=distance / speed;}else if(destination>0){destination=wrapperSize?wrapperSize / 2.5*(speed / 8):0;distance=Math.abs(current)+destination;duration=distance / speed;}
return{destination:Math.round(destination),duration:duration};};var _transform=_prefixStyle('transform');me.extend(me,{hasTransform:_transform!==false,hasPerspective:_prefixStyle('perspective')in _elementStyle,hasTouch:'ontouchstart'in window,hasPointer:window.PointerEvent||window.MSPointerEvent,hasTransition:_prefixStyle('transition')in _elementStyle});me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle('transitionTimingFunction'),transitionDuration:_prefixStyle('transitionDuration'),transitionDelay:_prefixStyle('transitionDelay'),transformOrigin:_prefixStyle('transformOrigin')});me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className);};me.addClass=function(e,c){if(me.hasClass(e,c)){return;}
var newclass=e.className.split(' ');newclass.push(c);e.className=newclass.join(' ');};me.removeClass=function(e,c){if(!me.hasClass(e,c)){return;}
var re=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');e.className=e.className.replace(re,' ');};me.offset=function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop;}
return{left:left,top:top};};me.preventDefaultException=function(el,exceptions){for(var i in exceptions){if(exceptions[i].test(el[i])){return true;}}
return false;};me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});me.extend(me.ease={},{quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k);}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return Math.sqrt(1-(--k*k));}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1;}},bounce:{style:'',fn:function(k){if((k /=1)<(1 / 2.75)){return 7.5625*k*k;}else if(k<(2 / 2.75)){return 7.5625*(k-=(1.5 / 2.75))*k+0.75;}else if(k<(2.5 / 2.75)){return 7.5625*(k-=(2.25 / 2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625 / 2.75))*k+0.984375;}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0;}
if(k==1){return 1;}
return(e*Math.pow(2,-10*k)*Math.sin((k-f / 4)*(2*Math.PI)/ f)+1);}}});me.tap=function(e,eventName){var ev=document.createEvent('Event');ev.initEvent(eventName,true,true);ev.pageX=e.pageX;ev.pageY=e.pageY;e.target.dispatchEvent(ev);};me.click=function(e){var target=e.target,ev;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName)){ev=document.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._constructed=true;target.dispatchEvent(ev);}};return me;})();function IScrollProbe(el,options){this.wrapper=typeof el=='string'?document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.scroller.style['touch-action']='none';this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:'',preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true,janMarryGoRound:false};for(var i in options){this.options[i]=options[i];}
if(this.options.janMarryGoRound){this.options.bounce=false;}
this.translateZ=this.options.HWCompositing&&utils.hasPerspective?' translateZ(0) translate3d(0,0,0)':'';this.options.useTransition=utils.hasTransition&&this.options.useTransition;this.options.useTransform=utils.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=='string'?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap='tap';}
if(this.options.shrinkScrollbars=='scale'){this.options.useTransition=false;}
this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.probeType==3){this.options.useTransition=false;}
this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable();}
IScrollProbe.prototype={version:'5.1.3',_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators();}
if(this.options.mouseWheel){this._initWheel();}
if(this.options.snap){this._initSnap();}
if(this.options.keyBindings){this._initKeys();}},destroy:function(){this._initEvents(true);this._execEvent('destroy');},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return;}
this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent('scrollEnd');}},_start:function(e){if(utils.eventType[e.type]!=1){if(e.button!==0){return;}}
if(!this.enabled||(this.initiated&&utils.eventType[e.type]!==this.initiated)){return;}
if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.touches?e.touches[0]:e,pos;this.initiated=utils.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=utils.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this._execEvent('scrollEnd');}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent('scrollEnd');}
this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this._execEvent('beforeScrollStart');},_move:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
if(this.options.preventDefault){e.preventDefault();}
var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime(),newX,newY,absDistX,absDistY;this.pointX=point.pageX;this.pointY=point.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return;}
if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked='h';}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked='v';}else{this.directionLocked='n';}}
if(this.directionLocked=='h'){if(this.options.eventPassthrough=='vertical'){e.preventDefault();}else if(this.options.eventPassthrough=='horizontal'){this.initiated=false;return;}
deltaY=0;}else if(this.directionLocked=='v'){if(this.options.eventPassthrough=='horizontal'){e.preventDefault();}else if(this.options.eventPassthrough=='vertical'){this.initiated=false;return;}
deltaX=0;}
deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX / 3:newX>0?0:this.maxScrollX;}
if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY / 3:newY>0?0:this.maxScrollY;}
this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent('scrollStart');}
this.moved=true;this._translate(newX,newY);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent('scroll');}}
if(this.options.probeType>1){this._execEvent('scroll');}},_end:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return;}
this._execEvent('scrollReleased');if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault();}
var point=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing='';this.isInTransition=0;this.initiated=0;this.endTime=utils.getTime();if(this.resetPosition(this.options.bounceTime)){return;}
this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){utils.tap(e,this.options.tap);}
if(this.options.click){utils.click(e);}
this._execEvent('scrollCancel');return;}
if(this._events.flick&&duration<200&&distanceX<100&&distanceY<(this.options.maxFlickY||150)&&distanceY>(this.options.minFlickY||20)){this._execEvent('flick');return;}
if(this.options.momentum&&duration<500){momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=Math.max(momentumX.duration,momentumY.duration);this.isInTransition=1;}
if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap;time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1000),Math.min(Math.abs(newY-snap.y),1000)),300);newX=snap.x;newY=snap.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing;}
if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=utils.ease.quadratic;}
this.scrollTo(newX,newY,time,easing);return;}
this._execEvent('scrollEnd');},_resize:function(){var that=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){that.refresh();},this.options.resizePolling);},resetPosition:function(time){var x=this.x,y=this.y;time=time||0;if(!this.hasHorizontalScroll||this.x>0){x=0;}else if(this.x<this.maxScrollX){x=this.maxScrollX;}
if(!this.hasVerticalScroll||this.y>0){y=0;}else if(this.y<this.maxScrollY){y=this.maxScrollY;}
if(x==this.x&&y==this.y){return false;}
this.scrollTo(x,y,time,this.options.bounceEasing);return true;},disable:function(){this.enabled=false;},enable:function(){this.enabled=true;},refresh:function(){var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=(this.options.janMarryGoRound?0:this.wrapperWidth)-
this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth;}
if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight;}
this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=utils.offset(this.wrapper);this._execEvent('refresh');this.resetPosition();},on:function(type,fn){if(!this._events[type]){this._events[type]=[];}
this._events[type].push(fn);},off:function(type,fn){if(!this._events[type]){return;}
var index=this._events[type].indexOf(fn);if(index>-1){this._events[type].splice(index,1);}},_execEvent:function(type){if(!this._events[type]){return;}
var i=0,l=this._events[type].length;if(!l){return;}
for(;i<l;i++){this._events[type][i].apply(this,[].slice.call(arguments,1));}},scrollBy:function(x,y,time,easing){x=this.x+x;y=this.y+y;time=time||0;this.scrollTo(x,y,time,easing);},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular;this.isInTransition=this.options.useTransition&&time>0;if(!time||(this.options.useTransition&&easing.style)){this._transitionTimingFunction(easing.style);this._transitionTime(time);this._translate(x,y);}else{this._animate(x,y,time,easing.fn);}},scrollToElement:function(el,time,offsetX,offsetY,easing){el=el.nodeType?el:this.scroller.querySelector(el);if(!el){return;}
var pos=utils.offset(el);pos.left-=this.wrapperOffset.left;pos.top-=this.wrapperOffset.top;if(offsetX===true){offsetX=Math.round(el.offsetWidth / 2-this.wrapper.offsetWidth / 2);}
if(offsetY===true){offsetY=Math.round(el.offsetHeight / 2-this.wrapper.offsetHeight / 2);}
pos.left-=offsetX||0;pos.top-=offsetY||0;pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;time=time===undefined||time===null||time==='auto'?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;this.scrollTo(pos.left,pos.top,time,easing);},_transitionTime:function(time){time=time||0;this.scrollerStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.scrollerStyle[utils.style.transitionDuration]='0.001s';}
if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(time);}}},_transitionTimingFunction:function(easing){this.scrollerStyle[utils.style.transitionTimingFunction]=easing;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(easing);}}},_translate:function(x,y){if(this.options.useTransform){this.scrollerStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.translateZ;}else{x=Math.round(x);y=Math.round(y);this.scrollerStyle.left=x+'px';this.scrollerStyle.top=y+'px';}
this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition();}}},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,'orientationchange',this);eventType(window,'resize',this);if(this.options.click){eventType(this.wrapper,'click',this,true);}
if(!this.options.disableMouse){eventType(this.wrapper,'mousedown',this);eventType(target,'mousemove',this);eventType(target,'mousecancel',this);eventType(target,'mouseup',this);}
if(utils.hasPointer&&!this.options.disablePointer){eventType(this.wrapper,utils.prefixPointerEvent('pointerdown'),this);eventType(target,utils.prefixPointerEvent('pointermove'),this);eventType(target,utils.prefixPointerEvent('pointercancel'),this);eventType(target,utils.prefixPointerEvent('pointerup'),this);}
if(utils.hasTouch&&!this.options.disableTouch){eventType(this.wrapper,'touchstart',this);eventType(target,'touchmove',this);eventType(target,'touchcancel',this);eventType(target,'touchend',this);}
eventType(this.scroller,'transitionend',this);eventType(this.scroller,'webkitTransitionEnd',this);eventType(this.scroller,'oTransitionEnd',this);eventType(this.scroller,'MSTransitionEnd',this);},getComputedPosition:function(){var matrix=window.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){matrix=matrix[utils.style.transform].split(')')[0].split(', ');x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5]);}else{x=+matrix.left.replace(/[^-\d.]/g,'');y=+matrix.top.replace(/[^-\d.]/g,'');}
return{x:x,y:y};},_initIndicators:function(){var interactive=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!='string',indicators=[],indicator;var that=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar('v',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}
if(this.options.scrollX){indicator={el:createDefaultScrollbar('h',interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator);}}
if(this.options.indicators){indicators=indicators.concat(this.options.indicators);}
for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]));}
function _indicatorsMap(fn){for(var i=that.indicators.length;i--;){fn.call(that.indicators[i]);}}
if(this.options.fadeScrollbars){this.on('scrollEnd',function(){_indicatorsMap(function(){this.fade();});});this.on('scrollCancel',function(){_indicatorsMap(function(){this.fade();});});this.on('scrollStart',function(){_indicatorsMap(function(){this.fade(1);});});this.on('beforeScrollStart',function(){_indicatorsMap(function(){this.fade(1,true);});});}
this.on('refresh',function(){_indicatorsMap(function(){this.refresh();});});this.on('destroy',function(){_indicatorsMap(function(){this.destroy();});delete this.indicators;});},_initWheel:function(){utils.addEvent(this.wrapper,'wheel',this);utils.addEvent(this.wrapper,'mousewheel',this);utils.addEvent(this.wrapper,'DOMMouseScroll',this);this.on('destroy',function(){utils.removeEvent(this.wrapper,'wheel',this);utils.removeEvent(this.wrapper,'mousewheel',this);utils.removeEvent(this.wrapper,'DOMMouseScroll',this);});},_wheel:function(e){if(!this.enabled){return;}
e.preventDefault();e.stopPropagation();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent('scrollStart');}
clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('scrollEnd');that.wheelTimeout=undefined;},400);if('deltaX'in e){if(e.deltaMode===1){wheelDeltaX=-e.deltaX*this.options.mouseWheelSpeed;wheelDeltaY=-e.deltaY*this.options.mouseWheelSpeed;}else{wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY;}}else if('wheelDeltaX'in e){wheelDeltaX=e.wheelDeltaX / 120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY / 120*this.options.mouseWheelSpeed;}else if('wheelDelta'in e){wheelDeltaX=wheelDeltaY=e.wheelDelta / 120*this.options.mouseWheelSpeed;}else if('detail'in e){wheelDeltaX=wheelDeltaY=-e.detail / 3*this.options.mouseWheelSpeed;}else{return;}
wheelDeltaX*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){wheelDeltaX=wheelDeltaY;wheelDeltaY=0;}
if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(wheelDeltaX>0){newX--;}else if(wheelDeltaX<0){newX++;}
if(wheelDeltaY>0){newY--;}else if(wheelDeltaY<0){newY++;}
this.goToPage(newX,newY);return;}
newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);if(newX>0){newX=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;}
if(newY>0){newY=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;}
this.scrollTo(newX,newY,0);if(this.options.probeType>1){this._execEvent('scroll');}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=='string'){this.options.origSnap=this.options.snap;this.options.snap=this.scroller.querySelectorAll(this.options.snap);}
this.on('refresh',function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return;}
if(this.options.snap===true){cx=Math.round(stepX / 2);cy=Math.round(stepY / 2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++;}
x-=stepX;i++;}}else{this.options.snap=this.scroller.querySelectorAll(this.options.origSnap);el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++;}
if(!this.pages[m]){this.pages[m]=[];}
x=Math.max(-el[i].offsetLeft,this.maxScrollX);y=Math.max(-el[i].offsetTop,this.maxScrollY);cx=x-Math.round(el[i].offsetWidth / 2);cy=y-Math.round(el[i].offsetHeight / 2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++;}}}
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold;}else{this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold);}});this.on('flick',function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1000),Math.min(Math.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time);});},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0};}
var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage;}
if(x>0){x=0;}else if(x<this.maxScrollX){x=this.maxScrollX;}
if(y>0){y=0;}else if(y<this.maxScrollY){y=this.maxScrollY;}
for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break;}}
l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break;}}
if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0;}else if(i>=this.pages.length){i=this.pages.length-1;}
x=this.pages[i][0].x;}
if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0;}else if(m>=this.pages[0].length){m=this.pages[0].length-1;}
y=this.pages[0][m].y;}
return{x:x,y:y,pageX:i,pageY:m};},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1;}else if(x<0){x=0;}
if(y>=this.pages[x].length){y=this.pages[x].length-1;}else if(y<0){y=0;}
var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=time===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1000),Math.min(Math.abs(posY-this.y),1000)),300):time;this.currentPage={x:posX,y:posY,pageX:x,pageY:y};this.scrollTo(posX,posY,time,easing);},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++;}
this.goToPage(x,y,time,easing);},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--;}
this.goToPage(x,y,time,easing);},_initKeys:function(e){var keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=='object'){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=='string'){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0);}}}else{this.options.keyBindings={};}
for(i in keys){this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];}
utils.addEvent(window,'keydown',this);this.on('destroy',function(){utils.removeEvent(window,'keydown',this);});},_key:function(e){if(!this.enabled){return;}
var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=0.250,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this.isInTransition=false;}
this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=snap?1:this.wrapperWidth;}else{newY+=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=snap?1:this.wrapperWidth;}else{newY-=snap?1:this.wrapperHeight;}
break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX;newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return;}
if(snap){this.goToPage(newX,newY);return;}
if(newX>0){newX=0;this.keyAcceleration=0;}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0;}
if(newY>0){newY=0;this.keyAcceleration=0;}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0;}
this.scrollTo(newX,newY,0);this.keyTime=now;},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;function step(){var now=utils.getTime(),newX,newY,easing;if(now>=destTime){that.isAnimating=false;that._translate(destX,destY);if(!that.resetPosition(that.options.bounceTime)){that._execEvent('scrollEnd');}
return;}
now=(now-startTime)/ duration;easing=easingFn(now);newX=(destX-startX)*easing+startX;newY=(destY-startY)*easing+startY;that._translate(newX,newY);if(that.isAnimating){rAF(step);}
if(that.options.probeType==3){that._execEvent('scroll');}}
this.isAnimating=true;step();},handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;case'orientationchange':case'resize':this._resize();break;case'transitionend':case'webkitTransitionEnd':case'oTransitionEnd':case'MSTransitionEnd':this._transitionEnd(e);break;case'wheel':case'DOMMouseScroll':case'mousewheel':this._wheel(e);break;case'keydown':this._key(e);break;case'click':if(!e._constructed){e.preventDefault();e.stopPropagation();}
break;}}};function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement('div'),indicator=document.createElement('div');if(type===true){scrollbar.style.cssText='position:absolute;z-index:9999';indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px';}
indicator.className='iScrollIndicator';if(direction=='h'){if(type===true){scrollbar.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';indicator.style.height='100%';}
scrollbar.className='iScrollHorizontalScrollbar';}else{if(type===true){scrollbar.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';indicator.style.width='100%';}
scrollbar.className='iScrollVerticalScrollbar';}
scrollbar.style.cssText+=';overflow:hidden';if(!interactive){scrollbar.style.pointerEvents='none';}
scrollbar.appendChild(indicator);return scrollbar;}
function Indicator(scroller,options){this.wrapper=typeof options.el=='string'?document.querySelector(options.el):options.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in options){this.options[i]=options[i];}
this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){utils.addEvent(this.indicator,'touchstart',this);utils.addEvent(window,'touchend',this);}
if(!this.options.disablePointer){utils.addEvent(this.indicator,utils.prefixPointerEvent('pointerdown'),this);utils.addEvent(window,utils.prefixPointerEvent('pointerup'),this);}
if(!this.options.disableMouse){utils.addEvent(this.indicator,'mousedown',this);utils.addEvent(window,'mouseup',this);}}
if(this.options.fade){this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?'0.001s':'0ms';this.wrapperStyle.opacity='0';}}
Indicator.prototype={handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;}},destroy:function(){if(this.options.interactive){utils.removeEvent(this.indicator,'touchstart',this);utils.removeEvent(this.indicator,utils.prefixPointerEvent('pointerdown'),this);utils.removeEvent(this.indicator,'mousedown',this);utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,utils.prefixPointerEvent('pointermove'),this);utils.removeEvent(window,'mousemove',this);utils.removeEvent(window,'touchend',this);utils.removeEvent(window,utils.prefixPointerEvent('pointerup'),this);utils.removeEvent(window,'mouseup',this);}
if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper);}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=utils.getTime();if(!this.options.disableTouch){utils.addEvent(window,'touchmove',this);}
if(!this.options.disablePointer){utils.addEvent(window,utils.prefixPointerEvent('pointermove'),this);}
if(!this.options.disableMouse){utils.addEvent(window,'mousemove',this);}
this.scroller._execEvent('beforeScrollStart');},_move:function(e){var point=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=utils.getTime();if(!this.moved){this.scroller._execEvent('scrollStart');}
this.moved=true;deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);if(this.scroller.options.probeType==1&&timestamp-this.startTime>300){this.startTime=timestamp;this.scroller._execEvent('scroll');}else if(this.scroller.options.probeType>1){this.scroller._execEvent('scroll');}
e.preventDefault();e.stopPropagation();},_end:function(e){if(!this.initiated){return;}
this.initiated=false;e.preventDefault();e.stopPropagation();utils.removeEvent(window,'touchmove',this);utils.removeEvent(window,utils.prefixPointerEvent('pointermove'),this);utils.removeEvent(window,'mousemove',this);if(this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1000),Math.min(Math.abs(this.scroller.y-snap.y),1000)),300);if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=snap;this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing);}}
if(this.moved){this.scroller._execEvent('scrollEnd');}},transitionTime:function(time){time=time||0;this.indicatorStyle[utils.style.transitionDuration]=time+'ms';if(!time&&utils.isBadAndroid){this.indicatorStyle[utils.style.transitionDuration]='0.001s';}},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing;},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none';}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none';}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none';}
if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){utils.addClass(this.wrapper,'iScrollBothScrollbars');utils.removeClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='8px';}else{this.wrapper.style.bottom='8px';}}}else{utils.removeClass(this.wrapper,'iScrollBothScrollbars');utils.addClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='2px';}else{this.wrapper.style.bottom='2px';}}}
var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth /(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+'px';}else{this.indicatorWidth=this.indicator.clientWidth;}
this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=='clip'){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8;}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX;}
this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX / this.scroller.maxScrollX));}
if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight /(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+'px';}else{this.indicatorHeight=this.indicator.clientHeight;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=='clip'){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8;}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY;}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY / this.scroller.maxScrollY));}
this.updatePosition();},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+'px';}
x=this.minBoundaryX;}else if(x>this.maxBoundaryX){if(this.options.shrink=='scale'){this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+'px';x=this.maxPosX+this.indicatorWidth-this.width;}else{x=this.maxBoundaryX;}}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+'px';}
if(y<this.minBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+'px';}
y=this.minBoundaryY;}else if(y>this.maxBoundaryY){if(this.options.shrink=='scale'){this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+'px';y=this.maxPosY+this.indicatorHeight-this.height;}else{y=this.maxBoundaryY;}}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+'px';}}
this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ;}else{this.indicatorStyle.left=x+'px';this.indicatorStyle.top=y+'px';}},_pos:function(x,y){if(x<0){x=0;}else if(x>this.maxPosX){x=this.maxPosX;}
if(y<0){y=0;}else if(y>this.maxPosY){y=this.maxPosY;}
x=this.options.listenX?Math.round(x / this.sizeRatioX):this.scroller.x;y=this.options.listenY?Math.round(y / this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y);},fade:function(val,hold){if(hold&&!this.visible){return;}
clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?'1':'0';this.wrapperStyle[utils.style.transitionDuration]=time+'ms';this.fadeTimeout=setTimeout((function(val){this.wrapperStyle.opacity=val;this.visible=+val;}).bind(this,val),delay);}};IScrollProbe.utils=utils;if(typeof module!='undefined'&&module.exports){module.exports=IScrollProbe;}else{window.IScrollProbe=IScrollProbe;}})(window,document,Math);
;
/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
 
 try{  /* try catch for - IE8 is not supported - 23.7.2015 - by editiondigital */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==kb?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ib.length;){if(c=ib[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return ob++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:rb?N:sb?Q:qb?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&yb&&d-e===0,g=b&(Ab|Bb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=nb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===yb||f.eventType===Ab)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Bb&&(i>xb||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=mb(l.x)>mb(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:lb(a.pointers[c].clientX),clientY:lb(a.pointers[c].clientY)},c++;return{timeStamp:nb(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:lb(a[0].clientX),y:lb(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:lb(c/b),y:lb(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Cb:mb(a)>=mb(b)?a>0?Db:Eb:b>0?Fb:Gb}function I(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],Lb)-J(a[1],a[0],Lb)}function L(a,b){return I(b[0],b[1],Lb)/I(a[0],a[1],Lb)}function M(){this.evEl=Nb,this.evWin=Ob,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Rb,this.evWin=Sb,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ub,this.evWin=Vb,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Ab|Bb)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xb,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(yb|zb)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===yb)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ab|Bb)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bc))return bc;var b=q(a,cc),c=q(a,dc);return b&&c?cc+" "+dc:b||c?b?cc:dc:q(a,ac)?ac:_b}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=ec,this.simultaneous={},this.requireFail=[]}function W(a){return a&jc?"cancel":a&hc?"end":a&gc?"move":a&fc?"start":""}function X(a){return a==Gb?"down":a==Fb?"up":a==Db?"left":a==Eb?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function ab(){V.apply(this,arguments),this._timer=null,this._input=null}function bb(){Z.apply(this,arguments)}function cb(){Z.apply(this,arguments)}function db(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eb(a,b){return b=b||{},b.recognizers=m(b.recognizers,eb.defaults.preset),new fb(a,b)}function fb(a,b){b=b||{},this.options=i(b,eb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),gb(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function gb(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function hb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ib=["","webkit","moz","MS","ms","o"],jb=b.createElement("div"),kb="function",lb=Math.round,mb=Math.abs,nb=Date.now,ob=1,pb=/mobile|tablet|ip(ad|hone|od)|android/i,qb="ontouchstart"in a,rb=v(a,"PointerEvent")!==d,sb=qb&&pb.test(navigator.userAgent),tb="touch",ub="pen",vb="mouse",wb="kinect",xb=25,yb=1,zb=2,Ab=4,Bb=8,Cb=1,Db=2,Eb=4,Fb=8,Gb=16,Hb=Db|Eb,Ib=Fb|Gb,Jb=Hb|Ib,Kb=["x","y"],Lb=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Mb={mousedown:yb,mousemove:zb,mouseup:Ab},Nb="mousedown",Ob="mousemove mouseup";j(M,y,{handler:function(a){var b=Mb[a.type];b&yb&&0===a.button&&(this.pressed=!0),b&zb&&1!==a.which&&(b=Ab),this.pressed&&this.allow&&(b&Ab&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:vb,srcEvent:a}))}});var Pb={pointerdown:yb,pointermove:zb,pointerup:Ab,pointercancel:Bb,pointerout:Bb},Qb={2:tb,3:ub,4:vb,5:wb},Rb="pointerdown",Sb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Rb="MSPointerDown",Sb="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pb[d],f=Qb[a.pointerType]||a.pointerType,g=f==tb,h=s(b,a.pointerId,"pointerId");e&yb&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ab|Bb)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Tb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Ub="touchstart",Vb="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Tb[a.type];if(b===yb&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Ab|Bb)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}});var Wb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Xb="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wb[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==tb,e=c.pointerType==vb;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Ab|Bb)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Yb=v(jb.style,"touchAction"),Zb=Yb!==d,$b="compute",_b="auto",ac="manipulation",bc="none",cc="pan-x",dc="pan-y";T.prototype={set:function(a){a==$b&&(a=this.compute()),Zb&&(this.manager.element.style[Yb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Zb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bc),f=q(d,dc),g=q(d,cc);return e||f&&c&Hb||g&&c&Ib?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var ec=1,fc=2,gc=4,hc=8,ic=hc,jc=16,kc=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hc>d&&b(!0),b(),d>=hc&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kc)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kc|ec)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ic|jc|kc)&&(this.state=ec),this.state=this.process(b),void(this.state&(fc|gc|hc|jc)&&this.tryEmit(b))):(this.reset(),void(this.state=kc))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fc|gc),e=this.attrTest(a);return d&&(c&Bb||!e)?b|jc:d||e?c&Ab?b|hc:b&fc?b|gc:fc:kc}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Jb},getTouchAction:function(){var a=this.options.direction,b=[];return a&Hb&&b.push(dc),a&Ib&&b.push(cc),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Hb?(e=0===f?Cb:0>f?Db:Eb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Cb:0>g?Fb:Gb,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fc||!(this.state&fc)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fc)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(ab,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_b]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ab|Bb)&&!f)this.reset();else if(a.eventType&yb)this.reset(),this._timer=e(function(){this.state=ic,this.tryEmit()},b.time,this);else if(a.eventType&Ab)return ic;return kc},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ic&&(a&&a.eventType&Ab?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=nb(),this.manager.emit(this.options.event,this._input)))}}),j(bb,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fc)}}),j(cb,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Hb|Ib,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Hb|Ib)?b=a.velocity:c&Hb?b=a.velocityX:c&Ib&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&mb(b)>this.options.velocity&&a.eventType&Ab},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(db,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ac]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&yb&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ab)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ic,this.tryEmit()},b.interval,this),fc):ic}return kc},failTimeout:function(){return this._timer=e(function(){this.state=kc},this.options.interval,this),kc},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ic&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eb.VERSION="2.0.4",eb.defaults={domEvents:!1,touchAction:$b,enable:!0,inputTarget:null,inputClass:null,preset:[[bb,{enable:!1}],[_,{enable:!1},["rotate"]],[cb,{direction:Hb}],[$,{direction:Hb},["swipe"]],[db],[db,{event:"doubletap",taps:2},["tap"]],[ab]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lc=1,mc=2;fb.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mc:lc},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ic)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fc|gc|hc)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&hb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&gb(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(eb,{INPUT_START:yb,INPUT_MOVE:zb,INPUT_END:Ab,INPUT_CANCEL:Bb,STATE_POSSIBLE:ec,STATE_BEGAN:fc,STATE_CHANGED:gc,STATE_ENDED:hc,STATE_RECOGNIZED:ic,STATE_CANCELLED:jc,STATE_FAILED:kc,DIRECTION_NONE:Cb,DIRECTION_LEFT:Db,DIRECTION_RIGHT:Eb,DIRECTION_UP:Fb,DIRECTION_DOWN:Gb,DIRECTION_HORIZONTAL:Hb,DIRECTION_VERTICAL:Ib,DIRECTION_ALL:Jb,Manager:fb,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:db,Pan:$,Swipe:cb,Pinch:_,Rotate:bb,Press:ab,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==kb&&define.amd?define(function(){return eb}):"undefined"!=typeof module&&module.exports?module.exports=eb:a[c]=eb}(window,document,"Hammer");
} catch(err) { /*console.log('Handled Hammer.js ERROR : ' + err.message)*/ }
//# source-Mapping-URL=hammer.min.map
;
(function(){var ed={debug:false,debugTemplate:false,isBetaScript:false,debugAnimations:false,debugLinks:false,textboxreadtimeout:10000,textboxreadtimeoutcalledwhenpageid:-1,loaderindex:0,playershown:false,allparalaxpagescount:0,customType:-100,istouchdevice:false,isdesktopmac:false,alltextblocktimeouts:new Array(),pageIsForReviewModeOnly:'pageIsForReviewModeOnly',_touch_start_event_nm:'touchstart',_touch_move_event_nm:'touchmove',_touch_end_event_nm:'touchend',clickwasusedtogotopage:false,zoomendwasalreadycalled:false,washandlingMovingPages:false,youtubecontrolnumber:0,youtubestate:null,loadingLayer:false,allowoneparalaxscroll:0,allowmaxparalaxscrolls:1,currentlyLoadingUHDImages:false,sndplayercontrolnumber:0,layerIsShown:false,textblock_increase_font_step:3,isLoadingPageBackgrounds:false,last_click_time:new Date(),lastCheckedPressedX:-1,lastCheckedPressedY:-1,addStatGroupToStats:'',_touch_out_event_nm:'',defaultNoImageValue:'',waitingAnims:'',defaultNoImageValueSrc:'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',galleryFSCZoomedIn:false,pageWasJustChanged:false,currentlyLoadingtextblockes:false,_was_end_handler:true,statsFired:false,startingWatch:new Date(),videoisinfullscreen:false,isiscrollroll:false,isiscrollWheelRoll:false,this_is_new_double_click:0,eDitionName:'',eDitionTitle:'',ProjectName:'',goToSubcategory:'',scrollToY:0,_version_of_linktest:0,z_index_max:800,stageWidth:0,stageHeight:0,arrPointerArray:new Array(),preventGlobalHandling:false,preventLocalHandling:false,onlyZoomContent:false,_add_to_statistics_only_first_time:'#fua=1',_last_image_clicked:'',currentDownloadImageIndex:0,timeoutindex:0,loader1:505,loader2:506,loader3:507,loader4:508,loader5:509,loader6:510,loader7:511,loader8:512,loader9:513,loader10:514,paralaxmaxscrolly:0,isIpad:'false',addToDownloadList:'',addtodownloadlistImages:'',pageHead:document.getElementsByTagName('head')[0],isLoadingObjectsImages:false,arrIscrolls:new Array(),clickOverVideo:false,page_currently_zoomed_in:false,_defaultPopupWidth:0,_defaultPopupHeight:0,isIeTouch:false,_currentlyMovingIfScale:false,isLoadingTemplate:false,forcePageReload:false,currentTemplate:'',singleQuote:'#singlqt#',dblQuote:'#dblqt#',fscGalScroll:null,fscLayerSCroll:null,fsgallerybuttonWidth:90,_previous_page_id_drawn_links:-1,_move_hanlder_started_to_scroll_left_or_right:false,_currnt_gal_width:0,_currnt_gal_height:0,_galFSCDiv:document.getElementById('pageGalleryFullscrenDiv'),_galFSCBtnPressedElement:null,galleryZoomInZoomOutDivName:'FSCGalleryZoomId',_download_counter:0,FSCGalleryVisible:false,FSCGalleryVisibleId:0,maindownloadGroupIndex:0,_currentlyLoadingFSCImage:false,FSCgalleryMaxZoom:2,_galnextGalleryImage:-2,_galpreviousGalleryImage:-3,isAndroid:false,galleryEndLastXtouch:0,galleryEndLastYtouch:0,jqueryTransition:'ease-in-out',webTransformNm:'Webkit',_subpage_up_arrow_img:'',_subpage_down_arrow_img:'',_currentPageObj:{divid:'',pageid:'',hasSubpages:false,pageNumber:0},_currentPageObjPgs:null,_currentPreviousPageObjPgs:null,googleAnalyCode:'',webTransformNmCSS:'-webkit-',webTransformFunct:'',youtubeplaywasalreadysent:false,mustPreloadImagesBeforeRunTmp:'',_isLandscapeMode:false,webTransformFunctCSS:'',edition_youtube_api_url:'https://www.youtube.com/iframe_api',webTransitionFunct:'',webTransformFunctOrigin:'',arrGalleryObjectSettings:new Array(),_currentlyScrollingSubpages:false,_ignorePage:1,subpageindx:0,issinglepagemode:false,preventBecauseImages:false,preventBecauseGallery:false,preventBecauseLinks:false,preventBecauseLoadingImagesToMemory:false,galleryStartingX:0,startinPageEventCalled:false,galleryStartingY:0,galleryStartingTime:null,hdwidth:0,previewNotSet:false,hdheight:0,usesHD:false,scaleFunct:'scale3d',addToScaleFunct:',1',translateFunct:'translate3d',addToTranslateFunct:',0px',translateZFunct:'',currentPageX:0,currentScale:0,currentPageY:0,singlePageWidth:0,paralaxImages:new Array(),showSubpagesArrows:true,_disableXScroll:false,_disableYScroll:false,_fadein_subpage_visible:false,_fadein_pgs_id:-1,_fadein_parent_id:-1,html5popup_links_forceNewWindow:false,_popupFiredFromStaticLinks:false,_click_was_used_to_hide:false,_current_screen_x:0,_current_screen_y:0,defaultTimingSubpages:300,preloadIndex:0,isIe58:false,isIe9:false,defaultEasing:'ease-out',singlePageHeight:0,oldWayHiRes:true,_pressedElementX:0,_loader_visible:true,_gallery_touch_counter:0,_pressedElementY:0,_pressedElement:null,firedautoplay:false,fscGalScrollImage:null,fscGalScrollImageParent:'',_subpageActionCount:0,downloadItems:{id:new Array(),items:new Array()},downloads:{id:new Array(),items:new Array()},FSCarrGalleryOptions:null,_current_ScreenHeight:0,_current_ScreenWidth:0,_current_ScreenHeight_withRatio:0,_current_ScreenWidth_withRatio:0,slideContainer:null,wrapper:null,slides:null,distanceX:0,startX:0,preferredWidth:0,preferredHeight:0,_video_shown:false,direction:"",timer:null,timerCounter:0,isTouchEnd:false,_initStatsSent:false,maxDistance:0,currentDistance:0,_pg_hasAnim:false,pressed:0,setTransformOrigin:'',_previousDrawn:'',_previousDrawn2:'',_requests_root_path:'',_requests_root_path_origin:'',currentlyloadingImages:false,_setZoomInregardingEverythings:false,tempHTMLContain:'',_referrer:'',distanceY:0,_linkImageElemShown:new Array(),_hiddenVideoBG:'',_hiddenVideoBG2:'',_linkImageShowLayer:false,layerLastElement:0,layerLastElementWidth:0,layerLastElementHeight:0,_randomchar:'',iconPercentWidth:'50',maxLoadedPages:0,_currentPageLinksShown:false,startY:0,_editionid:0,animation_local_int_vars:new Object(),animation_global_int_vars:new Object(),commandsEnabled:true,subpgsupArrowShow:false,subpgsdownArrowShow:false,_scaStrForViewPort:null,zoomPageOffsetX:0,_aboutBoxImage:'',isIphone:'false',_eDitionSwipeTimeoutForCheckLoading:50,thisIsInitialOffset:false,currentPublicationURL:'',_previousDifference:-1,_startScale:0,_facebookIsShown:false,isLoadingPublication:true,defaultPageOffsetX:0,usedHeight:0,usedWidth:0,enabledScrolling:-1,_currentLocation:'',startScaleOfPage:0,_originalRatio:1,ratioOfZoomPages:0,orientationEvent:null,currentOrientation:0,zoomPageOffsetY:0,_originalPageWidth:0,differenceX:0,differenceY:0,_originalPageHeight:0,_enabledTracking:true,main:null,_is_gallery_mouse_down:false,_is_textbox_mouse_down:false,lastShownObject:'',useOffsetOrigin:true,_hasNoEvents:false,_isFirstTime:true,_originalRatioX:0,_originalRatioY:0,_doHideLoader:false,_wasDistanceX:0,_currentPage:1,_hiresIsVisible:false,socialBookmarksVisible:false,startX_second:0,zoomFromX:0,zoomFromY:0,startY_second:0,_paddingTop:0,_isPortraitMode:false,_previousScale:1,startHandlerLastClickedX:0,startHandlerLastClickedY:0,endHandlerLastClickedX:0,endHandlerLastClickedY:0,mainHolderDivId:'mainHolder',textblockStylesInjected:false,mainWrapper:document.getElementById("mainHolder"),EventGesture:null,_isSingleClick:false,subpagesOffsetY:0,_isMinimized:false,_wasPreviousEnabledTwoFingers:false,_OBJECT_TO_SHOW:'',gestureStarter:null,_allPages:0,_bigImagesCount:0,_active:1,_singleClickWasClickedAtTime:null,screenWidth:document.documentElement.clientWidth,screenHeight:document.documentElement.clientHeight,lastClickX:0,lastClickY:0,linkLastClickX:0,linkLastClickY:0,thisTimeTwoFingersWereUsed:false,_openedAboutBox:false,_currentSlideWidth:0,_currentOffset:0,_actionversion:0,_enableZoom:true,_previous_version_of_call:-1,_currentScale:1,shouldRunTemplate:false,startDistance:0,_autotiming:400,_currentPageHasSubpages:false,_usertiming:0,_scaleTiming:0,_offsetPagesCnt:0,pressedGalleryElement:'',_isMouseDown:false,isPublicationFullyLoadedAndShown:false,defaultTransitionTiming:300,measureXOffset:0,measureYOffset:0,_idLinkPressed:0,nextPage:-1,previousPage:-2,nextMainPage:-3,previousMainPage:-4,currentMainPage:-5,nextSubpage:-6,previousSubpage:-7,currentBottomSubpage:-8,lastPage:-9,firstPage:-10,lastMainPage:-11,IscrollRollPressedX:0,IscrollRollPressedY:0,lastTimePageChange:null,allShownPages:new Array(),_popup_shown:false,pageStatArr:'',statsindex:0,_isDesktopBrowser:false,allDimensionsArr:new Array(),defaultZoom:1,isThisPreviewApp:false,_is_loading_fadein_subpage:false,hasAlreadyStartedScrollingVerticalLocaly:false,trace:function(value){if(ed.debug)
{console.log(value);}},traceRegardless:function(value){console.log(value);},showPreviewSign:function(){if(ed.isThisPreviewApp)
{ed.get(ed.pageIsForReviewModeOnly).style['display']='block';$('#'+ed.pageIsForReviewModeOnly).fadeTo(250,1);window.setTimeout('window.ed.runPreviewApplication();',3500);}},runPreviewApplication:function(){if(ed.isThisPreviewApp)
{$('#'+ed.pageIsForReviewModeOnly).fadeTo(200,0,function(){ed.get(ed.pageIsForReviewModeOnly).style['display']='none';window.setTimeout('window.ed.showPreviewSign();',8000);});}},checkIfCanHideLoader:function(){var resvar=true;if((ed.preventBecauseImages)||(ed.preventBecauseGallery)||(ed.isLoadingPublication)||(ed.isLoadingObjectsImages)||(ed.isLoadingPageBackgrounds)||(ed.isLoadingTemplate)||(ed.loadingLayer)||(ed.preventBecauseLoadingImagesToMemory)||(ed.currentlyLoadingtextblockes)||(ed.currentlyLoadingUHDImages)||(ed.preventBecauseLinks))
{resvar=false;}
return resvar;},addToGoToPageStats:function(toPageId){window.stats.pageview(toPageId.toString());},showLoader:function(){clearTimeout(window.showLoaderTimeout);window.showLoaderTimeout=setTimeout(function(){if(!ed.checkIfCanHideLoader()){var obj=ed.get('loadingMenu');obj.style.top=ed.iconPercentWidth+'%';ed._loader_visible=true;ed.loaderSetAlpha("100","loadingMenu",300);}},500);},hideLoader:function(loaderIndx){if(!ed._loader_visible){return;}
var resvar=ed.checkIfCanHideLoader();if(resvar)
{ed._loader_visible=false;ed.loaderSetAlpha("0","loadingMenu",300);window.setTimeout("document.getElementById('loadingMenu').style.top = '-300px';window.ed._loader_visible = false;",300);}},IsImgVisibleForLink:function(animobj_id){var res=false;if(typeof(IsImgVisibleForLink_Anim)=="function"){res=IsImgVisibleForLink_Anim(animobj_id);}
return(res);},getLinkTypeNameForTypeId:function(lid){lid=parseInt(lid,10);var res="unknown("+lid+")";if(lid=1){var res="link("+lid+")";}
else if(lid=2){var res="polylin("+lid+")";}
else if(lid=3){var res="ellipse("+lid+")";}
return res;},fixPageIdToSoda:function(pg){var resvar=pg;if(ed._isLandscapeMode)
{if(resvar%2!=0)
{resvar=resvar-1;}}
if(resvar<1)
{resvar=1;}
return resvar;},zoomIn:function(scaleFactor,setOffsetToZero,fromX,fromY,setPercent,user){if(ed._currentlyScrollingSubpages)
{return false;}
if(!ed.isLoadingPublication)
{if(!ed._enableZoom)
{return false;}}
var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var d=currobj.arrindex;{var elemsImg=ed.get(currobj.holderdivid);try
{if(elemsImg!=null)
{if((parseFloat(window.ide.maxScaleFactor)==parseFloat(scaleFactor))&&(currobj.loadedimageHD))
{scaleFactor=window.ide.scaleOfFullZoomHD;}
if((currobj.loadedimageHD)&&(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom))
{if(scaleFactor>window.ide.scaleOfFullZoomHD)
{scaleFactor=window.ide.scaleOfFullZoomHD;}}
else if(scaleFactor>window.ide.maxScaleFactor)
{scaleFactor=window.ide.maxScaleFactor;}
if(scaleFactor<(window.ide.defaultPublicationScale/2))
{scaleFactor=(window.ide.defaultPublicationScale/2);}
var window_pgs_index=currobj.arrindex;if(!window.initer.isIe9)
{window.eddata.pages[window_pgs_index].currentZoom=scaleFactor;window.eddata.pages[window_pgs_index].iscroll[0].zoom(scaleFactor);window.eddata.pages[window_pgs_index].iscroll[0].refresh();}}}catch(e)
{}}},zoomOut:function(scaleFactor,setOffsetToZero,fromX,fromY,setPercent,user,thisd){if((!ed.isLoadingPublication)&&(!ed._setZoomInregardingEverythings))
{if(!ed._enableZoom)
{return false;}}
if(user)
{ed._scaleTiming=ed._usertiming;}
else
{ed._scaleTiming=ed._autotiming;}
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var elemsImg=ed.get(currobj.holderdivid);try
{if(elemsImg!=null)
{if((parseFloat(window.ide.maxScaleFactor)==parseFloat(scaleFactor))&&(currobj.loadedimageHD))
{scaleFactor=window.ide.scaleOfFullZoomHD;}
if((currobj.loadedimageHD)&&(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom))
{if(scaleFactor>window.ide.scaleOfFullZoomHD)
{scaleFactor=window.ide.scaleOfFullZoomHD;}}
else if(scaleFactor>window.ide.maxScaleFactor)
{scaleFactor=window.ide.maxScaleFactor;}
if(scaleFactor<(window.ide.defaultPublicationScale/2))
{scaleFactor=(window.ide.defaultPublicationScale/2);}
var window_pgs_index=currobj.arrindex;if(!window.initer.isIe9)
{window.eddata.pages[window_pgs_index].currentZoom=scaleFactor;window.eddata.pages[window_pgs_index].iscroll[0].zoom(scaleFactor);window.eddata.pages[window_pgs_index].iscroll[0].refresh();}}}catch(e)
{}}},setZIndexForInteractive:function(anim_object_id,mode){var loadPage=window.ed._currentPageObjPgs.pagenumber-1;var highestZIndex=0;var originalZIndex=0;var imgArrayFirstIndex=-1;var imgArraySecondIndex=-1;var currentZIndex=0;for(var pgs=0;pgs<window.ide.editionAllPagesCount;pgs++)
{pageId=pgs;if(loadPage==pgs)
{if(window.ide.currentPageObjPgs.interactive!=null)
{if(window.ide.currentPageObjPgs.interactive.length>0)
{for(var d=0;d<window.ide.currentPageObjPgs.interactive.length;d++)
{var currObj=window.ide.currentPageObjPgs.interactive[d];if(currObj.itype==window.ide.itypeimage)
{if(window.ed.get(currObj.divid)!=null)
{if(parseInt(window.ed.get(currObj.divid).style.zIndex)>highestZIndex)
{highestZIndex=parseInt(window.ed.get(currObj.divid).style.zIndex);}
if(parseInt(currObj.id)==parseInt(anim_object_id))
{originalZIndex=parseInt(currObj.zindex);currentZIndex=parseInt(window.ed.get(currObj.divid).style.zIndex)
imgArrayFirstIndex=pageId;imgArraySecondIndex=d;}}}}}}}}
if((highestZIndex>0)&&(originalZIndex>0)&&(currentZIndex>0)&&(imgArrayFirstIndex>-1)&&(imgArraySecondIndex>-1))
{var currObj=window.ide.currentPageObjPgs.interactive[imgArraySecondIndex];if(mode=="top"){if(highestZIndex>currentZIndex)
{highestZIndex=highestZIndex+1;window.ed.traceRegardless('Zindex for obj ['+currObj.id.toString()+'] is set to TOP ['+highestZIndex.toString()+']');window.ed.get(currObj.divid).style.zIndex=highestZIndex.toString();}}
if(mode=="orig"){if(currentZIndex!=originalZIndex)
{window.ed.traceRegardless('Zindex for obj ['+currObj.id.toString()+'] is set to ORIG ['+originalZIndex.toString()+']');window.ed.get(currObj.divid).style.zIndex=originalZIndex.toString();}}}},clearAllCanvas:function(firstPage,secondPage,currentHTMLDiv){if(ed._loader_visible)
{ed.hideLoader();}
var isFirst=true;for(var d=0;d<window.ide.editionAllPagesCount+1;d++)
{var canvasNm=('pageHTMLDiv'+currentHTMLDiv);var canvasElem=document.getElementById(canvasNm);if(canvasElem!=null)
{if((d>=(parseInt(firstPage)))&&(d<=(parseInt(secondPage))))
{var evalLink='doDraw'+(d).toString()+'()';if((evalLink!=ed._previousDrawn)&&(evalLink!=ed._previousDrawn2))
{}
if(isFirst)
{ed._previousDrawn=evalLink;ed._previousDrawn2=evalLink;isFirst=false;}
else
{ed._previousDrawn2=evalLink;}}}}},logoffStatusToLoadingImages:function(){ed.currentlyloadingImages=false;if(ed._loader_visible)
{ed.hideLoader();}},setStatusToLoadingImages:function(){ed.currentlyloadingImages=true;},disableCommands:function(){},enableCommands:function(){ed.commandsEnabled=true;},clearImageFromMemory:function(divlowres,linkslowres){try
{}catch(e){ed.trace('couldnt find lowres for clearing image from memory -> '+divlowres);}
try
{document.getElementById(linkslowres).style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(linkslowres).style.background=window.ed.defaultNoImageValue;try
{document.getElementById(linkslowres+'Links').style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(linkslowres+'Links').style.background=window.ed.defaultNoImageValue;}catch(e){}}catch(e){ed.trace('couldnt find links div for clearing image from memory -> '+linkslowres);}},afterResize:function(){},enableCommandsAndHideLoader:function(_this_loader){ed.hideLoader(_this_loader);ed.enableCommands();ed.logoffStatusToLoadingImages();},checkLoadingInteractive:function(itype){var curr_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var pageleft=curr_obj.pagenumber;var pageright=-1;if((curr_obj.leftPage==window.ide.currentPage)&&(ide.orientIsBookMode))
{pageright=curr_obj.rightPage;}
else if(ide.orientIsBookMode)
{pageright=curr_obj.leftPage;}
var foundunloaded=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if((currobj.pagenumber==pageright)||(currobj.pagenumber==pageleft))
{for(var l in currobj.interactive)
{var tmpinteractive=currobj.interactive[l];if(tmpinteractive.itype==itype)
{if(typeof(tmpinteractive.initially_hidden)!='undefined')
{if((!tmpinteractive.contentloaded)&&(tmpinteractive.initially_hidden!=1))
{foundunloaded=true;}}
else
{if(!tmpinteractive.contentloaded)
{foundunloaded=true;}}}}}}
return foundunloaded;},onAfterVideosDrawn:function(forPgNumber,videodivid){if(window.ide.contain_video){window.ed.checkAutoplayVideos(forPgNumber,videodivid);}
window.ed.checkPreloadedImgs(forPgNumber,videodivid,window.ide.itypevideo);},showNonAnimatedInteractiveObjs:function(){var curr_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var pageleft=curr_obj.pagenumber;var pageright=-1;if((curr_obj.leftPage==window.ide.currentPage)&&(ide.orientIsBookMode))
{pageright=curr_obj.rightPage;}
else if(ide.orientIsBookMode)
{pageright=curr_obj.leftPage;}
var foundunloaded=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if((currobj.pagenumber==pageright)||(currobj.pagenumber==pageleft))
{for(var l in currobj.interactive)
{var dividtoanimate='';var tmpinteractive=currobj.interactive[l];switch(tmpinteractive.itype){case window.ide.itypeaudio:case'threesixty':{dividtoanimate=tmpinteractive.holderDivId;}}
if(dividtoanimate!='')
{$('#'+dividtoanimate).stop();$('#'+dividtoanimate).css({'visibility':'visible'}).delay(10).transition({opacity:1},350,window.ed.defaultEasing);}
if(tmpinteractive.itype=='threesixty')
{edThreesixty.finalizeElement(tmpinteractive);}}
try
{$('#'+curr_obj.dividinner).css({'visibility':'visible','pointer-events':'none'});}catch(e){}
$('.links').css({'visibility':'visible'});}}
return foundunloaded;},setInitAnimDiv:function(currObj){switch(currObj.itype)
{case window.ide.itypegallery:case window.ide.itypetextblock:currObj.animDivId=currObj.divid.substr(0,currObj.divid.length-'inner'.length)
break;default:currObj.animDivId=currObj.divid;}},refreshIscrollsFix:function(){try
{for(var l in window.ed.arrIscrolls)
{var currisroll=window.ed.arrIscrolls[l];if(currisroll!=null)
{eval('window.ed.'+currisroll+'.refresh();');}}}catch(e){}},runAnimationIfAnyPrepared:function(){if(window.ed.waitingAnims!='')
{eval(window.ed.waitingAnims);window.ed.waitingAnims='';}},setGlobalRefreshFunction:function(){window.refreshAfterShow=function(){window.ed.playershown=true;window.ed.refreshIscrollsFix();window.ed.runAnimationIfAnyPrepared();if(!window.ed.startinPageEventCalled)
{window.ed.startinPageEventCalled=true;window.edStartingPageSet();{window.ed.zoomendwasalreadycalled=false;edCurrentPageZoomEnd();}}
if(window.tlbr.layout!==undefined)
{window.tlbr.layout();}
else
{console.log('ERROR! window.tlbr.layout() function is not found! Invalid custom toolbar?');debugger;}}},loadImagesForPage:function(pageId){window.ed.animation_local_int_vars=new Object();var loadPage=pageId;ed._last_image_clicked='';var this_object=window.f.findObjFromWindowPgsByPagenumber(pageId);if(this_object.pageElementsLoaded)
{edPageLoaded();return false;}
ed._pg_hasAnim=false;var hasElements=false;var atLeastOneWasLoaded=false;var elementNotPreloaded='';var anyPreloadImage=false;for(var d in this_object.interactive)
{var currObj=this_object.interactive[d];if(currObj.itype==window.ide.itypeimage||currObj.itype==window.ide.itypetextblock||currObj.itype==window.ide.itypegallery||currObj.itype==window.ide.itypevideo)
{hasElements=true;try
{if(currObj.id>0)
{if(currObj.closeonclick==1)
{window.f.AtachEvent(currObj.divid,window.ed._touch_start_event_nm,'window.ed.click_on_image');if(window.ed.istouchdevice)
{window.f.AtachEvent(currObj.divid,'mousedown','window.ed.click_on_image');}}}}catch(e){}
if(currObj.preload)
{anyPreloadImage=true;if(currObj.hasAnim)
{atLeastOneWasLoaded=true;}
if(currObj.isScrollableImage)
{var addscrollbarStr='hScrollbar:true,vScrollbar:true,fadeScrollbar: true,';if(currObj.hideScrollbars)
{addscrollbarStr='hScrollbar:false,vScrollbar:false,fadeScrollbar: false,';}
var addjs='var currobj_imagesrcimg = document.getElementById("'+currObj.imagesrcimg+'");'+'var currobj_divid = document.getElementById("'+currObj.divid+'");'+' if(currobj_imagesrcimg != null){'+'    currobj_imagesrcimg.src=this.src;'+'  currobj_imagesrcimg.style.display="block";'+'  }'+' if(currobj_divid != null){'+'  currobj_divid.style.display="block";'+'  }';addjs+='window.setTimeout(function(){'+'if(window.ide.currentPage=='+window.ide.currentPage.toString()+'){'+'var currentiscroll = new iScroll("'+currObj.scrollholder+'",{x:'+currObj.startScrollX+',y:'+currObj.startScrollY+','+addscrollbarStr+' bounce: true, zoom:false });'+'window.ed.'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+' =  currentiscroll;'+'window.ed.'+currObj.iscrollid+'=currentiscroll;'+'window.ed.arrIscrolls.push("'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+'");'+'}';addjs+='},10);';}
else
{var addjs='var currobj_dividimage = document.getElementById("'+currObj.dividimage+'");'+'if(currobj_dividimage != null){'+'currobj_dividimage.style.backgroundImage="url("+String.fromCharCode(39)+this.src+String.fromCharCode(39)+")";'+'}';}
if(currObj.connected)
{if(ed.get(currObj.divid)!=null)
{ed.get(currObj.divid).style['visiblity']='hidden';}}
ed.isLoadingObjectsImages=true;ed.addtodownloadlistImages=ed.addtodownloadlistImages+','+currObj.divid+',';eval('var imgs'+d.toString()+' = new Image();');eval('imgs'+d.toString()+'.onload = function(){try{window.eddata.pages['+this_object.arrindex.toString()+'].interactive['+d+'].preloaded = true;window.ed.setAnimObjectPreloadStatus('+currObj.id.toString()+',true);'+addjs+'window.ed.checkPreloadedImgs('+loadPage+',this.alt);}catch(e){console.log("Error while seting anim object preload status and interactive.preloaded to true!. ["+e.message+"]");}}');eval('imgs'+d.toString()+'.onerror = function(){window.ed.checkPreloadedImgs('+loadPage+',this.alt);}');eval('imgs'+d.toString()+'.alt = "'+currObj.divid+'";');eval("imgs"+d.toString()+".src = '"+currObj.src+"';");try
{var arrinx=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).arrindex;document.getElementById('pageHTMLDiv'+arrinx.toString()+'Inner').style.opacity='1';}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2221; column: 305;  :: '+v);ed.trace('LOAD IMAGES FOR PAGE->Error while setting opacity to 1 -> '+e.message);}}
else
{elementNotPreloaded=currObj.divid;}}}
if(!hasElements||!anyPreloadImage){call_after_load_and_anim_finished_dev('pgl4');edPageLoaded();}
if((!atLeastOneWasLoaded)&&(hasElements)&&(elementNotPreloaded!=''))
{ed._pg_hasAnim=true;window.ed.checkPreloadedImgs(loadPage,elementNotPreloaded);}},runCallback:function(callback){try
{callback=ed.stringReplace(callback,ed.dblQuote,'"',0);eval(callback);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2227; column: 205;  :: '+v);console.log("Error when calling callback -> ["+e.message+"]"+callback);}},endLoadingBackgroundAndLinksForPage:function(for_page_number,divlowres,imgsrc){var currObj=window.f.findObjFromWindowPgsByPagenumber(for_page_number);if(currObj!=null)
{currObj.iscurrentlyloadingpagebackground=false;}
ed.addToDownloadList=ed.addToDownloadList.replace(','+divlowres+',','');if(ed.addToDownloadList=='')
{ed.isLoadingPageBackgrounds=false;ed.hideLoader();}
var lowres_element=document.getElementById(divlowres);if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{if(lowres_element!=null){lowres_element.src=imgsrc;}}
else
{if(lowres_element!=null){lowres_element.style.backgroundImage="url('"+imgsrc+"')";}}
currObj.loadedimage=true;var currobj=currObj;if(currobj!=null)
{if(window.ed.get(currobj.holderdivid)!=null)
{if(window.ed.get(currobj.holderdivid).style.display.toLowerCase()=='none')
{if(!window.ed.get(currobj.holderdivid).isfadeinsubpage)
{window.ed.get(currobj.holderdivid).style.display='block';$('#'+currobj.holderdivid).fadeTo(0,1);}}}}},loadBackgroundAndLinksForPage:function(for_page_number,lowresDiv,lowresSrc,linksDiv,linksSrc,loadlinks,callback){try
{try
{var currObj=window.f.findObjFromWindowPgsByPagenumber(for_page_number);if(currObj!=null)
{ed.addToDownloadList=ed.addToDownloadList+','+lowresDiv+',';if(!ed._loader_visible)
{ed.showLoader();}
ed.isLoadingPageBackgrounds=true;currObj.iscurrentlyloadingpagebackground=true;window.ed.currentDownloadImageIndex=window.ed.currentDownloadImageIndex++;var callback_set=ed.stringReplace(callback.toString(),'"',window.ed.dblQuote,1);eval('var img_lodr'+window.ed.currentDownloadImageIndex.toString()+' = new Image()');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.onload = function(){window.ed.endLoadingBackgroundAndLinksForPage('+for_page_number.toString()+',"'+lowresDiv+'","'+lowresSrc+'");if(this.alt !=""){window.ed.runCallback(this.alt);}}');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.onerror = function(){window.ed.endLoadingBackgroundAndLinksForPage('+for_page_number.toString()+',"'+lowresDiv+'","'+lowresSrc+'");if(this.alt !=""){window.ed.runCallback(this.alt);}}');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.alt = "'+callback_set.toString()+'"');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.src = "'+ed.stringReplace(lowresSrc," ","").toString()+'"');}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2244; column: 1183;  :: '+v);console.log('couldnt find lowres for loading image to memory -> '+divlowres+' ::: '+e.message);}
try
{if(loadlinks)
{if(linksDiv!='')
{document.getElementById(linksDiv).style.backgroundImage="url('"+linksSrc+"')";}}}catch(e){ed.trace('couldnt find links div for clearing image from memory -> '+linkslowres);}}
catch(e)
{}},showCurrentDiv:function(elementname){window.ed.preventBecauseLoadingImagesToMemory=false;ed.hideLoader();},already_requested_html5:[],getThumbToLoad:function(forPageObj){if((typeof(forPageObj.canvas)=="undefined")||(forPageObj.canvas==""))
{if(typeof(forPageObj.background_color)!='undefined')
{return window.ed.defaultNoImageValueSrc;}}
else
{if(window.edgl.argo.indexOf('*without_html5_page_img*')!=-1){return forPageObj.canvas;}
for(var i in window.ed.already_requested_html5){if(window.ed.already_requested_html5[i]==(forPageObj.arrindex+1)){return forPageObj.canvas;}}
return forPageObj.thumb;}},getCanvasToLoad:function(forPageObj,forceGetHD){if(typeof(forceGetHD)=='undefined')
{var forceGetHD=false;}
var isHD=window.ide.useHDCanvas==window.ide.editionId;if((typeof(forPageObj.canvas)=="undefined")||(forPageObj.canvas==""))
{if(typeof(forPageObj.background_color)!='undefined')
{$('#'+forPageObj.lowresdiv).css({'background-color':forPageObj.background_color});return window.ed.defaultNoImageValueSrc;}}
else
{if((isHD)||(forceGetHD))
{return forPageObj.canvasHD;}
else
{return forPageObj.canvas;}}},getcurrentdragpercent:function(child){var fullheight=$(child).parent().height()-$(child).height();var percentscrolled=$(child).position().top/fullheight;return percentscrolled;},setcurrentdragpercent:function(percent,child){var fullheight=$(child).parent().height()-$(child).height();var percentscrolled=fullheight*percent;$(child).css({'top':percentscrolled.toString()+'px'});return true;},updatedragscroller:function(){var mainpholder='.edition-player';if($(mainpholder).find('.ed-pscroll-parent').length>0)
{var percentscrl=window.ide.paralaxScrollY/-(ed.paralaxmaxscrolly);var child=$(mainpholder).find('.ed-pscroll-parent').find('.ed-pscroll-child')[0];ed.setcurrentdragpercent(percentscrl,child);}},calculatemaxscrolly:function(){ed.paralaxmaxscrolly=0;var currp=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currp!=null)
{if(currp.ismainparalaxpage)
{var cnt=0;var tmpparalaxallpages=(currp.paralaxallages).split(',');for(var d in tmpparalaxallpages)
{var currpg=tmpparalaxallpages[d];if(!isNaN(currpg))
{if(parseInt(currpg)>0)
{cnt++;}}}
ed.paralaxmaxscrolly=(cnt*window.eddata.head.pageHeight);}}},loadPage:function(for_page,loadAllelements){if(typeof(loadAllelements)=='undefined')
{var loadAllelements=false;}
var _set_to_close=false;var _original_current_page=for_page;try
{var this_page_object=window.f.findObjFromWindowPgsByPagenumber(for_page);var currentPage=this_page_object.arrindex;}catch(e){console.log('!!!Error!!!! in loadPage funct -> Object is '+this_page_object+' ____ PAGE->'+for_page)}
ed._OBJECT_TO_SHOW='';var n=currentPage;var elmnm='lowres'+n.toString();var elem=document.getElementById(elmnm);if((!window.eddata.pages[n].pageloaded)&&(!window.eddata.pages[n].iscurrentlyloadingpagebackground))
{window.ed.showLoader();ed.showLoader(ed.loader1);ed.disableCommands();try
{if(window.eddata.pages[n].ismainparalaxpage)
{window.ide.paralaxPagesInitiate(window.eddata.pages[n]);}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2279; column: 193;  :: '+v);console.log("exception while drawing paralax scrollbar ->"+e.message);}
ed.setStatusToLoadingImages();var difference=ed.maxLoadedPages / 2;var leftDifference=Math.floor(difference);if((leftDifference%2)>0)
{leftDifference=leftDifference-1;}
var startCount=currentPage-leftDifference;if(startCount<0)
{startCount=0;}
var endCount=startCount+ed.maxLoadedPages;var tmout=0;var showElement=elmnm;if(ed._pressedElement!=null)
{var objName=ed._pressedElement.id.toLowerCase().replace('pagehtmldiv','lowres');var thisD=parseInt(ed._pressedElement.id.toLowerCase().replace('pagehtmldiv',''));var objLinkName=ed._pressedElement.id;}
else
{var objName='pageHTML'+n.toString();var objNameLinks='pageHTMLDiv'+n.toString();}
var curobj=this_page_object;if(curobj!=null)
{var objName=curobj.pageHTML;var objNameLinks=curobj.divid;}
var obj=ed.get(objName);window.ed.loaderSetAlpha(100,objName,0);ed.maindownloadGroupIndex++;startCount=n;endCount=n;var d=n;var elemname='lowres'+d.toString();var elem=document.getElementById(elemname);if(elem!=null)
{if(!window.eddata.pages[d].pageloaded)
{ed.preventBecauseLoadingImagesToMemory=true;ed._download_counter++;ed.downloads.items.push(ed._download_counter);var path=window.ed.getCanvasToLoad(window.eddata.pages[d]);var download_path_image=path;ed.downloads.items[ed._download_counter]={loadpath:path,downloadindex:ed.maindownloadGroupIndex};_set_to_close=true;if(loadAllelements)
{var show_links_str="window.ed.showLinks(true);";var callback="window.eddata.pages["+d.toString()+"].pageloaded = true;window.ed.checkIfFilesDowloaded('"+ed.stringReplace(download_path_image," ","",3)+"',\"window.ed.showCurrentDiv("+ed.singleQuote+objName+ed.singleQuote+");"+show_links_str+"\","+ed.maindownloadGroupIndex.toString()+");";}
else
{var callback="";}
var loadLinks=true;if(this_page_object.linksAreTransparent)
{loadLinks=false;linksDiv='';}
if(this_page_object.linksOnPage<1)
{loadLinks=false;linksDiv='';}
if(!loadAllelements)
{loadLinks=false;linksDiv='';}
window.ed.loadBackgroundAndLinksForPage(this_page_object.pagenumber,this_page_object.lowresdiv,window.ed.getCanvasToLoad(this_page_object),this_page_object.linksDiv,this_page_object.linkimage,loadLinks,callback);ed._OBJECT_TO_SHOW=elmnm;}}}
else if(window.eddata.pages[n].pageloaded)
{try
{if(window.eddata.pages[n].ismainparalaxpage)
{if($('.ed-pscroll-parent').length<1)
{window.ide.paralaxPagesInitiate(window.eddata.pages[n]);}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2307; column: 194;  :: '+v);console.log("exception while drawing paralax scrollbar ->"+e.message);}}},updatePaginator:function(alsoLoadNewImages){if(typeof(alsoLoadNewImages)=='undefined')
{var alsoLoadNewImages=true;}
var pageId=window.ide.currentPage;window.ide.currentPage=pageId;window.ed._currentPageObjPgs=window.f.findObjFromWindowPgsByPagenumber(pageId);try
{if(document.getElementById('contentPaginator')!=null)
{for(var d=0;d<document.getElementById('contentPaginator').options.length;d++)
{if(parseInt(document.getElementById('contentPaginator').options[d].value)==parseInt(pageId))
{document.getElementById('contentPaginator').options[d].selected='selected';}}}}catch(e){}},drawLinks:function(pageId){var ratio=1;ratio=ed.preferredWidth / ed._originalPageWidth;if(parseInt(pageId)<1){pageId=1;}
secondpageId=-1;if((!ed._isPortraitMode)&&(pageId>1))
{if((pageId%2)==0)
{var secondpageId=pageId+1;}
else
{var secondpageId=pageId-1;}
var tmp=secondpageId;secondpageId=pageId
pageId=tmp;}
if(secondpageId>window.ide.editionAllPagesCount)
{secondpageId=window.ide.editionAllPagesCount;}
ed.clearAllCanvas(firstPage,secondPage,window.ide.currentPage-1);},onVideoCleared:function(video_id,page_id,video_title,video_id_plain){var video=$('#'+video_id);if(!video.length){return;}
var event={data:{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain}};if(window.ide.contain_video){window.ed.onEndedTrackingVideoPlayer(event);}},getHiddenPagesOffsetToPage:function(pageId){var hiddenPagesOffset=0;var set=false;for(var l=0;l<pageId;l++)
{var currobj=window.f.findObjFromWindowPgsByArrIndex(l);if(currobj.arrindex==l)
{if((!currobj.ismainpage)||(currobj.hidden))
{if((ed._isLandscapeMode))
{hiddenPagesOffset=hiddenPagesOffset+1;}
else
{if(ed._isPortraitMode)
{if(!currobj.ismainpage)
{hiddenPagesOffset=hiddenPagesOffset+1;}}}}}}
return hiddenPagesOffset;},unloadImagesFromPage:function(arrIndex){var pageId=arrIndex;if(window.ide.currentPageObjPgs.interactive!=null)
{if(window.ide.currentPageObjPgs.interactive.length>0)
{for(var d in window.ide.currentPageObjPgs.interactive)
{var currObj=window.ide.currentPageObjPgs.interactive[d];if(currObj.itype==window.ide.itypeimage)
{try
{if(currObj.isScrollableImage)
{try
{for(var l in window.ed.arrIscrolls)
{var iscroller=window.ed.arrIscrolls[l];if(iscroller!='')
{var tmpiscrl=eval('window.ed.'+iscroller);if((tmpiscrl!=null)&&(tmpiscrl!='undefined'))
{tmpiscrl.destroy();}
window.ed.arrIscrolls[l]='';}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2344; column: 165;  :: '+v);console.log('Error while freeing iscroll -> '+e.message);}
window.ed.setAnimObjectPreloadStatus(currObj.id,false);currObj.preloaded=false;document.getElementById(currObj.imagesrcimg).src=window.ed.defaultNoImageValueSrc;document.getElementById(currObj.divid).style.display='none';}
else
{currObj.preloaded=false;window.ed.setAnimObjectPreloadStatus(currObj.id,false);document.getElementById(currObj.dividimage).style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(currObj.divid).style.display='none';}}
catch(e){}}}}}},clearFadeInSubpage:function(_page_fadein_id){var fadeinobj=window.f.findObjFromWindowPgsByPagenumber(_page_fadein_id);var objnm=ed.get(fadeinobj.holderdivid);objnm.style.display='none';objnm.style.top='-5000px';try
{ed.clearImageFromMemory(fadeinobj.lowresdiv,fadeinobj.divid);try
{ed.unloadImagesFromPage(fadeinobj.arrindex);}catch(e){}}catch(e){}},hideAllFadeInSubpages:function(dontrefresh,dontclearpage1,dontclearpage2,doinstantly){if(typeof(doinstantly)=='undefined')
{var doinstantly=false;}
if(typeof(dontrefresh)=='undefined')
{var dontrefresh=false;}
for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if((currobj.isfadeinvisible)&&(currobj.isfadeinsubpage))
{if((parseInt(currobj.pagenumber)!=parseInt(dontclearpage1))&&(parseInt(currobj.pagenumber)!=parseInt(dontclearpage2)))
{var fadeinobj=window.f.findObjFromWindowPgsByPagenumber(currobj.pagenumber);if(doinstantly)
{window.setTimeout('window.ed.loaderSetAlpha(0,"'+fadeinobj.holderdivid+'",0);',1);window.setTimeout('window.ed.clearFadeInSubpage('+fadeinobj.pagenumber+');',2);}
else
{window.setTimeout('window.ed.loaderSetAlpha(0,"'+fadeinobj.holderdivid+'",300);',50);window.setTimeout('window.ed.clearFadeInSubpage('+fadeinobj.pagenumber+');',351);}
currobj.isfadeinvisible=false;ed._fadein_subpage_visible=false;ed._fadein_pgs_id=-1;ed._fadein_parent_id=-1;}}}},refreshStuffonchangedPage:function(_set_to_page,loadnewimages){if(typeof(loadnewimages)=='undefined')
{var loadnewimages=true;}
window.ide.currentPage=_set_to_page;ed._page_id=_set_to_page;window.f.setDefaultsOnActualChangePage();ed._actionversion=ed._actionversion+1;ed.updatePaginator(loadnewimages);window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",200);},setNewPageWithoutBgRefresh:function(_page_id_to_show){window.ide.currentPage=parseInt(_page_id_to_show);window.f.setDefaultsOnActualChangePage();ed._page_id=parseInt(_page_id_to_show);ed.updatePaginator(false);},initAndPosFadeInSubpage:function(_page_id_to_hide,_page_id_to_show){var dontWorryAboutParent=false;if(parseInt(_page_id_to_hide)==parseInt(_page_id_to_show))
{var _page_id_to_hide=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).mainPageId;}
var foundobj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show);var parentObj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide);if(foundobj!=null)
{ed._fadein_subpage_visible=true;ed._fadein_pgs_id=_page_id_to_show;ed._fadein_parent_id=_page_id_to_hide;ed._page_id=_page_id_to_show;var parentObjHolderDiv=parentObj.holderdivid;if(foundobj!=null)
{var rct=ed.get(parentObj.holderdivid).getBoundingClientRect();var newpgTop=rct.top;var newpgLeft=rct.left;ed.get(foundobj.holderdivid).style['top']=newpgTop.toString()+'px';ed.get(foundobj.holderdivid).style['left']=(Math.abs(ed.currentDistance)+(newpgLeft)).toString()+'px';$('#'+foundobj.holderdivid).stop();$('#'+foundobj.holderdivid).fadeTo(0,0.0001);ed.get(foundobj.holderdivid).style['display']='block';window.ed._is_loading_fadein_subpage=false;window.setTimeout('window.ed.refreshStuffonchangedPage('+_page_id_to_show.toString()+',false);',500);try
{if(window.ide.contain_video){window.ed.clearAllActualVideos(true);}
try
{ObjGoAnim(true,false,-11,-11,"hide",window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).pagenumber,false);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2370; column: 250;  :: '+v);window.ed.trace('Error while freeing animations!');}}catch(e){}
ed.setNewPageWithoutBgRefresh(_page_id_to_show);ed.loadPage(_page_id_to_show,true);try
{if(!dontWorryAboutParent)
{window.ed.get(parentObj.holderdivid).style.zIndex=window.ed.z_index_max;}
window.ed.z_index_max=window.ed.z_index_max+1;window.ed.get(foundobj.holderdivid).style.zIndex=window.ed.z_index_max;}catch(e){}
window.setTimeout('window.ed.endFadeinPageLoading("'+dontWorryAboutParent.toString()+'","'+parentObj.holderdivid+'","'+foundobj.holderdivid+'",'+_page_id_to_show.toString()+','+_page_id_to_hide.toString()+')',300);}}},endFadeinPageLoading:function(dontWorryAboutParent,parent_holder_divid,holder_divid,_page_id_to_show,_page_id_to_hide){if(ed.currentlyloadingImages)
{window.setTimeout('window.ed.endFadeinPageLoading("'+dontWorryAboutParent.toString()+'","'+parent_holder_divid+'","'+holder_divid+'",'+_page_id_to_show.toString()+','+_page_id_to_hide.toString()+')',200);}
else
{window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show).isfadeinvisible=true;window.setTimeout('window.ed.loaderSetAlpha("100","'+holder_divid+'",600);',50);if(dontWorryAboutParent=='false')
{try
{window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).ishiddenbecauseoffadeinsubpage=true;}catch(e){}
window.setTimeout('window.ed.hideAllFadeInSubpages(false,'+_page_id_to_show.toString()+',-1,true);',651);window.setTimeout('window.ed.loaderSetAlpha(0,"'+parent_holder_divid+'",600);',60);}
window.setTimeout('window.ed.checkIfAnyAction(window.ed._actionversion);',800);}},checkFadeInSubpagesHide:function(dontrefresh,dontfreepage1,dontfreepage2){if(typeof(dontfreepage1)=='undefined')
{var dontfreepage1=-1;}
if(typeof(dontfreepage1)=='undefined')
{var dontfreepage2=-1;}
if(typeof(dontrefresh)=='undefined')
{var dontrefresh=false;}
if(ed._fadein_subpage_visible)
{ed.hideAllFadeInSubpages(dontrefresh,dontfreepage1,dontfreepage2);}},showFadeInSubpagePage:function(_page_id_to_hide,_page_id_to_show){ed.checkFadeInSubpagesHide(true,_page_id_to_hide,_page_id_to_show);if(parseInt(_page_id_to_hide)==parseInt(_page_id_to_show))
{}
var foundobj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show);if(foundobj!=null)
{window.setTimeout("window.ed.initAndPosFadeInSubpage("+_page_id_to_hide.toString()+","+_page_id_to_show.toString()+");",50);}},resetAllPagesThatAreNotVisibleBecauseOfSubpages:function(){for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(currobj.ishiddenbecauseoffadeinsubpage)
{if(currobj.pageloaded)
{if(!window.eddata.pages[l].isfadeinsubpage)
{window.eddata.pages[l].ishiddenbecauseoffadeinsubpage=false;window.ed.get(window.eddata.pages[l].holderdivid).style.display='block';$('#'+window.eddata.pages[l].holderdivid).stop();$('#'+window.eddata.pages[l].holderdivid).fadeTo(0,1);}
else
{window.eddata.pages[l].ishiddenbecauseoffadeinsubpage=false;}}}}},callAllFunctionsAfterPageTransitionALL:function(previosPGSobj){window.ed.resetAllPagesThatAreNotVisibleBecauseOfSubpages();window.ed.hideAllFadeInSubpages(false,-1,-1,true);window.ed._is_loading_fadein_subpage=false;if(window.ide.contain_video){window.ed.clearAllActualVideos(true);}
try
{if(previosPGSobj!=null)
{try
{ObjGoAnim(true,false,-11,-11,"hide",previosPGSobj.pagenumber,false);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2402; column: 204;  :: '+v);window.ed.trace('Error while freeing animations!');}}}catch(e){}
ed.hideShowObject(ed._linkImageElemShown);},getCorrectQueryString:function(currentLocation){var resstr='';if(currentLocation.indexOf('?')>0)
{var arr_tmp=currentLocation.split('?');resstr=arr_tmp[1];resstr=resstr.replace("plr="+window.ed.getItemFromQueryString('plr'),'');resstr=resstr.replace("page="+window.ed.getItemFromQueryString('page'),'');resstr=resstr.replace("plr=ed",'');resstr=resstr.replace(resstr,"&&","&");resstr=resstr+":*;ed:*:";resstr=resstr.replace("&:*;ed:*:","");resstr=resstr.replace(":*;ed:*:","");resstr='&'+resstr;resstr=resstr.replace(resstr,"&&","&");}
return resstr;},setResizeEvents:function(){var supportsOrientationChange="onorientationchange"in window,orientationEvent=supportsOrientationChange?"orientationchange":"resize";try
{$(document).on("edResize",function(event){window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);});ed.wrapper.removeEventListener(orientationEvent,window.ide.add_and_resize_pages_to_fit(window.ide.currentPage),false);ed.orientationEvent=window.addEventListener(orientationEvent,window.ide.add_and_resize_pages_to_fit(window.ide.currentPage),false);}catch(e){}},enableScalingForSwipe:function(strScale)
{ed._scaStrForViewPort=strScale;},onImageLoaded:function(img,divlowres,imgsrc){ed.enableCommands();ed.hideLoader(ed.loader10);},refreshScreenResolution:function(){ed.screenWidth=document.documentElement.clientWidth;ed.screenHeight=document.documentElement.clientHeight;},getElementOffset:function(el){var _x=0;var _y=0;while(el&&!isNaN(el.offsetLeft)&&!isNaN(el.offsetTop)){_x+=el.offsetLeft-el.scrollLeft;_y+=el.offsetTop-el.scrollTop;el=el.parentNode;}
return{top:_y,left:_x};},doNextPageProcedure:function(pagenumber){ed.disableCommands();window.setTimeout('window.ed.enableCommands();',300);ed.goToStartOfPage(pagenumber);},getOptimalZoomRatio:function(){var resvar=1/ed._originalRatio;if(window.ed.usesHD)
{var single_original_width=ed._originalPageWidth;var ratio=ed.singlePageWidth / ed.hdwidth;resvar=1/ratio;}
return resvar;},initeDitionSwipe:function(){ed.mainWrapper=document.getElementById("mainHolder");ed.wrapper=document.getElementById("wrapper");ed.slideContainer=document.getElementById("wholeContainerDiv");ed.slides=ed.getAllElementsById('pagesholderparent');try
{if(typeof(addProductsStringToBasket)=='function')
{var cookie_str=ed.getCookie((window.ide.editionId.toString()+"chartContent"));if((cookie_str!='')&&(cookie_str!='undefined'))
{addProductsStringToBasket(cookie_str);}}}catch(e){}
var currobj=f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);ed.goToStartOfPage(currobj.id);},bestViewZoom:function(){if(!window.ed._move_hanlder_started_to_scroll_left_or_right)
{ed.zoomIn(window.ide.bestViewZoomFactor,false,'','',false,false);ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);}},initEvents:function(){if(ed._isDesktopBrowser)
{for(var d=0;d<(window.ide.editionAllPagesCount*2);d++)
{var srchDiv='pagesholderparent'+d.toString();var obj=document.getElementById(srchDiv);if(obj!=null)
{if(obj!='undefined')
{window.f.AtachEvent(obj.id,window.ed._touch_start_event_nm,'window.ed.startHndlLowres');window.f.AtachEvent(obj.id,window.ed._touch_move_event_nm,'window.ed.moveHndlLowres');}}}
try
{window.f.AtachEvent('aboutBox',window.ed._touch_start_event_nm,'window.ed.aboutboxStartHandler');window.f.AtachEvent('aboutBox',window.ed._touch_move_event_nm,'window.ed.aboutboxMoveHandler');window.f.AtachEvent('aboutBox',window.ed._touch_end_event_nm,'window.ed.aboutboxEndHandler');}catch(e){}
try
{window.f.AtachEvent('videoContentSRC',window.ed._touch_start_event_nm,'window.ed.videoStartHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_move_event_nm,'window.ed.videoMoveHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_end_event_nm,'window.ed.videoEndHndler');}catch(e){}
try
{$('#'+window.ide.mainStageElementParent).off("DOMMouseScroll mousewheel wheel onwheel",window.ed.mouseWheel);$('#'+window.ide.mainStageElementParent).on("DOMMouseScroll mousewheel wheel onwheel",window.ed.mouseWheel);}catch(e){}}
else
{for(var d=0;d<(window.ide.editionAllPagesCount*2);d++)
{var srchDiv='pagesholderparent'+d.toString();var obj=document.getElementById(srchDiv);if(obj!=null)
{if(obj!='undefined')
{window.f.AtachEvent(srchDiv,window.ed._touch_start_event_nm,'window.ed.startHndlLowres');window.f.AtachEvent(srchDiv,window.ed._touch_move_event_nm,'window.ed.moveHndlLowres');window.f.AtachEvent(srchDiv,'mousedown','window.ed.startHndlLowres');window.f.AtachEvent(srchDiv,'mousemove','window.ed.moveHndlLowres');}}}
try
{window.f.AtachEvent('aboutBox',window.ed._touch_start_event_nm,'window.ed.aboutboxStartHandler');window.f.AtachEvent('aboutBox',window.ed._touch_move_event_nm,'window.ed.aboutboxMoveHandler');window.f.AtachEvent('aboutBox',window.ed._touch_end_event_nm,'window.ed.aboutboxEndHandler');}catch(e){}
try
{window.f.AtachEvent('videoContentSRC',window.ed._touch_start_event_nm,'window.ed.videoStartHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_move_event_nm,'window.ed.videoMoveHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_end_event_nm,'window.ed.videoEndHndler');}catch(e){}}
ed.disableCommands();ed._isSingleClick=false;ed.pressed=0;},zoomTo100Percent:function(){ed.zoomOut(window.ide.defaultPublicationScale,true,0,0,false,false,-1);},checkScaleAndEnableTracking:function(eventtmp){ed._enabledTracking=true;},startHandler:function(eventer){},hideAboutBox:function(){$('#aboutBox').stop();$('#aboutBox').transition({opacity:0},290,window.ed.defaultEasing,function(){});window.setTimeout('window.ed.disableCloseAboutBox();',200);window.setTimeout("document.getElementById('innerAboutBox').style.background = 'none';document.getElementById('innerAboutBox').style.backgroundImage = 'none';document.getElementById('aboutBox').style.display = 'none';document.getElementById('aboutBox').style.top = '-1500px';",300);ed.initiateAlpha(document.getElementById('aboutBox'));ed._openedAboutBox=false;},disableCloseAboutBox:function(){ed._openedAboutBox=false;ed.enableCommands();},enableCloseAboutBox:function(){ed._openedAboutBox=true;},showAboutBox:function(){if(ed._openedAboutBox)
{window.ed.hideAboutBox();}
else
{ed._openedAboutBox=false;ed.disableCommands();ed.initiateAlpha(document.getElementById('aboutBox'));document.getElementById('aboutBox').style.opacity="0";document.getElementById('aboutBox').style.top="0px";document.getElementById('aboutBox').style.display='inline';document.getElementById('innerAboutBox').style.top="50%";document.getElementById('innerAboutBox').style.backgroundImage="url('"+ed._aboutBoxImage+"')";window.setTimeout('window.ed.loaderSetAlpha("100","aboutBox",300);',500);window.setTimeout('window.ed.enableCloseAboutBox();',800);}},checkOrientation:function(runFunct){var resvar=false;thisOrient=Math.abs(window.orientation);if(isNaN(thisOrient))
{thisOrient=0}
if(parseInt(thisOrient)!=Math.abs(ed.currentOrientation))
{if(runFunct)
{window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);}
resvar=true;return resvar;}
else
{resvar=ed.setWindowWidthAndHeight(true);return resvar;}},setImageSrc:function(imgelem,objId,functToRun,cancelGpuAccFix){try
{var obj=ed.get(objId);if(typeof(cancelGpuAccFix)=='undefined')
{var cancelGpuAccFix=false;}
if(cancelGpuAccFix!=true)
{cancelGpuAccFix=false;}
if(obj!=null)
{obj.src=imgelem.src;if(cancelGpuAccFix)
{obj.className=obj.className.replace('gpuAcc','');obj.className=obj.className.replace('renderBQ','');obj.className=obj.className+' renderBQ';}
else
{obj.className=obj.className.replace('gpuAcc','');obj.className=obj.className.replace('renderBQ','');obj.className=obj.className+' gpuAcc renderBQ';}}
else
{ed.trace('Error while loading BG image to object "'+objId+'" -> Object does not exit');}
if(functToRun!='')
{eval(functToRun);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2459; column: 126;  :: '+v);ed.trace('Error while loading BG image to object "'+objId+'" -> '+e.message);}},setCallbackCorrect:function(inputstr){var outputstr=inputstr.replace()
var find=ed.singleQuote.toString();var regex=new RegExp(find,"g");outputstr=outputstr.replace(regex,"'");var find=ed.dblQuote.toString();var regex=new RegExp(find,"g");outputstr=outputstr.replace(regex,"'");return outputstr;},checkIfFilesDowloaded:function(thissrcLoaded,callback,groupindex){if(typeof(thissrcLoaded)!='undefined')
{for(var d in ed.downloads.items)
{var currobj=ed.downloads.items[d];if((currobj!=null)||(typeof(currobj)=='undefined'))
{if(currobj.downloadindex==groupindex)
{if(ed.stringReplace(currobj.loadpath," ","")==thissrcLoaded)
{ed.downloads.items[d]=null;}}}}}
var everythingdownloaded=true
for(var d in ed.downloads.items)
{var currobj=ed.downloads.items[d];if(currobj!=null)
{if(currobj.downloadindex==groupindex)
{everythingdownloaded=false;}}}
if(everythingdownloaded)
{var callbackstr=ed.setCallbackCorrect(callback);eval(callbackstr);}
else
{if(!ed._loader_visible)
{ed.showLoader(ed.loader5);}}},removeAllSearchResults:function(){$('.ed-search-result-square').remove();},checkPageSearchResults:function(forpage){var curr_pg_obj=window.f.findObjFromWindowPgsByPagenumber(forpage);if(curr_pg_obj!=null)
{if(typeof(curr_pg_obj.search_results)!='undefined')
{if((curr_pg_obj.search_results).active==1)
{window.eddata.pages[curr_pg_obj.arrindex].search_results.active=0;for(var d in curr_pg_obj.search_results.results)
{var srchrs=curr_pg_obj.search_results.results[d];var addHtml='<div class="ed-search-result-square" style="left:'+srchrs.word.x.toString()+'px;top:'+srchrs.word.y.toString()+'px;width:'+srchrs.word.w.toString()+'px;height:'+srchrs.word.h.toString()+'px;"></div>';$('#'+curr_pg_obj.dividinner).append(addHtml);}}}}},initFirstTime:function(){window.ed.setGlobalRefreshFunction();window.ed.setResizeEvents();try
{if(typeof(runCustomJSScriptOnStart)=='function')
{runCustomJSScriptOnStart();}}catch(e){}
if(!window.ed.debug)
{window.ed.debug=window.ide.debug;}
if(!window.ed.debugLinks)
{window.ed.debugLinks=window.ide.debug;}
window.ed.eDitionName=window.ide.editionName;window.ed.eDitionTitle=window.ide.editionTitle;window.ed.ProjectName=window.ide.editionProjectName;window.ed.animation_global_int_vars=new Object();try
{reorderWindowPGS();ed.usesHD=usshd;ed.hdwidth=hdwdth;ed.hdheight=hdhghgt;}catch(e){}
ed.isThisPreviewApp=false;ed._requests_root_path=window.eddata.path.global_path;ed._requests_root_path_origin=window.eddata.path.global_path;ed.issinglepagemode=window.eddata.appearance.edition_style!='facingpages';ed.isAndroid=(window.navigator.userAgent.toLowerCase().indexOf('android')>0);ed.isIphone=(window.navigator.userAgent.toLowerCase().indexOf('iphone')>0)||(window.navigator.userAgent.toLowerCase().indexOf('ipod')>0);ed.isIpad=(window.navigator.userAgent.toLowerCase().indexOf('ipad')>0);if(ed.isAndroid){$('html').addClass('android-device-html');}
ed._randomchar=window.edgl.xmlversion;ed.checkOrientation(true);ed.thisIsInitialOffset=true;ed.maxLoadedPages=window.ide.eDitionAllPages;window.ide.editionAllPagesCount=window.eddata.head.AllPages;ed._isPortraitMode=window.ide.screenWidth<window.ide.screenHeight;ed._isLandscapeMode=!ed._isPortraitMode;ed._originalPageWidth=window.ide.originalSinglePageWidth;ed._originalPageHeight=window.ide.originalSinglePageHeight;ed._isFirstTime=true;ed._originalRatio=1;ed._originalRatioX=1;ed._originalRatioY=1;ed.iconPercentWidth='50';var leftPage=window.ide.currentPage-1;var rightPage=-1;if(!ed._isPortraitMode)
{if(leftPage%2==1)
{rightPage=leftPage+1;}
else
{leftPage=leftPage-1;rightPage=leftPage+1;}}
var objName='pageHTML'+(leftPage).toString();var obj=ed.get(objName);if(obj!=null)
{}
else
{if(rightPage>-1)
{var objName2='pageHTML'+(rightPage).toString();var obj2=ed.get(objName2);if(obj2!=null)
{obj2.style.opacity='0';window.setTimeout(function(){ed.loaderSetAlpha("100",objName2,1500)},4500);}}}
var timeout=0;window.setTimeout("window.ed.runeDitionSwipeDownloaded();",timeout);},showAllThumbs:function(){},runFirstLinks:function(){ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.isLoadingPublication = false;window.ed.hideLoader();window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},runeDitionSwipeOnReady:function(){window.setTimeout(function(){ed.enableCommands();ed.hideLoader()},200);window.setTimeout(function(){ed.runFirstLinks();},100);},initiateAlpha:function(element){eval('element.style.'+ed.webTransformNm+'Transition = "";');eval('element.style.'+ed.webTransformNm+'TransitionDuration = "";');eval('element.style.'+ed.webTransformNm+'TransitionTimingFunction = "";');},runeDitionSwipeDownloaded:function(){window.setTimeout(function(){ed.setSubpages(true);},5);},freeShowObject:function(object_id){var currObj=window.ide.currentPageObjPgs.interactive;for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.id==object_id)
{if(currObjThs.isScrollableImage)
{try
{for(var l in window.ed.arrIscrolls)
{var iscroller=window.ed.arrIscrolls[l];if(iscroller!='')
{var addjs="var tmpiscrl = eval('window.ed."+iscroller+"');";addjs+="if((tmpiscrl != null)&&(tmpiscrl != 'undefined')){tmpiscrl.destroy();}window.ed.arrIscrolls["+l.toString()+"] = '';";}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2506; column: 323;  :: '+v);console.log('Error while freeing iscroll -> '+e.message);}
window.ide.currentPageObjPgs.interactive[l].preloaded=false;window.ed.setAnimObjectPreloadStatus(currObjThs.id,false);try
{document.getElementById(currObjThs.divid).style.display='none';}catch(e){}
document.getElementById(currObjThs.imagesrcimg).src=window.ed.defaultNoImageValueSrc;}
else
{window.ide.currentPageObjPgs.interactive[l].preloaded=false;window.ed.setAnimObjectPreloadStatus(currObjThs.id,false);document.getElementById(currObjThs.dividinner).style.backgroundImage=window.ed.defaultNoImageValue;try
{document.getElementById(currObjThs.divid).style.display='none';}catch(e){}}}}},setAnimObjectPreloadStatus:function(object_id,preloaded){try
{if(typeof(anim_objects[object_id])!='undefined')
{if(anim_objects[object_id]!=null)
{anim_objects[object_id].preloaded=preloaded;}}}catch(e){}},freeLayer:function(){ed.closeFSCLayer();},freeFSCLayer:function(){if(window.ed.fscLayerSCroll!=null)
{window.ed.fscLayerSCroll.destroy();window.ed.fscLayerSCroll=null;}
try
{var elem_to_set_to=ide.get('showObjectLayer').getElementsByTagName("img")[0];if(elem_to_set_to!=null)
{elem_to_set_to.src=ed.defaultNoImageValueSrc;}
$('#showObjectLayer').stop().css({display:'none',opacity:'0',width:'0px',height:'0px'});}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2520; column: 223;  :: '+v);console.log("Error while freeing FSC LAYER");}},closeFSCLayer:function(){try
{ed.layerIsShown=false;ed._linkImageShowLayer=false;$('#showObjectLayer').stop().transition({opacity:0.0001},250,window.ed.jqueryTransition,function(){window.ed.freeFSCLayer();});}catch(e){console.log("Error while freeing FSC LAYER");}},runCurrentLayer:function(elem,image_width,image_height){ed.loadingLayer=false;ed.hideLoader();if(typeof(image_height)!='undefined')
{var image_width=image_width;var image_height=image_height;}
else
{var image_width=elem.width;var image_height=elem.height;ed.layerLastElement=elem;ed.layerLastElementWidth=image_width;ed.layerIsShown=true;ed.layerLastElementHeight=image_height;}
var ideminratio=1;if(image_height>window.ide.screenHeight)
{ideminratio=window.ide.screenHeight / image_height;}
var setToWidth=Math.round(image_width*ideminratio);var setToHeight=Math.round(image_height*ideminratio);if(setToWidth>window.ide.screenWidth)
{ideminratio=window.ide.screenWidth / image_width;setToWidth=Math.round(image_width*ideminratio);setToHeight=Math.round(image_height*ideminratio);}
if(setToWidth>window.ide.screenWidth)
{}
try{ed.get('showObjectLayer').style.left="0px";ed.get('showObjectLayer').style.top="0px";ed.get('showObjectLayer').style.width=window.ide.screenWidth.toString()+'px';ed.get('showObjectLayer').style.height=window.ide.screenHeight.toString()+'px';var parentNod=ed.get("tblObjLy");parentNod.style.left="0px";parentNod.style.top="0px";parentNod.style.width=window.ide.screenWidth.toString()+'px';parentNod.style.height=window.ide.screenHeight.toString()+'px';elem_to_set_to=parentNod.getElementsByTagName("img")[0];elem_to_set_to.style.width=setToWidth.toString()+'px';elem_to_set_to.style.height=setToHeight.toString()+'px';if(window.ed.fscLayerSCroll==null)
{elem_to_set_to.src=elem.src;if(window.ed.fscLayerSCroll!=null)
{window.ed.fscLayerSCroll.destroy();window.ed.fscLayerSCroll=null;}
window.ed.fscLayerSCroll=new iScroll(parentNod,{zoomMin:1,hScrollbar:true,fadeScrollbar:true,hScrollbar:true,bounce:false,zoom:true,lockDirection:false});}
else
{window.ed.fscLayerSCroll.refresh();}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2536; column: 172;  :: '+v);console.log('Error while creating iScroll -> '+e.message);};$('#showObjectLayer').stop().css({'display':'block',opacity:'0.0001'});$('#showObjectLayer').stop().delay(50).transition({opacity:'1'},500,window.ed.jqueryTransition,function(){});},showImageOnClick:function(idImage,showLayer,version_of_call,calledFromAnim){if(typeof(calledFromAnim)=='undefined')
{var calledFromAnim=false;}
var anim_index=0;var anim_name='show';idImage=idImage.toString();if(idImage.indexOf(',')>0)
{var arr_steps=idImage.split(',');try
{idImage=arr_steps[0];anim_index=arr_steps[1];if(typeof(arr_steps[2])=='undefined')
{anim_name=arr_steps[2];}}catch(e){anim_name='show';}}
var doCleanThem=true;if(ed._previous_version_of_call==version_of_call)
{doCleanThem=false;}
var found=false;var srchObjName='img'+idImage;for(var cntr=0;cntr<2;cntr++)
{var currObj=null;if(cntr==0)
{currObj=window.ide.currentPageObjPgs.interactive;}
if((cntr==1)&&(window.ide.orientIsBookMode))
{currObj_tmp=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(currObj_tmp!=null)
{currObj=currObj_tmp.interactive;}}
else if((cntr==1)&&(!window.ide.orientIsBookMode))
{found=true;}
if(!found)
{for(var l in currObj)
{var currObjThs=currObj[l];var srchObjName='img'+idImage;if(currObjThs.divid==srchObjName)
{var thisObj=document.getElementById(currObjThs.divid);var parentDiv=document.getElementById(currObjThs.parentDivInner);var absoluteParentDiv=document.getElementById(currObjThs.parentDivInner.replace('Inner',''));var currentSrc=currObjThs.src;ed._linkImageElemShown.push({imagename:"'"+srchObjName+"'",islayer:"'"+showLayer+"'"})
if(showLayer)
{var thisObjShow=ed.get('tblObjLy');var divObjShow=ed.get('showObjectLayer');var objImgElem=thisObjShow.getElementsByTagName('img');divObjShow.style.width='100%';divObjShow.style.height='100%';objImgElem[0].src=currentSrc;eval('thisObjShow.style.'+ed.webTransformNm+'Transition="opacity 0.5s linear";');thisObjShow.style.opacity='1';}
else
{ed.disableCommands();ed.showLoader(ed.loader6);if(((parentDiv.style.opacity!='1')&&(parentDiv.style.opacity!='0.0001'))||(parentDiv.style.visibility!='visible'))
{parentDiv.style.opacity='0.0001';parentDiv.style.visibility='visible';}
eval('thisObj.style.'+ed.webTransformNm+'Transition="";');thisObj.style.opacity='0.0001';thisObj.style.visibility='visible';thisObj.style.display='block';var wasSetAlready=false;var currobj=ed.findObjectForShowingFromDivName(currObjThs.divid);if(currobj!=null)
{if(currobj.hasAnim)
{ed.connectedImagePreload(currentSrc,currObjThs.divid,currObjThs.id,currObjThs.parentDivInner,true,currobj.anim_show,l,anim_index,anim_name,calledFromAnim);wasSetAlready=true;}}
if(!wasSetAlready)
{ed.connectedImagePreload(currentSrc,currObjThs.divid,currObjThs.id,currObjThs.parentDivInner,false,'',l,anim_index,anim_name,calledFromAnim);}}}}}}},findObjectForShowingFromDivName:function(searchDivId){if(searchDivId=='')
{searchDivId='undef';}
var returnObj=null;var found=false;if(!found)
{var tmpobjArr=window.ide.currentPageObjPgs.interactive;for(var n in tmpobjArr)
{var chkobj=tmpobjArr[n];if(chkobj.divid==searchDivId)
{returnObj=chkobj;found=true;}}}
return returnObj;},testPolyClick:function(polystring,pointX,pointY){var polystringArr=polystring.split("*");var polyCords=new Array();for(var l=0;l<polystringArr.length;l++)
{polystringArr2=polystringArr[l].split(',');polyCords[l]=[];polyCords[l][0]=parseInt(polystringArr2[0]);polyCords[l][1]=parseInt(polystringArr2[1]);}
var i,j,c=0;for(i=0,j=polyCords.length-1;i<polyCords.length;j=i++)
{if(((polyCords[i][1]>pointY)!=(polyCords[j][1]>pointY))&&(pointX<(polyCords[j][0]-polyCords[i][0])*(pointY-polyCords[i][1])/(polyCords[j][1]-polyCords[i][1])+polyCords[i][0]))
{c=!c;}}
polystringArr2=null;polystringArr=null;polyCords=null;return c;},checkIfCurrentPageHiddenAndReturnCorrectOne:function(val){try
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if(currobj.hidden)
{while(currobj.hidden)
{window.ide.currentPage=window.ide.currentPage+val;currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj.isfirstpage)
{currobj.hidden=false;}
if(currobj.islastpage)
{currobj.hidden=false;}}
window.f.setDefaultsOnActualChangePage();if(currobj!=null)
{ed.subpageindx=currobj.subpageindx;}}}}catch(e){}},checkIfCurrentPageFadeInInAndReturnCorrectOne:function(val){try
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if(currobj.isfadeinsubpage)
{while(currobj.isfadeinsubpage)
{window.ide.currentPage=window.ide.currentPage+val;currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj.isfirstpage)
{currobj.hidden=false;}
if(currobj.islastpage)
{currobj.hidden=false;}}
window.f.setDefaultsOnActualChangePage();if(currobj!=null)
{ed.subpageindx=currobj.subpageindx;}}}}catch(e){}},doStuffOnAfterPageTransition:function(object){window.setTimeout('window.ed.hasAlreadyStartedScrollingVerticalLocaly = false;window.ed.preventLocalHandling = false;window.ed.preventGlobalHandling = false;',50);window.ed.preventGlobalHandling=false;window.ed.preventLocalHandling=false;window.ed.hasAlreadyStartedScrollingVerticalLocaly=false;if(typeof(object)=='undefined')
{var object=null;}
if(object!=null)
{ed.comeBackSubpages(object.mainPageId);}},setSubpagesReset:function(resetsubpages,objpgs){if(typeof(objpgs)=='undefined')
{var objpgs=null;}
ed.subpgsupArrowShow=false;ed.subpgsdownArrowShow=false;if(typeof(resetsubpages)=='undefined')
{var resetsubpages=true;}
window.ed._currentPreviousPageObjPgs=null;if(resetsubpages)
{if(ed.subpageindx>0)
{if(objpgs!=null)
{window.ed._currentPreviousPageObjPgs=objpgs;}
else
{window.ed._currentPreviousPageObjPgs=window.ed._currentPageObjPgs;}
ed.subpageindx=0;}}
ed.subpagesOffsetY=0;ed.subpageindx=0;ed.subpagesOffsetY=0;window.ed._currentPageHasSubpages=false;window.ed._currentPageObjPgs.hasSubpages=false;},checkifFadeinSubpageAndReturnCorrectImage:function(indexOfWhatToSearch){if(typeof(indexOfWhatToSearch)=='undefined')
{return false;}
if(window.ed._currentPageObjPgs!=null)
{if(window.ed._currentPageObjPgs.isfadeinsubpage)
{if(indexOfWhatToSearch==window.ed.currentMainPage)
{var correctPage=window.f.findPreviousObjFromWindowPgsByElementObject(ed.get(window.ed._currentPageObjPgs.divid),false,true);if(correctPage!=null)
{ed.setNewPageWithoutBgRefresh(correctPage.pagenumber);}}}}},doStuffBeforeRightOrLeft:function(plusoneOrMinusOne){ed._subpageActionCount++;},comeBack:function(do_reset_everything){window.ide.checkEndPositionOrComeBack(do_reset_everything);ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},comeBackSubpages:function(mainpageid,subpageindx,doanimate){if(typeof(doanimate)=='undefined')
{var doanimate=true;}
if(doanimate!=false)
{doanimate=true;}
ed.trace('come Back subpages -> '+subpageindx+' ::: Mainpageid'+mainpageid+' DO ANIMATE -> '+doanimate);var startFromOffsetY=0;var singlepageHeight=ed.preferredHeight;if(subpageindx>0)
{startFromOffsetY=-(subpageindx*singlepageHeight);}
var mainpageid=mainpageid;for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];if(((curobj.mainPageId==mainpageid)&&(curobj.isswipesubpage))||((curobj.mainPageId==mainpageid)&&(curobj.ismainpage)))
{var diwlowres=window.eddata.pages[d].holderdivid;if(!doanimate)
{$('#'+diwlowres).transition({'top':(startFromOffsetY).toString()+'px'},0,window.ed.defaultEasing,function(){});}
else
{$('#'+diwlowres).transition({'top':(startFromOffsetY).toString()+'px'},window.ed.defaultTimingSubpages,window.ed.defaultEasing,function(){});}
startFromOffsetY=startFromOffsetY+singlepageHeight;}}
ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},onLinkdownloaded:function(img,divlowres,imgsrc,pageId,setBg){var currobj=window.f.findObjFromWindowPgsByPagenumber(pageId);if((pageId==window.ide.currentPage)||((currobj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode))&&(!ed._video_shown))
{divlowres=img.alt;var objMove=document.getElementById(img.alt);objMove.style.display='inline';objMove.style.backgroundImage="none";var linksDivName=img.alt+'Links';var actualLinksDiv=window.ed.get(linksDivName);if(setBg)
{if(actualLinksDiv!=null)
{actualLinksDiv.style.backgroundImage="url('"+imgsrc+"')";}}
ed.loaderSetAlphaObject("100",document.getElementById(divlowres),300);ed._actionversion=ed._actionversion+1;window.ed._currentPageLinksShown=true;var secondLowRes=img.alt+'Inner';if(!ed.previewNotSet)
{ed.previewNotSet=true;ed.runPreviewApplication();}
if(ed.get(secondLowRes)!=null)
{if((ed.get(secondLowRes).style['opacity']=='0')||(ed.get(secondLowRes).style['opacity']=='0.0001'))
{ed.get(secondLowRes).style['opacity']='1';}}
try
{ed.drawLinks(pageId);}catch(e){};if(ed._doHideLoader)
{window.setTimeout("window.ed.enableCommandsAndHideLoader(window.ed.loader3);",200);ed._doHideLoader=false;}}},showDivEvenIfNoLinks:function(thisobj,pageId){if((!window.ed._currentPageLinksShown)&&(!ed._video_shown))
{if(pageId==window.ide.currentPage)
{divlowres=thisobj;ed.loaderSetAlphaObject("100",document.getElementById(divlowres),300);window.ed._currentPageLinksShown=true;ed.preventBecauseLinks=false;var secondLowRes=thisobj+'Inner';if(ed.get(secondLowRes)!=null)
{if(ed.get(secondLowRes).style['opacity']=='0')
{ed.get(secondLowRes).style['opacity']='1';}}
try
{ed.drawLinks(window.ide.currentPage);}catch(e){};if(ed._doHideLoader)
{window.setTimeout("window.ed.enableCommandsAndHideLoader(window.ed.loader3);",200);ed._doHideLoader=false;}}}},drawStuffWhenPageOpens:function(){ed.setSubpages(false);},showLinks:function(disLoading){if(window.ed._is_loading_fadein_subpage)
{return false;}
if(window.ide.contain_textblock){window.ed.clearAllTextblockTimeouts();}
var previousDrawnLinks=ed._previous_page_id_drawn_links;ed._previous_page_id_drawn_links=window.ide.currentPage;if((previousDrawnLinks==window.ide.currentPage)&&(window.ed._currentPageLinksShown)&&(!ed.pageWasJustChanged))
{return false;}
ed.pageWasJustChanged=false;if((ed.currentlyloadingImages)&&(!disLoading))
{return false;}
ed._doHideLoader=disLoading;var d_page=window.ide.currentPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{d_page=currobj.arrindex;}
ed.addtodownloadlistImages='';window.ed.removeAllSearchResults();ed.videoisinfullscreen=false;for(var d=window.ide.drawPagesFrom;d<=window.ide.drawPagesTo;d++)
{var tmpobj=window.f.findObjFromWindowPgsByPagenumber(d);var takeDiv=tmpobj.divid;var elemDiv=ed.get(takeDiv)
var LoadPageHTMLDiv_PAGEID=tmpobj.divid;if(elemDiv!=null)
{if((window.ide.currentPage==tmpobj.pagenumber)||((tmpobj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode)))
{window.ed._currentPageLinksShown=false;tmpobj.ranpageanim=false;if(elemDiv.style.visibility!='visible')
{elemDiv.style.opacity=0;elemDiv.style.visibility='visible';if(elemDiv.style.display!='inline')
{elemDiv.style.display='inline';}
ed.initiateAlpha(elemDiv);ed.preventBecauseLinks=true;var source=tmpobj.linkimage;ed.drawStuffWhenPageOpens();if(tmpobj.linksAreTransparent)
{tmpobj.uselinks=false;}
if(tmpobj.linksOnPage<1)
{tmpobj.uselinks=false;}
if(tmpobj.uselinks)
{window.ed.get(LoadPageHTMLDiv_PAGEID+'Links').style.width="100%";}
if(tmpobj.uselinks)
{eval('var linksImg'+d_page.toString()+' = new Image();');eval('linksImg'+d_page.toString()+'.onload = function(){window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(this,"","'+source+'","'+tmpobj.pagenumber+'",true);}');eval('linksImg'+d_page.toString()+'.onerror = function(){window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(this,"","'+source+'","'+tmpobj.pagenumber+'",true);}');eval('linksImg'+d_page.toString()+'.alt = "'+LoadPageHTMLDiv_PAGEID+'";');eval("linksImg"+d_page.toString()+".src = '"+source+"';");}
else
{eval('var linksImg'+d_page.toString()+' = new Image();');eval('linksImg'+d_page.toString()+'.alt = "'+LoadPageHTMLDiv_PAGEID+'";');window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(eval('linksImg'+d_page.toString()),"",source,tmpobj.pagenumber,false);}
ed.loadImagesForPage(tmpobj.pagenumber);if(window.ide.contain_textblock){ed.checktextblockesForPage(tmpobj.pagenumber);}
if(window.ide.contain_gallery){ed.checkGalleriesForPage(tmpobj.pagenumber);}
ed.checkPageSearchResults(tmpobj.pagenumber);if(window.ide.contain_sound){window.snd.checkForSoundsForPage(tmpobj.pagenumber);}
window.setTimeout('window.ed.showDivEvenIfNoLinks("'+LoadPageHTMLDiv_PAGEID+'",'+tmpobj.pagenumber+');',3500);try
{if(window.eddata.appearance.edition_style=='facingpages')
{if(ide.isPagenumberRightPage(tmpobj.pagenumber))
{if(tmpobj.pagenumber>1)
{$('#'+elemDiv.id).css({'visibility':'visible',opacity:1});}}}}catch(e){}
if((ed.currentlyloadingImages)&&(disLoading))
{window.setTimeout('if((window.ed.currentlyloadingImages)&&(window.ed.commandsEnabled == false)&&(window.ed._actionversion=='+ed._actionversion+')){window.ed.enableCommandsAndHideLoader(window.ed.loader4);};',5000);}}
else
{ed.loadImagesForPage(tmpobj.pagenumber);}}
else
{if(elemDiv.style.visibility!='hidden')
{ed.initiateAlpha(elemDiv);elemDiv.style.opacity=0;elemDiv.style.backgroundImage='none';elemDiv.style.background='none';elemDiv.style.visibility='hidden';try
{}catch(e){}
try
{var actualLinkImageDivNm=elemDiv.id+'Links';if(window.ed.get(actualLinkImageDivNm)!=null)
{window.ed.get(actualLinkImageDivNm).style.backgroundImage='none';window.ed.get(actualLinkImageDivNm).style.background='none';}}catch(e){}}}}}},hideSiblingPages:function(){for(var d=window.ide.drawPagesFrom;d<=window.ide.drawPagesTo;d++){var tmpobj=window.f.findObjFromWindowPgsByPagenumber(d);var takeDiv=tmpobj.divid;var elemDiv=ed.get(takeDiv)
if(elemDiv!=null){if(elemDiv.style.visibility!='hidden'&&ed._hideSiblingPagesPreviousPageIndex!=window.ide.currentPage){ed.initiateAlpha(elemDiv);elemDiv.style.opacity=0;elemDiv.style.backgroundImage='none';elemDiv.style.background='none';elemDiv.style.visibility='hidden';}}}
ed._hideSiblingPagesPreviousPageIndex=window.ide.currentPage;},setImageBg:function(imgelem,objId,functToRun,dontsetgpuacc){try
{if(typeof(dontsetgpuacc)=='undefined')
{var dontsetgpuacc=false;}
var obj=ed.get(objId);if(obj!=null)
{obj.style.backgroundImage='url("'+imgelem.src+'")';varstr=obj.className;if(!dontsetgpuacc)
{varstr=varstr.replace('gpuAcc','');varstr=varstr.replace('imageRendering','');varstr=varstr+'gpuAcc imageRendering ';}
else
{varstr=varstr.replace('imageRendering','');varstr=varstr+' imageRendering ';}
var find='  ';var quotes=new RegExp(find,'g');varstr=varstr.replace(quotes,' ');obj.className=varstr;}
else
{ed.trace('Error while loading BG image to object "'+objId+'" -> Object does not exit');}
if(functToRun!='')
{eval(functToRun);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2704; column: 126;  :: '+v);ed.trace('Error while loading BG image to object "'+objId+'" -> '+e.message);}},setSubpages:function(finishinit){if(finishinit)
{ed.initeDitionSwipe();ed.runeDitionSwipeOnReady();}},showHideSocialBookmarks:function(doHideIt){if(typeof(doHideIt)=='undefined')
{doHideIt=false;}
if(doHideIt)
{if(ed.socialBookmarksVisible)
{ed.socialBookmarksVisible=false;if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'0px'},300,window.ed.jqueryTransition,function(){});};}}
else
{if(ed.socialBookmarksVisible)
{ed.socialBookmarksVisible=false;if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'0px'},350,window.ed.jqueryTransition,function(){});};}
else
{if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'502px'},300,window.ed.jqueryTransition,function(){});};ed.socialBookmarksVisible=true;}}}};window.eDitionSwipeObj=ed;window.ed=ed;})();
;
(function(){var f={debug:false,last_page_added_to_stats:-1,trace:function(value){if(f.debug)
{console.log(value);}},traceRegardless:function(value){console.log(value);},get:function(elemName){return document.getElementById(elemName);},trim:function(inputStr){try
{inputStr=inputStr.trim();}catch(e){inputStr=$.trim(inputStr);}
return inputStr;},hexToRgb:function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null;},resetDestkop:function(){window.ed.istouchdevice=window.initer.isTouchDevice;window.ed._isDesktopBrowser=window.initer.isNonTouchDesktop;},fixTouchEvents:function(){window.f.resetDestkop();if('ontouchstart'in window)
{window.ed._touch_start_event_nm='touchstart';window.ed._touch_move_event_nm='touchmove';window.ed._touch_end_event_nm='touchend';}
try
{if((window.navigator.pointerEnabled)&&(navigator.userAgent.toLowerCase().indexOf("touch")>0)){window.ed.isIeTouch=true;window.ed._touch_start_event_nm='pointerdown';window.ed._touch_move_event_nm='pointermove';window.ed._touch_end_event_nm='pointerup';window.ed._touch_out_event_nm='pointerout';}else if((window.navigator.msPointerEnabled)&&(navigator.userAgent.toLowerCase().indexOf("touch")>0))
{window.ed.isIeTouch=true;window.ed._touch_start_event_nm='MSPointerDown';window.ed._touch_move_event_nm='MSPointerMove';window.ed._touch_end_event_nm='MSPointerUp';window.ed._touch_out_event_nm='MSPointerOut';}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2723; column: 346;  :: '+v);}
if(window.ed._touch_start_event_nm=='touchstart')
{var isTouchScreen=('createTouch'in document)||$('html').hasClass('touch');if(isTouchScreen)
{window.ed._isDesktopBrowser=false;}}
if(window.ed._isDesktopBrowser)
{window.ed._touch_start_event_nm='mousedown';window.ed._touch_move_event_nm='mousemove';window.ed._touch_end_event_nm='mouseup';window.ed._touch_out_event_nm='mouseleave';}},AtachEvent:function(object,Event,funct){try
{if(object!='window'&&$('#'+object).length==0){console.log('Could not attach event to object. Object, event, funct',[object,Event,funct]);return;}
if(document.addEventListener)
{function getFunctionFromString(string)
{var scope=window;var scopeSplit=string.split('.');for(i=0;i<scopeSplit.length-1;i++)
{scope=scope[scopeSplit[i]];if(scope==undefined)return;}
return scope[scopeSplit[scopeSplit.length-1]];}
if(object!='window'){object='#'+object;}
var events=$._data($(object).get(0),'events');var already_bound=false;if(funct.indexOf('window.')==0){funct=funct.slice(7);}
funct=getFunctionFromString(funct);if(events&&events[Event]){$.each(events[Event],function(){if(this==funct){already_bound=true;return false;}});}
if(!already_bound){$(object).get(0).addEventListener(Event,funct,false);}}
else
{if(object!='window')
{funct=funct+'(event)';}
eval('$('+object+').bind("'+Event+'", function() {'+funct+'});');}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2742; column: 201;  :: '+v);console.log('Error adding events->'+e.message+' || -> EVENTS OBJS FUNCT ->'+object+' ::: '+Event+' :::: '+funct);}},getCurrentPageScale:function(pageNumber,natancno){var currentZoom=0;try
{if((typeof(pageNumber)=='undefined')||(!pageNumber))
{var currobj=f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);}
else
{var currobj=f.findObjFromWindowPgsByPagenumber(pageNumber);}
currentZoom=currobj.currentZoom;if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{currentZoom=currobj.iscroll[0].scale;currobj.currentZoom=currentZoom;}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2749; column: 207;  :: '+v);}
if(natancno){return currentZoom;}else{return currentZoom.toFixed(3);}},findObjFromWindowPgsByPagenumber:function(pagenum){var found=false;var resvar=null;try
{if(pagenum>-1)
{try
{resvar=window.eddata.pages[pagenum-1];if(resvar!=null)
{if(resvar.pagenumber==pagenum)
{found=true;}}}catch(e){}
if(!found)
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.pagenumber==pagenum)
{resvar=currobj;found=true;break;}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2759; column: 172;  :: '+v);}
return resvar;},findObjFromWindowPgsByObjectId:function(objid){var found=false;var resvar=null;try
{if(objid>-1)
{try
{resvar=window.eddata.pages[objid-1];if(resvar!=null)
{if(resvar.id==objid)
{found=true;}}}catch(e){}
if(!found)
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.id==objid)
{resvar=currobj;found=true;break;}}}}}catch(e){}
return resvar;},findPreviousObjFromWindowPgsByElementObject:function(element,usesubpages,dontusefadeinsubpage){if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=false;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=true;}
var resvar=null;var previousObj=null;try
{if(element!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.divid==element.id)
{found=true;located=true;resvar=previousObj;break;}
if((window.ide.orientIsBookMode)&&(currobj.rightPage>-1))
{if((currobj.ismainpage)&&(currobj.leftPage==currobj.pagenumber))
{if((!found)&&(!located))
{previousObj=currobj;}}}
else
{if(usesubpages)
{if(!dontusefadeinsubpage)
{if((currobj.isswipesubpage)||(currobj.isfadeinsubpage)||(currobj.ismainpage))
{if((!found)&&(!located))
{previousObj=currobj;}}}
else
{if((currobj.isswipesubpage)||(currobj.ismainpage))
{if((!found)&&(!located))
{previousObj=currobj;}}}}
else
{if(currobj.ismainpage)
{if((!found)&&(!located))
{previousObj=currobj;}}}}}}}catch(e){}
return resvar;},findNextObjFromWindowPgsByElementObject:function(element,usesubpages,dontusefadeinsubpage){if(typeof(element)=='number')
{}
if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=false;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=false;}
var resvar=null;if(element!=null)
{var curr_obj=f.findObjFromWindowPgs(element);if(curr_obj!=null)
{resvar=window.f.findNextObjFromWindowPgsByPageNumber(curr_obj.pagenumber,usesubpages,dontusefadeinsubpage);}}
return resvar;},findLastMainPageFromWindowPgsByElementObject:function(element){if(typeof(element)=='number')
{}
if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=false;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=false;}
var resvar=null;if(element!=null)
{var curr_obj=f.findObjFromWindowPgs(element);if(curr_obj!=null)
{var pagenumber=curr_obj.pagenumber;try
{if(pagenumber!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(found)
{if(currobj.ismainpage)
{if((found)&&(!located))
{resvar=currobj;}}}
if(currobj.pagenumber==pagenumber)
{if((window.ide.orientIsBookMode)&&(currobj.rightPage>-1))
{pagenumber=currobj.rightPage;if(currobj.pagenumber==pagenumber)
{found=true;}}
else
{found=true;}}}}}catch(e){}}}
return resvar;},findLastSubpageFromWindowPgsByElementObject:function(element,usesubpages,dontusefadeinsubpage){if(typeof(element)=='number')
{}
if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=false;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=false;}
var resvar=null;if(element!=null)
{var curr_obj=f.findObjFromWindowPgs(element);if(curr_obj!=null)
{var pagenumber=curr_obj.pagenumber;try
{if(pagenumber!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if((usesubpages)&&(found))
{if(currobj.isswipesubpage)
{if((found)&&(!located))
{resvar=currobj;}}
else
{located=true;return resvar;break;}}
if(currobj.pagenumber==pagenumber)
{if((window.ide.orientIsBookMode)&&(currobj.rightPage>-1))
{pagenumber=currobj.rightPage;if(currobj.pagenumber==pagenumber)
{found=true;}}
else
{found=true;}}}}}catch(e){}}}
return resvar;},findPreviousObjFromWindowPgsByPageNumber:function(pagenumber,usesubpages,dontusefadeinsubpage){if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=true;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=true;}
var resvar=null;var previousObj=null;try
{if(pagenumber!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.pagenumber==pagenumber)
{found=true;located=true;if((usesubpages)&&(currobj.isfadeinsubpage)){for(var d2=d;d2>=0;d2--){var cd2pg=window.eddata.pages[d2];if(!cd2pg.isfadeinsubpage){for(var d3=d2-1;d3>=0;d3--){var cd3pg=window.eddata.pages[d3];if(!cd3pg.isfadeinsubpage){previousObj=cd3pg;break;}}
break;}}}
resvar=previousObj;break;}
if((window.ide.orientIsBookMode)&&(currobj.rightPage>-1))
{if((currobj.ismainpage)&&(currobj.leftPage==currobj.pagenumber))
{if((!found)&&(!located))
{previousObj=currobj;}}}
else
{if(usesubpages)
{if(!dontusefadeinsubpage)
{if((currobj.isswipesubpage)||(currobj.isfadeinsubpage)||(currobj.isparalaxsubpage)||(currobj.ismainpage))
{if((!found)&&(!located))
{previousObj=currobj;}}}
else
{if((currobj.isswipesubpage)||(currobj.isparalaxsubpage)||(currobj.ismainpage))
{if((!found)&&(!located))
{previousObj=currobj;}}}}
else
{if(currobj.ismainpage)
{if((!found)&&(!located))
{previousObj=currobj;}}}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2878; column: 162;  :: '+v);}
return resvar;},findNextObjFromWindowPgsByPageNumber:function(pagenumber,usesubpages,dontusefadeinsubpage){if(typeof(dontusefadeinsubpage)=='undefined')
{var dontusefadeinsubpage=false;}
if(typeof(usesubpages)=='undefined')
{var usesubpages=true;}
var resvar=null;try
{if(pagenumber!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(usesubpages)
{if(!dontusefadeinsubpage)
{if((currobj.isswipesubpage)||(currobj.isparalaxsubpage)||(currobj.ismainpage)||(currobj.isfadeinsubpage))
{if((found)&&(!located))
{located=true;resvar=currobj;break;}}}
else
{if((currobj.isswipesubpage)||(currobj.isparalaxsubpage)||(currobj.ismainpage))
{if((found)&&(!located))
{located=true;resvar=currobj;break;}}}}
else
{if(currobj.ismainpage)
{if((found)&&(!located))
{located=true;resvar=currobj;break;}}}
if(currobj.pagenumber==pagenumber)
{if((window.ide.orientIsBookMode)&&(currobj.rightPage>-1))
{pagenumber=currobj.rightPage;if(currobj.pagenumber==pagenumber)
{found=true;}}
else
{found=true;}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2904; column: 151;  :: '+v);}
return resvar;},getObjectByParentDivId:function(element,usesubpages){if(typeof(usesubpages)=='undefined')
{var usesubpages=true;}
var resvar=null;try
{if(element!=null)
{var found=false;var located=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(usesubpages)
{if((currobj.isswipesubpage)||(currobj.ismainpage))
{if((found)&&(!located))
{located=true;resvar=currobj;}}}
else
{if(currobj.ismainpage)
{if((found)&&(!located))
{located=true;resvar=currobj;}}}
if(currobj.holderdivid==element)
{found=true;}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2919; column: 150;  :: '+v);}
return resvar;},findLastPageObj:function(forSwiping,forMainOnly){if(typeof(forSwiping)=='undefined')
{var forSwiping=false;}
if(typeof(forMainOnly)=='undefined')
{var forMainOnly=false;}
var resvar=null;var found=false;try
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(forSwiping)
{if(currobj.islastswipepage)
{resvar=currobj;found=true;}}
else
{if((currobj.islastpage)||(currobj.islastMainPageButNotSwipePage&&forMainOnly))
{resvar=currobj;found=true;}}}
if(!found)
{resvar=currobj;}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 2933; column: 152;  :: '+v);}
return resvar;},goToPageWithAnimation:function(page_number){var page_number_original=page_number;var find_obj=f.findObjFromWindowPgsByPagenumber(page_number);if(find_obj.hidden)
{var find_obj=f.findPreviousObjFromWindowPgsByPageNumber(page_number,false,true);if(find_obj==null)
{find_obj=f.findNextObjFromWindowPgsByPageNumber(page_number,false,true);}
if(find_obj!=null)
{page_number=find_obj.pagenumber;if(window.ide.currentPage==page_number_original)
{window.ide.currentPage=page_number;}}
else
{return false;}}
f.setDefaultsPriorToGoingToNextOrPreviousPage();window.ed.showLoader();var click_time=350;var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(page_number);if(tmp_obj!=null)
{if(tmp_obj.isfadeinsubpage)
{click_time=550;}}
if(window.ide.page_transition_type==1)
{click_time=350;}
if((window.ide.orientIsBookMode)&&(find_obj!=null)&&(window.ide.isPagenumberRightPage(page_number)))
{page_number=find_obj.leftPage;}
window.ide.additionalPageToLoad=page_number;window.ide.addStructureAndShowIt(window.ide.currentPage,page_number,true);window.ide.pageWasWhenStartFired=-1;if(window.ide.currentPage!=page_number)
{window.edPageChangeStarted();window.ide.pageWasWhenStartFired=window.ide.currentPage;window.ide.pageChangeEventStartFired=true;}
if(ide.pageflip){var click_time=100;window.setTimeout("window.ide.checkcounterindex++;window.f.setDefaultsOnActualChangePage(); if(window.ide.page_transition_type == 1){window.f.initiateFadePagesIfIsFadeWay();};window.pgfl.goto_page_listanje_zacni(window.ide.currentPage,"+page_number.toString()+");",click_time);}else{window.setTimeout("window.ide.checkcounterindex++;window.ide.previousPage = window.ide.currentPage;window.ide.currentPage = "+page_number.toString()+";window.f.setDefaultsOnActualChangePage();if(window.ide.page_transition_type == 1){window.f.initiateFadePagesIfIsFadeWay();};window.ide.positionPages(window.ide.previousPage,window.ide.currentPage,true);",click_time);}},initiateFadePagesIfIsFadeWay:function(){var is_fadein_transition_currently=false;if(window.ide.page_transition_type==1)
{is_fadein_transition_currently=true;}
if(is_fadein_transition_currently)
{var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(tmp_obj!=null)
{$('#'+tmp_obj.iscrollHolder).stop().css({x:'0px',y:'0px',opacity:0.0001,display:window.ide.displayNoneType});}}},processParalaxY:function(toy,poverlap,type,subpageindex,wholeparalaxscrolly,currobj,animatedPages){var pageheight=window.eddata.head.pageHeight;var resvar=-(pageheight*subpageindex);toy=wholeparalaxscrolly;var diffy=((((window.ed.screenHeight-$('#edition-player').position().top)-(pageheight*window.ed.currentScale))/2));var percentViewed=(pageheight/((toy-diffy)+(pageheight*subpageindex)));var actual_percent=1/percentViewed;actual_percent=actual_percent*-1;var easing_strength=poverlap<5?0:poverlap/100;easing_strength=Math.max(0,Math.min(1,easing_strength));window.ide.manipulateCurrent=true;window.ide.manipulatePrevious=true;window.ide.manipulateNext=true;if(percentViewed<-1)
{}
if(percentViewed>1)
{}
if(type==0)
{var percent_to_paral=window.f.calcParalaxPos(actual_percent,easing_strength,type,currobj,animatedPages);resvar=-(pageheight*percent_to_paral)-(pageheight*subpageindex);}
if(type==1)
{var percent_to_paral=window.f.calcParalaxPos(actual_percent,easing_strength,type,currobj,animatedPages);resvar=-(pageheight*percent_to_paral)-(pageheight*subpageindex);}
if(type==2)
{var percent_to_paral=window.f.calcParalaxPos(actual_percent,easing_strength,type,currobj,animatedPages);resvar=-(pageheight*percent_to_paral)-(pageheight*subpageindex);}
return{y:resvar,p:actual_percent};},calcParalaxPos:function(scrollPercents,easingStrength,type,currobj,animatedPages)
{easingStrength=Math.min(1,Math.max(0,easingStrength||0));if(easingStrength>0.05)
{easingStrength=1/5+4*(easingStrength)/5;}
var x=scrollPercents;var less=(x<0);if(less){x++}
var y=less?1-(--x)*x:Math.pow(x,Math.round(easingStrength*9));return(less?(y-1)*easingStrength:y*easingStrength)+scrollPercents*(1-easingStrength);},setEscapedFragmentsForCurrentPage:function(){var sefMainPageId=-2;var currentSefMainPageId=-3;var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(typeof(window.location.hash)=='undefined')
{window.location.hash=window.location.href.split('#!')[1];}
if(currobjPGS!=null)
{var setSef=currobjPGS.sef;if(currobjPGS.isfadeinsubpage)
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(!currobj.isfadeinsubpage)
{setSef=currobj.sef;sefMainPageId=currobj.mainPageId;}
if(currobj.pagenumber==currobjPGS.pagenumber)
{break;}}
if(window.location.hash!='')
{for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];if(curobj.sef!='')
{if((curobj.sef==window.location.hash.replace('#!','').replace('#',''))||(curobj.additional_sef.indexOf(window.location.hash.replace('#!','').replace('#',''))>-1))
{currentSefMainPageId=curobj.mainPageId;break;}}}}}
if(currentSefMainPageId!=sefMainPageId)
{window.location.hash='#!'+setSef;try
{document.title=currobjPGS.tabtitle;}catch(e){}}}},getStartingEscapedFragmentsPageNumber:function(){var returnPG=1;if(window.eddata.head.rtl){for(var d in window.eddata.pages){var curobj=window.eddata.pages[d];returnPG=curobj.pagenumber;}}
if(typeof(window.location.hash)=='undefined')
{window.location.hash=window.location.href.split('#!')[1];}
if(typeof(e)!='undefined')
{if(e!=null)
{try
{e.preventDefault();e.returnvalue=false;}catch(e){}}}
var sefseek=window.location.hash.replace('#!','');var gotofadeinSubpage=-1;if(window.location.hash!='')
{for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];{if((curobj.sef==sefseek)||(curobj.additional_sef.indexOf(sefseek)>-1))
{returnPG=curobj.pagenumber;if(curobj.isparalaxsubpage)
{returnPG=curobj.mainPageId;}
if(curobj.isfadeinsubpage)
{gotofadeinSubpage=curobj.pagenumber;}}}}}else{if(isApp()){var last_visited_page_ed="last_visited_page_desktop_ed"+window.ide.editionId;try
{var lvp=localStorage.getItem(last_visited_page_ed);if(lvp=='undefined'){lvp='';}
if(lvp){for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];if(curobj.id==lvp)
{returnPG=curobj.pagenumber;if(curobj.isparalaxsubpage)
{returnPG=curobj.mainPageId;}
if(curobj.isfadeinsubpage)
{gotofadeinSubpage=curobj.pagenumber;}}}}}catch(e){}}}
if(gotofadeinSubpage>-1)
{window.setTimeout('window.f.goToPageWithAnimation('+gotofadeinSubpage.toString()+');',200);}
return returnPG;},checkEscapedFragments:function(e){if(typeof(window.location.hash)=='undefined')
{window.location.hash=window.location.href.split('#!')[1];}
if(typeof(e)!='undefined')
{if(e!=null)
{try
{e.preventDefault();e.returnvalue=false;}catch(e){}}}
var sefseek=window.location.hash.replace('#!','');if(window.location.hash!='')
{for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];if((curobj.sef==sefseek)||(curobj.additional_sef.indexOf(sefseek)>-1))
{if(curobj.pagenumber!=window.ide.currentPage)
{try
{if(window.f.allowPageChanging(curobj))
{window.ed.goToPage(curobj.id);}}catch(e){}}
return false;}}}},allowPageChanging:function(currobj){var resvar=true;try
{if(currobj.isparalaxsubpage)
{resvar=false;}}catch(e){resvar=true;}
return resvar;},allowPageBgClearing:function(topageobj){var resvar=true;if((topageobj.ismainparalaxpage)||(topageobj.isparalaxsubpage))
{var mainpageobj=topageobj;if(topageobj.isparalaxsubpage)
{mainpageobj=window.f.findObjFromWindowPgsByPagenumber(topageobj.mainPageId);}
if((mainpageobj.paralaxallages.indexOf(','+window.ide.currentPage+',')>-1)||(window.ide.currentPage==mainpageobj.pagenumber))
{resvar=false;}}
return resvar;},checkIfShouldPreloadCanvases:function(){var curpgsobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if((curpgsobj.ismainparalaxpage)||(curpgsobj.isparalaxsubpage))
{var tmpobj=window.f.findNextObjFromWindowPgsByPageNumber(curpgsobj.pagenumber,true,true);if(tmpobj!=null)
{if(tmpobj.isparalaxsubpage)
{ide.preloadMainCanvases(tmpobj);}}}},oncustompagechange:function(){ide.checkLoadedMaterialsForPage(window.ide.currentPage,true);window.ide.onAfterPageTransition(true);f.checkIfShouldPreloadCanvases();},setDefaultsOnActualChangePage:function(){f.setEscapedFragmentsForCurrentPage();if(window.ide.contain_paralax_pages){window.ide.positionParalaxPagesEnd(true);}
if(window.f.last_page_added_to_stats!=window.ide.currentPage)
{var page_id=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id;window.f.last_page_added_to_stats=page_id;window.ed.addToGoToPageStats(page_id);if(isApp()){var last_visited_page_ed="last_visited_page_desktop_ed"+window.ide.editionId;try
{localStorage.setItem(last_visited_page_ed,page_id+"");}catch(e){}}}},setDefaultsPriorToGoingToNextOrPreviousPage:function(){window.ide.eventDragStartcalled=false;window.ed.loadingLayer=false;window.ed.this_is_new_double_click=0;window.ed.last_click_time=new Date();window.ed.lastCheckedPressedX=-1;window.ed.lastCheckedPressedY=-1;window.ide.additionalPageToLoad=-1;window.ed.currentlyLoadingUHDImages=false;},nextPage:function(useSubpages){if(typeof(useSubpages)=='undefined')
{var useSubpages=false;}
var tmpPage=window.ide.currentPage;var tmpPageObj=f.findNextObjFromWindowPgsByPageNumber(window.ide.currentPage,useSubpages,true);if(tmpPageObj!=null)
{tmpPage=tmpPageObj.pagenumber;}
else
{if(tmpPage>=window.ide.editionAllPagesCount)
{tmpPage=window.ide.editionAllPagesCount;}}
window.ide.previousPage=window.ide.currentPage;window.ide.currentPage=tmpPage;window.f.setDefaultsOnActualChangePage();window.ide.pageWasWhenStartFired=-1;if((window.ide.currentPage==window.ide.previousPage))
{if(window.ide.eventDragStartcalled)
{window.setTimeout("if(window.ide.validationnum == "+window.ide.validationnum.toString()+"){window.edPageDragReturned();}",300);window.ide.eventDragStartcalled=false;}}
else
{if(window.ide.eventDragStartcalled){window.edPageChangeStarted();window.ide.pageWasWhenStartFired=window.ide.previousPage;window.ide.pageChangeEventStartFired=true;}}
f.setDefaultsPriorToGoingToNextOrPreviousPage();if(ide.pageflip){window.ide.addStructureAndShowIt(window.ide.currentPage,-1,true);window.ide.addStructureAndShowIt(window.ide.currentPage+1,-1,true);window.ide.onAfterPageTransition();window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded(window.ide.previousPage,window.ide.currentPage,false,true);}else{window.ide.positionPages(window.ide.previousPage,window.ide.currentPage,true);}},previousPage:function(useSubpages){if(typeof(useSubpages)=='undefined')
{var useSubpages=false;}
var tmpPage=window.ide.currentPage;var reference_page=tmpPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(reference_page);if((!useSubpages)&&((currobj.isswipesubpage)||(currobj.isfadeinsubpage)||(currobj.isparalaxsubpage)))
{reference_page=currobj.mainPageId;}
var tmpPageObj=f.findPreviousObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);if(tmpPageObj!=null)
{tmpPage=tmpPageObj.pagenumber;}
else
{if(tmpPage<1)
{tmpPage=1;}}
if(window.ide.currentPage!=tmpPage)
{window.ide.previousPage=window.ide.currentPage;window.ide.currentPage=tmpPage;window.f.setDefaultsOnActualChangePage();}
window.ide.pageWasWhenStartFired=-1;if(window.ide.eventDragStartcalled){window.edPageChangeStarted();window.ide.pageWasWhenStartFired=window.ide.previousPage;window.ide.pageChangeEventStartFired=true;}
f.setDefaultsPriorToGoingToNextOrPreviousPage();if(ide.pageflip){window.ide.addStructureAndShowIt(window.ide.currentPage,-1,true);window.ide.addStructureAndShowIt(window.ide.currentPage+1,-1,true);window.ide.onAfterPageTransition();window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded(window.ide.previousPage,window.ide.currentPage,false,true);}else{window.ide.positionPages(window.ide.previousPage,window.ide.currentPage,true);}},shareSocialBookmark:function(scid)
{var url=url_of_current_sef;var title=title_of_current_sef;title=title.replace(' ','+');title=title.replace('%20','+');try
{var currentPage=window.ide.currentPage;}catch(e){var currentPage=1;}
var asterix='%3F';var SHARE_URL=url.replace('%2Flite','')+asterix+"page="+currentPage.toString();var SHARE_TITLE=title;window.ed.showHideSocialBookmarks(true);if(scid==1)
{window.open("https://www.facebook.com/sharer/sharer.php?u="+SHARE_URL+"&t="+SHARE_TITLE,"SocialBookmarks");}
if(scid==2)
{window.open("https://twitter.com/home?status="+SHARE_TITLE+"-"+SHARE_URL,"SocialBookmarks");}
if(scid==3)
{window.open("https://digg.com/submit?url="+SHARE_URL+"&title="+SHARE_TITLE+"&bodytext=&media=&topic=","SocialBookmarks");}
if(scid==4)
{window.open("https://delicious.com/login?lo_action=save&next=http%3A%2F%2Fdelicious.com%2Fpost%3Furl%3D"+SHARE_URL+"%3Flog%3Dout%26url%3D"+SHARE_URL,"SocialBookmarks");}
if(scid==5)
{window.open("https://m.google.com/app/plus/x/?v=compose&content="+SHARE_URL+"","SocialBookmarks");}
if(scid==6)
{try
{SHARE_TITLE=SHARE_TITLE.replace(/\+/g," ");window.location="mailto:enter_your_friends_address_here?subject=Your friend invited you to view the publication "+SHARE_TITLE+"&body=Hi%0D%0A%0D%0AOne of your friends liked the publication \""+SHARE_TITLE+"\" and invited you to view it. %0D%0A%0D%0A You can do so by visiting this url:%0D%0A"+SHARE_URL;}catch(e){}}
if(scid==7)
{window.open("https://tumblr.com/share?s=&v=3&t="+SHARE_TITLE+"&u="+SHARE_URL+"","SocialBookmarks");}
if(scid==8)
{window.open("https://www.stumbleupon.com/submit?url="+SHARE_URL+"&title="+SHARE_TITLE+"","SocialBookmarks");}
if(scid==9)
{window.open("https://technorati.com/faves?sub=addfavbtn&add="+SHARE_URL,"SocialBookmarks");}
if(scid==10)
{window.open("https://www.reddit.com/submit?url="+SHARE_URL+"&title="+SHARE_TITLE,"SocialBookmarks");}},findObjFromWindowPgsByArrIndex:function(arrindex){var resvar=null;try
{if(arrindex>-1)
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.arrindex==arrindex)
{resvar=currobj;}}}}catch(e){}
return resvar;},findObjByInteractiveId:function(interactiveid){var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var resvar=null;var found=false;for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];if(currobj.id==interactiveid)
{resvar=currobj;found=true;break;}}
if((!found)&&(window.ide.orientIsBookMode))
{var currobjPGS_right=window.f.findObjFromWindowPgsByPagenumber(currobjPGS.rightPage);if(currobjPGS_right){for(var d in currobjPGS_right.interactive)
{var currobj=currobjPGS_right.interactive[d];if(currobj.id==interactiveid)
{resvar=currobj;found=true;break;}}}}
return resvar;},findArrGalleryObjectByGalleryId:function(_gallery_id){var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var resvar=null;var found=false;for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];if(currobj.id==_gallery_id)
{resvar=currobj;found=true;break;}}
if((!found)&&(window.ide.orientIsBookMode))
{var currobjPGS_right=window.f.findObjFromWindowPgsByPagenumber(currobjPGS.rightPage);if(currobjPGS_right){for(var d in currobjPGS_right.interactive)
{var currobj=currobjPGS_right.interactive[d];if(currobj.id==_gallery_id)
{resvar=currobj;found=true;break;}}}}
return resvar;},findObjFromWindowPgsByLowresName:function(lowresName){var resvar=null;try
{if(lowresName!='')
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.lowresdiv==lowresName)
{resvar=currobj;}}}}catch(e){}
return resvar;},findObjFromWindowPgs:function(element){var resvar=null;try
{if(element!=null)
{for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.divid==element.id)
{resvar=currobj;}}}}catch(e){}
return resvar;}};window.f=f;})();
;
(function(){var ide={debug:false,debugTemplate:false,isBetaScript:false,itypelink:'link',itypeimage:'image',itypevideo:'video',itypegallery:'gallery',itypetextblock:'textblock',itypeaudio:'audio',itypesurvey:'survey',itypesoundcloud:'soundcloud',itypeiframe:'iframe',itypecode:'code',isparalaxbufferactivated:false,paralaxBufferActivePageScrollStart:3,paralaxBufferActivePageScroll:0,paralaxScrollY:0,paralaxCurrentOverlap:0,paralaxVelocity:100,paralaxVelocityTouch:30,paralaxDifferenceFromLastFireY:0,contain_paralax_pages:0,contain_textblock:0,contain_gallery:0,contain_sound:0,lastcorrectparalaxY:0,isHDEnabled:false,offerUHDonMaxZoom:true,page_transition_type:0,html_param_img_rotate_to_landscape:'',html_param_img_rotate_to_portrait:'',isIE58:false,playerPlacementOffset:null,landscapeOrient:0,portraitOrient:1,screenWidth:0,pageWasWhenStartFired:-1,screenHeight:0,editionSinglePageWidth:0,pageChangeEventStartFired:false,intro_was_already_disregarded:false,originalSinglePageWidth:0,editionSinglePageHeight:0,editionOriginalSinglePageWidth:0,editionOriginalSinglePageHeight:0,force_refresh_and_default_madement_of_iscrolls:false,mainStageElement:'slideContainer',mainStageElementParent:'edition-player',mainStageElementIscroll:null,addToScreenScaleZoom:1,checkcounterindex:0,displayNoneType:'none',orientationModePortrait:1,validationnum:0,orientIsBookMode:false,orientationModeLandscape:1,HTML_lockorientation:-1,showDisplayType:'block',rootOfHTMLV:'',xmlVersion:0,editionId:0,resizeZoomRatioOfPictures:1,editionName:'',editionProjectName:'',orientation:0,currentLocation:'',localStorageItemName:'',editionTitle:'',scaleOfFullZoom:1,scaleOfFullZoomHD:1,editionAllPagesCount:0,pagesMaxElements:8,pagesMaxElementsMaterialsLoaded:1,currentPage:1,currentPageRight:-1,previousPage:-1,currentPageObjPgs:null,defaultZoomRatio:1,pageOffsetY:0,pageOffsetX:0,bestViewZoomFactor:1,maxScaleFactor:1,defaultInitialScale:1,loadPagesArray:'',HTML_lock_images_instead_of_divs_lowres:0,firstPageBookMode:0,eventDragStartcalled:false,splitSequenceStart:'$prgedtnstartscript$',splitSequenceEnd:'$prgedtnendscript$',splitSequencePage:'$prgedtn$',splitSequenceDivs:'$prgedtnstartpagedivs$',additionalPageToLoad:-1,drawPagesFrom:0,drawPagesTo:0,useHDCanvas:-1,defaultPublicationScale:0,pageflip:0,tempHTMLContain:'',trace:function(value){if(ide.debug)
{console.log(value);}},traceRegardless:function(value){console.log(value);},get:function(elemName){return document.getElementById(elemName);},setCurrentRightPage:function(){},preloadCustomHTML:function(url,callback,calledWhenPageId){try
{var xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()
{if(xmlhttp.readyState==4&&xmlhttp.status==200)
{try
{if((calledWhenPageId==window.ide.currentPage)||(calledWhenPageId==window.ide.currentPage))
{window.ide.tempHTMLContain=xmlhttp.responseText;eval(callback);}}
catch(e){alert('Preload HTML Error (Invalid Script) -> '+e.message+' \n Call->'+callback);}}}
xmlhttp.open("GET",url,true);xmlhttp.send();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3121; column: 179;  :: '+v);console.log('Error while loading custom HTML ->'+e.message);}},playerstart:function(){window.ed.startinPageEventCalled=false;var useHDRequests=-1;var HTML_page_transition_change_type=0;try
{window.ide.addToScreenScaleZoom=ratioToAddToZoom;}catch(e){window.ide.addToScreenScaleZoom=0;}
window.ide.editionId=window.edgl.edition.id;window.ide.editionTitle=window.edgl.edition.title;window.ide.rootOfHTMLV=window.edgl.base_path+window.edgl.player+'/';window.ide.editionAllPagesCount=-1;window.ide.page_transition_type=HTML_page_transition_change_type;window.ide.useHDCanvas=0;var contain_yt=false;for(var ii=0;ii<window.eddata.pages.length;ii++){if(window.eddata.pages[ii].interactive&&window.eddata.pages[ii].interactive.length){for(var jj=0;jj<window.eddata.pages[ii].interactive.length;jj++){if((window.eddata.pages[ii].interactive[jj].itype=='video')&&window.eddata.pages[ii].interactive[jj].youtubeid){contain_yt=true;break;}}}
if(contain_yt){break;}}
if(contain_yt){setTimeout(function(){console.log(' load edition_youtube_api_url int00');window.onYouTubeIframeAPIReady=function(){window.ed.edition_youtube_api_url='';console.log('onYouTubeIframeAPIReady int0');}
var tag=document.createElement('script');tag.src=window.ed.edition_youtube_api_url;var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);window.ed.edition_youtube_api_url='';},3000);}
for(var ii=0;ii<window.eddata.pages.length;ii++){if(window.eddata.pages[ii].interactive&&window.eddata.pages[ii].interactive.length){for(var jj=0;jj<window.eddata.pages[ii].interactive.length;jj++){if(window.eddata.pages[ii].interactive[jj].itype=='textblock'){window.ide.contain_textblock=1;}
if(window.eddata.pages[ii].interactive[jj].itype=='gallery'){window.ide.contain_gallery=1;}
if(window.eddata.pages[ii].interactive[jj].itype=='audio'){window.ide.contain_sound=1;}
if(window.eddata.pages[ii].interactive[jj].itype=='soundcloud'){window.ide.contain_soundcloud=1;}
if(window.eddata.pages[ii].interactive[jj].itype=='video'){window.ide.contain_video=1;}}}}
if(typeof window.eddata.appearance.webcode_font!="undefined"&&window.eddata.appearance.webcode_font=="hByxxXTBA7RUtw1YqfJd"&&typeof webapp!="undefined"){var hdc_eq_all=true;for(var d in window.eddata.pages){var ok_c=false;var currobj=window.eddata.pages[d];if((currobj.canvas)&&(currobj.canvasHD)){if((currobj.canvas+''==currobj.canvasHD+'')&&(currobj.canvas!='')){ok_c=true;}}
if(!ok_c){hdc_eq_all=false;break;}}
if(hdc_eq_all){window.ide.useHDCanvas=window.ide.editionId;}}
window.ide.pageflip=(window.eddata.appearance.page_transition_effect=='flip');if(window.ide.pageflip){window.eddata.ipad={"portrait_nop":2,"portrait_fit":"CENTERED","landscape_nop":2,"landscape_fit":"CENTERED","locked_orientation":""};}
for(var d in window.eddata.pages){var currobj=window.eddata.pages[d];if(currobj.transition&&currobj.transition=='parallax'){window.ide.contain_paralax_pages=1;break;}}
if(window.edgl.argo.indexOf("*addDebugCallTrace*")>-1){addDebugCallTrace();}
if(window.edgl.argo.indexOf("*addInfoImagesToPagesDebug*")>-1){addInfoImagesToPagesDebug();}
if(window.edgl.argo.indexOf('*use_hd*')>-1){window.ide.useHDCanvas=window.ide.editionId;}
window.ide.isHDEnabled=window.ide.useHDCanvas==window.ide.editionId;window.ide.xmlVersion=window.edgl.xmlversion;window.ide.check_if_can_start_to_init();window.ide.checkForGlobalCssTemplatesAndIncludeThem();if(window.edgl.additional_data){var ok=false;if(window.edgl.additional_data.popup_edition){ok=true;}
if(typeof(window.edgl.additional_data)=="string"){if(window.edgl.additional_data.indexOf('popup_edition')>-1){ok=true;}}
if(ok){introPopup.showIfNeeded()}}},checkForGlobalCssTemplatesAndIncludeThem:function(){if(typeof(window.eddata.edition_templates_css)!='undefined')
{if(window.eddata.edition_templates_css!='')
{var head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=window.eddata.edition_templates_css;}else{style.appendChild(document.createTextNode(window.eddata.edition_templates_css));}
head.appendChild(style);}}},initScreenWidthHeightAndOrientation:function(){var bottomcutofflandscape=0;var bottomcutoffportrait=0;var isiphonelandscape=false;if((navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPad/i))){if($('#'+window.ide.mainStageElementParent).width()>$('#'+window.ide.mainStageElementParent).height())
{isiphonelandscape=true;}}
var scrwidth=0;var scrheight=0;var elemWidth=$('#'+window.ide.mainStageElementParent).width();var elemHeight=$('#'+window.ide.mainStageElementParent).height();if(elemWidth<=100)
{scrwidth=($('#'+window.ide.mainStageElementParent).parent().width()/ 100)*elemWidth;}
else
{scrwidth=elemWidth;}
if(elemHeight<=100)
{scrheight=($('#'+window.ide.mainStageElementParent).parent().height()/ 100)*elemHeight;}
else
{scrheight=elemHeight;}
if(isiphonelandscape)
{if((window.innerHeight>100)&&(window.innerHeight<scrheight))
{scrheight=window.innerHeight-40;}}
if((scrwidth==0)||(scrheight==0))
{scrwidth=document.documentElement.clientWidth;scrheight=document.documentElement.clientHeight;}
window.ide.playerPlacementOffset=$('#'+window.ide.mainStageElementParent).offset();window.ide.screenWidth=scrwidth;if(scrwidth>scrheight)
{window.ide.screenHeight=scrheight+bottomcutofflandscape;}
else
{window.ide.screenHeight=scrheight+bottomcutoffportrait;}
if(scrwidth>scrheight)
{}
else
{}
if(scrwidth>scrheight)
{window.ide.orientation=window.ide.landscapeOrient;}
else
{window.ide.orientation=window.ide.portraitOrient;}
ide.orientIsBookMode=false;if(window.ide.orientation==window.ide.landscapeOrient)
{if(ide.orientationModeLandscape==2)
{ide.orientIsBookMode=true;}}
else if(window.ide.orientation==window.ide.portraitOrient)
{if(ide.orientationModePortrait==2)
{ide.orientIsBookMode=true;}}
if(window.edgl.argo.indexOf('*orientIsBookModeFalse*')>-1){ide.orientIsBookMode=false;}
if(window.force_orientIsBookModeFalse){ide.orientIsBookMode=false;}
ide.checkBrowser();},checkBrowser:function(){try
{var version=999;if(navigator.appVersion.indexOf("MSIE")!=-1)
{version=parseFloat(navigator.appVersion.split("MSIE")[1]);}}catch(e){version=999;}
if(parseInt(version)<9)
{window.ide.isIE58=true;}
return version;},initDefaultVariables:function(){var ratioMaxZoom=1;if(window.eddata.head.pageWidth>window.eddata.head.pageHeight)
{ratioMaxZoom=window.eddata.head.pageWidthHD / window.eddata.head.pageWidth;}
else
{ratioMaxZoom=window.eddata.head.pageHeightHD / window.eddata.head.pageHeight;}
window.ide.scaleOfFullZoomHD=ratioMaxZoom;if(window.ide.useHDCanvas==ide.editionId)
{window.ide.scaleOfFullZoom=ratioMaxZoom;}
else
{window.ide.scaleOfFullZoom=1;}
window.ide.editionId=window.edgl.edition.id;window.ide.currentLocation='http://'+window.location.host;window.ide.originalSinglePageWidth=Math.round(window.eddata.head.pageWidth*window.ide.resizeZoomRatioOfPictures);window.ide.editionSinglePageWidth=Math.round(window.eddata.head.pageWidth*window.ide.resizeZoomRatioOfPictures);window.ide.editionSinglePageHeight=Math.round(window.eddata.head.pageHeight*window.ide.resizeZoomRatioOfPictures);window.ide.pageOffsetY=0;window.ide.pageOffsetX=0;window.ide.editionAllPagesCount=window.eddata.head.AllPages;try
{if(typeof(startPage)=='undefined')
{var startPage=window.f.getStartingEscapedFragmentsPageNumber();}
window.ide.currentPage=startPage;if(window.ide.currentPage<1)
{window.ide.currentPage=1;}
if(window.ide.currentPage>=ide.editionAllPagesCount)
{window.ide.currentPage=ide.editionAllPagesCount;}
window.f.setDefaultsOnActualChangePage();}catch(e){window.ide.currentPage=1;}
window.ide.editionOriginalSinglePageWidth=Math.round(window.eddata.head.pageWidth*window.ide.resizeZoomRatioOfPictures);window.ide.editionOriginalSinglePageHeight=Math.round(window.eddata.head.pageHeight*window.ide.resizeZoomRatioOfPictures);},setOrientationModes:function(){var HTML_dat='';var HTML_setOrientation_landscape=2;var HTML_setOrientation_portrait=1;var HTML_align_first_page_to=1;var HTML_lockorientation=-1;var HTML_enable_zoom=true;try
{if(window.eddata.appearance.zoom_enabled.toString()!='1')
{HTML_enable_zoom=false;}}catch(e){}
if(typeof(window.eddata.ipad)!='undefined')
{if(typeof(window.eddata.ipad.landscape_fit)!='undefined')
{HTML_dat=window.eddata.ipad.landscape_fit;if(window.f.trim(HTML_dat)!="")
{if(HTML_dat=="SCREEN"){HTML_setOrientation_landscape=1;}
if(HTML_dat=="BOOK"){HTML_setOrientation_landscape=2;}
if(HTML_dat=="WIDTH"){HTML_setOrientation_landscape=3;HTML_enable_zoom=false;}
if(HTML_dat=="HEIGHT"){HTML_setOrientation_landscape=4;HTML_enable_zoom=false;}}}
if(typeof(window.eddata.ipad.landscape_nop)!='undefined')
{if((HTML_setOrientation_landscape!=2)&&(window.eddata.ipad.landscape_nop==2)){HTML_setOrientation_landscape=2;}else if((window.eddata.ipad.landscape_nop==1)&&(HTML_setOrientation_landscape==2)){HTML_setOrientation_landscape=1;}}
if(typeof(window.eddata.ipad.locked_orientation)!='undefined')
{HTML_dat=window.eddata.ipad.locked_orientation;if(HTML_dat=="LANDSCAPE"){HTML_lockorientation=1;}
if(HTML_dat=="PORTRAIT"){HTML_lockorientation=2;}}
if(typeof(window.eddata.ipad.portrait_fit)!='undefined')
{HTML_dat=window.eddata.ipad.portrait_fit;if(window.f.trim(HTML_dat)!=""){if(HTML_dat=="SCREEN"){HTML_setOrientation_portrait=1;}
if(HTML_dat=="BOOK"){HTML_setOrientation_portrait=2;}
if(HTML_dat=="WIDTH"){HTML_setOrientation_portrait=3;HTML_enable_zoom=false;}
if(HTML_dat=="HEIGHT"){HTML_setOrientation_portrait=4;HTML_enable_zoom=false;}}}
if(typeof(window.eddata.ipad.portrait_nop)!='undefined')
{if((HTML_setOrientation_portrait!=2)&&(window.eddata.ipad.portrait_nop==2)){HTML_setOrientation_portrait=2;}else if((window.eddata.ipad.portrait_nop==1)&&(HTML_setOrientation_portrait==2)){HTML_setOrientation_portrait=1;}}
if(HTML_setOrientation_portrait==2)
{if(typeof(window.eddata.ipad.portrait_alignment)!='undefined')
{HTML_dat=window.eddata.ipad.portrait_alignment;if(HTML_dat=="CENTERED"){HTML_align_first_page_to=0;}}}
else
{if(typeof(window.eddata.ipad.portrait_alignment)!='undefined')
{HTML_dat=window.eddata.ipad.portrait_alignment;if(HTML_dat=="CENTERED"){HTML_align_first_page_to=0;}}}}
window.ide.orientationModePortrait=HTML_setOrientation_portrait;window.ide.orientationModeLandscape=HTML_setOrientation_landscape;window.ide.HTML_lockorientation=HTML_lockorientation;window.ide.firstPageBookMode=HTML_align_first_page_to;window.ide.html_param_img_rotate_to_landscape=window.eddata.path.global_path+'requests/pimage.asp?v=rotate_to_landscape.jpg&d=1&ver=1&vn='+window.ide.editionName.toString()+'&vid='+window.ide.editionId.toString();window.ide.html_param_img_rotate_to_portrait=window.eddata.path.global_path+'requests/pimage.asp?v=rotate_to_portrait.jpg&d=1&ver=1&vn='+window.ide.editionName.toString()+'&vid='+window.ide.editionId.toString();window.ed._enableZoom=HTML_enable_zoom;},addLoaderAndAllMainStageElements:function(){var usshd=false;var hdwdth=0;var hdhght=0;var loaderHTML='';var setLoaderLogo='';if(typeof(window.eddata.appearance.loader_logo_img)!='undefined')
{setLoaderLogo='background-image:url(\''+window.eddata.appearance.loader_logo_img+'\');';}
loaderHTML+='<div id="loadingMenu" class="NoSelect clickthrough gpuAcc edition-spinner-loading" style="position:absolute;left:'+window.ed.iconPercentWidth.toString()+'%;top:'+window.ed.iconPercentWidth.toString()+'%;z-index:999">';loaderHTML+='<span class="edition-spinner-logo NoSelect clickthrough " style="'+setLoaderLogo+'"></span>';loaderHTML+='<span class="spinner1 edition-spinner-circle NoSelect clickthrough "></span>';loaderHTML+='<span class="spinner2 edition-spinner-circle NoSelect clickthrough "></span>';loaderHTML+='<span class="spinner3 edition-spinner-circle NoSelect clickthrough "></span>';loaderHTML+='</div>';loaderHTML+='<div id="aboutBox" style="position:absolute;width:100%;height:100%;z-index:997;display:none;" class="gpuAcc NoSelect">';loaderHTML+='<div id="innerAboutBox" class="gpuAcc" style="position:absolute;border:1px solid #000000;display:inline;top:50%;left:50%;margin-left:-251px;margin-top:-161px;"></div>';loaderHTML+='</div>';loaderHTML+='<div id="video_popup" align="center" style="background-color:#000000;" class="gpuAcc NoSelect"><table id="videotableholder" class="videotablePopup" cellpadding="0" cellspacing="0"><tr valign="middle"><td align="middle"><table name="videopopframeholder" id="videopopframeholder" cellpadding="0" cellspacing="0"><tr><td><div id="videotablePopupCloseRow" onClick="window.ed.hideVideoPopup();">CLOSE&nbsp;&nbsp;</div></td></tr><tr><td><div id="videoContentSRC"></div></td></tr></table></td></tr></table></div>';var projectLogoBImg='';if(typeof(window.eddata.appearance.background_img)!='undefined')
{var bg_scaling='cover';if(window.eddata.appearance.background_img_scalling=='fit')
{bg_scaling='contain';}
else if(window.eddata.appearance.background_img_scalling=='fill')
{bg_scaling='cover';}
else if(window.eddata.appearance.background_img_scalling=='stretch')
{bg_scaling='100% 100%';}
else if(window.eddata.appearance.background_img_scalling=='centered')
{bg_scaling='initial';}
else if(window.eddata.appearance.background_img_scalling=='original')
{bg_scaling='initial';}
if(window.eddata.appearance.background_img!='')
{projectLogoBImg='background-image:url(\''+window.eddata.appearance.background_img+'\');background-position:center;background-size:100% auto;background-size:'+bg_scaling+';background-repeat:no-repeat;overflow:hidden;';}}
loaderHTML+='<div id="mainHolder" class="imageRendering_lowres gpuAcc NoSelect" style="background-color:'+window.eddata.appearance.background_color+';'+projectLogoBImg+'" align="center">';loaderHTML+='<div id="wholeContainerDiv" class="gpuAcc NoSelect" style="position:absolute;display:block;width:100%;height:100%;">';loaderHTML+='<div id="slideContainer" align="left" class="gpuAcc NoSelect slideContainer">';loaderHTML+='</div>';loaderHTML+='</div>';loaderHTML+='</div>';$('#'+ide.mainStageElementParent.toString()).append(loaderHTML);},saveeDitionData:function(){window.ide.editionName='';window.ide.editionProjectName='';window.ide.editionTitle=window.edgl.edition.title;},setCssPrefixesAndBrowserDetect:function(){var cssPrepona='';var cssPreponaCSS='';if(Modernizr.testProp('MozTransform'))
{cssPrepona='Moz';cssPreponaCSS='-moz-';window.ide.HTML_lock_images_instead_of_divs_lowres=1;}
else if(Modernizr.testProp('webkitTransform'))
{cssPrepona='Webkit';cssPreponaCSS='-webkit-';}
else if(Modernizr.testProp('msTransform'))
{cssPrepona='ms';cssPreponaCSS='-ms-';}
else if(Modernizr.testProp('OTransform'))
{cssPrepona='O';cssPreponaCSS='-o-';}
window.ed.webTransformNm=cssPrepona;window.ed.webTransformNmCSS=cssPreponaCSS;window.ed.webTransitionFunct=window.ed.webTransformNm+'Transition';window.ed.webTransformFunct=window.ed.webTransformNm+'Transform';window.ed.webTransformFunctOrigin=window.ed.webTransformNm+'TransformOrigin';window.ed.webTransformFunctCSS=window.ed.webTransformNmCSS+'transform ';},setDefaultListeners:function(){window.onhashchange=function(e){window.f.checkEscapedFragments(e);return false;};window.f.checkEscapedFragments();},loadinteractiveforallpages:function(){try
{var _pages_arr='';for(var d in window.eddata.pages)
{var _currpg=parseInt(d)+1;_pages_arr+=','+(_currpg).toString();}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3254; column: 200;  :: '+v);console.log("Error while trying to load interactive data ["+e.message+"]");}},check_if_can_start_to_init:function(){window.ide.saveeDitionData();window.ide.evalReturnObj();window.ide.setCssPrefixesAndBrowserDetect();window.ide.loadinteractiveforallpages();window.initer.showPlayerAndRemoveIntro();window.ide.init_start();},addEventsForKeys:function(){var vk_key_arrowup=38;var vk_key_arrowleft=37;var vk_key_arrowright=39;var vk_key_arrowdown=40;if(typeof(window.haveSentGOTOPage)=='undefined')
{window.haveSentGOTOPage=false;}
$(document).keydown(function(e){if(!window.haveSentGOTOPage)
{if(window.allowkeyinteractions)
{if(e.which==vk_key_arrowleft){ed_atp('gotopage','',['prev','statsCategorySet_IGNORE']);}
if(e.which==vk_key_arrowright){ed_atp('gotopage','',['next','statsCategorySet_IGNORE']);}
if(e.which==vk_key_arrowup){if((window.ide.currentPageObjPgs.isparalaxsubpage)||(window.ide.currentPageObjPgs.ismainparalaxpage))
{}
else
{ed_atp('gotopage','','prevsub');}}
if(e.which==vk_key_arrowdown){if((window.ide.currentPageObjPgs.isparalaxsubpage)||(window.ide.currentPageObjPgs.ismainparalaxpage))
{}
else
{ed_atp('gotopage','','nextsub');}}
window.haveSentGOTOPage=true;}}});$(document).keyup(function(e){window.haveSentGOTOPage=false;});},init_start:function(){if(window.edgl.argo.indexOf('*visualdebug*')>-1)
{$('html').addClass('ed_visual_debug')}
if(window.initer.isIe9)
{window.ed.defaultEasing='swing';window.ed.jqueryTransition='swing';}
window.ed.scrollToY=0;window.ed._isDesktopBrowser=window.initer.isNonTouchDesktop;BrowserDetect.init();window.f.fixTouchEvents();window.ed.setWindowWidthAndHeight(true);try
{}catch(e){}
window.ide.initScreenWidthHeightAndOrientation();window.ide.initDefaultVariables();window.ide.setOrientationModes();window.setTimeout('window.ide.addEventsForKeys();',500);try
{window.ide.addAndRemoveActualPagesStructure(window.ide.currentPage);var lastMainElem=true;var previousswipesubpageid=-1;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.ismainpage)
{lastMainElem=d;}
if((currobj.isswipesubpage)||(currobj.isparalaxsubpage))
{window.eddata.pages[lastMainElem].hasSubpages=true;window.eddata.pages[lastMainElem].islastsubpage=false;window.eddata.pages[lastMainElem].subpagespagenumberarr+=','+currobj.pagenumber+',';}}
for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if(currobj.hasSubpages)
{if(currobj.subpagespagenumberarr.length>0)
{var arrSPLT_PGNMUBERS_SWIPES=currobj.subpagespagenumberarr.split(',');var maxPageNumSwipeLast=-1;for(var cn in arrSPLT_PGNMUBERS_SWIPES)
{var obj_nmbr=arrSPLT_PGNMUBERS_SWIPES[cn];if(!isNaN(obj_nmbr))
{if(obj_nmbr!='')
{if(parseInt(obj_nmbr)>0)
{if(parseInt(obj_nmbr)>maxPageNumSwipeLast)
{maxPageNumSwipeLast=parseInt(obj_nmbr);}}}}}
if(maxPageNumSwipeLast>-1)
{var last_subpage_obj=window.f.findObjFromWindowPgsByPagenumber(maxPageNumSwipeLast);window.eddata.pages[last_subpage_obj.arrindex].islastsubpage=true;}}}}
try
{window.ide.setDefaultListeners();window.ed.initFirstTime();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3292; column: 195;  :: '+v);console.log("Error in ACTUAL SHOW AND DRAW section ["+e.message+", WHOLE ERROR -> "+e+"]");}
window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);window.ed.checkIfParalaxShouldPreload();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3293; column: 238;  :: '+v);console.log("Error in run after init section ["+e.message+", WHOLE ERROR -> "+e+"]");}},findmaxpage:function(arrofpages){var tmparr=arrofpages.split(',');var maxres=0;for(var d in tmparr){var curnum=tmparr[d];if(!isNaN(curnum))
{if(maxres<parseInt(curnum))
{maxres=parseInt(curnum);}}}
return maxres;},setPagesFromAndPagesTo:function(current_page,additional_page){var diverse=Math.round(window.ide.pagesMaxElements/2);var startShowPages=current_page-diverse;var endShowPages=current_page+diverse;if(startShowPages<1)
{startShowPages=1;}
var diverse_MEMORY_MATERIAL=Math.round(window.ide.pagesMaxElementsMaterialsLoaded/2);var startLoadPages=current_page-diverse_MEMORY_MATERIAL;if(startLoadPages<1)
{startLoadPages=1;}
if(window.ide.editionAllPagesCount>window.ide.pagesMaxElementsMaterialsLoaded)
{if(startLoadPages>=(window.ide.editionAllPagesCount-window.ide.pagesMaxElementsMaterialsLoaded))
{startLoadPages=(window.ide.editionAllPagesCount-window.ide.pagesMaxElementsMaterialsLoaded);}
var endLoadPages=startLoadPages+window.ide.pagesMaxElementsMaterialsLoaded;}
else
{var endLoadPages=window.ide.editionAllPagesCount;}
if(typeof(additional_page)=='undefined')
{additional_page=-1;}
var startNumber=startLoadPages;var endNumber=endLoadPages;var currPagesObj=window.f.findObjFromWindowPgsByPagenumber(current_page);var reference_page=current_page;if(currPagesObj&&((currPagesObj.isswipesubpage)||(currPagesObj.isparalaxsubpage)||(currPagesObj.isfadeinsubpage)))
{reference_page=currPagesObj.mainPageId;}
var prevobj=window.f.findPreviousObjFromWindowPgsByPageNumber(reference_page,false,true);var nextobj=window.f.findNextObjFromWindowPgsByPageNumber(current_page,false,true);var prevobj_subpages=window.f.findPreviousObjFromWindowPgsByPageNumber(current_page,true,true);var nextobj_subpages=window.f.findNextObjFromWindowPgsByPageNumber(current_page,true,true);var prevPageObj=null;if(ide.previousPage>0)
{prevPageObj=window.f.findObjFromWindowPgsByPagenumber(ide.previousPage);}
if(prevobj!=null)
{startNumber=prevobj.pagenumber;}
if(nextobj!=null)
{endNumber=nextobj.pagenumber;}
ide.loadPagesArray=',,';if(prevobj!=null)
{ide.loadPagesArray+=prevobj.pagenumber+',a,';}
if(nextobj!=null)
{ide.loadPagesArray+=nextobj.pagenumber+',b,';}
if(currPagesObj!=null)
{ide.loadPagesArray+=currPagesObj.pagenumber+',c,';}
if(prevobj_subpages!=null)
{ide.loadPagesArray+=prevobj_subpages.pagenumber+',d,';}
if(nextobj_subpages!=null)
{ide.loadPagesArray+=nextobj_subpages.pagenumber+',e,';}
if(prevPageObj!=null)
{ide.loadPagesArray+=prevPageObj.pagenumber+',f,';}
if(currPagesObj&&currPagesObj.isparalaxsubpage)
{ide.loadPagesArray+=currPagesObj.mainPageId+',f,';}
if(window.ide.additionalPageToLoad>0)
{ide.loadPagesArray+=window.ide.additionalPageToLoad+',g,';if(ide.orientIsBookMode)
{var tmpobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.additionalPageToLoad);if(tmpobj!=0)
{ide.loadPagesArray+=tmpobj.rightPage+','+tmpobj.leftPage+',h,';}}}
var tmparrpgs=ide.loadPagesArray.split(',');for(var d in tmparrpgs){var tmpcurpg=parseInt(tmparrpgs[d]);if(!isNaN(tmpcurpg))
{if(parseInt(tmpcurpg)>=0)
{var pgobj=window.f.findObjFromWindowPgsByPagenumber(tmpcurpg);if(pgobj!=null)
{if(pgobj.isparalaxsubpage)
{pgobj=window.f.findObjFromWindowPgsByPagenumber(tmpcurpg);}
if(pgobj.ismainparalaxpage)
{ide.loadPagesArray+=ide.loadPagesArray.replace(pgobj.paralaxallages,'')+pgobj.paralaxallages;}}}}}
if(ide.orientIsBookMode)
{if(currPagesObj){ide.loadPagesArray+=currPagesObj.leftPage+',';ide.loadPagesArray+=currPagesObj.rightPage+',';}
if(prevPageObj!=null)
{ide.loadPagesArray+=prevPageObj.leftPage+',';ide.loadPagesArray+=prevPageObj.rightPage+',';}
if(prevobj!=null)
{ide.loadPagesArray+=prevobj.leftPage+',';ide.loadPagesArray+=prevobj.rightPage+',';}
if(nextobj!=null)
{ide.loadPagesArray+=nextobj.leftPage+',';ide.loadPagesArray+=nextobj.rightPage+',';}}
var diverse_MEMORY_MATERIAL_SHOW_PAGES=Math.round(window.ide.pagesMaxElements/2);if(prevobj!=null)
{if(prevobj.pagenumber<startShowPages)
{startShowPages=prevobj.pagenumber;}}
if(nextobj!=null)
{if(nextobj.pagenumber>endShowPages)
{endShowPages=nextobj.pagenumber;}}
if(window.ide.editionAllPagesCount>window.ide.pagesMaxElements)
{if(startShowPages>=(window.ide.editionAllPagesCount-window.ide.pagesMaxElements))
{startShowPages=(window.ide.editionAllPagesCount-window.ide.pagesMaxElements);}
var endShowPages=window.ide.findmaxpage(window.ide.loadPagesArray);}
else
{var endShowPages=window.ide.editionAllPagesCount;}
if(nextobj!=null)
{if(endShowPages<nextobj.pagenumber)
{endShowPages=nextobj.pagenumber;}}
window.ide.drawPagesFrom=startShowPages;window.ide.drawPagesTo=endShowPages;},isPagenumberRightPage:function(for_page_num){var resvar=false;if(((for_page_num%2)==1)&&(for_page_num>1))
{resvar=true;}
return resvar;},addAndRemoveActualPagesStructure:function(current_page,shouldntremovepage,initiate_if_not_initiated){if(typeof(shouldntremovepage)=='undefined')
{var shouldntremovepage=-1;}
if(typeof(initiate_if_not_initiated)=='undefined')
{var initiate_if_not_initiated=false;}
var startShowPages=window.ide.drawPagesFrom;var endShowPages=window.ide.drawPagesTo;var previousObjAdded=null;var mustBeInitiated=false;ide.checkAndCleanNonBookPagesOrAddThem(current_page);$('.lowres_spreads_right').remove();for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(ide.loadPagesArray.indexOf(','+currobj.pagenumber.toString()+',')>0)
{if(window.ide.get(currobj.iscrollHolder)!=null)
{window.ide.initScreenWidthHeightAndOrientation();window.ide.actualResizePage(l);mustBeInitiated=true;}
else
{mustBeInitiated=false;if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}
if(ide.orientIsBookMode)
{if(ide.isPagenumberRightPage(currobj.pagenumber))
{if(window.ide.get(currobj.iscrollHolder)==null)
{$('#'+ide.mainStageElement).append(eval(currobj.srcHTML));}
var addSRCDIVID=window.ide.get(currobj.divid).outerHTML;var addSRCHTML=window.ide.get(currobj.pageHTML).outerHTML;if(window.ide.get(currobj.iscrollHolder)!=null)
{ide.preloadThumbnails(currobj,true);window.ide.get(currobj.iscrollHolder).outerHTML='';}
if(window.ide.get(currobj.spreadsleftpageholder)!=null)
{if(window.ide.get(currobj.divid)==null)
{$('#'+currobj.spreadsleftpageholder).append(addSRCDIVID);}
if(window.ide.get(currobj.pageHTML)==null)
{$('#'+currobj.spreadsleftpageholder).append(addSRCHTML);}
var margin_left=ide.editionOriginalSinglePageWidth;$('#'+currobj.pageHTML).append('<div class="lowres_spreads_right clickthrough gpuAcc noSelect"></div>');$('#'+currobj.divid).css({'margin-left':margin_left.toString()+'px'});$('#'+currobj.pageHTML).css({'margin-left':margin_left.toString()+'px'});}}
else
{$('#'+ide.mainStageElement).append(eval(currobj.srcHTML));mustBeInitiated=true;}}
else
{mustBeInitiated=true;if(currobj.isparalaxsubpage)
{var mainpageobj=window.f.findObjFromWindowPgsByObjectId(currobj.mainPageObjectId);if($('#'+currobj.holderdivid).length<1)
{if(window.ide.get(currobj.iscrollHolder)==null)
{$('#'+ide.mainStageElement).append(eval(currobj.srcHTML));}
var addsrc=window.ide.get(currobj.holderdivid).outerHTML;if(window.ide.get(currobj.iscrollHolder)!=null)
{ide.preloadThumbnails(currobj,true);$('#'+currobj.iscrollHolder).remove();}
$('#'+mainpageobj.holderdivid).parent().append(addsrc);}
try
{mainpageobj.iscroll[0].refresh();}catch(e){}}
else
{$('#'+ide.mainStageElement).append(eval(currobj.srcHTML));$('#'+currobj.divid).css({'margin-left':'0px'});}}
window.ide.actualResizePage(l);previousObjAdded=l;}
if((mustBeInitiated)&&(initiate_if_not_initiated))
{if(window.ide.get(currobj.iscrollHolder)!=null)
{if(window.ide.get(currobj.iscrollHolder).display!=window.ide.showDisplayType)
{var setToPosX=0;var setToPosY=0;if(currobj.pagenumber<window.ide.currentPage)
{setToPosX=-window.ide.screenWidth;}
else if(currobj.pagenumber>window.ide.currentPage)
{setToPosX=window.ide.screenWidth;}
if(((currobj.isswipesubpage)&&(currobj.pagenumber>window.ide.currentPage)))
{setToPosY=window.ide.screenHeight;}
if(((currobj.isswipesubpage)&&(currobj.pagenumber<window.ide.currentPage)))
{setToPosY=-window.ide.screenHeight;}
if((setToPosX!=0)||(setToPosY!=0))
{$('#'+currobj.iscrollHolder).css({x:setToPosX.toString()+'px',y:setToPosY.toString()+'px',display:ide.showDisplayType});}
mustBeInitiated=false;}}}}
else
{if((window.ide.get(currobj.iscrollHolder)!=null)&&(currobj.pagenumber!=shouldntremovepage))
{if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}
ide.preloadThumbnails(currobj,true);window.ide.get(currobj.iscrollHolder).outerHTML="";}}}},deleteAllIscrolls:function(current_page){for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}}},checkAndCleanNonBookPagesOrAddThem:function(current_page){if((ide.isPagenumberRightPage(window.ide.currentPage))&&(ide.orientIsBookMode))
{window.ide.currentPage-=1;}
for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if((l>=ide.drawPagesFrom)&&(l<=ide.drawPagesTo))
{if(ide.orientIsBookMode)
{if((window.ide.get(currobj.iscrollHolder)!=null))
{if(ide.isPagenumberRightPage(currobj.pagenumber))
{if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}
currobj.pageloaded=false;currobj.loadedimage=false;currobj.loadedimageHD=false;currobj.offeredUHD=false;currobj.elemsGetFunctionCalled=false;ide.drawPageElements(currobj.pagenumber,true);ide.preloadThumbnails(currobj,true);window.ide.get(currobj.iscrollHolder).outerHTML="";}}}
else
{if(ide.isPagenumberRightPage(currobj.pagenumber))
{if(window.ide.get(currobj.pageHTML)!=null)
{if(window.ide.get(currobj.pageHTML).parentNode.id!=currobj.holderdivid)
{window.ide.get(currobj.pageHTML).outerHTML="";}}
if(window.ide.get(currobj.divid)!=null)
{if(window.ide.get(currobj.divid).parentNode.id!=currobj.holderdivid)
{window.ide.get(currobj.divid).outerHTML="";currobj.pageloaded=false;currobj.loadedimage=false;currobj.loadedimageHD=false;currobj.offeredUHD=false;currobj.elemsGetFunctionCalled=false;ide.drawPageElements(currobj.pagenumber,true);}}}}}}},resize_any_fsc_gallery_if_exists:function(){try
{if((window.ed.fscGalScrollImage!=null)&&(window.ed.fscGalScrollImageParent!='')&&(window.ide.get(window.ed.fscGalScrollImage)!=null))
{window.ed.endedLoadingFSCImage(window.ide.get(window.ed.fscGalScrollImage),window.ed._currnt_gal_width,window.ed._currnt_gal_height);}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3447; column: 270;  :: '+v);console.log("Error while resizing gallery -> "+e.message);}
try
{if(window.ed.layerIsShown)
{window.ed.runCurrentLayer(window.ed.layerLastElement,window.ed.layerLastElementWidth,window.ed.layerLastElementHeight);}}catch(e){}},fixRightPageToLeft:function(current_page){var resvar=current_page;if(ide.orientIsBookMode)
{if(ide.isPagenumberRightPage(current_page))
{resvar=resvar-1;window.ide.currentPage=resvar;}}
return resvar;},clearPagesNotNeeded:function(current_page){for(var i in window.eddata.pages)
{var currobj=window.eddata.pages[i];if((currobj.pagenumber!=current_page)&&(currobj.pagenumber!=window.ide.additionalPageToLoad)&&((currobj.leftPage!=current_page)&&(ide.orientIsBookMode)))
{if(ide.get(currobj.iscrollHolder)!=null)
{ide.freePage(currobj.pagenumber);}
else if((ide.isPagenumberRightPage(currobj.pagenumber))&&(ide.orientIsBookMode))
{ide.freePage(currobj.pagenumber);}
if(window.ide.get(currobj.iscrollHolder)!=null)
{if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}
window.ide.get(currobj.iscrollHolder).outerHTML="";}}}},allowCurrentOrientation:function(){var resvar=-1;if(window.ide.orientation==window.ide.landscapeOrient)
{if(window.ide.HTML_lockorientation==2)
{resvar=false;resvar=1;}}
else if(window.ide.orientation==window.ide.portraitOrient)
{if(window.ide.HTML_lockorientation==1)
{resvar=false;resvar=2;}}
if(window.initer.isNonTouchDesktop)
{resvar=-1;}
return resvar;},drawActualRotateImage:function(index,element_rotate_parent_id){if(index==2)
{if(ide.get(element_rotate_parent_id)==null)
{var add_html='<div id="'+element_rotate_parent_id+'" class="fillWidthWithOpacity gpuAcc"><div class="gpuAcc rotate_to_actual_image rotate_to_landscape_image"><div class="title_rotate">ROTATE TO LANDSCAPE</div></div></div>';$('body').append(add_html);$('#'+element_rotate_parent_id).stop().delay(1).transition({opacity:1},300,window.ed.jqueryTransition,function(){});if(ide.get(element_rotate_parent_id)!=null)
{window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_start_event_nm,'window.ed.donothingStartHandler');window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_move_event_nm,'window.ed.donothingMoveHandler');window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_end_event_nm,'window.ed.donothingEndHandler');if(window.ed.istouchdevice)
{window.f.AtachEvent(element_rotate_parent_id,'mousedown','window.ed.donothingStartHandler');window.f.AtachEvent(element_rotate_parent_id,'mousemove','window.ed.donothingMoveHandler');window.f.AtachEvent(element_rotate_parent_id,'mouseup','window.ed.donothingEndHandler');}}}
return false;}
if(index==1)
{if(ide.get(element_rotate_parent_id)==null)
{var add_html='<div id="'+element_rotate_parent_id+'" class="fillWidthWithOpacity gpuAcc"><div class="gpuAcc rotate_to_actual_image rotate_to_portrait_image"><div class="title_rotate">ROTATE TO PORTRAIT</div></div></div>';$('body').append(add_html);$('#'+element_rotate_parent_id).stop().delay(1).transition({opacity:1},300,window.ed.jqueryTransition,function(){});if(ide.get(element_rotate_parent_id)!=null)
{window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_start_event_nm,'window.ed.donothingStartHandler');window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_move_event_nm,'window.ed.donothingMoveHandler');window.f.AtachEvent(element_rotate_parent_id,window.ed._touch_end_event_nm,'window.ed.donothingEndHandler');if(window.ed.istouchdevice)
{window.f.AtachEvent(element_rotate_parent_id,'mousedown','window.ed.donothingStartHandler');window.f.AtachEvent(element_rotate_parent_id,'mousemove','window.ed.donothingStartHandler');window.f.AtachEvent(element_rotate_parent_id,'mouseup','window.ed.donothingStartHandler');}}}
return false;}},add_and_resize_pages_to_fit:function(current_page){window.ide.initScreenWidthHeightAndOrientation();window.scrollTo(0,0);var return_val=ide.allowCurrentOrientation();var element_rotate_parent_id=ide.editionId.toString()+'rotateLockOrientPlease';if(return_val>0)
{ide.drawActualRotateImage(return_val,element_rotate_parent_id);return false;}
else
{if(ide.get(element_rotate_parent_id)!=null)
{ide.get(element_rotate_parent_id).outerHTML='';}}
current_page=ide.fixRightPageToLeft(current_page);ide.setLoadedAndUnloadedPages();ide.clearPagesNotNeeded(current_page);window.ide.initPageEvents();ide.setPagesFromAndPagesTo(current_page);window.ed.initEvents();window.ide.checkAndCleanNonBookPagesOrAddThem(current_page);window.ide.resize_any_fsc_gallery_if_exists();ide.force_refresh_and_default_madement_of_iscrolls=true;ide.positionPages(-1,current_page,false);},onZoomEndEventManipulateThingsStart:function(){if(window.ed._move_hanlder_started_to_scroll_left_or_right)
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage)
if(currobj!=null)
{if(currobj.iscroll!=null)
{currobj.iscroll[0].disable();}}}
else
{window.ed.page_currently_zoomed_in=true;var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage)
if(currobj!=null)
{if(currobj.iscroll!=null)
{currobj.iscroll[0].enable();}}}
var currobj=window.f.findObjFromWindowPgsByPagenumber(ide.currentPage);try
{var currentScale=this.scale;}catch(e)
{var currentScale=ide.defaultZoomRatio;if(currobj!=null)
{if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{currentScale=currobj.iscroll[0].scale;}}}}
currobj.currentZoom=currentScale;if(currobj.currentZoom>ide.defaultZoomRatio)
{currobj.scaled=true;edCurrentPageZoomStart();}
else
{currobj.scaled=false;}
window.ed.page_currently_zoomed_in=currobj.scaled;if(ide.pageflip){if(window.pgfl.mouse_up_moving){window.pgfl.reset_from_moving();}}},onZoomEndEventManipulateThingsEnd:function(){var currobj=window.f.findObjFromWindowPgsByPagenumber(ide.currentPage);try
{var currentScale=this.scale;}catch(e)
{var currentScale=ide.defaultZoomRatio;if(currobj!=null)
{if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{currentScale=currobj.iscroll[0].scale;}}}}
currobj.currentZoom=currentScale;if(currobj.currentZoom>ide.defaultZoomRatio)
{currobj.scaled=true;}
else
{currobj.scaled=false;}
window.ed.page_currently_zoomed_in=currobj.scaled;window.ide.checkIfUHDShouldBeOffered(currobj);if(!window.ed.startinPageEventCalled)
{window.ed.zoomendwasalreadycalled=true;}
else
{edCurrentPageZoomEnd();}
if(ide.pageflip){if(window.pgfl.mouse_up_moving){window.pgfl.reset_from_moving();}}},replaceCanvasWithHDCanvas:function(eddatapageindex,image,isrightpage){if(typeof(isrightpage)=='undefined')
{var isrightpage=false;}
var pgobj=window.eddata.pages[parseInt(eddatapageindex)];if(pgobj!=null)
{if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{$('#'+pgobj.lowresdiv).attr('src',image.src);}
else
{$('#'+pgobj.lowresdiv).css({'background-image':'url("'+image.src+'")'});}}
if(window.ide.orientIsBookMode)
{if((isrightpage)||(pgobj.isfirstpage)||(pgobj.islastpage))
{window.ed.currentlyLoadingUHDImages=false;}
window.ed.hideLoader();}
else
{window.ed.currentlyLoadingUHDImages=false;window.ed.hideLoader();}},checkIfUHDShouldBeOffered:function(pageobj){if((pageobj.currentZoom==window.ide.scaleOfFullZoom)&&(!pageobj.offeredUHD)&&(window.ide.offerUHDonMaxZoom))
{if(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom)
{if(window.edgl.argo.indexOf('*zoom2decimal*')>-1){pageobj.iscroll[0].options.zoomMax=Math.round((window.ide.scaleOfFullZoomHD*100))/100;}else{pageobj.iscroll[0].options.zoomMax=Math.round((window.ide.scaleOfFullZoomHD*100000))/100000;}
pageobj.offeredUHD=true;if(($('.ed-allow-uhd-zooming-notification').length<=0)&&(!pageobj.loadedimageHD))
{$('#'+window.ide.mainStageElementParent).append('<div class="ed-allow-uhd-zooming-notification">Zoom in again for UHD Quality</div>');$('.ed-allow-uhd-zooming-notification').stop().css({'display':'block',opacity:0.001}).transition({opacity:1},250,window.ed.jqueryTransition,function(){$('.ed-allow-uhd-zooming-notification').delay(4000).transition({opacity:0},250,window.ed.jqueryTransition,function(){$('.ed-allow-uhd-zooming-notification').remove();});})}}}
else
{if((pageobj.currentZoom>=window.ide.scaleOfFullZoom)&&(window.ide.offerUHDonMaxZoom))
{if(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom)
{if((!pageobj.loadedimageHD))
{window.ed.showLoader();pageobj.iscroll[0].options.HWCompositing=false;pageobj.iscroll[0].refreshTranslateZ();pageobj.loadedimageHD=true;pageobj.offeredUHD=true;window.ed.currentlyLoadingUHDImages=true;var imgToLoad=new Image;imgToLoad.alt=pageobj.arrindex.toString();imgToLoad.onload=function(){window.ide.replaceCanvasWithHDCanvas(this.alt,this);}
imgToLoad.src=window.ed.getCanvasToLoad(pageobj,true);if(window.ide.isPagenumberRightPage(pageobj.pagenumber))
{var right_page=pageobj.leftPage;}
else
{var right_page=pageobj.rightPage;}
if(window.ide.orientIsBookMode)
{var right_page_obj=window.f.findObjFromWindowPgsByPagenumber(right_page);if(right_page_obj!=null)
{right_page_obj.loadedimageHD=true;right_page_obj.offeredUHD=true;var imgToLoad_right=new Image;imgToLoad_right.alt=right_page_obj.arrindex.toString();imgToLoad_right.onload=function(){window.ide.replaceCanvasWithHDCanvas(this.alt,this,true);}
imgToLoad_right.src=window.ed.getCanvasToLoad(right_page_obj,true);}}}}}
else if(pageobj.currentZoom<window.ide.scaleOfFullZoom)
{if(!pageobj.loadedimageHD)
{pageobj.iscroll[0].options.zoomMax=window.ide.scaleOfFullZoom;}}
else if((pageobj.currentZoom==window.ide.scaleOfFullZoom)&&(pageobj.loadedimageHD))
{if(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom)
{try
{pageobj.iscroll[0].options.zoomMax=Math.round((window.ide.scaleOfFullZoomHD*100))/100;}catch(e){}}}}},redraw:function(divid){},unsetZoom:function(for_page,holder){$('#'+holder).stop();$('#'+holder).css({x:ide.pageOffsetX.toString(),y:ide.pageOffsetY.toString(),scale:ide.defaultPublicationScale,'transform-origin':'0 0'});},initHandlers:function(current_page,makedefaultzoom){if(typeof(makedefaultzoom)=='undefined')
{var makedefaultzoom=true;}
var forcetoremake=false;if(ide.force_refresh_and_default_madement_of_iscrolls)
{forcetoremake=true;ide.force_refresh_and_default_madement_of_iscrolls=false;}
ide.calculateRatio();ide.setPagesFromAndPagesTo(current_page);var startShowPages=window.ide.drawPagesFrom;var endShowPages=window.ide.drawPagesTo;for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(ide.loadPagesArray.indexOf(','+currobj.pagenumber.toString()+',')>0)
{if((currobj.pagenumber==current_page))
{try
{}catch(e){}}
var newIscrollWasMade=false;if(((window.eddata.pages[currobj.arrindex].iscroll==null)&&(ide.get(window.eddata.pages[currobj.arrindex].iscrollHolder)!=null)))
{if((!ide.isIE58))
{var usecenterofunzoomed=true;var useparalaxcenter=false;var enablewheel=true;var scrollerType='zoom';var poverlap=0;var interactivescrollbars=true;var enablescrollbar=true;if(!window.ed._enableZoom)
{scrollerType='scroll';}
try
{if((!window.eddata.pages[currobj.arrindex].zoom))
{scrollerType='scroll';}
if((window.eddata.pages[currobj.arrindex].isparalaxsubpage)||(window.eddata.pages[currobj.arrindex].ismainparalaxpage))
{scrollerType='scroll';enablewheel=false;usecenterofunzoomed=false;useparalaxcenter=true;interactivescrollbars=false;enablescrollbar=false;poverlap=window.eddata.pages[currobj.arrindex].poverlap;try
{window.eddata.pages[currobj.arrindex].zoom=false;}catch(e){}}}catch(e){}
if(!window.initer.isIe9)
{var obj=new IScroll('#'+currobj.iscrollHolder,{startX:0,startY:0,HWCompositing:(window.ide.useHDCanvas!=window.ide.editionId),interactiveScrollbars:interactivescrollbars,useCenterOfUnzoomedElement:usecenterofunzoomed,resizePolling:0,freeScroll:true,bindToWrapper:false,scrollX:true,scrollY:true,useCenterOfUnzoomedElementParalas:useparalaxcenter,paralaxOverlap:poverlap,scrollbars:enablescrollbar,mouseWheel:enablewheel,wheelAction:scrollerType,zoom:true,preventDefault:false,zoomMin:window.ide.defaultPublicationScale,zoomStart:window.ide.defaultPublicationScale,zoomMax:window.ide.maxScaleFactor});}
else
{var obj=new IScroll('#'+currobj.iscrollHolder,{startX:0,startY:0,HWCompositing:(window.ide.useHDCanvas!=window.ide.editionId),interactiveScrollbars:false,useCenterOfUnzoomedElement:usecenterofunzoomed,resizePolling:0,freeScroll:true,bindToWrapper:false,scrollX:true,scrollY:true,useCenterOfUnzoomedElementParalas:useparalaxcenter,paralaxOverlap:poverlap,scrollbars:enablescrollbar,mouseWheel:enablewheel,wheelAction:scrollerType,zoom:true,useTransition:true,useTransform:true,preventDefault:false,zoomMin:window.ide.defaultPublicationScale,zoomStart:window.ide.defaultPublicationScale,zoomMax:window.ide.maxScaleFactor});}
window.eddata.pages[currobj.arrindex].iscroll=new Array();window.eddata.pages[currobj.arrindex].iscroll[0]=obj;window.eddata.pages[currobj.arrindex].iscroll[0].on('zoomEnd',window.ide.onZoomEndEventManipulateThingsEnd);window.eddata.pages[currobj.arrindex].iscroll[0].on('zoomStart',window.ide.onZoomEndEventManipulateThingsStart);window.eddata.pages[currobj.arrindex].iscroll[0].forPageNumber=currobj.pagenumber;newIscrollWasMade=true;}
else
{var obj=new iScroll(currobj.iscrollHolder,{x:0,y:0,hScrollbar:true,fadeScrollbar:true,hScrollbar:true,bounce:true,zoom:true,zoomMin:window.ide.defaultPublicationScale,zoomMax:window.ide.maxScaleFactor});window.eddata.pages[currobj.arrindex].iscroll=new Array();window.eddata.pages[currobj.arrindex].iscroll.push(obj);window.eddata.pages[currobj.arrindex].iscroll[0].onZoomStart=function(){window.ide.onZoomEndEventManipulateThingsStart();};window.eddata.pages[currobj.arrindex].iscroll[0].onZoomEnd=function(){window.ide.onZoomEndEventManipulateThingsEnd();};}}
if((window.eddata.pages[currobj.arrindex].iscroll!=null)&&(ide.get(window.eddata.pages[currobj.arrindex].iscrollHolder)!=null)&&(newIscrollWasMade||forcetoremake))
{try
{var allowReseting=true;if(window.initer.isIe9)
{allowReseting=false;if(((newIscrollWasMade)||(forcetoremake))||(window.ide.currentPage!=currobj.pagenumber))
{allowReseting=true;}}
if(allowReseting)
{var scalefactor=window.ide.defaultZoomRatio;window.eddata.pages[currobj.arrindex].iscroll[0].options.zoomMin=(ide.defaultZoomRatio);window.eddata.pages[currobj.arrindex].iscroll[0].options.zoomStart=(ide.defaultZoomRatio);window.eddata.pages[currobj.arrindex].iscroll[0].options.startX=window.ide.pageOffsetX;window.eddata.pages[currobj.arrindex].iscroll[0].options.startY=window.ide.pageOffsetY;window.eddata.pages[currobj.arrindex].iscroll[0].refresh();window.eddata.pages[currobj.arrindex].iscroll[0].zoom(scalefactor,window.ide.pageOffsetX,window.ide.pageOffsetY,3);}}catch(e){}}}
else
{if(window.eddata.pages[currobj.arrindex].iscroll!=null)
{try
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}catch(e){}}}}},initPageEvents:function(){window.f.fixTouchEvents();window.f.AtachEvent(ide.mainStageElement,window.ed._touch_start_event_nm,'window.ed.startingHandler');window.f.AtachEvent(ide.mainStageElement,window.ed._touch_move_event_nm,'window.ed.moveHandler');window.f.AtachEvent(ide.mainStageElement,window.ed._touch_end_event_nm,'window.ed.endHandler');try
{if(window.ed._touch_out_event_nm!='')
{window.f.AtachEvent(ide.mainStageElement,window.ed._touch_out_event_nm,'window.ed.endOutHandler');}}catch(e){}
if(window.ed.istouchdevice)
{window.f.AtachEvent(ide.mainStageElement,'mousedown','window.ed.startingHandler');window.f.AtachEvent(ide.mainStageElement,'mousemove','window.ed.moveHandler');window.f.AtachEvent(ide.mainStageElement,'mouseup','window.ed.endHandler');window.f.AtachEvent(ide.mainStageElement,'mouseleave','window.ed.endOutHandler');}
if((window.initer.isIe10)||(window.initer.isIe9))
{}},checkEndPositionOrComeBack:function(do_reset_everything){if(typeof(do_reset_everything)=='undefined')
{var do_reset_everything=true;}
if(window.ide.eventDragStartcalled)
{window.setTimeout("if(window.ide.validationnum == "+window.ide.validationnum.toString()+"){window.edPageDragReturned();}",300);window.ide.eventDragStartcalled=false;}
window.ed.isPublicationFullyLoadedAndShown=true;window.ide.positionPages(-1,window.ide.currentPage,true,false,do_reset_everything);window.ide.checkcounterindex++;window.setTimeout('if(window.ide.checkcounterindex=='+window.ide.checkcounterindex.toString()+'){window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded('+window.ide.previousPage.toString()+','+window.ide.currentPage.toString()+',true,false);}',500);},freePage:function(pageNumber,deleteiscroll){if(typeof(deleteiscroll)=='undefined')
{var deleteiscroll=true;}
var currobj=window.f.findObjFromWindowPgsByPagenumber(pageNumber);if(currobj!=null)
{if(ide.get(currobj.lowresdiv)!=null)
{if(window.f.allowPageBgClearing(currobj))
{ide.get(currobj.lowresdiv).style.backgroundImage="url('"+window.ed.getThumbToLoad(currobj)+"')";if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{document.getElementById(currobj.lowresdiv).src=window.ed.defaultNoImageValueSrc;}}}
if(ide.get(currobj.linksDiv)!=null)
{ide.get(currobj.linksDiv).style.background=window.ed.defaultNoImageValue;ide.get(currobj.linksDiv).style.backgroundImage=window.ed.defaultNoImageValue;}
if(ide.get(currobj.divid)!=null)
{ide.get(currobj.divid).style.visibility="hidden";ide.get(currobj.divid).style.opacity=0;}
ide.drawPageElements(currobj.pagenumber,true);currobj.pageloaded=false;currobj.loadedimage=false;currobj.loadedimageHD=false;currobj.offeredUHD=false;currobj.elemsGetFunctionCalled=false;if((currobj.iscroll!=null)&&(deleteiscroll))
{if(currobj.iscroll[0]!=null)
{window.eddata.pages[currobj.arrindex].iscroll[0].destroy();window.eddata.pages[currobj.arrindex].iscroll[0]=null;window.eddata.pages[currobj.arrindex].iscroll=null;}}
if(ide.get(currobj.iscrollHolder)!=null)
{ide.get(currobj.iscrollHolder).style.display=window.ide.displayNoneType;}}},doAllStuffOnAfterChangePage:function(){window.ed.updatePaginator();window.ed.onlyZoomContent=false;window.ed.preventGlobalHandling=false;window.ed.preventLocalHandling=false;window.ed.hasAlreadyStartedScrollingVerticalLocaly=false;window.scrollTo(0,window.ed.scrollToY);window.ed.preventBecauseGallery=false;window.ed.move_hanlder_started_to_scroll_left_or_right=false;if(typeof(resetsubpages)=='undefined')
{var resetsubpages=true;}
window.ed.doStuffBeforeRightOrLeft(1);window.ed.pageWasJustChanged=true;},onChangePage:function(current_page){window.ed._currentPage=window.ide.currentPage;window.ide.currentPageObjPgs=window.f.findObjFromWindowPgsByPagenumber(current_page);window.ide.doAllStuffOnAfterChangePage();},setLoadedAndUnloadedPages:function(){for(var i in window.eddata.pages)
{var currobj=window.eddata.pages[i];if((currobj.pagenumber==window.ide.currentPage)||(currobj.pagenumber==ide.additionalPageToLoad)||((currobj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode)))
{}
else
{if(currobj.pageloaded)
{ide.freePage(currobj.pagenumber,false);}}}},positionPagesOnAfterCheckMaterialsLoadedOrUnloaded:function(from_page,current_page,animate,makedefaultzoom){if(typeof(current_page)!='undefined')
{ide.setPagesFromAndPagesTo(current_page);ide.addAndRemoveActualPagesStructure(current_page,from_page);window.ide.initHandlers(window.ide.currentPage,makedefaultzoom);window.ed.arrPointerArray=new Array();window.ed.hideLoader();var setdefaultposAndLoadPageMaterials=true;ide.setDisplayBlockAndDisplayNonePages(animate,makedefaultzoom,setdefaultposAndLoadPageMaterials);ide.setLoadedAndUnloadedPages();}},getCurrentPagesRedrawArray:function(new_page,old_page){var resvar=',';resvar+=new_page.toString()+',';resvar+=old_page.toString()+',';return resvar;},addStructureAndShowIt:function(current_page,page_shouldnt_be_freed,initiateposition){if(typeof(page_shouldnt_be_freed)=='undefined')
{var page_shouldnt_be_freed=-1;}
if(typeof(initiateposition)=='undefined')
{var initiateposition=false;}
ide.initScreenWidthHeightAndOrientation();ide.calculateRatio();ide.setPagesFromAndPagesTo(current_page,page_shouldnt_be_freed);ide.addAndRemoveActualPagesStructure(current_page,page_shouldnt_be_freed,initiateposition);window.ide.initHandlers(current_page,false);ide.setDisplayBlockAndDisplayNonePages(true,false,false);},positionPagesStartingHandler:function(){window.ide.checkcounterindex++;ide.addStructureAndShowIt(window.ide.currentPage,-1);},preloadMainCanvases:function(windowpgsobj){try
{var tmpimg=new Image();tmpimg.onload=function(){try
{var imgsrc=this.src;var lowresdiv=this.alt;if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{document.getElementById(lowresdiv).src=imgsrc;}
else
{document.getElementById(lowresdiv).style.backgroundImage="url('"+imgsrc+"')";}}catch(e){console.log("E-000000");}}
tmpimg.alt=windowpgsobj.lowresdiv;tmpimg.src=windowpgsobj.canvas;window.ed.paralaxImages.push(tmpimg);}catch(e){}},preloadThumbnails:function(windowpgsobj,unloadit){if(!unloadit)
{try
{if(windowpgsobj.imageObj==null)
{windowpgsobj.imageObj=new Image();windowpgsobj.imageObj.src=window.ed.getThumbToLoad(currobj);}}catch(e){}}
else
{try
{if(windowpgsobj.imageObj!=null)
{windowpgsobj.imageObj.src=window.ed.defaultNoImageValueSrc;windowpgsobj.imageObj=null;}}catch(e){}}},setSubpagesArrowsIfEnabled:function(current_obj_pgs){try
{var show_uparrow=false;var show_downarrow=false;var animtime=300;var animEasing='ease-out';if(window.ed.showSubpagesArrows)
{if((current_obj_pgs.hasSubpages)||(current_obj_pgs.isswipesubpage))
{show_uparrow=true;show_downarrow=true;if(current_obj_pgs.ismainpage)
{show_uparrow=false;show_downarrow=true;}
if(current_obj_pgs.isswipesubpage)
{show_uparrow=true;show_downarrow=true;}
if(current_obj_pgs.islastsubpage)
{show_uparrow=true;show_downarrow=false;}}
if(show_uparrow)
{if($('#subageimageup').css('display')==window.ide.displayNoneType)
{ide.get('subageimageup').style.backgroundImage="url('"+window.ed._subpage_up_arrow_img+"')";$('#subageimageup').stop(true,false);$('#subageimageup').css({'display':ide.showDisplayType,opacity:0.0001}).delay(50).transition({opacity:1},animtime,animEasing);}}
else
{if($('#subageimageup').css('display')!=window.ide.displayNoneType)
{$('#subageimageup').stop(true,false);$('#subageimageup').delay(50).transition({opacity:0},Math.round(animtime/2),animEasing,function(){window.ide.get('subageimageup').style.display="none";window.ide.get('subageimageup').style.backgroundImage=window.ed.defaultNoImageValue;});}}
if(show_downarrow)
{if($('#subageimagedown').css('display')==window.ide.displayNoneType)
{ide.get('subageimagedowninner').style.backgroundImage="url('"+window.ed._subpage_down_arrow_img+"')";$('#subageimagedown').stop(true,false);$('#subageimagedown').css({display:ide.showDisplayType,opacity:0.0001}).delay(50).transition({opacity:1},animtime,animEasing);}}
else
{if($('#subageimagedown').css('display')!=window.ide.displayNoneType)
{$('#subageimagedown').stop(true,false);$('#subageimagedown').delay(50).transition({opacity:0},Math.round(animtime/2),animEasing,function(){window.ide.get('subageimagedown').style.display="none";window.ide.get('subageimagedowninner').style.backgroundImage=window.ed.defaultNoImageValue;});}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3663; column: 427;  :: '+v);}},onAfterPageTransition:function(force){if(typeof(force)=="undefined")
{force=false;}
if((window.ide.pageChangeEventStartFired)&&((window.ide.pageWasWhenStartFired!=window.ide.currentPage)||force))
{window.ide.pageChangeEventStartFired=false;if(ide.contain_paralax_pages){window.ed.resetParalaxStuffAndPages();window.ed.checkIfParalaxShouldPreload();}
if(ide.pageflip){window.pgfl.resetFlipStuffAndPages();}
window.edPageChangeEnded();}},isAnimatedTransitionFromMainToAnotherSub:function(from_page,current_page,animate,do_reset_everything,do_reset_everything)
{var resvar=false;var from_obj=window.f.findObjFromWindowPgsByPagenumber(from_page);var to_page_obj=window.f.findObjFromWindowPgsByPagenumber(current_page);if(from_page>0)
{if(((to_page_obj.isswipesubpage)||(to_page_obj.isparalaxsubpage))&&((to_page_obj.mainPageId!=from_obj.mainPageId)&&(to_page_obj.mainPageId!=from_obj.pagenumber)))
{if(typeof(do_reset_everything)=='undefined')
{var do_reset_everything=false;}
var setToWidth=window.ide.screenWidth;if(from_page>current_page)
{setToWidth=-setToWidth;}
if(to_page_obj!=null)
{$('#'+to_page_obj.iscrollHolder).stop().css({x:setToWidth+'px',y:'0px'});}
resvar=true;}}
return resvar;},drawPageElements:function(forPageNumber,unloadTHEM){window.ed.firedautoplay=false;if(typeof(unloadTHEM)=='undefined')
{var unloadTHEM=false;}
var currobj=window.f.findObjFromWindowPgsByPagenumber(forPageNumber);var divToAddOrRemove=currobj.divid;var videosWereDrawn=false;if(currobj!=null)
{for(var d in currobj.interactive)
{var div=$();var elemObj=currobj.interactive[d];if(elemObj.itype=='link')
{if(!$('#'+elemObj.divid).length)
{if(!unloadTHEM)
{div=$(window.drawer.drawLink(elemObj.divid,elemObj.id,elemObj)).appendTo($('#'+divToAddOrRemove));div.css({'z-index':elemObj.zindex||0});div.toggleClass('hidden',elemObj.initially_hidden==1);div.css({'z-index':elemObj.zindex||0});if(elemObj.event_click_actions&&elemObj.event_click_actions.length)
{div.addClass('has_action');}}}
continue;}
if(!unloadTHEM)
{window.f.resetDestkop();if(ide.get(elemObj.holderDivId)==null)
{if(typeof(elemObj.srcHTML)!='undefined')
{elemObj.srcHTML=elemObj.srcHTML.replace('*parentdiv*',divToAddOrRemove);}
if(elemObj.srcHTML!='')
{jtrace('add element',elemObj.srcHTML);div=$(eval(elemObj.srcHTML)).appendTo($('#'+divToAddOrRemove));if(elemObj.event_click_actions&&elemObj.event_click_actions.length)
{div.addClass('has_action');}
div.addClass('element_holder');div.toggleClass('hidden',elemObj.initially_hidden==1);}
try
{if(elemObj.itype==window.ide.itypevideo)
{window.ed.onAfterVideosDrawn(forPageNumber,elemObj.holderDivId);}
if(elemObj.itype==window.ide.itypesoundcloud){ed_soundcloud.clearIntervalAndElementQueue();}}catch(e){}}}
else
{if(ide.get(elemObj.holderDivId)!=null)
{if(window.ide.contain_soundcloud){ed_soundcloud.destroyAllOnPage($('#'+currobj.parentdivid));}
if(elemObj.itype==window.ide.itypeaudio)
{if(ide.get(elemObj.divid)!=null)
{if(!ide.get(elemObj.divid).paused)
{ide.get(elemObj.divid).pause();window.snd.onSoundPlayerSendPercentHeard(false,elemObj.id,elemObj.mp3Title);}
else
{try
{if(ide.get(elemObj.divid).currentTime>0)
{window.snd.onSoundPlayerSendPercentHeard(false,elemObj.id,elemObj.mp3Title);}}catch(e){}}
try
{ide.get(elemObj.divid).src='';ide.get(elemObj.divid).innerHTML='';}catch(e){console.log("ERROR WHILE STOPPING AUDIO -> "+e.message);}}}
try
{if(elemObj.itype==window.ide.itypevideo)
{if((typeof(elemObj.youtubeid)!='undefined')&&(window.youtubestate!=null))
{var vid_title_elem=$(window.youtubestate.target.getIframe()).attr('id').replace('video_current','');var vid_title=$('#'+vid_title_elem).attr('title');var edition_obj_id=vid_title.replace('video','');window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;window.ed.onYoutubeVideoSendPlaybackPercentVal(false,edition_obj_id);window.youtubestate=null;}
else
{window.ed.onVideoCleared('video_current'+elemObj.divid,currobj.id,elemObj.dev_name,elemObj.divid.replace('video',''));}}}catch(e){}
if(ide.get(elemObj.holderDivId).outerHTML!='')
{ide.get(elemObj.holderDivId).outerHTML='';}}}}}},checkLoadedMaterialsForPage:function(forPageNumber,shouldforce){function clearTimer(timer,pagenumber){if(timer){clearTimeout(timer);window['pgLoadTimer_'+pagenumber]=false;}}
var currobj=window.f.findObjFromWindowPgsByPagenumber(forPageNumber);if(currobj!=null)
{var funct_to_call_to=currobj.elemsGetFunct;if(typeof(funct_to_call_to)=='function')
{if(!currobj.elemsGetFunctionCalled)
{currobj.elemsGetFunctionCalled=true;currobj.elemsGetFunct();}}
var timer=window['pgLoadTimer_'+currobj.pagenumber];clearTimer(timer,currobj.pagenumber);if(currobj.pagenumber==window.ide.currentPage||currobj.isparalaxsubpage||((currobj.leftPage==window.ide.currentPage&&currobj.leftPage!=currobj.pagenumber)&&(ide.orientIsBookMode)))
{window['pgLoadTimer_'+currobj.pagenumber]=setTimeout(function(){window.ide.drawPageElements(currobj.pagenumber,false);window.ed.loadPage(currobj.pagenumber,true,shouldforce);if(!ide.orientIsBookMode||!ide.isPagenumberRightPage(currobj.pagenumber))
{window.ide.onChangePage(currobj.pagenumber);}
currobj.pageloaded=true;},500);}
else
{window.ide.drawPageElements(currobj.pagenumber,true);currobj.pageloaded=false;if(!currobj.loadedimage)
{}}}},calculateRatio:function(){if(ide.screenWidth>ide.screenHeight)
{ide.defaultZoomRatio=ide.screenWidth / ide.editionSinglePageWidth;}
else
{ide.defaultZoomRatio=ide.screenWidth / ide.editionSinglePageWidth;}
if(Math.round(ide.editionSinglePageHeight*ide.defaultZoomRatio)>ide.screenHeight)
{ide.defaultZoomRatio=ide.screenHeight / ide.editionSinglePageHeight;}
if(window.ide.orientation==window.ide.landscapeOrient)
{if(ide.orientationModeLandscape==3)
{ide.defaultZoomRatio=ide.screenWidth / ide.editionSinglePageWidth;}
if(ide.orientationModeLandscape==4)
{ide.defaultZoomRatio=ide.screenHeight / ide.editionSinglePageHeight;}}
else if(window.ide.orientation==window.ide.landscapeOrient)
{if(ide.orientationModePortrait==3)
{ide.defaultZoomRatio=ide.screenWidth / ide.editionSinglePageWidth;}
if(ide.orientationModePortrait==4)
{ide.defaultZoomRatio=ide.screenHeight / ide.editionSinglePageHeight;}}
window.ide.defaultPublicationScale=ide.defaultZoomRatio.toFixed(3);window.ide.bestViewZoomFactor=window.ide.scaleOfFullZoom;window.ide.maxScaleFactor=window.ide.scaleOfFullZoom;window.ide.defaultInitialScale=ide.defaultZoomRatio;window.ide.defaultPublicationScale=ide.defaultZoomRatio;window.ed._current_ScreenWidth_withRatio=Math.round(ide.editionSinglePageWidth*ide.defaultZoomRatio);window.ed._current_ScreenHeight_withRatio=Math.round(ide.editionSinglePageHeight*ide.defaultZoomRatio);var tmpRatio=window.ide.defaultInitialScale;window.ed._current_ScreenWidth_withRatio=window.ide.screenWidth;window.ed._current_ScreenWidth=window.ide.screenWidth;window.ed._current_ScreenHeight_withRatio=window.ide.screenHeight;window.ed._current_ScreenHeight=window.ide.screenHeight;window.ide.pageOffsetX=Math.round((ide.screenWidth-window.ed._current_ScreenWidth_withRatio)/2);window.ide.pageOffsetY=Math.round((ide.screenHeight-window.ed._current_ScreenHeight_withRatio)/2);window.scrollTo(0,window.ed.scrollToY);},actualResizePage:function(window_pgs_index){ide.editionSinglePageWidth=ide.originalSinglePageWidth;if(ide.orientIsBookMode)
{ide.editionSinglePageWidth=ide.editionSinglePageWidth*2;}
window.ed.arrPointerArray=new Array();window.ide.calculateRatio();var currobj=window.eddata.pages[window_pgs_index];try
{if(currobj!=null)
{var setToWidth=ide.editionSinglePageWidth;var setToHeight=ide.editionSinglePageHeight;var setToWidth_bookmode=ide.editionSinglePageWidth;if(ide.orientIsBookMode)
{setToWidth_bookmode=ide.originalSinglePageWidth;}
if(window.ide.isPagenumberRightPage(currobj.pagenumber)||currobj.rightPage<1)
{setToWidth=ide.originalSinglePageWidth;}
if(currobj.pagenumber<=1)
{setToWidth=ide.originalSinglePageWidth;}
window.ide.get(ide.mainStageElement).style.width=ide.screenWidth.toString()+'px';window.ide.get(ide.mainStageElement).style.height=ide.screenHeight.toString()+'px';window.ide.get(ide.mainStageElement).style.width=ide.screenWidth.toString()+'px';window.ide.get(ide.mainStageElement).style.height=ide.screenHeight.toString()+'px';if(window.ide.get(currobj.holderdivid)!=null)
{window.ide.get(currobj.holderdivid).style.width=setToWidth.toString()+'px';window.ide.get(currobj.holderdivid).style.height=setToHeight.toString()+'px';}
window.ide.get(currobj.divid).style.width=setToWidth.toString()+'px';window.ide.get(currobj.divid).style.height=setToHeight.toString()+'px';window.ide.get(currobj.dividinner).style.width=setToWidth.toString()+'px';window.ide.get(currobj.dividinner).style.height=setToHeight.toString()+'px';window.ide.get(currobj.dividinner).style.height=setToHeight.toString()+'px';window.ide.get(currobj.pageHTML).style.width=setToWidth.toString()+'px';window.ide.get(currobj.pageHTML).style.height=setToHeight.toString()+'px';window.ide.get(currobj.lowresdiv).style.width=setToWidth_bookmode.toString()+'px';window.ide.get(currobj.lowresdiv).style.height=setToHeight.toString()+'px';window.eddata.pages[window_pgs_index].currentStageWidth=window.ed._current_ScreenWidth_withRatio;window.eddata.pages[window_pgs_index].currentStageHeight=window.ed._current_ScreenHeight_withRatio;if(currobj.pagenumber<=1)
{if(window.ide.firstPageBookMode==1)
{}
else if(window.ide.firstPageBookMode==1)
{}}
if(window.ide.get(currobj.iscrollHolder)!=null)
{window.ide.get(currobj.iscrollHolder).style.width='100%';window.ide.get(currobj.iscrollHolder).style.height='100%';$('#'+currobj.iscrollHolder).css({opacity:1});}
window.eddata.pages[window_pgs_index].currentZoom=ide.defaultZoomRatio;}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3766; column: 207;  :: '+v);console.log("Error while actualResizePage() : index ["+window_pgs_index+"], pagenumber ["+currobj.pagenumber+"], divid["+currobj.divid+"] is undefined ["+e.message+"]");}}};window.ide=ide;})();
;
window.ide.increaseParalaxScroll=function(forscroll){if(window.ide.isparalaxbufferactivated)
{window.ide.paralaxBufferActivePageScroll+=forscroll;var x=window.ide.paralaxCurrentOverlap/100;var bufferBarrier=window.ide.paralaxBufferActivePageScrollStart*(1-(--x)*x*x*x*x*x)*100;if(Math.abs(window.ide.paralaxBufferActivePageScroll)>=Math.abs(bufferBarrier))
{window.ide.isparalaxbufferactivated=false;}}
else
{window.ide.paralaxBufferActivePageScroll=0;window.ide.paralaxScrollY+=forscroll;}};window.ide.resetParalaxToZeroPage=function(pageobj,animobj,anim_easing,anim_time,addpages){if(typeof(addpages)=="undefined")
{var addpages=0;}
window.ed.refreshScreenResolution();var tmpobjm=pageobj;var diffy=((((window.ed.screenHeight-$('#edition-player').position().top)-(window.eddata.head.pageHeight*window.ed.currentScale)))/2);var tmpy=-(window.eddata.head.pageHeight*(tmpobjm.subpageindx+addpages))-(diffy);$(animobj).stop();$(animobj).animate({x:(0).toString()+'px',y:(tmpy).toString()+'px'},anim_time,anim_easing,function(){});return tmpy;};window.ide.positionParalaxPagesStart=function(){if(window.eddata.appearance.edition_style=='facingpages'){return}
try
{var tmppgsarr=ide.loadPagesArray.split(',');for(var d in tmppgsarr)
{if(!isNaN(parseInt(tmppgsarr[d])))
{var curpgobj=window.f.findObjFromWindowPgsByPagenumber(parseInt(tmppgsarr[d]));if((curpgobj.ismainparalaxpage)||(curpgobj.isparalaxsubpage))
{window.eddata.pages[curpgobj.arrindex].paralaxY=parseFloat($('#'+curpgobj.holderdivid).css('y').toString().replace('px',''));}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3779; column: 264;  :: '+v);}};window.ide.positionParalaxPagesEnd=function(init){if(window.eddata.appearance.edition_style=='facingpages'){return}
try
{var tmppgsarr=ide.loadPagesArray.split(',');for(var d in tmppgsarr)
{if(!isNaN(parseInt(tmppgsarr[d])))
{var curpgobj=window.f.findObjFromWindowPgsByPagenumber(parseInt(tmppgsarr[d]));var curpgobjMain=curpgobj;if((curpgobj.ismainparalaxpage)||(curpgobj.isparalaxsubpage))
{if(curpgobj.isparalaxsubpage)
{curpgobjMain=window.f.findObjFromWindowPgsByPagenumber(curpgobj.mainPageId);}
if(curpgobjMain.paralaxallages.indexOf(','+window.ide.currentPage+',')>=0)
{paralaxY=parseFloat($('#'+curpgobj.holderdivid).css('y').toString().replace('px',''));;}
else
{if(init)
{paralaxY=0;}
else
{paralaxY=parseFloat($('#'+curpgobj.holderdivid).css('y').toString().replace('px',''));;}}
window.eddata.pages[curpgobj.arrindex].paralaxY=paralaxY;}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 3793; column: 195;  :: '+v);}};window.ide.paralaxPagesInitiate=function(pageobj){if((pageobj.ismainparalaxpage)||(pageobj.isparalaxsubpage))
{var mainpobj=pageobj;if(pageobj.isparalaxsubpage)
{mainpobj=window.f.findObjFromWindowPgsByPagenumber(pageobj.mainPageId);}
if(mainpobj!=null)
{if(mainpobj.ismainparalaxpage)
{var htmltoadd=window.drawer.drawpscrollholder(pageobj);}}}};window.ide.iscurrentpagesubpageofparalax=function(currobj){var preventFree=false;if(currobj.ismainparalaxpage)
{if(currobj.paralaxallages.indexOf(','+window.ide.currentPage.toString()+',')>=0)
{preventFree=true;}}
return preventFree;};
;
window.ide.handleMovingPages=function(moveX,moveY,useSubpages,paralaxX,paralaxY,onlyoncerun,listanjex,listanjey){if(typeof(onlyoncerun)=="undefined")
{var onlyoncerun=false;}
var isParalax=false;var allparalaxpageszindexdefault=99;var paralax_anim_time=0;if(window.ide.contain_paralax_pages&&((paralaxX>-9999)||(paralaxY>-9999)))
{isParalax=true;paralax_anim_time=250;}
if(window.ide.page_transition_type==1)
{window.ed.clickwasusedtogotopage=false;window.ed.washandlingMovingPages=true;return false;}
var reference_page=ide.currentPage;window.ide.checkcounterindex++;var currobj=window.f.findObjFromWindowPgsByPagenumber(ide.currentPage);if((!useSubpages)&&(currobj.isparalaxsubpage))
{currobj=window.f.findObjFromWindowPgsByPagenumber(currobj.mainPageId);reference_page=currobj.mainPageId;}
try
{var tmpobj=currobj;if(currobj.isparalaxsubpage)
{tmpobj=window.f.findObjFromWindowPgsByPagenumber(currobj.mainPageId);}
if(tmpobj.ismainparalaxpage)
{window.ed.currentScale=tmpobj.iscroll[0].scale;}}catch(e){}
if((!useSubpages)&&((currobj.isparalaxsubpage)||(currobj.isswipesubpage)||(currobj.isfadeinsubpage)))
{reference_page=currobj.mainPageId;}
var prevobj=window.f.findPreviousObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);var nextobj=window.f.findNextObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);try
{var nextobj2=null;nextobj2=window.f.findNextObjFromWindowPgsByPageNumber(nextobj.pagenumber,useSubpages,true);}catch(e){nextobj2=null;}
var prev_diffX=moveX;var prev_diffY=moveY;var next_diffX=moveX;var next_diffY=moveY;var abandonManipulationPREV=false;var abandonManipulationNEXT=false;if(useSubpages)
{if(currobj.islastsubpage)
{abandonManipulationNEXT=true;}
if(currobj.ismainpage)
{abandonManipulationPREV=true;}}
var anim_time=0;if(paralax_anim_time!=0)
{var anim_time=paralax_anim_time;}
var actualtoppposToY_PREV=0;var actualtoppposToY_NEXT=0;var anim_easing='linear';window.ide.validationnum++;if(isParalax){window.ide.paralax_mv(currobj,prevobj,nextobj,onlyoncerun,allparalaxpageszindexdefault,paralaxX,paralaxY,useSubpages,prev_diffX,prev_diffY,next_diffX,next_diffY,abandonManipulationPREV,abandonManipulationNEXT,actualtoppposToY_PREV,actualtoppposToY_NEXT,moveX,moveY);}
else
{if(!window.ide.eventDragStartcalled)
{window.ide.eventDragStartcalled=true;window.edPageDragStarted();}
if(prevobj!=null)
{if((prevobj.isswipesubpage)||(useSubpages))
{prev_diffY=prev_diffY-ide.screenHeight;}
else
{prev_diffX=prev_diffX-ide.screenWidth;}
if(prev_diffX<=-ide.screenWidth)
{abandonManipulationPREV=true;}}
if(nextobj!=null)
{if((nextobj.isswipesubpage)||(useSubpages))
{next_diffY=next_diffY+ide.screenHeight;}
else
{next_diffX=next_diffX+ide.screenWidth;}
if(next_diffX>=ide.screenWidth)
{abandonManipulationNEXT=true;}}
if((prevobj!=null)&&(!abandonManipulationPREV))
{if(ide._prevId===undefined||ide._prevId!=prevobj.id)
{ide._prevId=prevobj.id;ide._prevSelector=$('#'+prevobj.iscrollHolder);}
if(window.ed.isIeTouch)
{ide._prevSelector.stop(true,true).transStop().transition({x:prev_diffX,y:prev_diffY},anim_time,anim_easing);}
else
{if(ide.pageflip){if(pgfl.pageflip_direction<0){window.pgfl.pg_currobj=currobj;window.pgfl.pg_nextobj=nextobj;window.pgfl.pg_prevobj=prevobj;window.pgfl.listanje_nazaj_korak(currobj,prevobj,listanjex,listanjey);}else{window.pgfl.moving_zgoraj_na_strani_levo_oz_desno(listanjex,listanjey);}}else{var css_jq={x:prev_diffX,y:prev_diffY};if(currobj.isfadeinsubpage){css_jq.display='block';css_jq.opacity=1;}
ide._prevSelector.stop().transStop().css(css_jq);}}}
if((nextobj!=null)&&(!abandonManipulationNEXT))
{if(ide._nextId===undefined||ide._nextId!=nextobj.id)
{ide._nextId=nextobj.id;ide._nextSelector=$('#'+nextobj.iscrollHolder);}
if(window.ed.isIeTouch)
{ide._nextSelector.stop(true,true).transStop().transition({x:next_diffX,y:next_diffY},anim_time,anim_easing);}
else
{if(ide.pageflip){if(pgfl.pageflip_direction>0){window.pgfl.pg_currobj=currobj;window.pgfl.pg_nextobj=nextobj;window.pgfl.pg_prevobj=prevobj;window.pgfl.listanje_naprej_korak(currobj,nextobj,listanjex,listanjey);}else{window.pgfl.moving_zgoraj_na_strani_levo_oz_desno(listanjex,listanjey);}}else{var css_jq={x:next_diffX,y:next_diffY};if(currobj.isfadeinsubpage&&!currobj.islastfadeinsubpage){css_jq.display='block';css_jq.opacity=1;}
ide._nextSelector.stop().transStop().css(css_jq);}}}
if(currobj!=null)
{if(ide._curId===undefined||ide._curId!=currobj.id)
{ide._curId=currobj.id;ide._curSelector=$('#'+currobj.iscrollHolder);}
if(window.ed.isIeTouch)
{ide._curSelector.stop(true,true).transStop().transition({x:moveX,y:moveY},anim_time,anim_easing);}
else
{if(ide.pageflip){}else{ide._curSelector.stop().transStop().css({x:moveX,y:moveY});}}}}
window.ed.clickwasusedtogotopage=false;window.ed.washandlingMovingPages=true;};
;
window.ide.paralax_mv=function(currobj,prevobj,nextobj,onlyoncerun,allparalaxpageszindexdefault,paralaxX,paralaxY,useSubpages,prev_diffX,prev_diffY,next_diffX,next_diffY,abandonManipulationPREV,abandonManipulationNEXT,actualtoppposToY_PREV,actualtoppposToY_NEXT,moveX,moveY){var nextobj2=null;var forceNextYWhileActive=999;var diffy=((((window.ed.screenHeight-$('#edition-player').position().top)-(window.eddata.head.pageHeight*window.ed.currentScale))/2));if(window.ide.paralaxScrollY>0)
{window.ide.paralaxScrollY=0;}
var actualtoppposToYMain=0;try
{var manimobjp='#'+prevobj.holderdivid;}catch(e){}
var isendofparalax=false;if(currobj.islastsubpage)
{abandonManipulationNEXT=true;if(moveY<=0)
{window.ide.paralaxScrollY=-ed.paralaxmaxscrolly;}}
if(actualtoppposToYMain>0)
{actualtoppposToYMain=0;}
var animatedPages={prev:prevobj?prevobj.arrindex:-1,cur:currobj?currobj.arrindex:-1,next:nextobj?nextobj.arrindex:-1};if(currobj.ismainparalaxpage){if(typeof(currobj.paralaxpgcount)!='undefined')
{window.ed.allparalaxpagescount=currobj.paralaxpgcount+1;}}
var resobj=window.f.processParalaxY(actualtoppposToYMain,currobj.poverlap,0,currobj.subpageindx,window.ide.paralaxScrollY,currobj,animatedPages);var pMainVisible=resobj.p;actualtoppposToYMain=resobj.y;if(window.ide.paralaxScrollY==0)
{actualtoppposToYMain=0;}
window.ide.paralaxCurrentOverlap=currobj.poverlap;if((actualtoppposToYMain<=0)&&(!isendofparalax))
{window.ide.lastcorrectparalaxY=window.ide.paralaxScrollY;var force_anim=true;anim_time=300;anim_easing='easeOutQuad';if(window.ide.paralaxCurrentOverlap<5)
{}
if((prevobj!=null)&&(!abandonManipulationPREV))
{var actualtoppposToY=prevobj.paralaxY+prev_diffY;actualtoppposToY_PREV=actualtoppposToY;var resobj=window.f.processParalaxY(actualtoppposToY_PREV,prevobj.poverlap,2,prevobj.subpageindx,window.ide.paralaxScrollY,prevobj,animatedPages);var pPrevVisible=resobj.p;actualtoppposToY_PREV=resobj.y;if(actualtoppposToYMain==0){actualtoppposToY_PREV=0;pPrevVisible=0;}
if(actualtoppposToY_PREV<actualtoppposToYMain)
{actualtoppposToY_PREV=actualtoppposToYMain;}
$(manimobjp).stop(true);$(manimobjp).animate({x:(prev_diffX).toString()+'px',y:(actualtoppposToY_PREV).toString()+'px'},anim_time,anim_easing,function(){});}
try
{var manimobjn='#'+nextobj.holderdivid;}catch(e){}
if((nextobj!=null)&&(!abandonManipulationNEXT))
{var actualtoppposToY=nextobj.paralaxY+next_diffY;if(actualtoppposToY>actualtoppposToYMain)
{actualtoppposToY=actualtoppposToYMain;}
actualtoppposToY_NEXT=actualtoppposToY;var resobj=window.f.processParalaxY(actualtoppposToY_NEXT,nextobj.poverlap,1,nextobj.subpageindx,window.ide.paralaxScrollY,nextobj,animatedPages);var pNextVisible=resobj.p;actualtoppposToY_NEXT=resobj.y;if((actualtoppposToY_NEXT>actualtoppposToYMain)||(actualtoppposToYMain>=0))
{actualtoppposToY_NEXT=actualtoppposToYMain;}
var zIndexNext=allparalaxpageszindexdefault;if(nextobj.isparalaxsubpage)
{zIndexNext=allparalaxpageszindexdefault+nextobj.subpageindx;}
$(manimobjn).css({'z-index':(zIndexNext).toString()});$(manimobjn).stop(true,false);$(manimobjn).animate({x:(next_diffX).toString()+'px',y:(actualtoppposToY_NEXT).toString()+'px'},anim_time,anim_easing,function(){});}
try
{var manimobjc='#'+currobj.holderdivid;}catch(e){}
if(currobj!=null)
{var shouldscroll=true;var zIndexCurrnt=allparalaxpageszindexdefault;if(currobj.isparalaxsubpage)
{zIndexCurrnt=allparalaxpageszindexdefault+currobj.subpageindx;}
$(manimobjc).css({'z-index':(zIndexCurrnt).toString()});if(shouldscroll)
{$(manimobjc).stop(true,false);$(manimobjc).animate({x:(moveX).toString()+'px',y:(actualtoppposToYMain).toString()+'px'},anim_time,anim_easing,function(){});}
if(window.ide.isparalaxbufferactivated)
{var returnYCurrent=window.ide.resetParalaxToZeroPage(currobj,manimobjc,anim_easing,anim_time);window.ide.paralaxScrollY=returnYCurrent;forceNextYWhileActive=returnYCurrent-window.eddata.head.pageHeight;}}
if((nextobj!=null)&&(!abandonManipulationNEXT))
{var active_page_on=(window.eddata.head.pageHeight*(nextobj.subpageindx-1))+((window.eddata.head.pageHeight / 6)*6);var checkY=Math.abs(actualtoppposToY_NEXT);if(window.ide.isparalaxbufferactivated)
{var returnYCurrent=window.ide.resetParalaxToZeroPage(nextobj,manimobjn,anim_easing,anim_time,-1);}
if((pNextVisible>=-0.03))
{actualtoppposToY_NEXT=window.ide.resetParalaxToZeroPage(nextobj,manimobjn,anim_easing,anim_time);window.f.nextPage(true);window.f.oncustompagechange();window.ide.isparalaxbufferactivated=true;if(!onlyoncerun)
{window.ide.handleMovingPages(moveX,moveY,useSubpages,paralaxX,paralaxY,true);}
if(window.ide.paralaxCurrentOverlap<5)
{window.ide.isparalaxbufferactivated=false;}}}
if((prevobj!=null)&&(!abandonManipulationPREV))
{var active_page_on=(window.eddata.head.pageHeight*(prevobj.subpageindx-1))+((window.eddata.head.pageHeight / 6)*6);var checkY=Math.abs(actualtoppposToY_NEXT);if(active_page_on<=0)
{active_page_on=100;}
if((pPrevVisible<=0.03))
{window.ide.resetParalaxToZeroPage(prevobj,manimobjp,anim_easing,anim_time);window.f.previousPage(true);window.f.oncustompagechange();window.ide.isparalaxbufferactivated=true;if(!onlyoncerun)
{window.ide.handleMovingPages(moveX,moveY,useSubpages,paralaxX,paralaxY,true);}
if(window.ide.paralaxCurrentOverlap<5)
{window.ide.isparalaxbufferactivated=false;}}}
var currentparalaxPages='';var mainpageid=-1;if(!currobj.ismainparalaxpage)
{var pgobj=window.f.findObjFromWindowPgsByPagenumber(currobj.mainPageId);if(pgobj.ismainparalaxpage)
{currentparalaxPages=pgobj.paralaxallages;mainpageid=pgobj.mainPageId;}}
else
{currentparalaxPages=currobj.paralaxallages;mainpageid=currobj.pagenumber;}
currentparalaxPages+=','+mainpageid.toString()+',';try
{currentparalaxPages=currentparalaxPages.replace(','+prevobj.pagenumber.toString()+',','');}catch(e){}
try
{currentparalaxPages=currentparalaxPages.replace(','+nextobj.pagenumber.toString()+',','');}catch(e){}
try{currentparalaxPages=currentparalaxPages.replace(','+currobj.pagenumber.toString()+',','');}catch(e){}
if(forceNextYWhileActive!=999)
{}
var tmparrother=currentparalaxPages.split(',');for(var d in tmparrother)
{var toy=0;var tmppage=window.f.findObjFromWindowPgsByPagenumber(parseInt(tmparrother[d]));if(tmppage!=null)
{if(tmppage.pagenumber<currobj.pagenumber)
{toy=actualtoppposToY_PREV;}
else if(tmppage.pagenumber>currobj.pagenumber)
{toy=actualtoppposToY_NEXT;}
var animobj='#'+tmppage.holderdivid;$(animobj).stop();$(animobj).animate({x:(moveX).toString()+'px',y:(toy).toString()+'px'},anim_time,anim_easing,function(){});}}
window.ed.updatedragscroller();}}
;
window.ide.evalReturnObj=function(){var HTML_parentPageId=-1;var HTML_subpageindex=0;var HTML_ismainpage=false;var HTML_previous_main_page_id=0;var mainparalaxpageindex=-1;var HTML_previous_main_pageobject_id=0;var pagenumber=1;var previous_mobile_id=-1;var numofppages=0;var currnt_paralax_overlap=-1;for(var d in window.eddata.pages){var currobj=window.eddata.pages[d];window.eddata.pages[d].isswipesubpage=false;window.eddata.pages[d].isfadeinsubpage=false;window.eddata.pages[d].multi_group_subpages=false;window.eddata.pages[d].isfadeinsub2page=false;window.eddata.pages[d].isparalaxsubpage=false;window.eddata.pages[d].ismainparalaxpage=false;window.eddata.pages[d].ismainpage=true;window.eddata.pages[d].poverlap=-1;window.eddata.pages[d].paralaxY=0;window.eddata.pages[d].pagenumber=pagenumber;pagenumber++;window.eddata.pages[d].arrindex=parseInt(d);window.eddata.pages[d].zoom=window.eddata.pages[d].zoom!=0;try
{window.eddata.pages[d].linksOnPage=currobj.links.length;}catch(e){window.eddata.pages[d].linksOnPage=0;}
window.eddata.pages[d].linksAreTransparent=true;window.eddata.pages[d].uselinks=true;window.eddata.pages[d].styleElem=new Array();window.eddata.pages[d].scriptElemCUSTOM=new Array();window.eddata.pages[d].scriptElem=new Array();window.eddata.pages[d].isBlankPGS=false;window.eddata.pages[d].paralaxallages='';window.eddata.pages[d].contentloaded=false;window.eddata.pages[d].hidden=window.eddata.pages[d].transition=='hidden';window.eddata.pages[d].iscrollHolder='iscrollholder'+d.toString();window.eddata.pages[d].offeredUHD=false;if((d%2==0)&&(d>0))
{window.eddata.pages[d].leftPage=parseInt(currobj.pagenumber)-1;window.eddata.pages[d].rightPage=parseInt(currobj.pagenumber);}
else if(d>0)
{window.eddata.pages[d].leftPage=parseInt(currobj.pagenumber);var rightPage=parseInt(currobj.pagenumber)+1;if(rightPage>window.eddata.pages.length){rightPage=-1}
window.eddata.pages[d].rightPage=rightPage;}
else if(d==0)
{window.eddata.pages[d].leftPage=parseInt(d+1);window.eddata.pages[d].rightPage=-1;}
if(window.eddata.appearance.edition_style!='facingpages')
{if(currobj.subpage==1)
{window.eddata.pages[d].isswipesubpage=true;window.eddata.pages[d].ismainpage=false;}
if((currobj.subpage==1)&&(currobj.transition=="fadein"))
{window.eddata.pages[d].isfadeinsubpage=true;window.eddata.pages[d].isswipesubpage=false;window.eddata.pages[d].ismainpage=false;HTML_ismainpage=false;}
if((currobj.subpage==1)&&(currobj.transition=="parallax"))
{window.eddata.pages[d].isfadeinsubpage=false;window.eddata.pages[d].isswipesubpage=false;window.eddata.pages[d].isparalaxsubpage=true;window.eddata.pages[d].ismainpage=false;window.eddata.pages[d].poverlap=currnt_paralax_overlap;window.eddata.pages[mainparalaxpageindex].paralaxallages+=','+window.eddata.pages[d].pagenumber+',';numofppages++;window.eddata.pages[mainparalaxpageindex].paralaxpgcount=numofppages;HTML_ismainpage=false;}}
if((window.eddata.pages[d].ismainpage)&&(!window.eddata.pages[d].hidden))
{mainparalaxpageindex=-1;numofppages=0;HTML_parentPageId=d;HTML_subpageindex=0;HTML_ismainpage=true;if(typeof(window.eddata.pages[d].transition_params)!='undefined')
{if(typeof(window.eddata.pages[d].transition_params.paralax_overlap)!='undefined')
{currnt_paralax_overlap=parseInt(window.eddata.pages[d].transition_params.paralax_overlap);}
else
{currnt_paralax_overlap=-1;}}
else
{currnt_paralax_overlap=-1;}
if(currnt_paralax_overlap>-1)
{window.eddata.pages[d].poverlap=currnt_paralax_overlap;mainparalaxpageindex=d;window.eddata.pages[d].ismainparalaxpage=true;}}
else
{if(!window.eddata.pages[d].hidden)
{HTML_subpageindex+=1;}
HTML_ismainpage=false;}
if(d==0)
{HTML_ismainpage=true;}
if(HTML_ismainpage)
{HTML_previous_main_page_id=currobj.pagenumber;HTML_previous_main_pageobject_id=currobj.id;}
window.eddata.pages[d].mainPageId=HTML_previous_main_page_id;window.eddata.pages[d].mainPageObjectId=HTML_previous_main_pageobject_id;window.eddata.pages[d].holderdivid='pagesholderparent'+d.toString();window.eddata.pages[d].loadedimage=false;window.eddata.pages[d].loadedimageHD=false;window.eddata.pages[d].lowresdiv='lowres'+d.toString();window.eddata.pages[d].spreadsleftpageholder='pagesholderparent'+(window.eddata.pages[d].leftPage-1).toString();window.eddata.pages[d].pageHTML='pageHTML'+d.toString();window.eddata.pages[d].dividinner='pageHTMLDiv'+d.toString()+'Inner';window.eddata.pages[d].pageElementsLoaded=false;window.eddata.pages[d].elemsGetFunctionCalled=false;window.eddata.pages[d].pageloaded=false;window.eddata.pages[d].iscurrentlyloadingpagebackground=false;window.eddata.pages[d].islastswipepage=false;window.eddata.pages[d].islastMainPageButNotSwipePage=false;window.eddata.pages[d].parentdivid='pageHTMLDiv'+HTML_parentPageId.toString();window.eddata.pages[d].maindivid='pageHTMLDiv'+HTML_parentPageId.toString();window.eddata.pages[d].maindividinner='pageHTMLDiv'+HTML_parentPageId.toString()+'Inner';window.eddata.pages[d].linksDiv='pageHTMLDiv'+d.toString()+'Links';window.eddata.pages[d].currentZoom=0;window.eddata.pages[d].currentStageWidth=0;window.eddata.pages[d].currentStageHeight=0;window.eddata.pages[d].subpageindx=HTML_subpageindex;window.eddata.pages[d].islastpage=false;window.eddata.pages[d].isfirstpage=false;window.eddata.pages[d].islastsubpage=false;window.eddata.pages[d].islastfadeinsubpage=false;window.eddata.pages[d].fadeinsubpageParent=-1;window.eddata.pages[d].scaled=false;window.eddata.pages[d].ishiddenbecauseoffadeinsubpage=false;window.eddata.pages[d].isfadeinvisible=false;window.eddata.pages[d].iscroll=null;window.eddata.pages[d].divid='pageHTMLDiv'+d.toString();window.eddata.pages[d].hasSubpages=false;window.eddata.pages[d].linksFunction='';window.eddata.pages[d].subpagespagenumberarr='';window.eddata.pages[d].ismainpage=HTML_ismainpage;window.eddata.pages[d].pageElemsVideos=new Array();window.eddata.pages[d].pagesElemstextblockes=new Array();window.eddata.pages[d].imageObj=null;window.eddata.pages[d].pagesElemsGalleries=new Array();if(window.eddata.pages[d].mob_page_id>0)
{var mobile_obj=window.eddata.pages_mobile[window.eddata.pages[d].mob_page_id];if(previous_mobile_id!=window.eddata.pages[d].mob_page_id)
{previous_mobile_id=window.eddata.pages[d].mob_page_id;if(typeof(mobile_obj.mobile_sef)!='undefined')
{if(mobile_obj.mobile_sef!='')
{window.eddata.pages[d].additional_sef.push(mobile_obj.mobile_sef);}}}}
window.eddata.pages[d].srcHTML='window.drawer.drawBasePageStructure('+d.toString()+');';if(!window.eddata.pages[d].interactive)
{window.eddata.pages[d].interactive=[];}
$.each(window.eddata.pages[d].links,function(i,link)
{link.itype='link';window.eddata.pages[d].interactive.push(link);});if(typeof(window.eddata.pages[d].interactive)!='undefined')
{var active_only_imgs={};for(var c in window.eddata.pages[d].interactive)
{var tmpobj=window.eddata.pages[d].interactive[c];if(tmpobj.itype==window.ide.itypelink){if(typeof(tmpobj.activeOnObjId)!=='undefined'){var img_id=tmpobj.activeOnObjId+'';img_id=img_id.trim();if(img_id!=''){if(typeof(active_only_imgs[img_id])=='undefined'){active_only_imgs[img_id]=[];}
active_only_imgs[img_id].push({id:tmpobj.id,divid:'div'+tmpobj.id.toString()});}}}}
for(var c in window.eddata.pages[d].interactive)
{var tmpobj=window.eddata.pages[d].interactive[c];var parent_index=d.toString();var interactive_index=c.toString();switch(tmpobj.itype){case window.ide.itypelink:window.eddata.pages[d].interactive[c].divid='div'+window.eddata.pages[d].interactive[c].id.toString();window.eddata.pages[d].interactive[c].zindex=c;break;case window.ide.itypeimage:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawImage('+d.toString()+','+c.toString()+',\'*parentdiv*\');';if(typeof(active_only_imgs[tmpobj.id])!=='undefined'){window.eddata.pages[d].interactive[c].active_only_links=active_only_imgs[tmpobj.id];}
break;case window.ide.itypevideo:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawVideo('+d.toString()+','+c.toString()+',\'*parentdiv*\');';break;case window.ide.itypegallery:var elData=window.eddata.pages[d].interactive[c];var galType=(elData.additional_params||{}).gallery_type||'';if(galType=='threesixty')
{elData.itype='threesixty';elData.srcHTML='window.drawer.drawThreesixty('+d.toString()+','+c.toString()+',\'*parentdiv*\');';}
else
{elData.srcHTML='window.drawer.drawGallery('+d.toString()+','+c.toString()+',\'*parentdiv*\');';}
break;case window.ide.itypetextblock:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawtextblock('+d.toString()+','+c.toString()+',\'*parentdiv*\');';break;case window.ide.itypeaudio:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawAudio('+d.toString()+','+c.toString()+',\'*parentdiv*\');';break;case window.ide.itypesoundcloud:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawSoundCloud('+parent_index+','+interactive_index+',\'*parentdiv*\');';break;case window.ide.itypeiframe:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawIframe('+parent_index+','+interactive_index+',\'*parentdiv*\');';break;case window.ide.itypecode:window.eddata.pages[d].interactive[c].srcHTML='window.drawer.drawCode('+parent_index+','+interactive_index+',\'*parentdiv*\');';break;}}}}
var fadeint_parent_pg=-1;for(var d in window.eddata.pages){if(!window.eddata.pages[d].isfadeinsubpage){fadeint_parent_pg=window.eddata.pages[d].id;}
window.eddata.pages[d].fadeinsubpageParent=fadeint_parent_pg;var d0=parseInt(d,10);var multi_subpage=false;if(window.eddata.pages[d0].ismainpage){for(var d2=d0+1;d2<window.eddata.pages.length;d2++){if(!window.eddata.pages[d2].isfadeinsubpage&&!window.eddata.pages[d2].ismainpage){multi_subpage=true;}
if((window.eddata.pages[d2].ismainpage)||(d2==window.eddata.pages.length-1)){if(window.eddata.pages[d2-1].isfadeinsubpage&&window.eddata.pages[d2].ismainpage){window.eddata.pages[d2-1].islastfadeinsubpage=true;}
if(multi_subpage){if((d2==window.eddata.pages.length-1)&&(!window.eddata.pages[d2].ismainpage)){d2=window.eddata.pages.length;}
for(var d3=d0;d3<=d2-1;d3++){window.eddata.pages[d3].multi_group_subpages=true;}}
break;}}}}
window.ide.addLoaderAndAllMainStageElements();};
;
window.ide.setDisplayBlockAndDisplayNonePages=function(animate,makedefaultzoom,put_to_starting_pos){var startShowPages=window.ide.drawPagesFrom;var endShowPages=window.ide.drawPagesTo;if(typeof(put_to_starting_pos)=='undefined')
{var put_to_starting_pos=true;}
if(typeof(makedefaultzoom)=='undefined')
{var makedefaultzoom=true;}
if(!animate)
{makedefaultzoom=true;}
var is_fadein_transition_currently=false;if(window.ide.page_transition_type==1)
{is_fadein_transition_currently=true;}
var current_pgs_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);try
{if(current_pgs_obj.isfadeinsubpage)
{is_fadein_transition_currently=true;}}catch(e){}
for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if((ide.loadPagesArray.indexOf(','+currobj.pagenumber.toString()+',')>0)||(current_pgs_obj.pagenumber==currobj.pagenumber)||(current_pgs_obj.rightPage==currobj.pagenumber))
{if(!currobj.iscurrentlyloadingpagebackground)
{if(window.ide.get(currobj.iscrollHolder)!=null)
{if(window.ide.get(currobj.iscrollHolder).display!=window.ide.showDisplayType)
{$('#'+currobj.iscrollHolder).stop(true,false);var setToPosX=0;var setToPosY=0;var dosetInitialFadein=false;if(currobj.pagenumber<window.ide.currentPage)
{setToPosX=-window.ide.screenWidth;dosetInitialFadein=true;}
else if(currobj.pagenumber>window.ide.currentPage)
{setToPosX=window.ide.screenWidth;dosetInitialFadein=true;}
if(((currobj.isswipesubpage)&&(currobj.pagenumber>window.ide.currentPage)))
{setToPosY=window.ide.screenHeight;dosetInitialFadein=true;}
if(((currobj.isswipesubpage)&&(currobj.pagenumber<window.ide.currentPage)))
{setToPosY=-window.ide.screenHeight;dosetInitialFadein=true;}
if((current_pgs_obj.mainPageId==currobj.mainPageId)&&(currobj.pagenumber<window.ide.currentPage))
{if(!is_fadein_transition_currently)
{setToPosX=0;setToPosY=-(ide.screenHeight);}
dosetInitialFadein=true;}
if((current_pgs_obj.mainPageId==currobj.mainPageId)&&(currobj.pagenumber>window.ide.currentPage))
{if(!is_fadein_transition_currently)
{setToPosX=0;setToPosY=(ide.screenHeight);}
dosetInitialFadein=true;}
if((currobj.isparalaxsubpage)||(currobj.ismainparalaxpage))
{setToPosY=0;dosetInitialFadein=false;}
if(put_to_starting_pos)
{var is_current_page_this_one=false;if((currobj.pagenumber==window.ide.currentPage)||((window.ide.currentPage==currobj.leftPage)&&(ide.orientIsBookMode)))
{is_current_page_this_one=true;}
if((is_fadein_transition_currently)&&(dosetInitialFadein))
{$('#'+currobj.iscrollHolder).stop(true,false).css({opacity:0.0001,x:setToPosX.toString()+'px',y:setToPosY.toString()+'px',display:window.ide.showDisplayType});}
else
{$('#'+currobj.iscrollHolder).stop(true,false).css({x:setToPosX.toString()+'px',y:setToPosY.toString()+'px',display:window.ide.showDisplayType});}
if(currobj.iscroll!=null)
{if(currobj.iscroll[0]!=null)
{currobj.iscroll[0].refresh();}}}
else
{if((currobj.ismainparalaxpage)||(currobj.isparalaxsubpage))
{var css_obj={x:setToPosX.toString()+'px',y:'0px',display:window.ide.showDisplayType}
$('#'+currobj.iscrollHolder).stop(true,false).css(css_obj);}
else
{if((is_fadein_transition_currently)&&(dosetInitialFadein))
{$('#'+currobj.iscrollHolder).stop(true,false).css({x:setToPosX.toString()+'px',y:setToPosY.toString()+'px',opacity:0.00001,display:window.ide.showDisplayType});}
else
{$('#'+currobj.iscrollHolder).stop(true,false).css({x:setToPosX.toString()+'px',y:setToPosY.toString()+'px',display:window.ide.showDisplayType});}}}}
if(put_to_starting_pos)
{ide.checkLoadedMaterialsForPage(currobj.pagenumber);if(ide.orientIsBookMode)
{if(currobj.pagenumber>1)
{if(!ide.isPagenumberRightPage(currobj.pagenumber))
{ide.checkLoadedMaterialsForPage(currobj.rightPage);}}}
if((currobj.pagenumber==window.ide.currentPage)||((window.ide.currentPage==currobj.leftPage)||(window.ide.currentPage==currobj.rightPage)&&(ide.orientIsBookMode)))
{}
else
{var preventFree=window.ide.contain_paralax_pages&&window.ide.iscurrentpagesubpageofparalax(currobj);if(!preventFree)
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).css({display:window.ide.displayNoneType});ide.freePage(currobj.pagenumber);if((!ide.isPagenumberRightPage(currobj.pagenumber))&&(ide.orientIsBookMode))
{}}}}}}
else
{var preventFree=window.ide.contain_paralax_pages&&window.ide.iscurrentpagesubpageofparalax(currobj);if(!preventFree)
{if(window.ide.get(currobj.iscrollHolder)!=null)
{if((currobj.pagenumber!=window.ide.currentPage)&&((window.ide.currentPage!=currobj.leftPage)||(!ide.orientIsBookMode)))
{if(window.ide.get(currobj.iscrollHolder).display!=window.ide.displayNoneType)
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).css({display:window.ide.displayNoneType});ide.freePage(currobj.pagenumber);}}}
else if((ide.isPagenumberRightPage(currobj.pagenumber))&&(ide.orientIsBookMode))
{if(currobj.leftPage!=window.ide.currentPage)
{ide.freePage(currobj.pagenumber);}}}}}
else
{var preventFree=window.ide.contain_paralax_pages&&window.ide.iscurrentpagesubpageofparalax(currobj);if(!preventFree)
{if((window.ide.get(currobj.iscrollHolder)!=null)&&(put_to_starting_pos))
{ide.freePage(currobj.pagenumber);}
else if((ide.isPagenumberRightPage(currobj.pagenumber))&&(ide.orientIsBookMode)&&(put_to_starting_pos))
{ide.freePage(currobj.pagenumber);}}}}};
;
window.ide.positionPages=function(from_page,current_page,animate,do_reset_everything,ignoreCheckingPageTransition){ide.setPagesFromAndPagesTo(current_page);var isOddPageAnimation=false;if(typeof(ignoreCheckingPageTransition)=='undefined')
{var ignoreCheckingPageTransition=false;}
if((animate)&&(!ignoreCheckingPageTransition))
{if(!ide.orientIsBookMode)
{if(window.ide.isAnimatedTransitionFromMainToAnotherSub(from_page,current_page,animate,do_reset_everything))
{isOddPageAnimation=true;}}}
if(typeof(do_reset_everything)=='undefined')
{var do_reset_everything=true;}
if(typeof(makedefaultzoom)=='undefined')
{var makedefaultzoom=true;}
var currpage_objpgs=window.f.findObjFromWindowPgsByPagenumber(current_page);window.ide.currentPageObjPgs=currpage_objpgs;if(ide.get(currpage_objpgs.iscrollHolder)==null)
{ide.addAndRemoveActualPagesStructure(current_page,from_page);}
if(currpage_objpgs.isfadeinsubpage)
{window.ide.initHandlers(window.ide.currentPage,makedefaultzoom);}
var current_drawing_pages_arr=ide.getCurrentPagesRedrawArray(current_page,window.ide.previousPage);var startShowPages=window.ide.drawPagesFrom;var endShowPages=window.ide.drawPagesTo;var animTime=0;var animEasing='linear';window.ide.checkcounterindex++;var endFunction=(function(from_page,current_page,animate,makedefaultzoom,checkcounterindex){var fired=false;return function(){window.setTimeout(function(){if(fired==false&&checkcounterindex==window.ide.checkcounterindex){window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded(from_page.toString(),current_page.toString(),animate.toString(),makedefaultzoom.toString());}
fired=true;},100);}})(from_page,current_page,animate,makedefaultzoom,window.ide.checkcounterindex);var currpage_objpgs_main_if_currobj_is_subpage={pagenumber:-10};var prev_page_obj={'mainPageId':-1,'ismainpage':false,'isswipesubpage':false,'isfadeinsubpage':false,'isfadeinsubpage2':false,'fadeinsubpageParent':-1};if((from_page>-1)&&(from_page!=current_page))
{prev_page_obj=window.f.findObjFromWindowPgsByPagenumber(from_page);}
if((currpage_objpgs.isswipesubpage)||(currpage_objpgs.isparalaxsubpage))
{currpage_objpgs_main_if_currobj_is_subpage=window.f.findObjFromWindowPgsByPagenumber(currpage_objpgs.mainPageId);}
var is_fadein_transition_currently=false;if(window.ide.page_transition_type==1)
{is_fadein_transition_currently=true;}
if(!is_fadein_transition_currently)
{ide.setSubpagesArrowsIfEnabled(currpage_objpgs);}
if(((currpage_objpgs.isparalaxsubpage))&&(!animate)&&(!do_reset_everything))
{}
if(animate)
{animTime=300;if(!$.support.transition)
{animEasing='swing';}
else
{animEasing='ease-out';}
window.ide.checkcounterindex++;endFunction=function(){window.setTimeout(function(){if(window.ide.checkcounterindex==window.ide.checkcounterindex)
{window.ide.onAfterPageTransition(true);window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded(from_page,current_page,animate,makedefaultzoom);}},animTime);};}
if(!makedefaultzoom)
{endFunction=function(){};}
if(!do_reset_everything)
{endFunction=function(){};}
var abandonothersthatarenot_from_page_or_current_page=false;var was_handling_moving_pages=false;if(((window.ed.washandlingMovingPages)&&(from_page>-1)&&animate)&&(!is_fadein_transition_currently))
{abandonothersthatarenot_from_page_or_current_page=true;was_handling_moving_pages=true;}
for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(window.ide.contain_paralax_pages&&(ide.get(currobj.iscrollHolder)==null))
{if(ide.loadPagesArray.indexOf(','+currobj.pagenumber+',')>0)
{if(currobj.isparalaxsubpage)
{if(currobj.pagenumber==current_page)
{if(currobj.isparalaxsubpage)
{var currobj=window.f.findObjFromWindowPgsByPagenumber(currobj.mainPageId);}
$('#'+currobj.iscrollHolder).css({x:0,y:0}).delay(50).transition({x:0,y:0},animTime,animEasing,endFunction);window.ide.onAfterPageTransition();endFunction();}}}}
if(ide.get(currobj.iscrollHolder)!=null)
{if(ide.loadPagesArray.indexOf(','+currobj.pagenumber+',')>0)
{ide.preloadThumbnails(currobj,false);if(currobj.pagenumber==current_page)
{if((from_page>-1)&&(window.ed.clickwasusedtogotopage))
{var setFromX=-100;var setFromY=-100;var abandon_SUBPAGES_POSITIONING=false;var is_current_page_this_one=false;if((currobj.pagenumber==window.ide.currentPage)||((window.ide.currentPage==currobj.leftPage)&&(ide.orientIsBookMode)))
{is_current_page_this_one=true;}
if((is_current_page_this_one)&&(is_fadein_transition_currently)){setFromX=0;setFromY=0;}else if(((is_fadein_transition_currently)||(currpage_objpgs.isfadeinsubpage)||((prev_page_obj.isfadeinsubpage&&(currpage_objpgs.fadeinsubpageParent==prev_page_obj.fadeinsubpageParent)))&&(!ide.orientIsBookMode)))
{window.ed.showLoader();$('#'+currobj.iscrollHolder).stop(true,false);if(($('#'+currobj.iscrollHolder).css('display')!=ide.showDisplayType)||($('#'+currobj.iscrollHolder).css('opacity')!='1'))
{$('#'+currobj.iscrollHolder).css({x:'0px',y:'0px',opacity:0.0001,display:ide.showDisplayType}).delay(50).transition({opacity:1},animTime,animEasing,endFunction);}
else
{$('#'+currobj.iscrollHolder).css({x:'0px',y:'0px',display:ide.showDisplayType}).delay(50).transition({opacity:1},animTime,animEasing,endFunction);}}
else if(((currobj.isswipesubpage)||(currobj.isparalaxsubpage)||(prev_page_obj.mainPageId==currobj.mainPageId))&&(!isOddPageAnimation)&&(!ide.orientIsBookMode))
{if(current_page>from_page)
{setFromX=0;setFromY=window.ide.screenHeight;}
else if(current_page<from_page)
{setFromX=0;setFromY=-window.ide.screenHeight;}
if(currobj.ismainparalaxpage)
{setFromX=0;setFromY=0;}}
else
{if(current_page>from_page)
{setFromX=window.ide.screenWidth;setFromY=0;}
else if(current_page<from_page)
{setFromX=-window.ide.screenWidth;setFromY=0;}}
if((setFromX!=-100)&&(setFromY!=-100))
{$('#'+currobj.iscrollHolder).stop(true,false);if(was_handling_moving_pages)
{$('#'+currobj.iscrollHolder).css({opacity:1}).delay(50).transition({x:(0).toString()+'px',y:(0).toString()+'px'},animTime,animEasing,endFunction);}
else
{if(is_fadein_transition_currently)
{$('#'+currobj.iscrollHolder).css({x:setFromX.toString()+'px',display:ide.showDisplayType,y:setFromY.toString()+'px'}).delay(50).transition({x:(0).toString()+'px',opacity:1,y:(0).toString()+'px'},animTime,animEasing,endFunction);}
else
{$('#'+currobj.iscrollHolder).css({x:setFromX.toString()+'px',y:setFromY.toString()+'px'}).delay(50).transition({x:(0).toString()+'px',y:(0).toString()+'px'},animTime,animEasing,endFunction);}}}}
else
{$('#'+currobj.iscrollHolder).stop(true,false);if(is_fadein_transition_currently)
{if(($('#'+currobj.iscrollHolder).css('display')!=ide.showDisplayType)||($('#'+currobj.iscrollHolder).css('opacity')!='1'))
{window.ed.showLoader();$('#'+currobj.iscrollHolder).css({x:'0px',y:'0px',opacity:0.0001,display:ide.showDisplayType}).delay(50).transition({opacity:1},animTime,animEasing,endFunction);}
else
{$('#'+currobj.iscrollHolder).css({x:'0px',y:'0px',display:ide.showDisplayType}).delay(50).transition({opacity:1},animTime,animEasing,endFunction);}}
else
{$('#'+currobj.iscrollHolder).transition({x:(0).toString()+'px',y:(0).toString()+'px'},animTime,animEasing,endFunction);}}}
else if(currobj.pagenumber<current_page)
{if((ide.get(currobj.iscrollHolder).style.x!=(-ide.screenWidth).toString()+'px')&&(ide.get(currobj.iscrollHolder).style.display==ide.showDisplayType))
{var gotoX=-ide.screenWidth;var gotoY=0;if(currpage_objpgs.mainPageId==currobj.mainPageId)
{gotoX=0;gotoY=-(ide.screenHeight);}
if(currobj.ismainparalaxpage)
{if(currobj.paralaxallages.indexOf(','+current_page.toString()+',')<0)
{gotoX=-ide.screenWidth;abandonothersthatarenot_from_page_or_current_page=false;}
else
{gotoX=0;}
gotoY=0;}
var makeAnException=false;if(from_page==currobj.pagenumber)
{makeAnException=true;}
if((!abandonothersthatarenot_from_page_or_current_page)||(makeAnException))
{if((((is_fadein_transition_currently)||(currpage_objpgs.isfadeinsubpage)||((prev_page_obj.isfadeinsubpage&&(currpage_objpgs.fadeinsubpageParent==prev_page_obj.fadeinsubpageParent)))))&&(currobj.pagenumber==from_page))
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).delay(animTime-1).transition({opacity:0.0001},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}
else
{if((is_fadein_transition_currently))
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).delay(animTime-1).transition({opacity:0.0001},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}
else
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).transition({x:gotoX.toString()+'px',y:(gotoY).toString()+'px'},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}}}}}
else if(currobj.pagenumber>current_page)
{if((ide.get(currobj.iscrollHolder).style.left!=(-ide.screenWidth).toString()+'px')&&(ide.get(currobj.iscrollHolder).style.display==ide.showDisplayType))
{var gotoX=ide.screenWidth;var gotoY=0;if(currpage_objpgs.mainPageId==currobj.mainPageId)
{gotoX=0;gotoY=ide.screenHeight;}
if(currobj.ismainparalaxpage)
{if(currobj.paralaxallages.indexOf(','+current_page.toString()+',')<0)
{gotoX=ide.screenWidth;abandonothersthatarenot_from_page_or_current_page=false;}
else
{gotoX=0;}
gotoY=0;}
var makeAnException=false;if(from_page==currobj.pagenumber)
{makeAnException=true;}
if((!abandonothersthatarenot_from_page_or_current_page)||(makeAnException))
{if((((is_fadein_transition_currently)||(currpage_objpgs.isfadeinsubpage)||((prev_page_obj.isfadeinsubpage&&(currpage_objpgs.fadeinsubpageParent==prev_page_obj.fadeinsubpageParent)))))&&(currobj.pagenumber==from_page))
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).delay(animTime).transition({opacity:0.0001},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}
else
{if((is_fadein_transition_currently))
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).delay(animTime).transition({opacity:0.0001},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}
else
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).transition({x:gotoX.toString()+'px',y:gotoY.toString()+'px'},animTime,animEasing,function(){window.ide.onAfterPageTransition();});}}}}}}
else
{if(ide.get(currobj.iscrollHolder)!=null)
{$('#'+currobj.iscrollHolder).stop(true,false);$('#'+currobj.iscrollHolder).css({x:-ide.screenWidth.toString()+'px',y:-ide.screenHeight.toString()+'px',display:window.ide.displayNoneType});}}}}};
;
if(!window.pgfl){window.pgfl={};}
window.pgfl.listanje_nazaj_korak=function(currobj,prevobj,listanjex,listanjey,x2_final_prm,y2_final_prm){var currobj=window.pgfl.pg_currobj;var nextobj=window.pgfl.pg_nextobj;var prevobj=window.pgfl.pg_prevobj;var do_auto_listanje_to_false=false;if(window.pgfl.do_auto_listanje){if(window.performance.now()<=window.pgfl.start_time_listanje+window.pgfl.duration_time_ms_listanje){var delez_listanja=(window.performance.now()-window.pgfl.start_time_listanje)/window.pgfl.duration_time_ms_listanje;}else{do_auto_listanje_to_false=true;}}
var objr=window.pgfl.calc_xy1_xy6_scale(currobj,listanjex,listanjey);var x1=objr.x1;var x2=objr.x2;var x6=objr.x6;var y1=objr.y1;var y2=objr.y2;var y6=objr.y6;var scale=objr.scale;var height_scl=objr.height_scl;var width_scl=objr.width_scl;var inv_scale=1/scale;if(typeof(x2_final_prm)!=='undefined'){x2=x2_final_prm;}
if(typeof(y2_final_prm)!=='undefined'){y2=y2_final_prm;}
var x2_final=x2;var y2_final=y2;x2=pgfl.lastx+(x2-pgfl.lastx)/window.pgfl.deli_z_move;y2=pgfl.lasty+(y2-pgfl.lasty)/window.pgfl.deli_z_move;if(window.pgfl.do_auto_listanje){var tt=1-Math.pow(1-delez_listanja,2);var odmm=Math.min(height_scl,width_scl)*0.01;if(window.pgfl.start_x_listanje===false){window.pgfl.start_x_listanje=x1+odmm;}
if(window.pgfl.start_y_listanje===false){window.pgfl.start_y_listanje=y1+odmm;}
x2=window.pgfl.start_x_listanje+(x6-window.pgfl.start_x_listanje)*tt;var y_preloma=(y1+height_scl/5);if(x2<x1+(2*width_scl)*1/4){y2=window.pgfl.start_y_listanje+(y_preloma-window.pgfl.start_y_listanje)*tt;}else{y2=y_preloma+(y1-y_preloma)*tt;}
x2=pgfl.lastx+(x2-pgfl.lastx)/window.pgfl.deli_z_move;y2=pgfl.lasty+(y2-pgfl.lasty)/window.pgfl.deli_z_move;window.pgfl.deli_z_move=Math.max(window.pgfl.deli_z_move-0.8,(window.pgfl.auto_goto_page_mode?2:1));}else{window.pgfl.deli_z_move=Math.max(window.pgfl.deli_z_move-0.3,window.pgfl.deli_z_move_init);}
var kvadrat_senca_delez=Math.sqrt(Math.pow(x2-x6,2)+Math.pow(y2-y1,2))/ Math.sqrt(Math.pow(x1-x6,2)+Math.pow(y6-y1,2));kvadrat_senca_delez=1-Math.pow(1-kvadrat_senca_delez,5);var x7=(x1+x2)/2;var y7=(y1+y2)/2;var k1=(y1-y2)/(x1-x2);var n1=(y1-k1*x1);var k2=-1/k1;var n2=y7-k2*x7;var y8=k2*x1+n2;var x9=(y1-n2)/k2;if(x9>x1+width_scl){x9=x1+width_scl;k2=(y1-y8)/(x9-x1);k1=-1/k2;n2=y1-k2*x9;n1=y1-k1*x1;x7=(n2-n1)/(k1-k2);y7=k2*x7+n2;x2=x1+2*(x7-x1);y2=y1+2*(y7-y1);}
pgfl.lastx=x2;pgfl.lasty=y2;var fi=(-2*Math.atan(-k1));var fi_deg=(fi*180/Math.PI);var x2d=x2-(+x6*Math.cos(-fi)+y1*Math.sin(-fi));var y2d=y2-(-x6*Math.sin(-fi)+y1*Math.cos(-fi));var css_jq={};css_jq.transform="translateX("+x2d+"px) translateY("+y2d+"px) rotate("+(fi_deg)+"deg) scaleY(1) scaleX(1)";css_jq.transformOrigin='0px 0px';if(y8<y6){css_jq.clipPath="polygon("+(x6)+"px "+(y1)+"px, "+(x6)+"px "+(y8)+"px,"+(x6-(x9-x1))+"px "+(y1)+"px)";var cp_parent="polygon("+((x6-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x6-x1)*inv_scale)+"px "+((y8-y1)*inv_scale)+"px,"+((x6-(x9-x1)-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px)";var cp_parent_pg="polygon("+((x6-x1-width_scl)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x6-x1-width_scl)*inv_scale)+"px "+((y8-y1)*inv_scale)+"px,"+((x6-(x9-x1)-x1-width_scl)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px)";if(prevobj.isfirstpage){cp_parent=cp_parent_pg;}}else{var kk=(y8-y1)/(x9-x1);var nn=y8-kk*x6;var xx=(y6-nn)/kk;css_jq.clipPath="polygon("+(x6)+"px "+(y1)+"px, "+(x6)+"px "+(y6)+"px,"+(xx)+"px "+(y6)+"px, "+(x6-(x9-x1))+"px "+(y1)+"px)";var cp_parent="polygon("+((x6-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x6-x1)*inv_scale)+"px "+((y6-y1)*inv_scale)+"px,"+((xx-x1)*inv_scale)+"px "+((y6-y1)*inv_scale)+"px, "+((x6-(x9-x1)-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px)";var cp_parent_pg="polygon("+((x6-x1-width_scl)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x6-x1-width_scl)*inv_scale)+"px "+((y6-y1)*inv_scale)+"px,"+((xx-x1-width_scl)*inv_scale)+"px "+((y6-y1)*inv_scale)+"px, "+((x6-(x9-x1)-x1-width_scl)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px)";if(prevobj.isfirstpage){cp_parent=cp_parent_pg;}}
var razdalja=inv_scale*Math.sqrt(Math.pow(x1-x7,2)+Math.pow(y1-y7,2));var razdalja2=Math.sqrt(Math.pow(x1-x7,2)+Math.pow(y1-y7,2));var senca_gradient="linear-gradient("+(90-fi_deg/2-180)+"deg,   rgba(0,0,0,0) "+(0.70*razdalja)+"px, rgba(255,255,255,"+(0.3*kvadrat_senca_delez)+") "+(0.80*razdalja)+"px, rgba(0,0,0,"+(0.4*kvadrat_senca_delez)+") ,rgba(0,0,0,0.0) "+(1.06*razdalja)+"px )";var senca2_gradient="linear-gradient("+(fi_deg/2-90+180)+"deg,  rgba(0,0,0,0) "+(0.60*razdalja2)+"px, rgba(0,0,0,"+(0.3*kvadrat_senca_delez)+") "+(1.06*razdalja2)+"px )";window.rq_anim_frame_data={prev_holderdivid:prevobj.holderdivid,prev_selector:prevobj.iscrollHolder,prev_clipPath:css_jq.clipPath,prev_clipPath_parent:cp_parent,prev_clipPath_parent_pg:cp_parent_pg,prev_transform:css_jq.transform,prev_gradient:senca_gradient,curr_gradient:senca2_gradient};window.rq_anim_frame_data.tmp_flip_page=0;if(!prevobj.isfirstpage){var leva=prevobj.leftPage;if(!$("#flip_pg_"+leva).length){var prt=$('#'+'slideContainer');var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(leva);var background_color='rgba(255,255,255,1)';var background_image='';if(tmp_obj.background_color){background_color=tmp_obj.background_color;}else{background_image='background-image:url('+tmp_obj.canvas+');';}
prt.append('<div id="flip_pg_'+leva+'" class="flip_tmp gpuAcc" style="display:none;background-color:'+background_color+';'+background_image+'width:'+width_scl+'px;height:'+height_scl+'px;left:'+(x1)+'px;top:'+(y1)+'px;position:absolute;background-repeat: no-repeat;background-size: '+width_scl+'px '+height_scl+'px;"></div>');}
window.rq_anim_frame_data.tmp_flip_page=leva;}
if(!prevobj.isfirstpage){var desna=prevobj.rightPage
var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(desna);}else{var desna=prevobj.leftPage;var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(desna);}
if(tmp_obj){window.rq_anim_frame_data.lowresdiv_desna=tmp_obj.lowresdiv;if(!$("#flip_pg_senca1").length){$('<div id="flip_pg_senca1" class="flip_tmp gpuAcc" style="display:none;transform-origin=500px 0px;background-color:rgba(0,255,0,0.00008);width:'+(window.eddata.head.pageWidth)+'px;height:'+(window.eddata.head.pageHeight)+'px;position:absolute;"></div>').insertAfter('#'+tmp_obj.lowresdiv);}}
if(!$("#flip_pg_senca2").length){var prt=$('#'+'slideContainer');var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(leva);prt.append('<div id="flip_pg_senca2" class="flip_tmp gpuAcc" style="display:none;width:'+width_scl+'px;height:'+height_scl+'px;left:'+(x1)+'px;top:'+(y1)+'px;position:absolute;background-repeat: no-repeat;background-size: '+width_scl+'px '+height_scl+'px;"></div>');}
css_jq1={};css_jq1.clipPath="polygon("+(x9)+"px "+(y1)+"px, "+(x6)+"px "+(y1)+"px, "+(x6)+"px "+(y6)+"px, "
if(y8>y6){css_jq1.clipPath+=""+(x1)+"px "+(y8)+"px, ";}else{css_jq1.clipPath+=""+(x1)+"px "+(y6)+"px, "+(x1)+"px "+(y8)+"px, ";}
css_jq1.clipPath+=""+(x9)+"px "+(y1)+"px)"
if(!window.rq_anim_frame_data){window.rq_anim_frame_data={};}
window.rq_anim_frame_data.curr_clipPath=css_jq1.clipPath;window.rq_anim_frame_data.curr_selector=currobj.iscrollHolder;if((!window.pgfl.do_auto_listanje)&&((Math.abs(x2_final-x2)>1)||(Math.abs(y2_final-y2)>1))){window.rq_anim_frame_data.y2_final=y2_final;window.rq_anim_frame_data.x2_final=x2_final;}
var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame(window.rqaf_ed);window.rqaf_ed=requestAnimationFrame(window.pgfl.raf);if(do_auto_listanje_to_false){window.pgfl.do_auto_listanje=false;window.pgfl.auto_listanje_koncano();}}
;
if(!window.pgfl){window.pgfl={};}
window.pgfl.listanje_naprej_korak=function(currobj,nextobj,listanjex,listanjey,x2_final_prm,y2_final_prm){var currobj=window.pgfl.pg_currobj;var nextobj=window.pgfl.pg_nextobj;var prevobj=window.pgfl.pg_prevobj;var do_auto_listanje_to_false=false;if(window.pgfl.do_auto_listanje){if(window.performance.now()<=window.pgfl.start_time_listanje+window.pgfl.duration_time_ms_listanje){var delez_listanja=(window.performance.now()-window.pgfl.start_time_listanje)/window.pgfl.duration_time_ms_listanje;}else{do_auto_listanje_to_false=true;}}
var objr=window.pgfl.calc_xy1_xy6_scale(currobj,listanjex,listanjey);var x1=objr.x1;var x2=objr.x2;var x6=objr.x6;var y1=objr.y1;var y2=objr.y2;var y6=objr.y6;var scale=objr.scale;var height_scl=objr.height_scl;var width_scl=objr.width_scl;var inv_scale=1/scale;if(typeof(x2_final_prm)!=='undefined'){x2=x2_final_prm;}
if(typeof(y2_final_prm)!=='undefined'){y2=y2_final_prm;}
var x2_final=x2;var y2_final=y2;x2=pgfl.lastx+(x2-pgfl.lastx)/window.pgfl.deli_z_move;y2=pgfl.lasty+(y2-pgfl.lasty)/window.pgfl.deli_z_move;if(x2>x6-3){x2=x6-3;}
if(window.pgfl.do_auto_listanje){var tt=1-(1-delez_listanja)*(1-delez_listanja);var odmm=Math.min(height_scl,width_scl)*0.02;if(window.pgfl.start_x_listanje===false){window.pgfl.start_x_listanje=x6-odmm;}
if(window.pgfl.start_y_listanje===false){window.pgfl.start_y_listanje=y1+odmm;}
x2=window.pgfl.start_x_listanje+(x1-window.pgfl.start_x_listanje)*tt;var y_preloma=(y1+height_scl/5);if(x2>x1+(2*width_scl)*3/4){y2=window.pgfl.start_y_listanje+(y_preloma-window.pgfl.start_y_listanje)*tt;}else{y2=y_preloma+(y1-y_preloma)*tt;}
x2=pgfl.lastx+(x2-pgfl.lastx)/window.pgfl.deli_z_move;y2=pgfl.lasty+(y2-pgfl.lasty)/window.pgfl.deli_z_move;window.pgfl.deli_z_move=Math.max(window.pgfl.deli_z_move-0.8,(window.pgfl.auto_goto_page_mode?2:1));}else{window.pgfl.deli_z_move=Math.max(window.pgfl.deli_z_move-0.3,window.pgfl.deli_z_move_init);}
var kvadrat_senca_delez=Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))/ Math.sqrt(Math.pow(x1-x6,2)+Math.pow(y6-y1,2));kvadrat_senca_delez=1-Math.pow(1-kvadrat_senca_delez,5);var x7=(x6+x2)/2;var y7=(y1+y2)/2;var n1=-111;var k1=(y2-y1)/(x2-x6);var k2=-1/k1;var n2=y7-k2*x7;var x8=x6;var y8=k2*x6+n2;var x9=(y1-n2)/k2;var y9=y1;if(x9<x1+width_scl){x9=x1+width_scl;k2=(y1-y8)/(x9-x6);k1=-1/k2;n2=y1-k2*x9;n1=y1-k1*x6;x7=(n2-n1)/(k1-k2);y7=k2*x7+n2;x2=2*x7-x6;y2=2*y7-y1;}
pgfl.lastx=x2;pgfl.lasty=y2;var fi=(-2*Math.atan(-k1));var fi_deg=(fi*180/Math.PI);var x2d=x2-(+x1*Math.cos(-fi)+y1*Math.sin(-fi));var y2d=y2-(-x1*Math.sin(-fi)+y1*Math.cos(-fi));var css_jq={};css_jq.x=x2d;css_jq.y=y2d;css_jq.transform="translateX("+x2d+"px) translateY("+y2d+"px) rotate("+(fi_deg)+"deg)";css_jq.transformOrigin='0px 0px';css_jq.clipPath="polygon("+(x1)+"px "+(y1)+"px, "+(x1+x6-x9)+"px "+(y1)+"px, "+(x1)+"px "+(y8)+"px)";var cp_parent="polygon("+((x1-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x1+x6-x9-x1)*inv_scale)+"px "+((y1-y1)*inv_scale)+"px, "+((x1-x1)*inv_scale)+"px "+((y8-y1)*inv_scale)+"px)";var cp_parent_pg=cp_parent;css_jq4={};var razdalja=inv_scale*Math.sqrt(Math.pow(x6-x7,2)+Math.pow(y1-y7,2));var razdalja2=Math.sqrt(Math.pow(x6-x7,2)+Math.pow(y1-y7,2));var razdalja2=Math.sqrt(Math.pow(x6-x7,2)+Math.pow(y1-y7,2));var senca_gradient="linear-gradient("+(90-fi_deg/2-180+180)+"deg,   rgba(0,0,0,0) "+(0.70*razdalja)+"px, rgba(255,255,255,"+(0.3*kvadrat_senca_delez)+") "+(0.80*razdalja)+"px, rgba(0,0,0,"+(0.4*kvadrat_senca_delez)+") ,rgba(0,0,0,0.0) "+(1.06*razdalja)+"px )";var senca2_gradient="linear-gradient("+(fi_deg/2-90+180+180)+"deg,  rgba(0,0,0,0) "+(0.60*razdalja2)+"px, rgba(0,0,0,"+(0.3*kvadrat_senca_delez)+") "+(1.06*razdalja2)+"px  )";window.rq_anim_frame_data={next_selector:nextobj.iscrollHolder,next_clipPath:css_jq.clipPath,next_transform:css_jq.transform,next_gradient:senca_gradient,curr_gradient:senca2_gradient,next_clipPath_parent:cp_parent,next_clipPath_parent_pg:cp_parent_pg};window.rq_anim_frame_data.lowresdiv_leva=nextobj.lowresdiv;if(!$("#flip_pg_senca1").length){$('<div id="flip_pg_senca1" class="flip_tmp gpuAcc" style="display:none;transform-origin=500px 0px;background-color:rgba(0,255,0,0.00008);width:'+(window.eddata.head.pageWidth)+'px;height:'+(window.eddata.head.pageHeight)+'px;position:absolute;"></div>').insertAfter('#'+nextobj.lowresdiv);}
window.rq_anim_frame_data.tmp_flip_page=0;if(!nextobj.islastpage){var desna=nextobj.rightPage;if(!$("#flip_pg_"+desna).length){var prt=$('#'+'slideContainer');var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(desna);var background_color='rgba(255,255,255,1)';var background_image='';if(tmp_obj.background_color){background_color=tmp_obj.background_color;}else{background_image='background-image:url('+tmp_obj.canvas+');';}
prt.append('<div id="flip_pg_'+desna+'" class="flip_tmp" style="display:none;background-color:'+background_color+';'+background_image+'width:'+width_scl+'px;height:'+height_scl+'px;left:'+(x1+width_scl)+'px;top:'+(y1)+'px;position:absolute;background-repeat: no-repeat;background-size: '+width_scl+'px '+height_scl+'px;"></div>');}
window.rq_anim_frame_data.tmp_flip_page=desna;}
if(!$("#flip_pg_senca2").length){var prt=$('#'+'slideContainer');prt.append('<div id="flip_pg_senca2" class="flip_tmp gpuAcc" style="display:none;width:'+width_scl+'px;height:'+height_scl+'px;left:'+(x1+width_scl)+'px;top:'+(y1)+'px;position:absolute;background-repeat: no-repeat;background-size: '+width_scl+'px '+height_scl+'px;"></div>');}
css_jq1={};css_jq1.clipPath="polygon("+(x1)+"px "+(y1)+"px, "+(x9)+"px "+(y1)+"px, "
if(y8>y6){css_jq1.clipPath+=""+(x6)+"px "+(y8)+"px, ";}else{css_jq1.clipPath+=""+(x6)+"px "+(y8)+"px, "+(x6)+"px "+(y6)+"px, ";}
css_jq1.clipPath+=""+(x1)+"px "+(y6)+"px)"
if(!window.rq_anim_frame_data){window.rq_anim_frame_data={};}
window.rq_anim_frame_data.curr_clipPath=css_jq1.clipPath;window.rq_anim_frame_data.curr_selector=currobj.iscrollHolder;if((!window.pgfl.do_auto_listanje)&&((Math.abs(x2_final-x2)>1)||(Math.abs(y2_final-y2)>1))){window.rq_anim_frame_data.x2_final=x2_final;window.rq_anim_frame_data.y2_final=y2_final;}
var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame(window.rqaf_ed);window.rqaf_ed=requestAnimationFrame(window.pgfl.raf);if(do_auto_listanje_to_false){window.pgfl.do_auto_listanje=false;window.pgfl.auto_listanje_koncano();}}
;
if(!window.pgfl){window.pgfl={};}
window.rqaf_cnt_ed=0;window.pgfl.raf=function(timestamp){var enable_gradient=true;window.pgfl.duration_curr_cnt++;if(!ide.pageflip){return;}
var d=window.rq_anim_frame_data;window.rqaf_cnt_ed++;var do_blizje=false;if((typeof(d.x2_final)!=='undefined')&&(typeof(d.y2_final)!=='undefined')&&!window.pgfl.do_auto_listanje){do_blizje=true;var x2_final_prm=d.x2_final;var y2_final_prm=d.y2_final;}
if(pgfl.pageflip_direction>0){if(!d.next_selector){return;}
var curr=document.getElementById(d.curr_selector);var next=document.getElementById(d.next_selector);curr.style.transitionProperty='none';next.style.transitionProperty='none';curr.style.transitionDuration="0s";next.style.transitionDuration="0s";curr.style.webkitClipPath=d.curr_clipPath;curr.style.clipPath=d.curr_clipPath;curr.style.zIndex=5;next.style.transformOrigin='0px 0px';next.style.webkitClipPath=d.next_clipPath;next.style.clipPath=d.next_clipPath;next.style.transform=d.next_transform;next.style.zIndex=10;var tmp_flip_page=d.tmp_flip_page;if(tmp_flip_page){var desna_flip=document.getElementById("flip_pg_"+tmp_flip_page);if(desna_flip){desna_flip.style.display='block';desna_flip.style.zIndex=2;}}
if(d.lowresdiv_leva){var pgg2=document.getElementById(d.lowresdiv_leva);if(pgg2){if(window.edgl.argo.indexOf('*ignore-clip-path-sublayer*')<0){}
pgg2.style.zIndex=5;}}
var senca1=document.getElementById("flip_pg_senca1");if(senca1){if(enable_gradient){senca1.style.backgroundImage=d.next_gradient;}
senca1.style.display='block';senca1.style.zIndex=11;}
var senca2=document.getElementById("flip_pg_senca2");if(senca2){if(enable_gradient){senca2.style.backgroundImage=d.curr_gradient;}
senca2.style.display='block';senca2.style.zIndex=3;}
window.rq_anim_frame_data={};if(window.pgfl.do_auto_listanje){window.pgfl.listanje_naprej_korak();}
if(do_blizje){window.pgfl.listanje_naprej_korak(null,null,0,0,x2_final_prm,y2_final_prm);}}
if(pgfl.pageflip_direction<0){if(!d.curr_selector){return;}
if(!d.prev_selector){return;}
var curr=document.getElementById(d.curr_selector);var prev=document.getElementById(d.prev_selector);curr.style.transitionProperty='none';prev.style.transitionProperty='none';curr.style.transitionDuration="0s";prev.style.transitionDuration="0s";if(d.prev_holderdivid){var pgg=document.getElementById(d.prev_holderdivid);if(pgg){pgg.style.clipPath=d.prev_clipPath_parent;pgg.style.transitionDuration="0s";pgg.style.transitionProperty='none';}}
if(d.lowresdiv_desna){var pgg2=document.getElementById(d.lowresdiv_desna);if(pgg2){pgg2.style.clipPath=d.prev_clipPath_parent_pg;pgg2.style.transitionDuration="0s";pgg2.style.transitionProperty='none';pgg2.style.zIndex=5;}}
prev.style.clipPath=d.prev_clipPath;prev.style.transformOrigin='0px 0px';prev.style.transform=d.prev_transform;prev.style.zIndex=17;curr.style.clipPath=d.curr_clipPath;curr.style.zIndex=5;var tmp_flip_page=d.tmp_flip_page;if(tmp_flip_page){var leva_flip=document.getElementById("flip_pg_"+tmp_flip_page);if(leva_flip){leva_flip.style.display='block';leva_flip.style.zIndex=2;}}
var senca1=document.getElementById("flip_pg_senca1");if(senca1){senca1.style.clipPath=d.prev_clipPath_parent_pg;if(enable_gradient){senca1.style.backgroundImage=d.prev_gradient;}
senca1.style.display='block';senca1.style.zIndex=11;}
var senca2=document.getElementById("flip_pg_senca2");if(senca2){if(enable_gradient){senca2.style.backgroundImage=d.curr_gradient;}
senca2.style.display='block';senca2.style.zIndex=3;}
window.rq_anim_frame_data={};if(window.pgfl.do_auto_listanje){window.pgfl.listanje_nazaj_korak();}
if(do_blizje){window.pgfl.listanje_nazaj_korak(null,null,0,0,x2_final_prm,y2_final_prm);}}}
window.pgfl.timeout_id=0;window.pgfl.do_auto_listanje=false;window.pgfl.pageflip_direction=0;window.pgfl.pg_currobj=false;window.pgfl.pg_nextobj=false;window.pgfl.pg_prevobj=false;window.pgfl.zalistaj=function(listanjex,listanjey){window.tlbr.checkIfShouldHideNavArrows(window.ide.currentPage,true);if(!window.pgfl.pg_currobj){var useSubpages=false;var reference_page=ide.currentPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(reference_page);var prevobj=window.f.findPreviousObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);var nextobj=window.f.findNextObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);window.pgfl.pg_currobj=currobj;window.pgfl.pg_nextobj=nextobj;window.pgfl.pg_prevobj=prevobj;}else{var currobj=window.pgfl.pg_currobj;var nextobj=window.pgfl.pg_nextobj;var prevobj=window.pgfl.pg_prevobj;}
window.pgfl.do_auto_listanje=true;window.pgfl.start_time_listanje=window.performance.now();window.pgfl.duration_time_ms_listanje=900;window.pgfl.start_x_listanje=listanjex;window.pgfl.start_y_listanje=listanjey;window.pgfl.duration_curr_cnt=0;window.pgfl.duration_max_cnt=42;window.pgfl.to_new_page=true;var objr=window.pgfl.calc_xy1_xy6_scale(currobj,listanjex,listanjey);var x1=objr.x1;var x2=objr.x2;var x6=objr.x6;var y1=objr.y1;var y2=objr.y2;var y6=objr.y6;if(pgfl.pageflip_direction>0){var d=Math.sqrt(Math.pow(x1-x2,2)+Math.pow(y1-y2,2))/(x6-x1);}else{var d=Math.sqrt(Math.pow(x6-x2,2)+Math.pow(y1-y2,2))/(x6-x1);}
if(listanjex===false){d=1;}
window.pgfl.duration_time_ms_listanje=window.pgfl.duration_time_ms_listanje*d;window.pgfl.duration_max_cnt=Math.round(window.pgfl.duration_max_cnt*d);if(pgfl.pageflip_direction>0){window.pgfl.listanje_naprej_korak();}else{window.pgfl.listanje_nazaj_korak();}}
window.pgfl.after_flip_ended_for_endHandler=false;window.pgfl.auto_listanje_koncano=function(){clearTimeout(window.pgfl.go_back_from_moving_INT);window.pgfl.go_back_from_moving_INT=false;var currentPage=-1;if(window.pgfl.after_goto_page_currentPage>-1){var currentPage=window.pgfl.after_goto_page_currentPage;var previousPage=window.pgfl.after_goto_page_previousPage;window.pgfl.after_goto_page_currentPage=-1;window.pgfl.after_goto_page_previousPage=-1;}else{if(pgfl.pageflip_direction>0){var previousPage=window.pgfl.pg_currobj.pagenumber
var currentPage=window.pgfl.pg_nextobj.pagenumber}
if(pgfl.pageflip_direction<0){var previousPage=window.pgfl.pg_currobj.pagenumber
var currentPage=window.pgfl.pg_prevobj.pagenumber}}
window.pgfl.auto_goto_page_mode=false;var goto_page_listanje_smer=window.pgfl.goto_page_listanje_smer;window.pgfl.goto_page_listanje_smer=0;var d=window.rq_anim_frame_data;if(d.next_selector){var next=document.getElementById(d.next_selector);if(next){next.style.webkitClipPath='none';next.style.clipPath='none';next.style.transform='none';next.style.zIndex=1;}}
if(d.prev_selector){var prev=document.getElementById(d.prev_selector);if(prev){prev.style.webkitClipPath='none';prev.style.clipPath='none';prev.style.transform='none';prev.style.zIndex=1;}}
if(d.curr_selector){var curr=document.getElementById(d.curr_selector);if(curr){curr.style.clipPath='none';curr.style.webkitClipPath='none';curr.style.zIndex=1;}}
if(d.tmp_flip_page){var leva_desna_flip=document.getElementById("flip_pg_"+d.tmp_flip_page);if(leva_desna_flip){leva_desna_flip.remove();}}
var senca1=document.getElementById("flip_pg_senca1");if(senca1){senca1.remove();}
var senca2=document.getElementById("flip_pg_senca2");if(senca2){senca2.remove();}
if(window.pgfl.to_new_page){}else{}
$('.flip_tmp').remove();if(d.lowresdiv_desna){var pgg2=document.getElementById(d.lowresdiv_desna);if(pgg2){pgg2.style.clipPath='none';}}
if(d.prev_holderdivid){var pgg=document.getElementById(d.prev_holderdivid);if(pgg){pgg.style.clipPath='none';}}
if(goto_page_listanje_smer===0){window.pgfl.after_flip_ended_for_endHandler=true;window.ed.endHandler(pgfl.endHandler_event);}
ed.checkScaleAndEnableTracking();if((goto_page_listanje_smer!=0)||(pgfl.pageflip_direction!=0)){if(currentPage>-1){window.ide.currentPage=currentPage;window.ide.previousPage=previousPage;}
window.f.setDefaultsOnActualChangePage();window.f.setDefaultsPriorToGoingToNextOrPreviousPage();window.ide.addStructureAndShowIt(window.ide.currentPage,-1,true);window.ide.addStructureAndShowIt(window.ide.currentPage+1,-1,true);window.ide.pageChangeEventStartFired=true;window.ide.onAfterPageTransition(true);window.ide.positionPagesOnAfterCheckMaterialsLoadedOrUnloaded(window.ide.previousPage,window.ide.currentPage,false,true);}
window.pgfl.do_auto_listanje=false;ed._enabledTracking=true;pgfl.pageflip_direction=0;window.pgfl.pg_currobj=false;window.pgfl.lastx=-55555;window.pgfl.lasty=-55555;}
window.pgfl.resetFlipStuffAndPages=function(){var currobjpgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);$('#'+currobjpgs.iscrollHolder).css({'clip-path':'none'});$('#'+currobjpgs.lowresdiv).css({'clip-path':'none'});$('#'+currobjpgs.holderdivid).css({'clip-path':'none'});$('.flip_tmp').remove();}
window.pgfl.deli_z_move_init=5;window.pgfl.deli_z_move=window.pgfl.deli_z_move_init;window.pgfl.auto_goto_page_mode=false;window.pgfl.calc_xy1_xy6_scale=function(currobj,listanjex,listanjey){if(typeof(listanjex)==='undefined'){var listanjex=0;}
if(typeof(listanjey)==='undefined'){var listanjey=0;}
var obj={};var xa=false;if(currobj==='aaa'){currobj=false;xa=true;}
if(!currobj){currobj=window.f.findObjFromWindowPgsByPagenumber(ide.currentPage);}
var objx=$('#'+currobj.holderdivid);var transformMatrix=objx.css("-webkit-transform")||objx.css("transform");var matrix=transformMatrix.replace(/[^0-9\-.,]/g,'').split(',');var x_MTR=parseFloat(matrix[4]);var y_MTR=parseFloat(matrix[5]);var scale=window.f.getCurrentPageScale(null,true);var width_scl=window.eddata.head.pageWidth*scale
var height_scl=window.eddata.head.pageHeight*scale
var x1=(currobj.isfirstpage?(-width_scl):0)+x_MTR;var y1=y_MTR;var x6=x1+2*width_scl;var y6=y1+1*height_scl;var ofs=$('#mainHolder').offset();var x2=listanjex-ofs.left;var y2=listanjey-ofs.top;var islastpage=currobj.islastpage;if(!islastpage){if(currobj.rightPage){rightobj=window.f.findObjFromWindowPgsByPagenumber(currobj.rightPage);if(rightobj){if(rightobj.islastpage){islastpage=true;}}}}
obj.x1=x1;obj.x2=x2;obj.x6=x6;obj.y1=y1;obj.y2=y2;obj.y6=y6;obj.x2_ofs=ofs.left;obj.y2_ofs=ofs.top;obj.scale=scale;obj.height_scl=height_scl;obj.width_scl=width_scl;obj.isfirstpage=currobj.isfirstpage
obj.islastpage=islastpage;return obj;}
window.pgfl.inti_before_start_listanje=function(){}
window.pgfl.moving_zgoraj_na_strani_levo_oz_desno=function(listanjex,listanjey){window.pgfl.klik_zgoraj_na_strani_levo_oz_desno(listanjex,listanjey,true);}
window.pgfl.mouse_up_moving=false;window.pgfl.go_back_from_moving_INT=false;window.pgfl.klik_zgoraj_na_strani_levo_oz_desno=function(listanjex,listanjey,moving_mode){if(!moving_mode){if(window.pgfl.mouse_up_moving){window.pgfl.reset_from_moving();}}
var curr_pageflip_direction=0;var useSubpages=false;var reference_page=ide.currentPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(reference_page);var prevobj=window.f.findPreviousObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);var nextobj=window.f.findNextObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);window.pgfl.pg_currobj=currobj;window.pgfl.pg_nextobj=nextobj;window.pgfl.pg_prevobj=prevobj;window.pgfl.auto_goto_page_mode=false;if(moving_mode){}
var objr=window.pgfl.calc_xy1_xy6_scale(currobj,listanjex,listanjey);var x1=objr.x1;var x2=objr.x2;var x6=objr.x6;var y1=objr.y1;var y2=objr.y2;var y6=objr.y6;var x2_ofs=objr.x2_ofs;var y2_ofs=objr.y2_ofs;var scale=objr.scale;var height_scl=objr.height_scl;var width_scl=objr.width_scl;var isfirstpage=objr.isfirstpage;var islastpage=objr.islastpage;var odmm=Math.min(height_scl,width_scl)*0.15;if((x2>=x1)&&(y2>=y1)&&(Math.pow(x1-x2,2)+Math.pow(y1-y2,2)<Math.pow(odmm,2))&&(!isfirstpage)){window.pgfl.inti_before_start_listanje();window.pgfl.deli_z_move=2*window.pgfl.deli_z_move_init;if(!moving_mode||(window.pgfl.lastx==-55555)){pgfl.lastx=x1;}
if(!moving_mode||(window.pgfl.lasty==-55555)){pgfl.lasty=y1;}
if(pgfl.pageflip_direction!==-1){window.pgfl.reset_from_moving();}
pgfl.pageflip_direction=-1;curr_pageflip_direction=-1;}
if((x2<=x6)&&(y2>=y1)&&(Math.pow(x6-x2,2)+Math.pow(y1-y2,2)<Math.pow(odmm,2))&&(!islastpage)){window.pgfl.inti_before_start_listanje();window.pgfl.deli_z_move=2*window.pgfl.deli_z_move_init;if(!moving_mode||(window.pgfl.lastx==-55555)){pgfl.lastx=x6;}
if(!moving_mode||(window.pgfl.lasty==-55555)){pgfl.lasty=y1;}
if(pgfl.pageflip_direction!==1){window.pgfl.reset_from_moving();}
pgfl.pageflip_direction=+1;curr_pageflip_direction=+1;}
if(pgfl.pageflip_direction===0){pgfl.pageflip_reset=true;}
if(moving_mode){if(curr_pageflip_direction!==0){window.pgfl.mouse_up_moving=true;document.body.style.cursor='pointer';window.pgfl.pg_currobj=currobj;window.pgfl.pg_nextobj=nextobj;window.pgfl.pg_prevobj=prevobj;if(pgfl.pageflip_direction>0){var x_dif=x6-listanjex+x2_ofs;var y_dif=listanjey-y1-y2_ofs;if((Math.abs(listanjex-pgfl.lastx)>180)||(Math.abs(listanjey-pgfl.lasty)>180)){x_dif=6;pgfl.lastx=x6;y_dif=6;pgfl.lasty=y1;}
if(x_dif<5){x_dif=5;}
if(y_dif<5){y_dif=5;}
if(x_dif>y_dif*4){x_dif=y_dif*4;}
if(y_dif>x_dif*4){y_dif=x_dif*4;}
listanjex=x6-x_dif+x2_ofs;listanjey=y1+y_dif+y2_ofs;clearTimeout(window.pgfl.go_back_from_moving_INT);window.pgfl.go_back_from_moving_INT=false;window.pgfl.listanje_naprej_korak(currobj,nextobj,listanjex,listanjey);}
if(pgfl.pageflip_direction<0){var x_dif=listanjex-x1-x2_ofs;var y_dif=listanjey-y1-y2_ofs;if((Math.abs(listanjex-pgfl.lastx)>180)||(Math.abs(listanjey-pgfl.lasty)>180)){x_dif=6;pgfl.lastx=x1;y_dif=6;pgfl.lasty=y1;}
if(x_dif<5){x_dif=5;}
if(y_dif<5){y_dif=5;}
if(x_dif>y_dif*4){x_dif=y_dif*4;}
if(y_dif>x_dif*4){y_dif=x_dif*4;}
listanjex=x1+x_dif+x2_ofs;listanjey=y1+y_dif+y2_ofs;clearTimeout(window.pgfl.go_back_from_moving_INT);window.pgfl.go_back_from_moving_INT=false;window.pgfl.listanje_nazaj_korak(currobj,prevobj,listanjex,listanjey);}}else{var min_odd=2;var timeout_ms=2500;if(pgfl.pageflip_direction>0){listanjex=x6+x2_ofs-min_odd;listanjey=y1+y2_ofs+min_odd;window.pgfl.listanje_naprej_korak(currobj,nextobj,listanjex,listanjey);if(Math.abs(pgfl.lastx-(listanjex-x2_ofs))+Math.abs(pgfl.lasty-(listanjey-y2_ofs))<min_odd*1.5){timeout_ms=10;}}
if(pgfl.pageflip_direction<0){listanjex=x1+x2_ofs+min_odd;listanjey=y1+y2_ofs+min_odd;window.pgfl.listanje_nazaj_korak(currobj,prevobj,listanjex,listanjey);if(Math.abs(pgfl.lastx-(listanjex-x2_ofs))+Math.abs(pgfl.lasty-(listanjey-y2_ofs))<min_odd*1.5){timeout_ms=10;}}
if((window.pgfl.go_back_from_moving_INT===false)||(timeout_ms==10)){console.log('set timout 2500 --- ',timeout_ms)
clearTimeout(window.pgfl.go_back_from_moving_INT);window.pgfl.go_back_from_moving_INT=setTimeout(function(){window.pgfl.go_back_from_moving_INT=false;window.pgfl.go_back_from_moving();},timeout_ms);}}}
if(curr_pageflip_direction===0){document.body.style.cursor='default';}}
window.pgfl.reset_from_moving=function(){clearTimeout(window.pgfl.go_back_from_moving_INT);window.pgfl.go_back_from_moving_INT=false;if(!window.pgfl.mouse_up_moving){return;}
var useSubpages=false;var reference_page=ide.currentPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(reference_page);var prevobj=window.f.findPreviousObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);var nextobj=window.f.findNextObjFromWindowPgsByPageNumber(reference_page,useSubpages,true);if(currobj){var curr=document.getElementById(currobj.iscrollHolder);if(curr){curr.style.clipPath='none';curr.style.webkitClipPath='none';curr.style.zIndex=1;}}
if(nextobj){var next=document.getElementById(nextobj.iscrollHolder);if(next){next.style.transform="translateX(5000px) translateY(0px) rotate(0deg) scaleY(1) scaleX(1)";}}
if(prevobj){var prev=document.getElementById(prevobj.iscrollHolder);if(prev){prev.style.transform="translateX(5000px) translateY(0px) rotate(0deg) scaleY(1) scaleX(1)";}}
var senca1=document.getElementById("flip_pg_senca1");if(senca1){senca1.remove();}
var senca2=document.getElementById("flip_pg_senca2");if(senca2){senca2.remove();}
$('.flip_tmp').remove();window.rq_anim_frame_data={};pgfl.pageflip_direction=0;document.body.style.cursor='default';window.pgfl.mouse_up_moving=false;}
window.pgfl.go_back_from_moving=function(){window.pgfl.reset_from_moving();}
window.pgfl.goto_page_listanje_smer=0;window.pgfl.lastx=-55555;window.pgfl.lasty=-55555;window.pgfl.after_goto_page_currentPage=-1;window.pgfl.after_goto_page_previousPage=-1;window.pgfl.goto_page_listanje_zacni=function(frompage,topage){if(window.f.getCurrentPageScale(window.ide.currentPage)>(Math.round(window.ide.defaultPublicationScale*1000)/1000))
{if(window.ed._enableZoom)
{ed.zoomOut(window.ide.defaultPublicationScale,true,0,0,false,false,-1);}}
if(window.pgfl.mouse_up_moving){window.pgfl.reset_from_moving();}
window.pgfl.after_goto_page_previousPage=frompage;window.pgfl.after_goto_page_currentPage=topage;var useSubpages=false;var currobj=window.f.findObjFromWindowPgsByPagenumber(frompage);window.pgfl.pg_currobj=currobj;var objr=window.pgfl.calc_xy1_xy6_scale();var x1=objr.x1;var x2=objr.x2;var x6=objr.x6;var y1=objr.y1;var y2=objr.y2;var y6=objr.y6;var scale=objr.scale;var height_scl=objr.height_scl;var width_scl=objr.width_scl;var isfirstpage=objr.isfirstpage;var islastpage=objr.islastpage;var odmm=Math.min(height_scl,width_scl)*0.1;var sirina_omik_listanje=5;window.pgfl.auto_goto_page_mode=true;if(topage>frompage){window.pgfl.inti_before_start_listanje();window.pgfl.deli_z_move=4*window.pgfl.deli_z_move_init;pgfl.lastx=x6;pgfl.lasty=y1;pgfl.pageflip_direction=+1;window.pgfl.goto_page_listanje_smer=+1;var nextobj=window.f.findObjFromWindowPgsByPagenumber(topage);window.pgfl.pg_nextobj=nextobj;window.pgfl.zalistaj(x6-sirina_omik_listanje,y1+sirina_omik_listanje);}
if(topage<frompage){window.pgfl.inti_before_start_listanje();window.pgfl.deli_z_move=4*window.pgfl.deli_z_move_init;pgfl.lastx=x1;pgfl.lasty=y1;pgfl.pageflip_direction=-1;window.pgfl.goto_page_listanje_smer=-1;var prevobj=window.f.findObjFromWindowPgsByPagenumber(topage);window.pgfl.pg_prevobj=prevobj;window.pgfl.zalistaj(x1+sirina_omik_listanje,y1+sirina_omik_listanje);}}
;
(function(){var ed={debug:false,debugTemplate:false,isBetaScript:false,debugAnimations:false,debugLinks:false,textboxreadtimeout:10000,textboxreadtimeoutcalledwhenpageid:-1,loaderindex:0,playershown:false,allparalaxpagescount:0,customType:-100,istouchdevice:false,isdesktopmac:false,alltextblocktimeouts:new Array(),pageIsForReviewModeOnly:'pageIsForReviewModeOnly',_touch_start_event_nm:'touchstart',_touch_move_event_nm:'touchmove',_touch_end_event_nm:'touchend',clickwasusedtogotopage:false,zoomendwasalreadycalled:false,washandlingMovingPages:false,youtubecontrolnumber:0,youtubestate:null,loadingLayer:false,allowoneparalaxscroll:0,allowmaxparalaxscrolls:1,currentlyLoadingUHDImages:false,sndplayercontrolnumber:0,layerIsShown:false,textblock_increase_font_step:3,isLoadingPageBackgrounds:false,last_click_time:new Date(),lastCheckedPressedX:-1,lastCheckedPressedY:-1,addStatGroupToStats:'',_touch_out_event_nm:'',defaultNoImageValue:'',waitingAnims:'',defaultNoImageValueSrc:'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',galleryFSCZoomedIn:false,pageWasJustChanged:false,currentlyLoadingtextblockes:false,_was_end_handler:true,statsFired:false,startingWatch:new Date(),videoisinfullscreen:false,isiscrollroll:false,isiscrollWheelRoll:false,this_is_new_double_click:0,eDitionName:'',eDitionTitle:'',ProjectName:'',goToSubcategory:'',scrollToY:0,_version_of_linktest:0,z_index_max:800,stageWidth:0,stageHeight:0,arrPointerArray:new Array(),preventGlobalHandling:false,preventLocalHandling:false,onlyZoomContent:false,_add_to_statistics_only_first_time:'#fua=1',_last_image_clicked:'',currentDownloadImageIndex:0,timeoutindex:0,loader1:505,loader2:506,loader3:507,loader4:508,loader5:509,loader6:510,loader7:511,loader8:512,loader9:513,loader10:514,paralaxmaxscrolly:0,isIpad:'false',addToDownloadList:'',addtodownloadlistImages:'',pageHead:document.getElementsByTagName('head')[0],isLoadingObjectsImages:false,arrIscrolls:new Array(),clickOverVideo:false,page_currently_zoomed_in:false,_defaultPopupWidth:0,_defaultPopupHeight:0,isIeTouch:false,_currentlyMovingIfScale:false,isLoadingTemplate:false,forcePageReload:false,currentTemplate:'',singleQuote:'#singlqt#',dblQuote:'#dblqt#',fscGalScroll:null,fscLayerSCroll:null,fsgallerybuttonWidth:90,_previous_page_id_drawn_links:-1,_move_hanlder_started_to_scroll_left_or_right:false,_currnt_gal_width:0,_currnt_gal_height:0,_galFSCDiv:document.getElementById('pageGalleryFullscrenDiv'),_galFSCBtnPressedElement:null,galleryZoomInZoomOutDivName:'FSCGalleryZoomId',_download_counter:0,FSCGalleryVisible:false,FSCGalleryVisibleId:0,maindownloadGroupIndex:0,_currentlyLoadingFSCImage:false,FSCgalleryMaxZoom:2,_galnextGalleryImage:-2,_galpreviousGalleryImage:-3,isAndroid:false,galleryEndLastXtouch:0,galleryEndLastYtouch:0,jqueryTransition:'ease-in-out',webTransformNm:'Webkit',_subpage_up_arrow_img:'',_subpage_down_arrow_img:'',_currentPageObj:{divid:'',pageid:'',hasSubpages:false,pageNumber:0},_currentPageObjPgs:null,_currentPreviousPageObjPgs:null,googleAnalyCode:'',webTransformNmCSS:'-webkit-',webTransformFunct:'',youtubeplaywasalreadysent:false,mustPreloadImagesBeforeRunTmp:'',_isLandscapeMode:false,webTransformFunctCSS:'',edition_youtube_api_url:'https://www.youtube.com/iframe_api',webTransitionFunct:'',webTransformFunctOrigin:'',arrGalleryObjectSettings:new Array(),_currentlyScrollingSubpages:false,_ignorePage:1,subpageindx:0,issinglepagemode:false,preventBecauseImages:false,preventBecauseGallery:false,preventBecauseLinks:false,preventBecauseLoadingImagesToMemory:false,galleryStartingX:0,startinPageEventCalled:false,galleryStartingY:0,galleryStartingTime:null,hdwidth:0,previewNotSet:false,hdheight:0,usesHD:false,scaleFunct:'scale3d',addToScaleFunct:',1',translateFunct:'translate3d',addToTranslateFunct:',0px',translateZFunct:'',currentPageX:0,currentScale:0,currentPageY:0,singlePageWidth:0,paralaxImages:new Array(),showSubpagesArrows:true,_disableXScroll:false,_disableYScroll:false,_fadein_subpage_visible:false,_fadein_pgs_id:-1,_fadein_parent_id:-1,html5popup_links_forceNewWindow:false,_popupFiredFromStaticLinks:false,_click_was_used_to_hide:false,_current_screen_x:0,_current_screen_y:0,defaultTimingSubpages:300,preloadIndex:0,isIe58:false,isIe9:false,defaultEasing:'ease-out',singlePageHeight:0,oldWayHiRes:true,_pressedElementX:0,_loader_visible:true,_gallery_touch_counter:0,_pressedElementY:0,_pressedElement:null,firedautoplay:false,fscGalScrollImage:null,fscGalScrollImageParent:'',_subpageActionCount:0,downloadItems:{id:new Array(),items:new Array()},downloads:{id:new Array(),items:new Array()},FSCarrGalleryOptions:null,_current_ScreenHeight:0,_current_ScreenWidth:0,_current_ScreenHeight_withRatio:0,_current_ScreenWidth_withRatio:0,slideContainer:null,wrapper:null,slides:null,distanceX:0,startX:0,preferredWidth:0,preferredHeight:0,_video_shown:false,direction:"",timer:null,timerCounter:0,isTouchEnd:false,_initStatsSent:false,maxDistance:0,currentDistance:0,_pg_hasAnim:false,pressed:0,setTransformOrigin:'',_previousDrawn:'',_previousDrawn2:'',_requests_root_path:'',_requests_root_path_origin:'',currentlyloadingImages:false,_setZoomInregardingEverythings:false,tempHTMLContain:'',_referrer:'',distanceY:0,_linkImageElemShown:new Array(),_hiddenVideoBG:'',_hiddenVideoBG2:'',_linkImageShowLayer:false,layerLastElement:0,layerLastElementWidth:0,layerLastElementHeight:0,_randomchar:'',iconPercentWidth:'50',maxLoadedPages:0,_currentPageLinksShown:false,startY:0,_editionid:0,animation_local_int_vars:new Object(),animation_global_int_vars:new Object(),commandsEnabled:true,subpgsupArrowShow:false,subpgsdownArrowShow:false,_scaStrForViewPort:null,zoomPageOffsetX:0,_aboutBoxImage:'',isIphone:'false',_eDitionSwipeTimeoutForCheckLoading:50,thisIsInitialOffset:false,currentPublicationURL:'',_previousDifference:-1,_startScale:0,_facebookIsShown:false,isLoadingPublication:true,defaultPageOffsetX:0,usedHeight:0,usedWidth:0,enabledScrolling:-1,_currentLocation:'',startScaleOfPage:0,_originalRatio:1,ratioOfZoomPages:0,orientationEvent:null,currentOrientation:0,zoomPageOffsetY:0,_originalPageWidth:0,differenceX:0,differenceY:0,_originalPageHeight:0,_enabledTracking:true,main:null,_is_gallery_mouse_down:false,_is_textbox_mouse_down:false,lastShownObject:'',useOffsetOrigin:true,_hasNoEvents:false,_isFirstTime:true,_originalRatioX:0,_originalRatioY:0,_doHideLoader:false,_wasDistanceX:0,_currentPage:1,_hiresIsVisible:false,socialBookmarksVisible:false,startX_second:0,zoomFromX:0,zoomFromY:0,startY_second:0,_paddingTop:0,_isPortraitMode:false,_previousScale:1,startHandlerLastClickedX:0,startHandlerLastClickedY:0,endHandlerLastClickedX:0,endHandlerLastClickedY:0,mainHolderDivId:'mainHolder',textblockStylesInjected:false,mainWrapper:document.getElementById("mainHolder"),EventGesture:null,_isSingleClick:false,subpagesOffsetY:0,_isMinimized:false,_wasPreviousEnabledTwoFingers:false,_OBJECT_TO_SHOW:'',gestureStarter:null,_allPages:0,_bigImagesCount:0,_active:1,_singleClickWasClickedAtTime:null,screenWidth:document.documentElement.clientWidth,screenHeight:document.documentElement.clientHeight,lastClickX:0,lastClickY:0,linkLastClickX:0,linkLastClickY:0,thisTimeTwoFingersWereUsed:false,_openedAboutBox:false,_currentSlideWidth:0,_currentOffset:0,_actionversion:0,_enableZoom:true,_previous_version_of_call:-1,_currentScale:1,shouldRunTemplate:false,startDistance:0,_autotiming:400,_currentPageHasSubpages:false,_usertiming:0,_scaleTiming:0,_offsetPagesCnt:0,pressedGalleryElement:'',_isMouseDown:false,isPublicationFullyLoadedAndShown:false,defaultTransitionTiming:300,measureXOffset:0,measureYOffset:0,_idLinkPressed:0,nextPage:-1,previousPage:-2,nextMainPage:-3,previousMainPage:-4,currentMainPage:-5,nextSubpage:-6,previousSubpage:-7,currentBottomSubpage:-8,lastPage:-9,firstPage:-10,lastMainPage:-11,IscrollRollPressedX:0,IscrollRollPressedY:0,lastTimePageChange:null,allShownPages:new Array(),_popup_shown:false,pageStatArr:'',statsindex:0,_isDesktopBrowser:false,allDimensionsArr:new Array(),defaultZoom:1,isThisPreviewApp:false,_is_loading_fadein_subpage:false,hasAlreadyStartedScrollingVerticalLocaly:false,trace:function(value){if(ed.debug)
{console.log(value);}},traceRegardless:function(value){console.log(value);},showPreviewSign:function(){if(ed.isThisPreviewApp)
{ed.get(ed.pageIsForReviewModeOnly).style['display']='block';$('#'+ed.pageIsForReviewModeOnly).fadeTo(250,1);window.setTimeout('window.ed.runPreviewApplication();',3500);}},runPreviewApplication:function(){if(ed.isThisPreviewApp)
{$('#'+ed.pageIsForReviewModeOnly).fadeTo(200,0,function(){ed.get(ed.pageIsForReviewModeOnly).style['display']='none';window.setTimeout('window.ed.showPreviewSign();',8000);});}},checkIfCanHideLoader:function(){var resvar=true;if((ed.preventBecauseImages)||(ed.preventBecauseGallery)||(ed.isLoadingPublication)||(ed.isLoadingObjectsImages)||(ed.isLoadingPageBackgrounds)||(ed.isLoadingTemplate)||(ed.loadingLayer)||(ed.preventBecauseLoadingImagesToMemory)||(ed.currentlyLoadingtextblockes)||(ed.currentlyLoadingUHDImages)||(ed.preventBecauseLinks))
{resvar=false;}
return resvar;},addToGoToPageStats:function(toPageId){window.stats.pageview(toPageId.toString());},showLoader:function(){clearTimeout(window.showLoaderTimeout);window.showLoaderTimeout=setTimeout(function(){if(!ed.checkIfCanHideLoader()){var obj=ed.get('loadingMenu');obj.style.top=ed.iconPercentWidth+'%';ed._loader_visible=true;ed.loaderSetAlpha("100","loadingMenu",300);}},500);},hideLoader:function(loaderIndx){if(!ed._loader_visible){return;}
var resvar=ed.checkIfCanHideLoader();if(resvar)
{ed._loader_visible=false;ed.loaderSetAlpha("0","loadingMenu",300);window.setTimeout("document.getElementById('loadingMenu').style.top = '-300px';window.ed._loader_visible = false;",300);}},IsImgVisibleForLink:function(animobj_id){var res=false;if(typeof(IsImgVisibleForLink_Anim)=="function"){res=IsImgVisibleForLink_Anim(animobj_id);}
return(res);},getLinkTypeNameForTypeId:function(lid){lid=parseInt(lid,10);var res="unknown("+lid+")";if(lid=1){var res="link("+lid+")";}
else if(lid=2){var res="polylin("+lid+")";}
else if(lid=3){var res="ellipse("+lid+")";}
return res;},fixPageIdToSoda:function(pg){var resvar=pg;if(ed._isLandscapeMode)
{if(resvar%2!=0)
{resvar=resvar-1;}}
if(resvar<1)
{resvar=1;}
return resvar;},zoomIn:function(scaleFactor,setOffsetToZero,fromX,fromY,setPercent,user){if(ed._currentlyScrollingSubpages)
{return false;}
if(!ed.isLoadingPublication)
{if(!ed._enableZoom)
{return false;}}
var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var d=currobj.arrindex;{var elemsImg=ed.get(currobj.holderdivid);try
{if(elemsImg!=null)
{if((parseFloat(window.ide.maxScaleFactor)==parseFloat(scaleFactor))&&(currobj.loadedimageHD))
{scaleFactor=window.ide.scaleOfFullZoomHD;}
if((currobj.loadedimageHD)&&(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom))
{if(scaleFactor>window.ide.scaleOfFullZoomHD)
{scaleFactor=window.ide.scaleOfFullZoomHD;}}
else if(scaleFactor>window.ide.maxScaleFactor)
{scaleFactor=window.ide.maxScaleFactor;}
if(scaleFactor<(window.ide.defaultPublicationScale/2))
{scaleFactor=(window.ide.defaultPublicationScale/2);}
var window_pgs_index=currobj.arrindex;if(!window.initer.isIe9)
{window.eddata.pages[window_pgs_index].currentZoom=scaleFactor;window.eddata.pages[window_pgs_index].iscroll[0].zoom(scaleFactor);window.eddata.pages[window_pgs_index].iscroll[0].refresh();}}}catch(e)
{}}},zoomOut:function(scaleFactor,setOffsetToZero,fromX,fromY,setPercent,user,thisd){if((!ed.isLoadingPublication)&&(!ed._setZoomInregardingEverythings))
{if(!ed._enableZoom)
{return false;}}
if(user)
{ed._scaleTiming=ed._usertiming;}
else
{ed._scaleTiming=ed._autotiming;}
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var elemsImg=ed.get(currobj.holderdivid);try
{if(elemsImg!=null)
{if((parseFloat(window.ide.maxScaleFactor)==parseFloat(scaleFactor))&&(currobj.loadedimageHD))
{scaleFactor=window.ide.scaleOfFullZoomHD;}
if((currobj.loadedimageHD)&&(window.ide.scaleOfFullZoomHD>window.ide.scaleOfFullZoom))
{if(scaleFactor>window.ide.scaleOfFullZoomHD)
{scaleFactor=window.ide.scaleOfFullZoomHD;}}
else if(scaleFactor>window.ide.maxScaleFactor)
{scaleFactor=window.ide.maxScaleFactor;}
if(scaleFactor<(window.ide.defaultPublicationScale/2))
{scaleFactor=(window.ide.defaultPublicationScale/2);}
var window_pgs_index=currobj.arrindex;if(!window.initer.isIe9)
{window.eddata.pages[window_pgs_index].currentZoom=scaleFactor;window.eddata.pages[window_pgs_index].iscroll[0].zoom(scaleFactor);window.eddata.pages[window_pgs_index].iscroll[0].refresh();}}}catch(e)
{}}},setZIndexForInteractive:function(anim_object_id,mode){var loadPage=window.ed._currentPageObjPgs.pagenumber-1;var highestZIndex=0;var originalZIndex=0;var imgArrayFirstIndex=-1;var imgArraySecondIndex=-1;var currentZIndex=0;for(var pgs=0;pgs<window.ide.editionAllPagesCount;pgs++)
{pageId=pgs;if(loadPage==pgs)
{if(window.ide.currentPageObjPgs.interactive!=null)
{if(window.ide.currentPageObjPgs.interactive.length>0)
{for(var d=0;d<window.ide.currentPageObjPgs.interactive.length;d++)
{var currObj=window.ide.currentPageObjPgs.interactive[d];if(currObj.itype==window.ide.itypeimage)
{if(window.ed.get(currObj.divid)!=null)
{if(parseInt(window.ed.get(currObj.divid).style.zIndex)>highestZIndex)
{highestZIndex=parseInt(window.ed.get(currObj.divid).style.zIndex);}
if(parseInt(currObj.id)==parseInt(anim_object_id))
{originalZIndex=parseInt(currObj.zindex);currentZIndex=parseInt(window.ed.get(currObj.divid).style.zIndex)
imgArrayFirstIndex=pageId;imgArraySecondIndex=d;}}}}}}}}
if((highestZIndex>0)&&(originalZIndex>0)&&(currentZIndex>0)&&(imgArrayFirstIndex>-1)&&(imgArraySecondIndex>-1))
{var currObj=window.ide.currentPageObjPgs.interactive[imgArraySecondIndex];if(mode=="top"){if(highestZIndex>currentZIndex)
{highestZIndex=highestZIndex+1;window.ed.traceRegardless('Zindex for obj ['+currObj.id.toString()+'] is set to TOP ['+highestZIndex.toString()+']');window.ed.get(currObj.divid).style.zIndex=highestZIndex.toString();}}
if(mode=="orig"){if(currentZIndex!=originalZIndex)
{window.ed.traceRegardless('Zindex for obj ['+currObj.id.toString()+'] is set to ORIG ['+originalZIndex.toString()+']');window.ed.get(currObj.divid).style.zIndex=originalZIndex.toString();}}}},clearAllCanvas:function(firstPage,secondPage,currentHTMLDiv){if(ed._loader_visible)
{ed.hideLoader();}
var isFirst=true;for(var d=0;d<window.ide.editionAllPagesCount+1;d++)
{var canvasNm=('pageHTMLDiv'+currentHTMLDiv);var canvasElem=document.getElementById(canvasNm);if(canvasElem!=null)
{if((d>=(parseInt(firstPage)))&&(d<=(parseInt(secondPage))))
{var evalLink='doDraw'+(d).toString()+'()';if((evalLink!=ed._previousDrawn)&&(evalLink!=ed._previousDrawn2))
{}
if(isFirst)
{ed._previousDrawn=evalLink;ed._previousDrawn2=evalLink;isFirst=false;}
else
{ed._previousDrawn2=evalLink;}}}}},logoffStatusToLoadingImages:function(){ed.currentlyloadingImages=false;if(ed._loader_visible)
{ed.hideLoader();}},setStatusToLoadingImages:function(){ed.currentlyloadingImages=true;},disableCommands:function(){},enableCommands:function(){ed.commandsEnabled=true;},clearImageFromMemory:function(divlowres,linkslowres){try
{}catch(e){ed.trace('couldnt find lowres for clearing image from memory -> '+divlowres);}
try
{document.getElementById(linkslowres).style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(linkslowres).style.background=window.ed.defaultNoImageValue;try
{document.getElementById(linkslowres+'Links').style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(linkslowres+'Links').style.background=window.ed.defaultNoImageValue;}catch(e){}}catch(e){ed.trace('couldnt find links div for clearing image from memory -> '+linkslowres);}},afterResize:function(){},enableCommandsAndHideLoader:function(_this_loader){ed.hideLoader(_this_loader);ed.enableCommands();ed.logoffStatusToLoadingImages();},checkLoadingInteractive:function(itype){var curr_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var pageleft=curr_obj.pagenumber;var pageright=-1;if((curr_obj.leftPage==window.ide.currentPage)&&(ide.orientIsBookMode))
{pageright=curr_obj.rightPage;}
else if(ide.orientIsBookMode)
{pageright=curr_obj.leftPage;}
var foundunloaded=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if((currobj.pagenumber==pageright)||(currobj.pagenumber==pageleft))
{for(var l in currobj.interactive)
{var tmpinteractive=currobj.interactive[l];if(tmpinteractive.itype==itype)
{if(typeof(tmpinteractive.initially_hidden)!='undefined')
{if((!tmpinteractive.contentloaded)&&(tmpinteractive.initially_hidden!=1))
{foundunloaded=true;}}
else
{if(!tmpinteractive.contentloaded)
{foundunloaded=true;}}}}}}
return foundunloaded;},onAfterVideosDrawn:function(forPgNumber,videodivid){if(window.ide.contain_video){window.ed.checkAutoplayVideos(forPgNumber,videodivid);}
window.ed.checkPreloadedImgs(forPgNumber,videodivid,window.ide.itypevideo);},showNonAnimatedInteractiveObjs:function(){var curr_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var pageleft=curr_obj.pagenumber;var pageright=-1;if((curr_obj.leftPage==window.ide.currentPage)&&(ide.orientIsBookMode))
{pageright=curr_obj.rightPage;}
else if(ide.orientIsBookMode)
{pageright=curr_obj.leftPage;}
var foundunloaded=false;for(var d in window.eddata.pages)
{var currobj=window.eddata.pages[d];if((currobj.pagenumber==pageright)||(currobj.pagenumber==pageleft))
{for(var l in currobj.interactive)
{var dividtoanimate='';var tmpinteractive=currobj.interactive[l];switch(tmpinteractive.itype){case window.ide.itypeaudio:case'threesixty':{dividtoanimate=tmpinteractive.holderDivId;}}
if(dividtoanimate!='')
{$('#'+dividtoanimate).stop();$('#'+dividtoanimate).css({'visibility':'visible'}).delay(10).transition({opacity:1},350,window.ed.defaultEasing);}
if(tmpinteractive.itype=='threesixty')
{edThreesixty.finalizeElement(tmpinteractive);}}
try
{$('#'+curr_obj.dividinner).css({'visibility':'visible','pointer-events':'none'});}catch(e){}
$('.links').css({'visibility':'visible'});}}
return foundunloaded;},setInitAnimDiv:function(currObj){switch(currObj.itype)
{case window.ide.itypegallery:case window.ide.itypetextblock:currObj.animDivId=currObj.divid.substr(0,currObj.divid.length-'inner'.length)
break;default:currObj.animDivId=currObj.divid;}},refreshIscrollsFix:function(){try
{for(var l in window.ed.arrIscrolls)
{var currisroll=window.ed.arrIscrolls[l];if(currisroll!=null)
{eval('window.ed.'+currisroll+'.refresh();');}}}catch(e){}},runAnimationIfAnyPrepared:function(){if(window.ed.waitingAnims!='')
{eval(window.ed.waitingAnims);window.ed.waitingAnims='';}},setGlobalRefreshFunction:function(){window.refreshAfterShow=function(){window.ed.playershown=true;window.ed.refreshIscrollsFix();window.ed.runAnimationIfAnyPrepared();if(!window.ed.startinPageEventCalled)
{window.ed.startinPageEventCalled=true;window.edStartingPageSet();{window.ed.zoomendwasalreadycalled=false;edCurrentPageZoomEnd();}}
if(window.tlbr.layout!==undefined)
{window.tlbr.layout();}
else
{console.log('ERROR! window.tlbr.layout() function is not found! Invalid custom toolbar?');debugger;}}},loadImagesForPage:function(pageId){window.ed.animation_local_int_vars=new Object();var loadPage=pageId;ed._last_image_clicked='';var this_object=window.f.findObjFromWindowPgsByPagenumber(pageId);if(this_object.pageElementsLoaded)
{edPageLoaded();return false;}
ed._pg_hasAnim=false;var hasElements=false;var atLeastOneWasLoaded=false;var elementNotPreloaded='';var anyPreloadImage=false;for(var d in this_object.interactive)
{var currObj=this_object.interactive[d];if(currObj.itype==window.ide.itypeimage||currObj.itype==window.ide.itypetextblock||currObj.itype==window.ide.itypegallery||currObj.itype==window.ide.itypevideo)
{hasElements=true;try
{if(currObj.id>0)
{if(currObj.closeonclick==1)
{window.f.AtachEvent(currObj.divid,window.ed._touch_start_event_nm,'window.ed.click_on_image');if(window.ed.istouchdevice)
{window.f.AtachEvent(currObj.divid,'mousedown','window.ed.click_on_image');}}}}catch(e){}
if(currObj.preload)
{anyPreloadImage=true;if(currObj.hasAnim)
{atLeastOneWasLoaded=true;}
if(currObj.isScrollableImage)
{var addscrollbarStr='hScrollbar:true,vScrollbar:true,fadeScrollbar: true,';if(currObj.hideScrollbars)
{addscrollbarStr='hScrollbar:false,vScrollbar:false,fadeScrollbar: false,';}
var addjs='var currobj_imagesrcimg = document.getElementById("'+currObj.imagesrcimg+'");'+'var currobj_divid = document.getElementById("'+currObj.divid+'");'+' if(currobj_imagesrcimg != null){'+'    currobj_imagesrcimg.src=this.src;'+'  currobj_imagesrcimg.style.display="block";'+'  }'+' if(currobj_divid != null){'+'  currobj_divid.style.display="block";'+'  }';addjs+='window.setTimeout(function(){'+'if(window.ide.currentPage=='+window.ide.currentPage.toString()+'){'+'var currentiscroll = new iScroll("'+currObj.scrollholder+'",{x:'+currObj.startScrollX+',y:'+currObj.startScrollY+','+addscrollbarStr+' bounce: true, zoom:false });'+'window.ed.'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+' =  currentiscroll;'+'window.ed.'+currObj.iscrollid+'=currentiscroll;'+'window.ed.arrIscrolls.push("'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+'");'+'}';addjs+='},10);';}
else
{var addjs='var currobj_dividimage = document.getElementById("'+currObj.dividimage+'");'+'if(currobj_dividimage != null){'+'currobj_dividimage.style.backgroundImage="url("+String.fromCharCode(39)+this.src+String.fromCharCode(39)+")";'+'}';}
if(currObj.connected)
{if(ed.get(currObj.divid)!=null)
{ed.get(currObj.divid).style['visiblity']='hidden';}}
ed.isLoadingObjectsImages=true;ed.addtodownloadlistImages=ed.addtodownloadlistImages+','+currObj.divid+',';eval('var imgs'+d.toString()+' = new Image();');eval('imgs'+d.toString()+'.onload = function(){try{window.eddata.pages['+this_object.arrindex.toString()+'].interactive['+d+'].preloaded = true;window.ed.setAnimObjectPreloadStatus('+currObj.id.toString()+',true);'+addjs+'window.ed.checkPreloadedImgs('+loadPage+',this.alt);}catch(e){console.log("Error while seting anim object preload status and interactive.preloaded to true!. ["+e.message+"]");}}');eval('imgs'+d.toString()+'.onerror = function(){window.ed.checkPreloadedImgs('+loadPage+',this.alt);}');eval('imgs'+d.toString()+'.alt = "'+currObj.divid+'";');eval("imgs"+d.toString()+".src = '"+currObj.src+"';");try
{var arrinx=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).arrindex;document.getElementById('pageHTMLDiv'+arrinx.toString()+'Inner').style.opacity='1';}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4510; column: 305;  :: '+v);ed.trace('LOAD IMAGES FOR PAGE->Error while setting opacity to 1 -> '+e.message);}}
else
{elementNotPreloaded=currObj.divid;}}}
if(!hasElements||!anyPreloadImage){call_after_load_and_anim_finished_dev('pgl4');edPageLoaded();}
if((!atLeastOneWasLoaded)&&(hasElements)&&(elementNotPreloaded!=''))
{ed._pg_hasAnim=true;window.ed.checkPreloadedImgs(loadPage,elementNotPreloaded);}},runCallback:function(callback){try
{callback=ed.stringReplace(callback,ed.dblQuote,'"',0);eval(callback);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4516; column: 205;  :: '+v);console.log("Error when calling callback -> ["+e.message+"]"+callback);}},endLoadingBackgroundAndLinksForPage:function(for_page_number,divlowres,imgsrc){var currObj=window.f.findObjFromWindowPgsByPagenumber(for_page_number);if(currObj!=null)
{currObj.iscurrentlyloadingpagebackground=false;}
ed.addToDownloadList=ed.addToDownloadList.replace(','+divlowres+',','');if(ed.addToDownloadList=='')
{ed.isLoadingPageBackgrounds=false;ed.hideLoader();}
var lowres_element=document.getElementById(divlowres);if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{if(lowres_element!=null){lowres_element.src=imgsrc;}}
else
{if(lowres_element!=null){lowres_element.style.backgroundImage="url('"+imgsrc+"')";}}
currObj.loadedimage=true;var currobj=currObj;if(currobj!=null)
{if(window.ed.get(currobj.holderdivid)!=null)
{if(window.ed.get(currobj.holderdivid).style.display.toLowerCase()=='none')
{if(!window.ed.get(currobj.holderdivid).isfadeinsubpage)
{window.ed.get(currobj.holderdivid).style.display='block';$('#'+currobj.holderdivid).fadeTo(0,1);}}}}},loadBackgroundAndLinksForPage:function(for_page_number,lowresDiv,lowresSrc,linksDiv,linksSrc,loadlinks,callback){try
{try
{var currObj=window.f.findObjFromWindowPgsByPagenumber(for_page_number);if(currObj!=null)
{ed.addToDownloadList=ed.addToDownloadList+','+lowresDiv+',';if(!ed._loader_visible)
{ed.showLoader();}
ed.isLoadingPageBackgrounds=true;currObj.iscurrentlyloadingpagebackground=true;window.ed.currentDownloadImageIndex=window.ed.currentDownloadImageIndex++;var callback_set=ed.stringReplace(callback.toString(),'"',window.ed.dblQuote,1);eval('var img_lodr'+window.ed.currentDownloadImageIndex.toString()+' = new Image()');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.onload = function(){window.ed.endLoadingBackgroundAndLinksForPage('+for_page_number.toString()+',"'+lowresDiv+'","'+lowresSrc+'");if(this.alt !=""){window.ed.runCallback(this.alt);}}');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.onerror = function(){window.ed.endLoadingBackgroundAndLinksForPage('+for_page_number.toString()+',"'+lowresDiv+'","'+lowresSrc+'");if(this.alt !=""){window.ed.runCallback(this.alt);}}');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.alt = "'+callback_set.toString()+'"');eval('img_lodr'+window.ed.currentDownloadImageIndex.toString()+'.src = "'+ed.stringReplace(lowresSrc," ","").toString()+'"');}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4533; column: 1183;  :: '+v);console.log('couldnt find lowres for loading image to memory -> '+divlowres+' ::: '+e.message);}
try
{if(loadlinks)
{if(linksDiv!='')
{document.getElementById(linksDiv).style.backgroundImage="url('"+linksSrc+"')";}}}catch(e){ed.trace('couldnt find links div for clearing image from memory -> '+linkslowres);}}
catch(e)
{}},showCurrentDiv:function(elementname){window.ed.preventBecauseLoadingImagesToMemory=false;ed.hideLoader();},already_requested_html5:[],getThumbToLoad:function(forPageObj){if((typeof(forPageObj.canvas)=="undefined")||(forPageObj.canvas==""))
{if(typeof(forPageObj.background_color)!='undefined')
{return window.ed.defaultNoImageValueSrc;}}
else
{if(window.edgl.argo.indexOf('*without_html5_page_img*')!=-1){return forPageObj.canvas;}
for(var i in window.ed.already_requested_html5){if(window.ed.already_requested_html5[i]==(forPageObj.arrindex+1)){return forPageObj.canvas;}}
return forPageObj.thumb;}},getCanvasToLoad:function(forPageObj,forceGetHD){if(typeof(forceGetHD)=='undefined')
{var forceGetHD=false;}
var isHD=window.ide.useHDCanvas==window.ide.editionId;if((typeof(forPageObj.canvas)=="undefined")||(forPageObj.canvas==""))
{if(typeof(forPageObj.background_color)!='undefined')
{$('#'+forPageObj.lowresdiv).css({'background-color':forPageObj.background_color});return window.ed.defaultNoImageValueSrc;}}
else
{if((isHD)||(forceGetHD))
{return forPageObj.canvasHD;}
else
{return forPageObj.canvas;}}},getcurrentdragpercent:function(child){var fullheight=$(child).parent().height()-$(child).height();var percentscrolled=$(child).position().top/fullheight;return percentscrolled;},setcurrentdragpercent:function(percent,child){var fullheight=$(child).parent().height()-$(child).height();var percentscrolled=fullheight*percent;$(child).css({'top':percentscrolled.toString()+'px'});return true;},updatedragscroller:function(){var mainpholder='.edition-player';if($(mainpholder).find('.ed-pscroll-parent').length>0)
{var percentscrl=window.ide.paralaxScrollY/-(ed.paralaxmaxscrolly);var child=$(mainpholder).find('.ed-pscroll-parent').find('.ed-pscroll-child')[0];ed.setcurrentdragpercent(percentscrl,child);}},calculatemaxscrolly:function(){ed.paralaxmaxscrolly=0;var currp=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currp!=null)
{if(currp.ismainparalaxpage)
{var cnt=0;var tmpparalaxallpages=(currp.paralaxallages).split(',');for(var d in tmpparalaxallpages)
{var currpg=tmpparalaxallpages[d];if(!isNaN(currpg))
{if(parseInt(currpg)>0)
{cnt++;}}}
ed.paralaxmaxscrolly=(cnt*window.eddata.head.pageHeight);}}},loadPage:function(for_page,loadAllelements){if(typeof(loadAllelements)=='undefined')
{var loadAllelements=false;}
var _set_to_close=false;var _original_current_page=for_page;try
{var this_page_object=window.f.findObjFromWindowPgsByPagenumber(for_page);var currentPage=this_page_object.arrindex;}catch(e){console.log('!!!Error!!!! in loadPage funct -> Object is '+this_page_object+' ____ PAGE->'+for_page)}
ed._OBJECT_TO_SHOW='';var n=currentPage;var elmnm='lowres'+n.toString();var elem=document.getElementById(elmnm);if((!window.eddata.pages[n].pageloaded)&&(!window.eddata.pages[n].iscurrentlyloadingpagebackground))
{window.ed.showLoader();ed.showLoader(ed.loader1);ed.disableCommands();try
{if(window.eddata.pages[n].ismainparalaxpage)
{window.ide.paralaxPagesInitiate(window.eddata.pages[n]);}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4568; column: 193;  :: '+v);console.log("exception while drawing paralax scrollbar ->"+e.message);}
ed.setStatusToLoadingImages();var difference=ed.maxLoadedPages / 2;var leftDifference=Math.floor(difference);if((leftDifference%2)>0)
{leftDifference=leftDifference-1;}
var startCount=currentPage-leftDifference;if(startCount<0)
{startCount=0;}
var endCount=startCount+ed.maxLoadedPages;var tmout=0;var showElement=elmnm;if(ed._pressedElement!=null)
{var objName=ed._pressedElement.id.toLowerCase().replace('pagehtmldiv','lowres');var thisD=parseInt(ed._pressedElement.id.toLowerCase().replace('pagehtmldiv',''));var objLinkName=ed._pressedElement.id;}
else
{var objName='pageHTML'+n.toString();var objNameLinks='pageHTMLDiv'+n.toString();}
var curobj=this_page_object;if(curobj!=null)
{var objName=curobj.pageHTML;var objNameLinks=curobj.divid;}
var obj=ed.get(objName);window.ed.loaderSetAlpha(100,objName,0);ed.maindownloadGroupIndex++;startCount=n;endCount=n;var d=n;var elemname='lowres'+d.toString();var elem=document.getElementById(elemname);if(elem!=null)
{if(!window.eddata.pages[d].pageloaded)
{ed.preventBecauseLoadingImagesToMemory=true;ed._download_counter++;ed.downloads.items.push(ed._download_counter);var path=window.ed.getCanvasToLoad(window.eddata.pages[d]);var download_path_image=path;ed.downloads.items[ed._download_counter]={loadpath:path,downloadindex:ed.maindownloadGroupIndex};_set_to_close=true;if(loadAllelements)
{var show_links_str="window.ed.showLinks(true);";var callback="window.eddata.pages["+d.toString()+"].pageloaded = true;window.ed.checkIfFilesDowloaded('"+ed.stringReplace(download_path_image," ","",3)+"',\"window.ed.showCurrentDiv("+ed.singleQuote+objName+ed.singleQuote+");"+show_links_str+"\","+ed.maindownloadGroupIndex.toString()+");";}
else
{var callback="";}
var loadLinks=true;if(this_page_object.linksAreTransparent)
{loadLinks=false;linksDiv='';}
if(this_page_object.linksOnPage<1)
{loadLinks=false;linksDiv='';}
if(!loadAllelements)
{loadLinks=false;linksDiv='';}
window.ed.loadBackgroundAndLinksForPage(this_page_object.pagenumber,this_page_object.lowresdiv,window.ed.getCanvasToLoad(this_page_object),this_page_object.linksDiv,this_page_object.linkimage,loadLinks,callback);ed._OBJECT_TO_SHOW=elmnm;}}}
else if(window.eddata.pages[n].pageloaded)
{try
{if(window.eddata.pages[n].ismainparalaxpage)
{if($('.ed-pscroll-parent').length<1)
{window.ide.paralaxPagesInitiate(window.eddata.pages[n]);}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4596; column: 194;  :: '+v);console.log("exception while drawing paralax scrollbar ->"+e.message);}}},updatePaginator:function(alsoLoadNewImages){if(typeof(alsoLoadNewImages)=='undefined')
{var alsoLoadNewImages=true;}
var pageId=window.ide.currentPage;window.ide.currentPage=pageId;window.ed._currentPageObjPgs=window.f.findObjFromWindowPgsByPagenumber(pageId);try
{if(document.getElementById('contentPaginator')!=null)
{for(var d=0;d<document.getElementById('contentPaginator').options.length;d++)
{if(parseInt(document.getElementById('contentPaginator').options[d].value)==parseInt(pageId))
{document.getElementById('contentPaginator').options[d].selected='selected';}}}}catch(e){}},drawLinks:function(pageId){var ratio=1;ratio=ed.preferredWidth / ed._originalPageWidth;if(parseInt(pageId)<1){pageId=1;}
secondpageId=-1;if((!ed._isPortraitMode)&&(pageId>1))
{if((pageId%2)==0)
{var secondpageId=pageId+1;}
else
{var secondpageId=pageId-1;}
var tmp=secondpageId;secondpageId=pageId
pageId=tmp;}
if(secondpageId>window.ide.editionAllPagesCount)
{secondpageId=window.ide.editionAllPagesCount;}
ed.clearAllCanvas(firstPage,secondPage,window.ide.currentPage-1);},onVideoCleared:function(video_id,page_id,video_title,video_id_plain){var video=$('#'+video_id);if(!video.length){return;}
var event={data:{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain}};if(window.ide.contain_video){window.ed.onEndedTrackingVideoPlayer(event);}},getHiddenPagesOffsetToPage:function(pageId){var hiddenPagesOffset=0;var set=false;for(var l=0;l<pageId;l++)
{var currobj=window.f.findObjFromWindowPgsByArrIndex(l);if(currobj.arrindex==l)
{if((!currobj.ismainpage)||(currobj.hidden))
{if((ed._isLandscapeMode))
{hiddenPagesOffset=hiddenPagesOffset+1;}
else
{if(ed._isPortraitMode)
{if(!currobj.ismainpage)
{hiddenPagesOffset=hiddenPagesOffset+1;}}}}}}
return hiddenPagesOffset;},unloadImagesFromPage:function(arrIndex){var pageId=arrIndex;if(window.ide.currentPageObjPgs.interactive!=null)
{if(window.ide.currentPageObjPgs.interactive.length>0)
{for(var d in window.ide.currentPageObjPgs.interactive)
{var currObj=window.ide.currentPageObjPgs.interactive[d];if(currObj.itype==window.ide.itypeimage)
{try
{if(currObj.isScrollableImage)
{try
{for(var l in window.ed.arrIscrolls)
{var iscroller=window.ed.arrIscrolls[l];if(iscroller!='')
{var tmpiscrl=eval('window.ed.'+iscroller);if((tmpiscrl!=null)&&(tmpiscrl!='undefined'))
{tmpiscrl.destroy();}
window.ed.arrIscrolls[l]='';}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4633; column: 165;  :: '+v);console.log('Error while freeing iscroll -> '+e.message);}
window.ed.setAnimObjectPreloadStatus(currObj.id,false);currObj.preloaded=false;document.getElementById(currObj.imagesrcimg).src=window.ed.defaultNoImageValueSrc;document.getElementById(currObj.divid).style.display='none';}
else
{currObj.preloaded=false;window.ed.setAnimObjectPreloadStatus(currObj.id,false);document.getElementById(currObj.dividimage).style.backgroundImage=window.ed.defaultNoImageValue;document.getElementById(currObj.divid).style.display='none';}}
catch(e){}}}}}},clearFadeInSubpage:function(_page_fadein_id){var fadeinobj=window.f.findObjFromWindowPgsByPagenumber(_page_fadein_id);var objnm=ed.get(fadeinobj.holderdivid);objnm.style.display='none';objnm.style.top='-5000px';try
{ed.clearImageFromMemory(fadeinobj.lowresdiv,fadeinobj.divid);try
{ed.unloadImagesFromPage(fadeinobj.arrindex);}catch(e){}}catch(e){}},hideAllFadeInSubpages:function(dontrefresh,dontclearpage1,dontclearpage2,doinstantly){if(typeof(doinstantly)=='undefined')
{var doinstantly=false;}
if(typeof(dontrefresh)=='undefined')
{var dontrefresh=false;}
for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if((currobj.isfadeinvisible)&&(currobj.isfadeinsubpage))
{if((parseInt(currobj.pagenumber)!=parseInt(dontclearpage1))&&(parseInt(currobj.pagenumber)!=parseInt(dontclearpage2)))
{var fadeinobj=window.f.findObjFromWindowPgsByPagenumber(currobj.pagenumber);if(doinstantly)
{window.setTimeout('window.ed.loaderSetAlpha(0,"'+fadeinobj.holderdivid+'",0);',1);window.setTimeout('window.ed.clearFadeInSubpage('+fadeinobj.pagenumber+');',2);}
else
{window.setTimeout('window.ed.loaderSetAlpha(0,"'+fadeinobj.holderdivid+'",300);',50);window.setTimeout('window.ed.clearFadeInSubpage('+fadeinobj.pagenumber+');',351);}
currobj.isfadeinvisible=false;ed._fadein_subpage_visible=false;ed._fadein_pgs_id=-1;ed._fadein_parent_id=-1;}}}},refreshStuffonchangedPage:function(_set_to_page,loadnewimages){if(typeof(loadnewimages)=='undefined')
{var loadnewimages=true;}
window.ide.currentPage=_set_to_page;ed._page_id=_set_to_page;window.f.setDefaultsOnActualChangePage();ed._actionversion=ed._actionversion+1;ed.updatePaginator(loadnewimages);window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",200);},setNewPageWithoutBgRefresh:function(_page_id_to_show){window.ide.currentPage=parseInt(_page_id_to_show);window.f.setDefaultsOnActualChangePage();ed._page_id=parseInt(_page_id_to_show);ed.updatePaginator(false);},initAndPosFadeInSubpage:function(_page_id_to_hide,_page_id_to_show){var dontWorryAboutParent=false;if(parseInt(_page_id_to_hide)==parseInt(_page_id_to_show))
{var _page_id_to_hide=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).mainPageId;}
var foundobj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show);var parentObj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide);if(foundobj!=null)
{ed._fadein_subpage_visible=true;ed._fadein_pgs_id=_page_id_to_show;ed._fadein_parent_id=_page_id_to_hide;ed._page_id=_page_id_to_show;var parentObjHolderDiv=parentObj.holderdivid;if(foundobj!=null)
{var rct=ed.get(parentObj.holderdivid).getBoundingClientRect();var newpgTop=rct.top;var newpgLeft=rct.left;ed.get(foundobj.holderdivid).style['top']=newpgTop.toString()+'px';ed.get(foundobj.holderdivid).style['left']=(Math.abs(ed.currentDistance)+(newpgLeft)).toString()+'px';$('#'+foundobj.holderdivid).stop();$('#'+foundobj.holderdivid).fadeTo(0,0.0001);ed.get(foundobj.holderdivid).style['display']='block';window.ed._is_loading_fadein_subpage=false;window.setTimeout('window.ed.refreshStuffonchangedPage('+_page_id_to_show.toString()+',false);',500);try
{if(window.ide.contain_video){window.ed.clearAllActualVideos(true);}
try
{ObjGoAnim(true,false,-11,-11,"hide",window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).pagenumber,false);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4659; column: 250;  :: '+v);window.ed.trace('Error while freeing animations!');}}catch(e){}
ed.setNewPageWithoutBgRefresh(_page_id_to_show);ed.loadPage(_page_id_to_show,true);try
{if(!dontWorryAboutParent)
{window.ed.get(parentObj.holderdivid).style.zIndex=window.ed.z_index_max;}
window.ed.z_index_max=window.ed.z_index_max+1;window.ed.get(foundobj.holderdivid).style.zIndex=window.ed.z_index_max;}catch(e){}
window.setTimeout('window.ed.endFadeinPageLoading("'+dontWorryAboutParent.toString()+'","'+parentObj.holderdivid+'","'+foundobj.holderdivid+'",'+_page_id_to_show.toString()+','+_page_id_to_hide.toString()+')',300);}}},endFadeinPageLoading:function(dontWorryAboutParent,parent_holder_divid,holder_divid,_page_id_to_show,_page_id_to_hide){if(ed.currentlyloadingImages)
{window.setTimeout('window.ed.endFadeinPageLoading("'+dontWorryAboutParent.toString()+'","'+parent_holder_divid+'","'+holder_divid+'",'+_page_id_to_show.toString()+','+_page_id_to_hide.toString()+')',200);}
else
{window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show).isfadeinvisible=true;window.setTimeout('window.ed.loaderSetAlpha("100","'+holder_divid+'",600);',50);if(dontWorryAboutParent=='false')
{try
{window.f.findObjFromWindowPgsByPagenumber(_page_id_to_hide).ishiddenbecauseoffadeinsubpage=true;}catch(e){}
window.setTimeout('window.ed.hideAllFadeInSubpages(false,'+_page_id_to_show.toString()+',-1,true);',651);window.setTimeout('window.ed.loaderSetAlpha(0,"'+parent_holder_divid+'",600);',60);}
window.setTimeout('window.ed.checkIfAnyAction(window.ed._actionversion);',800);}},checkFadeInSubpagesHide:function(dontrefresh,dontfreepage1,dontfreepage2){if(typeof(dontfreepage1)=='undefined')
{var dontfreepage1=-1;}
if(typeof(dontfreepage1)=='undefined')
{var dontfreepage2=-1;}
if(typeof(dontrefresh)=='undefined')
{var dontrefresh=false;}
if(ed._fadein_subpage_visible)
{ed.hideAllFadeInSubpages(dontrefresh,dontfreepage1,dontfreepage2);}},showFadeInSubpagePage:function(_page_id_to_hide,_page_id_to_show){ed.checkFadeInSubpagesHide(true,_page_id_to_hide,_page_id_to_show);if(parseInt(_page_id_to_hide)==parseInt(_page_id_to_show))
{}
var foundobj=window.f.findObjFromWindowPgsByPagenumber(_page_id_to_show);if(foundobj!=null)
{window.setTimeout("window.ed.initAndPosFadeInSubpage("+_page_id_to_hide.toString()+","+_page_id_to_show.toString()+");",50);}},resetAllPagesThatAreNotVisibleBecauseOfSubpages:function(){for(var l in window.eddata.pages)
{var currobj=window.eddata.pages[l];if(currobj.ishiddenbecauseoffadeinsubpage)
{if(currobj.pageloaded)
{if(!window.eddata.pages[l].isfadeinsubpage)
{window.eddata.pages[l].ishiddenbecauseoffadeinsubpage=false;window.ed.get(window.eddata.pages[l].holderdivid).style.display='block';$('#'+window.eddata.pages[l].holderdivid).stop();$('#'+window.eddata.pages[l].holderdivid).fadeTo(0,1);}
else
{window.eddata.pages[l].ishiddenbecauseoffadeinsubpage=false;}}}}},callAllFunctionsAfterPageTransitionALL:function(previosPGSobj){window.ed.resetAllPagesThatAreNotVisibleBecauseOfSubpages();window.ed.hideAllFadeInSubpages(false,-1,-1,true);window.ed._is_loading_fadein_subpage=false;if(window.ide.contain_video){window.ed.clearAllActualVideos(true);}
try
{if(previosPGSobj!=null)
{try
{ObjGoAnim(true,false,-11,-11,"hide",previosPGSobj.pagenumber,false);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4691; column: 204;  :: '+v);window.ed.trace('Error while freeing animations!');}}}catch(e){}
ed.hideShowObject(ed._linkImageElemShown);},getCorrectQueryString:function(currentLocation){var resstr='';if(currentLocation.indexOf('?')>0)
{var arr_tmp=currentLocation.split('?');resstr=arr_tmp[1];resstr=resstr.replace("plr="+window.ed.getItemFromQueryString('plr'),'');resstr=resstr.replace("page="+window.ed.getItemFromQueryString('page'),'');resstr=resstr.replace("plr=ed",'');resstr=resstr.replace(resstr,"&&","&");resstr=resstr+":*;ed:*:";resstr=resstr.replace("&:*;ed:*:","");resstr=resstr.replace(":*;ed:*:","");resstr='&'+resstr;resstr=resstr.replace(resstr,"&&","&");}
return resstr;},setResizeEvents:function(){var supportsOrientationChange="onorientationchange"in window,orientationEvent=supportsOrientationChange?"orientationchange":"resize";try
{$(document).on("edResize",function(event){window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);});ed.wrapper.removeEventListener(orientationEvent,window.ide.add_and_resize_pages_to_fit(window.ide.currentPage),false);ed.orientationEvent=window.addEventListener(orientationEvent,window.ide.add_and_resize_pages_to_fit(window.ide.currentPage),false);}catch(e){}},enableScalingForSwipe:function(strScale)
{ed._scaStrForViewPort=strScale;},onImageLoaded:function(img,divlowres,imgsrc){ed.enableCommands();ed.hideLoader(ed.loader10);},refreshScreenResolution:function(){ed.screenWidth=document.documentElement.clientWidth;ed.screenHeight=document.documentElement.clientHeight;},getElementOffset:function(el){var _x=0;var _y=0;while(el&&!isNaN(el.offsetLeft)&&!isNaN(el.offsetTop)){_x+=el.offsetLeft-el.scrollLeft;_y+=el.offsetTop-el.scrollTop;el=el.parentNode;}
return{top:_y,left:_x};},doNextPageProcedure:function(pagenumber){ed.disableCommands();window.setTimeout('window.ed.enableCommands();',300);ed.goToStartOfPage(pagenumber);},getOptimalZoomRatio:function(){var resvar=1/ed._originalRatio;if(window.ed.usesHD)
{var single_original_width=ed._originalPageWidth;var ratio=ed.singlePageWidth / ed.hdwidth;resvar=1/ratio;}
return resvar;},initeDitionSwipe:function(){ed.mainWrapper=document.getElementById("mainHolder");ed.wrapper=document.getElementById("wrapper");ed.slideContainer=document.getElementById("wholeContainerDiv");ed.slides=ed.getAllElementsById('pagesholderparent');try
{if(typeof(addProductsStringToBasket)=='function')
{var cookie_str=ed.getCookie((window.ide.editionId.toString()+"chartContent"));if((cookie_str!='')&&(cookie_str!='undefined'))
{addProductsStringToBasket(cookie_str);}}}catch(e){}
var currobj=f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);ed.goToStartOfPage(currobj.id);},bestViewZoom:function(){if(!window.ed._move_hanlder_started_to_scroll_left_or_right)
{ed.zoomIn(window.ide.bestViewZoomFactor,false,'','',false,false);ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);}},initEvents:function(){if(ed._isDesktopBrowser)
{for(var d=0;d<(window.ide.editionAllPagesCount*2);d++)
{var srchDiv='pagesholderparent'+d.toString();var obj=document.getElementById(srchDiv);if(obj!=null)
{if(obj!='undefined')
{window.f.AtachEvent(obj.id,window.ed._touch_start_event_nm,'window.ed.startHndlLowres');window.f.AtachEvent(obj.id,window.ed._touch_move_event_nm,'window.ed.moveHndlLowres');}}}
try
{window.f.AtachEvent('aboutBox',window.ed._touch_start_event_nm,'window.ed.aboutboxStartHandler');window.f.AtachEvent('aboutBox',window.ed._touch_move_event_nm,'window.ed.aboutboxMoveHandler');window.f.AtachEvent('aboutBox',window.ed._touch_end_event_nm,'window.ed.aboutboxEndHandler');}catch(e){}
try
{window.f.AtachEvent('videoContentSRC',window.ed._touch_start_event_nm,'window.ed.videoStartHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_move_event_nm,'window.ed.videoMoveHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_end_event_nm,'window.ed.videoEndHndler');}catch(e){}
try
{$('#'+window.ide.mainStageElementParent).off("DOMMouseScroll mousewheel wheel onwheel",window.ed.mouseWheel);$('#'+window.ide.mainStageElementParent).on("DOMMouseScroll mousewheel wheel onwheel",window.ed.mouseWheel);}catch(e){}}
else
{for(var d=0;d<(window.ide.editionAllPagesCount*2);d++)
{var srchDiv='pagesholderparent'+d.toString();var obj=document.getElementById(srchDiv);if(obj!=null)
{if(obj!='undefined')
{window.f.AtachEvent(srchDiv,window.ed._touch_start_event_nm,'window.ed.startHndlLowres');window.f.AtachEvent(srchDiv,window.ed._touch_move_event_nm,'window.ed.moveHndlLowres');window.f.AtachEvent(srchDiv,'mousedown','window.ed.startHndlLowres');window.f.AtachEvent(srchDiv,'mousemove','window.ed.moveHndlLowres');}}}
try
{window.f.AtachEvent('aboutBox',window.ed._touch_start_event_nm,'window.ed.aboutboxStartHandler');window.f.AtachEvent('aboutBox',window.ed._touch_move_event_nm,'window.ed.aboutboxMoveHandler');window.f.AtachEvent('aboutBox',window.ed._touch_end_event_nm,'window.ed.aboutboxEndHandler');}catch(e){}
try
{window.f.AtachEvent('videoContentSRC',window.ed._touch_start_event_nm,'window.ed.videoStartHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_move_event_nm,'window.ed.videoMoveHndler');window.f.AtachEvent('videoContentSRC',window.ed._touch_end_event_nm,'window.ed.videoEndHndler');}catch(e){}}
ed.disableCommands();ed._isSingleClick=false;ed.pressed=0;},zoomTo100Percent:function(){ed.zoomOut(window.ide.defaultPublicationScale,true,0,0,false,false,-1);},checkScaleAndEnableTracking:function(eventtmp){ed._enabledTracking=true;},startHandler:function(eventer){},hideAboutBox:function(){$('#aboutBox').stop();$('#aboutBox').transition({opacity:0},290,window.ed.defaultEasing,function(){});window.setTimeout('window.ed.disableCloseAboutBox();',200);window.setTimeout("document.getElementById('innerAboutBox').style.background = 'none';document.getElementById('innerAboutBox').style.backgroundImage = 'none';document.getElementById('aboutBox').style.display = 'none';document.getElementById('aboutBox').style.top = '-1500px';",300);ed.initiateAlpha(document.getElementById('aboutBox'));ed._openedAboutBox=false;},disableCloseAboutBox:function(){ed._openedAboutBox=false;ed.enableCommands();},enableCloseAboutBox:function(){ed._openedAboutBox=true;},showAboutBox:function(){if(ed._openedAboutBox)
{window.ed.hideAboutBox();}
else
{ed._openedAboutBox=false;ed.disableCommands();ed.initiateAlpha(document.getElementById('aboutBox'));document.getElementById('aboutBox').style.opacity="0";document.getElementById('aboutBox').style.top="0px";document.getElementById('aboutBox').style.display='inline';document.getElementById('innerAboutBox').style.top="50%";document.getElementById('innerAboutBox').style.backgroundImage="url('"+ed._aboutBoxImage+"')";window.setTimeout('window.ed.loaderSetAlpha("100","aboutBox",300);',500);window.setTimeout('window.ed.enableCloseAboutBox();',800);}},checkOrientation:function(runFunct){var resvar=false;thisOrient=Math.abs(window.orientation);if(isNaN(thisOrient))
{thisOrient=0}
if(parseInt(thisOrient)!=Math.abs(ed.currentOrientation))
{if(runFunct)
{window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);}
resvar=true;return resvar;}
else
{resvar=ed.setWindowWidthAndHeight(true);return resvar;}},setImageSrc:function(imgelem,objId,functToRun,cancelGpuAccFix){try
{var obj=ed.get(objId);if(typeof(cancelGpuAccFix)=='undefined')
{var cancelGpuAccFix=false;}
if(cancelGpuAccFix!=true)
{cancelGpuAccFix=false;}
if(obj!=null)
{obj.src=imgelem.src;if(cancelGpuAccFix)
{obj.className=obj.className.replace('gpuAcc','');obj.className=obj.className.replace('renderBQ','');obj.className=obj.className+' renderBQ';}
else
{obj.className=obj.className.replace('gpuAcc','');obj.className=obj.className.replace('renderBQ','');obj.className=obj.className+' gpuAcc renderBQ';}}
else
{ed.trace('Error while loading BG image to object "'+objId+'" -> Object does not exit');}
if(functToRun!='')
{eval(functToRun);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4748; column: 126;  :: '+v);ed.trace('Error while loading BG image to object "'+objId+'" -> '+e.message);}},setCallbackCorrect:function(inputstr){var outputstr=inputstr.replace()
var find=ed.singleQuote.toString();var regex=new RegExp(find,"g");outputstr=outputstr.replace(regex,"'");var find=ed.dblQuote.toString();var regex=new RegExp(find,"g");outputstr=outputstr.replace(regex,"'");return outputstr;},checkIfFilesDowloaded:function(thissrcLoaded,callback,groupindex){if(typeof(thissrcLoaded)!='undefined')
{for(var d in ed.downloads.items)
{var currobj=ed.downloads.items[d];if((currobj!=null)||(typeof(currobj)=='undefined'))
{if(currobj.downloadindex==groupindex)
{if(ed.stringReplace(currobj.loadpath," ","")==thissrcLoaded)
{ed.downloads.items[d]=null;}}}}}
var everythingdownloaded=true
for(var d in ed.downloads.items)
{var currobj=ed.downloads.items[d];if(currobj!=null)
{if(currobj.downloadindex==groupindex)
{everythingdownloaded=false;}}}
if(everythingdownloaded)
{var callbackstr=ed.setCallbackCorrect(callback);eval(callbackstr);}
else
{if(!ed._loader_visible)
{ed.showLoader(ed.loader5);}}},removeAllSearchResults:function(){$('.ed-search-result-square').remove();},checkPageSearchResults:function(forpage){var curr_pg_obj=window.f.findObjFromWindowPgsByPagenumber(forpage);if(curr_pg_obj!=null)
{if(typeof(curr_pg_obj.search_results)!='undefined')
{if((curr_pg_obj.search_results).active==1)
{window.eddata.pages[curr_pg_obj.arrindex].search_results.active=0;for(var d in curr_pg_obj.search_results.results)
{var srchrs=curr_pg_obj.search_results.results[d];var addHtml='<div class="ed-search-result-square" style="left:'+srchrs.word.x.toString()+'px;top:'+srchrs.word.y.toString()+'px;width:'+srchrs.word.w.toString()+'px;height:'+srchrs.word.h.toString()+'px;"></div>';$('#'+curr_pg_obj.dividinner).append(addHtml);}}}}},initFirstTime:function(){window.ed.setGlobalRefreshFunction();window.ed.setResizeEvents();try
{if(typeof(runCustomJSScriptOnStart)=='function')
{runCustomJSScriptOnStart();}}catch(e){}
if(!window.ed.debug)
{window.ed.debug=window.ide.debug;}
if(!window.ed.debugLinks)
{window.ed.debugLinks=window.ide.debug;}
window.ed.eDitionName=window.ide.editionName;window.ed.eDitionTitle=window.ide.editionTitle;window.ed.ProjectName=window.ide.editionProjectName;window.ed.animation_global_int_vars=new Object();try
{reorderWindowPGS();ed.usesHD=usshd;ed.hdwidth=hdwdth;ed.hdheight=hdhghgt;}catch(e){}
ed.isThisPreviewApp=false;ed._requests_root_path=window.eddata.path.global_path;ed._requests_root_path_origin=window.eddata.path.global_path;ed.issinglepagemode=window.eddata.appearance.edition_style!='facingpages';ed.isAndroid=(window.navigator.userAgent.toLowerCase().indexOf('android')>0);ed.isIphone=(window.navigator.userAgent.toLowerCase().indexOf('iphone')>0)||(window.navigator.userAgent.toLowerCase().indexOf('ipod')>0);ed.isIpad=(window.navigator.userAgent.toLowerCase().indexOf('ipad')>0);if(ed.isAndroid){$('html').addClass('android-device-html');}
ed._randomchar=window.edgl.xmlversion;ed.checkOrientation(true);ed.thisIsInitialOffset=true;ed.maxLoadedPages=window.ide.eDitionAllPages;window.ide.editionAllPagesCount=window.eddata.head.AllPages;ed._isPortraitMode=window.ide.screenWidth<window.ide.screenHeight;ed._isLandscapeMode=!ed._isPortraitMode;ed._originalPageWidth=window.ide.originalSinglePageWidth;ed._originalPageHeight=window.ide.originalSinglePageHeight;ed._isFirstTime=true;ed._originalRatio=1;ed._originalRatioX=1;ed._originalRatioY=1;ed.iconPercentWidth='50';var leftPage=window.ide.currentPage-1;var rightPage=-1;if(!ed._isPortraitMode)
{if(leftPage%2==1)
{rightPage=leftPage+1;}
else
{leftPage=leftPage-1;rightPage=leftPage+1;}}
var objName='pageHTML'+(leftPage).toString();var obj=ed.get(objName);if(obj!=null)
{}
else
{if(rightPage>-1)
{var objName2='pageHTML'+(rightPage).toString();var obj2=ed.get(objName2);if(obj2!=null)
{obj2.style.opacity='0';window.setTimeout(function(){ed.loaderSetAlpha("100",objName2,1500)},4500);}}}
var timeout=0;window.setTimeout("window.ed.runeDitionSwipeDownloaded();",timeout);},showAllThumbs:function(){},runFirstLinks:function(){ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.isLoadingPublication = false;window.ed.hideLoader();window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},runeDitionSwipeOnReady:function(){window.setTimeout(function(){ed.enableCommands();ed.hideLoader()},200);window.setTimeout(function(){ed.runFirstLinks();},100);},initiateAlpha:function(element){eval('element.style.'+ed.webTransformNm+'Transition = "";');eval('element.style.'+ed.webTransformNm+'TransitionDuration = "";');eval('element.style.'+ed.webTransformNm+'TransitionTimingFunction = "";');},runeDitionSwipeDownloaded:function(){window.setTimeout(function(){ed.setSubpages(true);},5);},freeShowObject:function(object_id){var currObj=window.ide.currentPageObjPgs.interactive;for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.id==object_id)
{if(currObjThs.isScrollableImage)
{try
{for(var l in window.ed.arrIscrolls)
{var iscroller=window.ed.arrIscrolls[l];if(iscroller!='')
{var addjs="var tmpiscrl = eval('window.ed."+iscroller+"');";addjs+="if((tmpiscrl != null)&&(tmpiscrl != 'undefined')){tmpiscrl.destroy();}window.ed.arrIscrolls["+l.toString()+"] = '';";}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4795; column: 323;  :: '+v);console.log('Error while freeing iscroll -> '+e.message);}
window.ide.currentPageObjPgs.interactive[l].preloaded=false;window.ed.setAnimObjectPreloadStatus(currObjThs.id,false);try
{document.getElementById(currObjThs.divid).style.display='none';}catch(e){}
document.getElementById(currObjThs.imagesrcimg).src=window.ed.defaultNoImageValueSrc;}
else
{window.ide.currentPageObjPgs.interactive[l].preloaded=false;window.ed.setAnimObjectPreloadStatus(currObjThs.id,false);document.getElementById(currObjThs.dividinner).style.backgroundImage=window.ed.defaultNoImageValue;try
{document.getElementById(currObjThs.divid).style.display='none';}catch(e){}}}}},setAnimObjectPreloadStatus:function(object_id,preloaded){try
{if(typeof(anim_objects[object_id])!='undefined')
{if(anim_objects[object_id]!=null)
{anim_objects[object_id].preloaded=preloaded;}}}catch(e){}},freeLayer:function(){ed.closeFSCLayer();},freeFSCLayer:function(){if(window.ed.fscLayerSCroll!=null)
{window.ed.fscLayerSCroll.destroy();window.ed.fscLayerSCroll=null;}
try
{var elem_to_set_to=ide.get('showObjectLayer').getElementsByTagName("img")[0];if(elem_to_set_to!=null)
{elem_to_set_to.src=ed.defaultNoImageValueSrc;}
$('#showObjectLayer').stop().css({display:'none',opacity:'0',width:'0px',height:'0px'});}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4809; column: 223;  :: '+v);console.log("Error while freeing FSC LAYER");}},closeFSCLayer:function(){try
{ed.layerIsShown=false;ed._linkImageShowLayer=false;$('#showObjectLayer').stop().transition({opacity:0.0001},250,window.ed.jqueryTransition,function(){window.ed.freeFSCLayer();});}catch(e){console.log("Error while freeing FSC LAYER");}},runCurrentLayer:function(elem,image_width,image_height){ed.loadingLayer=false;ed.hideLoader();if(typeof(image_height)!='undefined')
{var image_width=image_width;var image_height=image_height;}
else
{var image_width=elem.width;var image_height=elem.height;ed.layerLastElement=elem;ed.layerLastElementWidth=image_width;ed.layerIsShown=true;ed.layerLastElementHeight=image_height;}
var ideminratio=1;if(image_height>window.ide.screenHeight)
{ideminratio=window.ide.screenHeight / image_height;}
var setToWidth=Math.round(image_width*ideminratio);var setToHeight=Math.round(image_height*ideminratio);if(setToWidth>window.ide.screenWidth)
{ideminratio=window.ide.screenWidth / image_width;setToWidth=Math.round(image_width*ideminratio);setToHeight=Math.round(image_height*ideminratio);}
if(setToWidth>window.ide.screenWidth)
{}
try{ed.get('showObjectLayer').style.left="0px";ed.get('showObjectLayer').style.top="0px";ed.get('showObjectLayer').style.width=window.ide.screenWidth.toString()+'px';ed.get('showObjectLayer').style.height=window.ide.screenHeight.toString()+'px';var parentNod=ed.get("tblObjLy");parentNod.style.left="0px";parentNod.style.top="0px";parentNod.style.width=window.ide.screenWidth.toString()+'px';parentNod.style.height=window.ide.screenHeight.toString()+'px';elem_to_set_to=parentNod.getElementsByTagName("img")[0];elem_to_set_to.style.width=setToWidth.toString()+'px';elem_to_set_to.style.height=setToHeight.toString()+'px';if(window.ed.fscLayerSCroll==null)
{elem_to_set_to.src=elem.src;if(window.ed.fscLayerSCroll!=null)
{window.ed.fscLayerSCroll.destroy();window.ed.fscLayerSCroll=null;}
window.ed.fscLayerSCroll=new iScroll(parentNod,{zoomMin:1,hScrollbar:true,fadeScrollbar:true,hScrollbar:true,bounce:false,zoom:true,lockDirection:false});}
else
{window.ed.fscLayerSCroll.refresh();}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4825; column: 172;  :: '+v);console.log('Error while creating iScroll -> '+e.message);};$('#showObjectLayer').stop().css({'display':'block',opacity:'0.0001'});$('#showObjectLayer').stop().delay(50).transition({opacity:'1'},500,window.ed.jqueryTransition,function(){});},showImageOnClick:function(idImage,showLayer,version_of_call,calledFromAnim){if(typeof(calledFromAnim)=='undefined')
{var calledFromAnim=false;}
var anim_index=0;var anim_name='show';idImage=idImage.toString();if(idImage.indexOf(',')>0)
{var arr_steps=idImage.split(',');try
{idImage=arr_steps[0];anim_index=arr_steps[1];if(typeof(arr_steps[2])=='undefined')
{anim_name=arr_steps[2];}}catch(e){anim_name='show';}}
var doCleanThem=true;if(ed._previous_version_of_call==version_of_call)
{doCleanThem=false;}
var found=false;var srchObjName='img'+idImage;for(var cntr=0;cntr<2;cntr++)
{var currObj=null;if(cntr==0)
{currObj=window.ide.currentPageObjPgs.interactive;}
if((cntr==1)&&(window.ide.orientIsBookMode))
{currObj_tmp=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(currObj_tmp!=null)
{currObj=currObj_tmp.interactive;}}
else if((cntr==1)&&(!window.ide.orientIsBookMode))
{found=true;}
if(!found)
{for(var l in currObj)
{var currObjThs=currObj[l];var srchObjName='img'+idImage;if(currObjThs.divid==srchObjName)
{var thisObj=document.getElementById(currObjThs.divid);var parentDiv=document.getElementById(currObjThs.parentDivInner);var absoluteParentDiv=document.getElementById(currObjThs.parentDivInner.replace('Inner',''));var currentSrc=currObjThs.src;ed._linkImageElemShown.push({imagename:"'"+srchObjName+"'",islayer:"'"+showLayer+"'"})
if(showLayer)
{var thisObjShow=ed.get('tblObjLy');var divObjShow=ed.get('showObjectLayer');var objImgElem=thisObjShow.getElementsByTagName('img');divObjShow.style.width='100%';divObjShow.style.height='100%';objImgElem[0].src=currentSrc;eval('thisObjShow.style.'+ed.webTransformNm+'Transition="opacity 0.5s linear";');thisObjShow.style.opacity='1';}
else
{ed.disableCommands();ed.showLoader(ed.loader6);if(((parentDiv.style.opacity!='1')&&(parentDiv.style.opacity!='0.0001'))||(parentDiv.style.visibility!='visible'))
{parentDiv.style.opacity='0.0001';parentDiv.style.visibility='visible';}
eval('thisObj.style.'+ed.webTransformNm+'Transition="";');thisObj.style.opacity='0.0001';thisObj.style.visibility='visible';thisObj.style.display='block';var wasSetAlready=false;var currobj=ed.findObjectForShowingFromDivName(currObjThs.divid);if(currobj!=null)
{if(currobj.hasAnim)
{ed.connectedImagePreload(currentSrc,currObjThs.divid,currObjThs.id,currObjThs.parentDivInner,true,currobj.anim_show,l,anim_index,anim_name,calledFromAnim);wasSetAlready=true;}}
if(!wasSetAlready)
{ed.connectedImagePreload(currentSrc,currObjThs.divid,currObjThs.id,currObjThs.parentDivInner,false,'',l,anim_index,anim_name,calledFromAnim);}}}}}}},findObjectForShowingFromDivName:function(searchDivId){if(searchDivId=='')
{searchDivId='undef';}
var returnObj=null;var found=false;if(!found)
{var tmpobjArr=window.ide.currentPageObjPgs.interactive;for(var n in tmpobjArr)
{var chkobj=tmpobjArr[n];if(chkobj.divid==searchDivId)
{returnObj=chkobj;found=true;}}}
return returnObj;},testPolyClick:function(polystring,pointX,pointY){var polystringArr=polystring.split("*");var polyCords=new Array();for(var l=0;l<polystringArr.length;l++)
{polystringArr2=polystringArr[l].split(',');polyCords[l]=[];polyCords[l][0]=parseInt(polystringArr2[0]);polyCords[l][1]=parseInt(polystringArr2[1]);}
var i,j,c=0;for(i=0,j=polyCords.length-1;i<polyCords.length;j=i++)
{if(((polyCords[i][1]>pointY)!=(polyCords[j][1]>pointY))&&(pointX<(polyCords[j][0]-polyCords[i][0])*(pointY-polyCords[i][1])/(polyCords[j][1]-polyCords[i][1])+polyCords[i][0]))
{c=!c;}}
polystringArr2=null;polystringArr=null;polyCords=null;return c;},checkIfCurrentPageHiddenAndReturnCorrectOne:function(val){try
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if(currobj.hidden)
{while(currobj.hidden)
{window.ide.currentPage=window.ide.currentPage+val;currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj.isfirstpage)
{currobj.hidden=false;}
if(currobj.islastpage)
{currobj.hidden=false;}}
window.f.setDefaultsOnActualChangePage();if(currobj!=null)
{ed.subpageindx=currobj.subpageindx;}}}}catch(e){}},checkIfCurrentPageFadeInInAndReturnCorrectOne:function(val){try
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if(currobj.isfadeinsubpage)
{while(currobj.isfadeinsubpage)
{window.ide.currentPage=window.ide.currentPage+val;currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj.isfirstpage)
{currobj.hidden=false;}
if(currobj.islastpage)
{currobj.hidden=false;}}
window.f.setDefaultsOnActualChangePage();if(currobj!=null)
{ed.subpageindx=currobj.subpageindx;}}}}catch(e){}},doStuffOnAfterPageTransition:function(object){window.setTimeout('window.ed.hasAlreadyStartedScrollingVerticalLocaly = false;window.ed.preventLocalHandling = false;window.ed.preventGlobalHandling = false;',50);window.ed.preventGlobalHandling=false;window.ed.preventLocalHandling=false;window.ed.hasAlreadyStartedScrollingVerticalLocaly=false;if(typeof(object)=='undefined')
{var object=null;}
if(object!=null)
{ed.comeBackSubpages(object.mainPageId);}},setSubpagesReset:function(resetsubpages,objpgs){if(typeof(objpgs)=='undefined')
{var objpgs=null;}
ed.subpgsupArrowShow=false;ed.subpgsdownArrowShow=false;if(typeof(resetsubpages)=='undefined')
{var resetsubpages=true;}
window.ed._currentPreviousPageObjPgs=null;if(resetsubpages)
{if(ed.subpageindx>0)
{if(objpgs!=null)
{window.ed._currentPreviousPageObjPgs=objpgs;}
else
{window.ed._currentPreviousPageObjPgs=window.ed._currentPageObjPgs;}
ed.subpageindx=0;}}
ed.subpagesOffsetY=0;ed.subpageindx=0;ed.subpagesOffsetY=0;window.ed._currentPageHasSubpages=false;window.ed._currentPageObjPgs.hasSubpages=false;},checkifFadeinSubpageAndReturnCorrectImage:function(indexOfWhatToSearch){if(typeof(indexOfWhatToSearch)=='undefined')
{return false;}
if(window.ed._currentPageObjPgs!=null)
{if(window.ed._currentPageObjPgs.isfadeinsubpage)
{if(indexOfWhatToSearch==window.ed.currentMainPage)
{var correctPage=window.f.findPreviousObjFromWindowPgsByElementObject(ed.get(window.ed._currentPageObjPgs.divid),false,true);if(correctPage!=null)
{ed.setNewPageWithoutBgRefresh(correctPage.pagenumber);}}}}},doStuffBeforeRightOrLeft:function(plusoneOrMinusOne){ed._subpageActionCount++;},comeBack:function(do_reset_everything){window.ide.checkEndPositionOrComeBack(do_reset_everything);ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},comeBackSubpages:function(mainpageid,subpageindx,doanimate){if(typeof(doanimate)=='undefined')
{var doanimate=true;}
if(doanimate!=false)
{doanimate=true;}
ed.trace('come Back subpages -> '+subpageindx+' ::: Mainpageid'+mainpageid+' DO ANIMATE -> '+doanimate);var startFromOffsetY=0;var singlepageHeight=ed.preferredHeight;if(subpageindx>0)
{startFromOffsetY=-(subpageindx*singlepageHeight);}
var mainpageid=mainpageid;for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];if(((curobj.mainPageId==mainpageid)&&(curobj.isswipesubpage))||((curobj.mainPageId==mainpageid)&&(curobj.ismainpage)))
{var diwlowres=window.eddata.pages[d].holderdivid;if(!doanimate)
{$('#'+diwlowres).transition({'top':(startFromOffsetY).toString()+'px'},0,window.ed.defaultEasing,function(){});}
else
{$('#'+diwlowres).transition({'top':(startFromOffsetY).toString()+'px'},window.ed.defaultTimingSubpages,window.ed.defaultEasing,function(){});}
startFromOffsetY=startFromOffsetY+singlepageHeight;}}
ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);},onLinkdownloaded:function(img,divlowres,imgsrc,pageId,setBg){var currobj=window.f.findObjFromWindowPgsByPagenumber(pageId);if((pageId==window.ide.currentPage)||((currobj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode))&&(!ed._video_shown))
{divlowres=img.alt;var objMove=document.getElementById(img.alt);objMove.style.display='inline';objMove.style.backgroundImage="none";var linksDivName=img.alt+'Links';var actualLinksDiv=window.ed.get(linksDivName);if(setBg)
{if(actualLinksDiv!=null)
{actualLinksDiv.style.backgroundImage="url('"+imgsrc+"')";}}
ed.loaderSetAlphaObject("100",document.getElementById(divlowres),300);ed._actionversion=ed._actionversion+1;window.ed._currentPageLinksShown=true;var secondLowRes=img.alt+'Inner';if(!ed.previewNotSet)
{ed.previewNotSet=true;ed.runPreviewApplication();}
if(ed.get(secondLowRes)!=null)
{if((ed.get(secondLowRes).style['opacity']=='0')||(ed.get(secondLowRes).style['opacity']=='0.0001'))
{ed.get(secondLowRes).style['opacity']='1';}}
try
{ed.drawLinks(pageId);}catch(e){};if(ed._doHideLoader)
{window.setTimeout("window.ed.enableCommandsAndHideLoader(window.ed.loader3);",200);ed._doHideLoader=false;}}},showDivEvenIfNoLinks:function(thisobj,pageId){if((!window.ed._currentPageLinksShown)&&(!ed._video_shown))
{if(pageId==window.ide.currentPage)
{divlowres=thisobj;ed.loaderSetAlphaObject("100",document.getElementById(divlowres),300);window.ed._currentPageLinksShown=true;ed.preventBecauseLinks=false;var secondLowRes=thisobj+'Inner';if(ed.get(secondLowRes)!=null)
{if(ed.get(secondLowRes).style['opacity']=='0')
{ed.get(secondLowRes).style['opacity']='1';}}
try
{ed.drawLinks(window.ide.currentPage);}catch(e){};if(ed._doHideLoader)
{window.setTimeout("window.ed.enableCommandsAndHideLoader(window.ed.loader3);",200);ed._doHideLoader=false;}}}},drawStuffWhenPageOpens:function(){ed.setSubpages(false);},showLinks:function(disLoading){if(window.ed._is_loading_fadein_subpage)
{return false;}
if(window.ide.contain_textblock){window.ed.clearAllTextblockTimeouts();}
var previousDrawnLinks=ed._previous_page_id_drawn_links;ed._previous_page_id_drawn_links=window.ide.currentPage;if((previousDrawnLinks==window.ide.currentPage)&&(window.ed._currentPageLinksShown)&&(!ed.pageWasJustChanged))
{return false;}
ed.pageWasJustChanged=false;if((ed.currentlyloadingImages)&&(!disLoading))
{return false;}
ed._doHideLoader=disLoading;var d_page=window.ide.currentPage;var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{d_page=currobj.arrindex;}
ed.addtodownloadlistImages='';window.ed.removeAllSearchResults();ed.videoisinfullscreen=false;for(var d=window.ide.drawPagesFrom;d<=window.ide.drawPagesTo;d++)
{var tmpobj=window.f.findObjFromWindowPgsByPagenumber(d);var takeDiv=tmpobj.divid;var elemDiv=ed.get(takeDiv)
var LoadPageHTMLDiv_PAGEID=tmpobj.divid;if(elemDiv!=null)
{if((window.ide.currentPage==tmpobj.pagenumber)||((tmpobj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode)))
{window.ed._currentPageLinksShown=false;tmpobj.ranpageanim=false;if(elemDiv.style.visibility!='visible')
{elemDiv.style.opacity=0;elemDiv.style.visibility='visible';if(elemDiv.style.display!='inline')
{elemDiv.style.display='inline';}
ed.initiateAlpha(elemDiv);ed.preventBecauseLinks=true;var source=tmpobj.linkimage;ed.drawStuffWhenPageOpens();if(tmpobj.linksAreTransparent)
{tmpobj.uselinks=false;}
if(tmpobj.linksOnPage<1)
{tmpobj.uselinks=false;}
if(tmpobj.uselinks)
{window.ed.get(LoadPageHTMLDiv_PAGEID+'Links').style.width="100%";}
if(tmpobj.uselinks)
{eval('var linksImg'+d_page.toString()+' = new Image();');eval('linksImg'+d_page.toString()+'.onload = function(){window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(this,"","'+source+'","'+tmpobj.pagenumber+'",true);}');eval('linksImg'+d_page.toString()+'.onerror = function(){window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(this,"","'+source+'","'+tmpobj.pagenumber+'",true);}');eval('linksImg'+d_page.toString()+'.alt = "'+LoadPageHTMLDiv_PAGEID+'";');eval("linksImg"+d_page.toString()+".src = '"+source+"';");}
else
{eval('var linksImg'+d_page.toString()+' = new Image();');eval('linksImg'+d_page.toString()+'.alt = "'+LoadPageHTMLDiv_PAGEID+'";');window.ed.preventBecauseLinks=false;window.ed.onLinkdownloaded(eval('linksImg'+d_page.toString()),"",source,tmpobj.pagenumber,false);}
ed.loadImagesForPage(tmpobj.pagenumber);if(window.ide.contain_textblock){ed.checktextblockesForPage(tmpobj.pagenumber);}
if(window.ide.contain_gallery){ed.checkGalleriesForPage(tmpobj.pagenumber);}
ed.checkPageSearchResults(tmpobj.pagenumber);if(window.ide.contain_sound){window.snd.checkForSoundsForPage(tmpobj.pagenumber);}
window.setTimeout('window.ed.showDivEvenIfNoLinks("'+LoadPageHTMLDiv_PAGEID+'",'+tmpobj.pagenumber+');',3500);try
{if(window.eddata.appearance.edition_style=='facingpages')
{if(ide.isPagenumberRightPage(tmpobj.pagenumber))
{if(tmpobj.pagenumber>1)
{$('#'+elemDiv.id).css({'visibility':'visible',opacity:1});}}}}catch(e){}
if((ed.currentlyloadingImages)&&(disLoading))
{window.setTimeout('if((window.ed.currentlyloadingImages)&&(window.ed.commandsEnabled == false)&&(window.ed._actionversion=='+ed._actionversion+')){window.ed.enableCommandsAndHideLoader(window.ed.loader4);};',5000);}}
else
{ed.loadImagesForPage(tmpobj.pagenumber);}}
else
{if(elemDiv.style.visibility!='hidden')
{ed.initiateAlpha(elemDiv);elemDiv.style.opacity=0;elemDiv.style.backgroundImage='none';elemDiv.style.background='none';elemDiv.style.visibility='hidden';try
{}catch(e){}
try
{var actualLinkImageDivNm=elemDiv.id+'Links';if(window.ed.get(actualLinkImageDivNm)!=null)
{window.ed.get(actualLinkImageDivNm).style.backgroundImage='none';window.ed.get(actualLinkImageDivNm).style.background='none';}}catch(e){}}}}}},hideSiblingPages:function(){for(var d=window.ide.drawPagesFrom;d<=window.ide.drawPagesTo;d++){var tmpobj=window.f.findObjFromWindowPgsByPagenumber(d);var takeDiv=tmpobj.divid;var elemDiv=ed.get(takeDiv)
if(elemDiv!=null){if(elemDiv.style.visibility!='hidden'&&ed._hideSiblingPagesPreviousPageIndex!=window.ide.currentPage){ed.initiateAlpha(elemDiv);elemDiv.style.opacity=0;elemDiv.style.backgroundImage='none';elemDiv.style.background='none';elemDiv.style.visibility='hidden';}}}
ed._hideSiblingPagesPreviousPageIndex=window.ide.currentPage;},setImageBg:function(imgelem,objId,functToRun,dontsetgpuacc){try
{if(typeof(dontsetgpuacc)=='undefined')
{var dontsetgpuacc=false;}
var obj=ed.get(objId);if(obj!=null)
{obj.style.backgroundImage='url("'+imgelem.src+'")';varstr=obj.className;if(!dontsetgpuacc)
{varstr=varstr.replace('gpuAcc','');varstr=varstr.replace('imageRendering','');varstr=varstr+'gpuAcc imageRendering ';}
else
{varstr=varstr.replace('imageRendering','');varstr=varstr+' imageRendering ';}
var find='  ';var quotes=new RegExp(find,'g');varstr=varstr.replace(quotes,' ');obj.className=varstr;}
else
{ed.trace('Error while loading BG image to object "'+objId+'" -> Object does not exit');}
if(functToRun!='')
{eval(functToRun);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 4993; column: 126;  :: '+v);ed.trace('Error while loading BG image to object "'+objId+'" -> '+e.message);}},setSubpages:function(finishinit){if(finishinit)
{ed.initeDitionSwipe();ed.runeDitionSwipeOnReady();}},showHideSocialBookmarks:function(doHideIt){if(typeof(doHideIt)=='undefined')
{doHideIt=false;}
if(doHideIt)
{if(ed.socialBookmarksVisible)
{ed.socialBookmarksVisible=false;if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'0px'},300,window.ed.jqueryTransition,function(){});};}}
else
{if(ed.socialBookmarksVisible)
{ed.socialBookmarksVisible=false;if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'0px'},350,window.ed.jqueryTransition,function(){});};}
else
{if(window.ed.get('socialBookmarksInfEd')!=null){$('#socialBookmarksInfEd').transition({'height':'502px'},300,window.ed.jqueryTransition,function(){});};ed.socialBookmarksVisible=true;}}}};window.eDitionSwipeObj=ed;window.ed=ed;})();
;
window.ed.registerVideoPlayerEvents=function(video_id,page_id,video_title,video_id_plain){var video=$('#'+video_id);if(typeof video=='undefined'){ederror('edition_js','video element is undefined on registerVideoPlayerEvents');return;}
video.on('timeupdate',{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoPlayerTimeUpdate);video.on('play',{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoPlayerPlay);video.on('pause',{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoPlayerPause);video.on('ended',{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onEndedTrackingVideoPlayer);video.on("fullscreenchange",{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoFullscreen);video.on("webkitfullscreenchange",{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoFullscreen);video.on("mozfullscreenchange",{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoFullscreen);video.on("MSFullscreenChange",{video:video,page_id:page_id,video_title:video_title,video_id:video_id_plain},this.onVideoFullscreen);}
window.ed.onVideoPlayerTimeUpdate=function(event){var video=event.data.video;if(!video.length){ederror('edition_js','video element is undefined on onVideoPlayerTimeUpdate');return;}
var video_dom=video[0];var current_time=video_dom.currentTime;var duration=video_dom.duration;var saved_progress=video.data('video_progress');var progress=0;var progress_time=0;if(typeof saved_progress=="undefined"){progress=(parseFloat(current_time)/ parseFloat(duration))*100;progress_time=current_time;video.data('video_progress',progress);video.data('video_progress_time',progress_time);}
else{var calculated_progress=(parseFloat(current_time)/ parseFloat(duration))*100;if(calculated_progress>parseFloat(saved_progress)){progress=calculated_progress;progress_time=current_time;video.data('video_progress',progress);video.data('video_progress_time',progress_time);}}};window.ed.onVideoPlayerPause=function(event){var video=event.data.video;if(!video.length){ederror('edition_js','video element is undefined on onVideoPlayerPause');return;}
if(typeof video.data('has_sent_event')!='undefined'&&video.data('has_sent_event')){return;}
var statDataObj={category:'video',action:'pause',page_id:event.data.page_id,duration:video[0].duration,label:event.data.video_title,edition_object_id:event.data.video_id};window.stats.event('Video','Pause',statDataObj);clearTimeout(video.data('video_player_timeout'));video.data('video_player_timeout',setTimeout(function(){var event_data={data:{video:video,video_title:event.data.video_title,page_id:event.data.page_id,video_id:event.data.video_id}};window.ed.onEndedTrackingVideoPlayer(event_data);},10000));};window.ed.onVideoPlayerPlay=function(event){var video=event.data.video;if(!video.length){return;}
var t=window.setInterval(function(){if(video===undefined||video.length==0||video[0]===undefined||video[0].readyState<=0){return;}
var statDataObj={category:'video',action:'play',page_id:event.data.page_id,label:event.data.video_title,duration:video[0].duration,edition_object_id:event.data.video_id};window.stats.event('Video','Play',statDataObj);clearTimeout(video.data('video_player_timeout'));video.data('has_sent_event',false);clearInterval(t);},500);}
window.ed.onEndedTrackingVideoPlayer=function(event){var video=event.data.video;if(!video.length||(typeof video.data('has_sent_event')!='undefined'&&video.data('has_sent_event'))){return;}
if(typeof video.data('video_progress')=='undefined'){video.data('video_progress',0);video.data('video_progress_time',0);}
clearTimeout(video.data('video_player_timeout'));if(typeof video.data('video_progress')!='undefined'){var statDataObj={category:'Video',action:'playback_percent',page_id:event.data.page_id,label:event.data.video_title,duration:video[0].duration,current_time:video.data('video_progress_time'),percent:video.data('video_progress'),edition_object_id:event.data.video_id};window.stats.event('Video','playback_percent',statDataObj,video.data('video_progress'));}
video.data('has_sent_event',true);}
window.ed.onVideoFullscreen=function(event){var video=event.data.video;if(!video.length){ederror('edition_js','video element is undefined on onVideoFullscreen');return;}
var title_stat='';if(ed.videoisinfullscreen)
{title_stat='Close full screen';ed.videoisinfullscreen=false;}
else
{title_stat='Full screen';ed.videoisinfullscreen=true;}
var statDataObj={category:'Video',action:title_stat,page_id:event.data.page_id,label:event.data.video_title,edition_object_id:event.data.video_id};window.stats.event('Video',title_stat,statDataObj);};window.ed.checkAutoplayVideos=function(forPgNumber,videodivid){var currobjpgs=window.f.findObjFromWindowPgsByPagenumber(forPgNumber);for(var vid in currobjpgs.interactive)
{var tmpobj=currobjpgs.interactive[vid];if(tmpobj.itype==window.ide.itypevideo)
{if(tmpobj.holderDivId==videodivid)
{if(tmpobj.autoPlayMode==1)
{if(!window.ed.firedautoplay)
{window.ed.firedautoplay=true;window.ed.checkVideosAndShow(0,0,0,tmpobj,currobjpgs);}}}}}};var player;function onPlayerReady(event){window.ed.youtubeplaywasalreadysent=false;var is_mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
if(!is_mobile){event.target.playVideo();}}
window.ed.checkVideosAndShow=function(pressedX,pressedY,indx,videointeractiveobj,videopageobj,do_play){var found=false;var checkXCoordinate=pressedX;var checkYCoordinate=pressedY;var exception=false;if(typeof(videointeractiveobj)!='undefined')
{if(videointeractiveobj!=null)
{if(videointeractiveobj.autoPlayMode==1)
{exception=true;}}}
if(do_play){exception=true;}
var elementUnderMouse=$.elementFromPoint().selfOrParents('element_holder');for(var d in window.eddata.pages)
{var currobj_pgs=window.eddata.pages[d];if((currobj_pgs.pagenumber==window.ide.currentPage)||((currobj_pgs.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode)))
{for(var d in currobj_pgs.interactive)
{var curobj=currobj_pgs.interactive[d];if(curobj.itype==window.ide.itypevideo)
{if(curobj!=null){var isClicked=$('#'+curobj.divid).is(elementUnderMouse);if((isClicked)||((exception)&&(videointeractiveobj.id==curobj.id)))
{found=true;ed.get('videoContentSRC').innerHTML='';var htmlSrc=curobj.src;if(curobj.type=='2')
{if(document.getElementById('video_current'+curobj.divid)==null)
{window.ed.clearAllActualVideos(true);var video_src='<div id="video_current'+curobj.divid+'" width="100%" height="100%" style="position:absolute;display:block;z-index:5;left:0px;top:0px;width:100%;height:100%;"></div>';window.ed.get(curobj.divid).innerHTML=window.ed.get(curobj.divid).innerHTML+video_src;$('#'+curobj.divid).attr('title',curobj.dev_name);window.youtubevideoobj=curobj;var tag=document.createElement('script');tag.src=window.ed.edition_youtube_api_url;var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);window.youtubepageid=null;window.youtubeduration=null;window.onYouTubeIframeAPIReady=function(prm){var delay=1000;if(prm=='alrd'){delay=50;}
setTimeout(function(){var player=new YT.Player('video_current'+window.youtubevideoobj.divid.toString(),{videoId:window.youtubevideoobj.youtubeid,playerVars:{rel:0,modestbranding:1},height:$('#video_current'+window.youtubevideoobj.divid).height(),width:$('#video_current'+window.youtubevideoobj.divid).width(),events:{'onReady':onPlayerReady,'onStateChange':window.ed.onYoutubePlayerStateChange,}});window.youtubevideoobj.yt_player=player;},delay);}
if(window.ed.edition_youtube_api_url=='')
{window.onYouTubeIframeAPIReady('alrd');}
window.ed.edition_youtube_api_url='';ed._video_shown=true;}}
else
{if(document.getElementById('video_current'+curobj.divid)==null)
{window.ed.clearAllActualVideos(true);var video_src='<video id="video_current'+curobj.divid+'" name="video_current'+curobj.divid+'" width="100%" height="100%" controls autoXplay style="position:absolute;display:block;z-index:5;left:0px;top:0px;width:100%;height:100%;" class="allowMouseDownAndMouseUpVideo">';video_src+='<source src="'+htmlSrc+'" type="video/mp4">';if(typeof(curobj.webm)!='undefined')
{if(curobj.webm!='')
{video_src+='<source src="'+curobj.webm+'" type="video/webm">';}}
if(typeof(curobj.ogg)!='undefined')
{if(curobj.ogg!='')
{video_src+='<source src="'+curobj.ogg+'" type="video/ogg">';}}
video_src+='Your browser does not support the video tag.';video_src+='</video>';var currobj_divid=window.ed.get(curobj.divid);if(currobj_divid!=null){currobj_divid.innerHTML=currobj_divid.innerHTML+video_src;}
try
{window.ed.get('video_current'+curobj.divid+'').load();}catch(e){}
window.ed.registerVideoPlayerEvents('video_current'+curobj.divid,currobj_pgs.id,curobj.dev_name,curobj.divid.replace('video',''));try
{window.ed.get('video_current'+curobj.divid+'').play();}catch(e){}
ed._video_shown=true;}
else
{}}
ed.enableCommandsAndHideLoader(window.ed.loader2);}}}}}}
return found;};window.ed.toggleVideo=function(state,id){try
{var div=document.getElementById(id);var iframe=div.getElementsByTagName("iframe")[0].contentWindow;func=state=='hide'?'pauseVideo':'playVideo';iframe.postMessage('{"event":"command","func":"'+func+'","args":""}','*');}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5065; column: 353;  :: '+v);}};window.ed.onYoutubeVideoSendPlaybackPercentVal=function(runagain,edition_obj_id){if(window.youtubestate)
{var player=window.youtubestate.target;var iframe=$(player.getIframe());var percentage_viewed=player.getCurrentTime()/ player.getDuration();var edition_obj_id=iframe.attr('id').replace('video_current','').replace('video','');var page_id_for_sending=window.youtubepageid;if((page_id_for_sending==null)||(typeof(page_id_for_sending)=="undefined"))
{window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id}
if((page_id_for_sending==null)||(typeof(page_id_for_sending)=="undefined"))
{window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id}
if(edition_obj_id==edition_obj_id)
{if(!isNaN(percentage_viewed))
{var statDataObj={category:'Video',action:'playback_percent',page_id:page_id_for_sending,label:'',duration:window.youtubestate.target.getDuration(),current_time:window.youtubestate.target.getCurrentTime(),percent:Math.round(percentage_viewed*100),edition_object_id:edition_obj_id};window.stats.event('Video','playback_percent',statDataObj,0);}}
if((Math.round(percentage_viewed*100)<100)&&(window.youtubestate.data==1)&&(runagain))
{window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;}}}
window.ed.onYoutubePlayerStateChange=function(state){try
{try
{window.youtubepageid=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id;}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5077; column: 226;  :: '+v);}
try
{window.youtubeduration=state.target.getDuration();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5079; column: 186;  :: '+v);}
window.youtubestate=state;var player=state.target;if(!player){return;}
var iframe=$(player.getIframe());if(!iframe){return;}
var percentage_viewed=player.getCurrentTime()/ player.getDuration();var edition_obj_id=iframe.attr('id').replace('video_current','').replace('video','');if(isNaN(percentage_viewed)){percentage_viewed=0;}
var sendValueToStats=0;if(state.data==0)
{window.ed.sendInteractiveStats('Video','Finished',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,'','',sendValueToStats,'',window.youtubestate.target.getDuration(),edition_obj_id);window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;window.ed.onYoutubeVideoSendPlaybackPercentVal(false,edition_obj_id);}
else if(state.data==2)
{window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;window.setTimeout('if(window.ed.youtubecontrolnumber == '+window.ed.youtubecontrolnumber.toString()+'){window.ed.onYoutubeVideoSendPlaybackPercentVal(true,"'+edition_obj_id.toString()+'");}',10000);window.ed.sendInteractiveStats('Video','Pause',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,'','',sendValueToStats,'',window.youtubestate.target.getDuration(),edition_obj_id);}
else if(state.data==1)
{window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;window.ed.youtubeplaywasalreadysent=true;window.ed.sendInteractiveStats('Video','Play',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,'','',sendValueToStats,'',window.youtubestate.target.getDuration(),edition_obj_id);}
else if(state.data==3)
{if(window.ed.youtubeplaywasalreadysent)
{window.ed.sendInteractiveStats('Video','Seeking',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,'','',sendValueToStats,'',window.youtubestate.target.getDuration(),edition_obj_id);}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5091; column: 339;  :: '+v);}};window.ed.pauseAllActualVideos=function(dopause){if(typeof(doClear)=='undefined')
{var doClear=false;}
try
{for(var d in window.eddata.pages)
{var currobj_pgs=window.eddata.pages[d];for(var d in currobj_pgs.interactive)
{var curobj=currobj_pgs.pageElemsVideos[d];if(curobj&&curobj!==null)
{if(curobj.itype==window.ide.itypevideo)
{if(ed.get(curobj.divid)!=null)
{window.ed.toggleVideo('hide',curobj.holderDivId);if(window.ed.get('video_current'+curobj.divid)!=null)
{try
{window.ed.get('video_current'+curobj.divid).pauseVideo();}catch(e){}
try
{window.ed.get('video_current'+curobj.divid).pause();}catch(e){}
try
{window.ed.get('video_current'+curobj.divid).stop();}catch(e){}}}}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5105; column: 204;  :: '+v);}};window.ed.clearAllActualVideos=function(doClear){if(typeof(doClear)=='undefined')
{var doClear=false;}
try
{for(var d in window.eddata.pages)
{var currobj_pgs=window.eddata.pages[d];for(var d in currobj_pgs.interactive)
{var curobj=currobj_pgs.interactive[d];if(curobj&&curobj!==null){if(curobj.itype==window.ide.itypevideo)
{if(ed.get(curobj.divid)!=null)
{window.ed.youtubeplaywasalreadysent=false;if(window.youtubestate!=null)
{var vid_title_elem=$(window.youtubestate.target.getIframe()).attr('id').replace('video_current','');var vid_title=$('#'+vid_title_elem).attr('title');var edition_obj_id=vid_title.replace('video','');window.ed.youtubecontrolnumber=window.ed.youtubecontrolnumber+1;window.ed.onYoutubeVideoSendPlaybackPercentVal(false,edition_obj_id);window.youtubestate=null;window.youtubepageid=null;window.youtubeduration=null;}
else
{window.ed.onVideoCleared('video_current'+curobj.divid,currobj_pgs.id,curobj.dev_name,curobj.divid.replace('video',''));}
try
{window.ed.get('video_current'+curobj.divid).src="javascript:void(0)";}catch(e){}
if(window.ed.get('video_current'+curobj.divid)!=null)
{try
{window.ed.get('video_current'+curobj.divid).outerHTML='';}catch(e){}}}}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5120; column: 210;  :: '+v);}};
;
window.ed.checkPreloadedImgs=function(load_for_page,divid,itype){var resvar=true;var isConnected=false;var foundMoreThan0=true;if(typeof(itype)=='undefined')
{var itype=-999;}
if(divid!=null)
{ed.addtodownloadlistImages=ed.addtodownloadlistImages.replace(','+divid+',','');}
var curr_obj=window.f.findObjFromWindowPgsByPagenumber(load_for_page);var curr_obj_pageobj=curr_obj;if(curr_obj_pageobj.ranpageanim)
{return;}
if(curr_obj.interactive!=null)
{if(curr_obj.interactive.length>0)
{for(var d in curr_obj.interactive)
{var currObj=curr_obj.interactive[d];if(currObj.itype==window.ide.itypeimage)
{try
{if(currObj.hasAnim)
{ed._pg_hasAnim=true;}}catch(e){}
if(currObj.hasAnim)
{foundMoreThan0=true;}
if((currObj.preloaded!=true)&&(currObj.preload)&&(!currObj.connected))
{if(currObj.hasAnim)
{ed._pg_hasAnim=true;foundMoreThan0=true;}
resvar=false;}
else
{if((currObj.divid==divid))
{if(currObj.hasAnim)
{ed._pg_hasAnim=true;foundMoreThan0=true;currObj.contentloaded=true;}}
else if((currObj.connected)&&(currObj.divid==divid))
{isConnected=true;}}}}}}
var parentId=null;try
{document.getElementById(divid).style.opacity=0.0001;document.getElementById(divid).style.visibility='visible';parentId=document.getElementById(divid).parentNode;if(parentId!=null)
{if(parentId.style.visibility!='hidden')
{parentId.style.visibility='hidden';}}}
catch(e){}
var animationSet=false;if((window.ed.checkLoadingInteractive(window.ide.itypevideo))||(window.ed.checkLoadingInteractive(window.ide.itypegallery))||(window.ed.checkLoadingInteractive(window.ide.itypetextblock))||(window.ed.checkLoadingInteractive(window.ide.itypeaudio))||(window.ed.checkLoadingInteractive('threesixty'))||(window.ed.addtodownloadlistImages!=''))
{resvar=false;}
else
{resvar=true;animationSet=true;}
if(resvar)
{ed.isLoadingObjectsImages=false;ed.hideLoader();}
if(!resvar)
{if(!ed._loader_visible)
{ed.showLoader();}}
if(!ed._pg_hasAnim)
{anim_objects=new Object();}
if(resvar)
{}
if((ed._pg_hasAnim)&&(resvar))
{anim_objects=new Object();if(foundMoreThan0)
{edPageLoaded();if(curr_obj.interactive!=null)
{if(curr_obj.interactive.length>0)
{for(var d in curr_obj.interactive)
{var currObj=curr_obj.interactive[d];if(currObj.itype==window.ide.itypeimage||currObj.itype==window.ide.itypetextblock||currObj.itype==window.ide.itypegallery||currObj.itype=='link'||currObj.itype=='threesixty'||currObj.itype==window.ide.itypevideo)
{if(currObj.anim_hide==''){currObj.anim_hide="stop";}
var tObj=new Object();for(io in currObj){tObj[io]=currObj[io];}
tObj.imgvisible_forlink=false;var shall="$"+tObj.anim_show+"$"+tObj.anim_hide+"$";shall=shall.split("#").join("$");tObj.ignore_autohide=(tObj.connected)&&(shall.indexOf("$ignoreautohide=1$")>-1);tObj.inited_obj=false;this.setInitAnimDiv(tObj);anim_objects[currObj.id]=tObj;}}}}
var for_page_additional_spreads=-1;if((curr_obj.leftPage==load_for_page)&&(ide.orientIsBookMode))
{for_page_additional_spreads=curr_obj.rightPage;}
else if(ide.orientIsBookMode)
{for_page_additional_spreads=curr_obj.leftPage;}
if(for_page_additional_spreads>-1)
{var curr_obj1=window.f.findObjFromWindowPgsByPagenumber(for_page_additional_spreads);if(curr_obj1&&curr_obj1.interactive!=null)
{if(curr_obj1.interactive.length>0)
{for(var d in curr_obj1.interactive)
{var currObj=curr_obj1.interactive[d];if(currObj.itype==window.ide.itypeimage||currObj.itype==window.ide.itypetextblock||currObj.itype==window.ide.itypegallery||currObj.itype=='link'||currObj.itype=='threesixty'||currObj.itype==window.ide.itypevideo)
{if(currObj.anim_hide=='')
{currObj.anim_hide="stop";}
var tObj=new Object();for(io in currObj){tObj[io]=currObj[io];}
tObj.imgvisible_forlink=false;var shall="$"+tObj.anim_show+"$"+tObj.anim_hide+"$";shall=shall.split("#").join("$");tObj.ignore_autohide=(tObj.connected)&&(shall.indexOf("$ignoreautohide=1$")>-1);tObj.inited_obj=false;this.setInitAnimDiv(tObj);anim_objects[currObj.id]=tObj;}}}}}
if(animationSet)
{try
{parentId=document.getElementById(curr_obj.divid);if(parentId!=null){anim_parent_div_id=parentId.id;}
anim_global_nm_trans=ed.webTransformNm;window.ed.preventBecauseLoadingImagesToMemory=false;ed.hideLoader();if((curr_obj.pagenumber==window.ide.currentPage)||((curr_obj.leftPage==window.ide.currentPage)&&(window.ide.orientIsBookMode)))
{if(!window.initer.introvisible)
{curr_obj_pageobj.ranpageanim=true;window.setTimeout('ObjGoAnim(true,false,-11,-11,"show",'+window.ide.currentPage.toString()+',false);window.ed.showNonAnimatedInteractiveObjs();',100);}
else
{curr_obj_pageobj.ranpageanim=true;window.ed.waitingAnims='ObjGoAnim(true,false,-11,-11,"show",'+window.ide.currentPage.toString()+',false);window.ed.showNonAnimatedInteractiveObjs();';}}}
catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5195; column: 134;  :: '+v);console.log("Error animating -> "+e.message);}}}
else
{if(resvar)
{call_after_load_and_anim_finished_dev('l1');window.ed.showNonAnimatedInteractiveObjs();}}}
else
{if(resvar)
{call_after_load_and_anim_finished_dev('l2');window.ed.showNonAnimatedInteractiveObjs();}}};
;
window.ed.testIfLinkWasPressed=function(pressedX,pressedY,last_image_clicked,custom_event_click_actions,custom_link_id){tlbr.hideAllPanels(undefined)
if(window.edgl.argo.indexOf('*link_debugger*')!=-1){debugger;}
var is_custom_link=false;if(typeof(custom_event_click_actions)!='undefined')
{is_custom_link=true;pressedX=-1;pressedY=-1;last_image_clicked='';if(typeof(custom_link_id)=='undefined')
{var custom_link_id=-1;}}
try
{var offset_elem_main=$('#'+window.ide.mainStageElementParent).offset();if(offset_elem_main.left!=0){}
if(offset_elem_main.top!=0){}}catch(e){}
if((pressedX==ed.lastCheckedPressedX)&&(pressedY==ed.lastCheckedPressedY))
{}
else
{ed.lastCheckedPressedX=pressedX;ed.lastCheckedPressedY=pressedY;}
ed._version_of_linktest=ed._version_of_linktest+1;var spread_Size=10;var pgnumber=window.ide.currentPage;var secondpageId=-1;if((window.ide.orientIsBookMode)&&(pgnumber!=window.ide.currentPageObjPgs.rightPage))
{secondpageId=window.ide.currentPageObjPgs.rightPage;}
var found=false;var originalPressedX=pressedX;var pageobj=window.ide.currentPageObjPgs;var shouldAddToLinkX=0;for(var dall=0;dall<2;dall++)
{pressedX=originalPressedX;shouldAddToLinkX=0;if(dall==0)
{var selArray=[];$.each(ide.currentPageObjPgs.interactive,function(i,element)
{if($.isArray(element.event_click_actions)&&element.event_click_actions.length)
{selArray.push(element);}});}
else if(secondpageId>0)
{if(dall==1)
{var rightPageObj=window.f.findObjFromWindowPgsByPagenumber(secondpageId);pageobj=rightPageObj;var selArray=[];$.each(rightPageObj.interactive,function(i,element)
{if($.isArray(element.event_click_actions)&&element.event_click_actions.length)
{selArray.push(element);}});if((ide.isPagenumberRightPage(rightPageObj.pagenumber))&&(ide.orientIsBookMode))
{shouldAddToLinkX=window.eddata.head.pageWidth;}}}
else
{var selArray=null;}
if(is_custom_link)
{jtrace('this is custom link!');var selArray=new Array();var event_click_actions=new Array();selArray.push({'event_click_actions':custom_event_click_actions,'dev_name':'','activeOnObjId':'',w:100,h:100,x:pressedX-1,y:pressedY-1,id:custom_link_id});dall=999;}
var PAGE_NAME='';if(pageobj!=null)
{PAGE_NAME=pageobj.sef;}
var elementUnderMouse=$.elementFromPoint().selfOrParents('element_holder');if((selArray!=-1)&&(selArray!=null))
{if(selArray.length>0)
{for(var i=selArray.length-1;i>=0;i--)
{var element=selArray[i];if(!element){continue}
if(!found)
{{var linkX=element.x+shouldAddToLinkX;var linkY=element.y;var linkRight=linkX+element.w;var linkBottom=linkY+element.h;var doneaction=false;spread_Size=10;linkX=linkX-spread_Size;linkY=linkY-spread_Size;linkRight=linkRight+spread_Size;linkBottom=linkBottom+spread_Size;var isClicked=false;if(is_custom_link)
{isClicked=true;}
else
{if((element.itype=='link')&&(element.type=='poly'))
{var polyPoints=element.points;isClicked=ed.testPolyClick(polyPoints,(pressedX-shouldAddToLinkX),pressedY);if(isClicked)
{if(parseInt($('#'+element.divid).css('z-index')||0)<parseInt(elementUnderMouse.css('z-index')||0))
{isClicked=false}}}
else
{isClicked=$('#'+element.divid).is(elementUnderMouse);}}
if(isClicked){jtrace('Clicked on '+element.dev_name+', ('+element.divid+')',element)}
if(isClicked)
{var HTML_activeOnObjId=element.activeOnObjId;if(typeof(HTML_activeOnObjId)=='undefined')
{HTML_activeOnObjId='';}
var isEnabled=window.ed.isLinkEnabled(HTML_activeOnObjId);var isEnabled_str=isEnabled;if(window.ed.debugLinks)
{isEnabled=true;}
if(isEnabled_str&&(HTML_activeOnObjId=="")){isEnabled_str="true unconditional";}
if(isEnabled)
{if(window.edgl.argo.indexOf('*link_debugger*')!=-1){debugger;}
found=true;doneaction=false;var LINK_ID=element.id;var LINK_NAME=element.dev_name;if(typeof(LINK_NAME)=='undefined')
{var LINK_NAME='';}
if(typeof(pageId)=='undefined')
{var pageId=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id;}
var statDataObj={category:'Link',page_id:pageId,label:'',edition_object_id:LINK_ID};var multi_params=element.values;var linkAction=ed.urlDecode(element.value);ed._idLinkPressed=element.id;var multi_link_array=new Array();multi_link_array=element.event_click_actions;var dev_param=element.devparam;if(typeof(element.linkAdditionalParams)=='undefined')
{element.linkAdditionalParams='';}
if(typeof(dev_param)=='undefined')
{dev_param='';}
var tmp_var_additonal_params='';for(var l in multi_link_array)
{try
{var curr_link_action=multi_link_array[l].action;var curr_link_param=multi_link_array[l].params;try
{if(typeof(curr_link_param)==='object'&&curr_link_param.length<2)
{curr_link_param=curr_link_param[0];}}catch(e){}
if(typeof(curr_link_param)=='undefined')
{curr_link_param='';}
var curr_link_target=multi_link_array[l].target;try
{if(typeof(curr_link_target)==='object'&&curr_link_target.length<2)
{curr_link_target=curr_link_target[0];}}catch(e){}}catch(e){break;}
var allShowObjectIdsInThisLink=window.ed.getAllShowObjectIdsInThisLink(curr_link_action,curr_link_target,curr_link_param);jtrace('Execute action',curr_link_action);if(curr_link_action=='gotopage')
{var sendStats=false;if(LINK_ID){var idlink1=parseInt(LINK_ID,10);if(!isNaN(idlink1)){if(idlink1>0){var sendStats=true;}}}
var statsAction='Go to page';try
{var tmplinkparam=new Array();tmplinkparam=curr_link_param;if(typeof(curr_link_param)=='object')
{if(tmplinkparam.length>1)
{curr_link_param=curr_link_param[0];if(tmplinkparam[1]=='statsfalse')
{sendStats=false;}
if(tmplinkparam[1].indexOf('statsCategorySet_')>-1)
{var arrStatsAction=tmplinkparam[1].split('statsCategorySet_');statsAction=arrStatsAction[1];}}}}catch(e){}
if(curr_link_param!='')
{try
{statDataObj.action=statsAction;statDataObj.label=LINK_NAME;statDataObj.label2=curr_link_param;}catch(e){console.log('statDataObj error -> '+e.message);}
window.ed.clickwasusedtogotopage=true;var pageNum=curr_link_param;if(!isNaN(parseInt(pageNum)))
{ed.goToStartOfPage(parseInt(pageNum));if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
else
{if(pageNum=='nextsub')
{ed.goToNextSubPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='prevsub')
{ed.goToPreviousSubPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='next')
{ed.goToNextMainPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if((pageNum=='prev')||(pageNum=='previous'))
{ed.goToPreviousMainPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='top')
{ed.goToCurrentMainPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='last')
{ed.goToLastPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='first')
{ed.goToFirstPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='bottom')
{ed.goToBottomSubpage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}
if(pageNum=='lastmain')
{ed.goToLastMainPage();if(sendStats)window.stats.event('Link',statsAction,statDataObj,0);}}
window.avoidgotopagestats=false;found=true;doneaction=true;}}
if((curr_link_action=='gallery')||(curr_link_action=='gotoimage'))
{ed.goToGalleryLink(curr_link_param,curr_link_target,statDataObj);found=true;doneaction=true;}
if(curr_link_action=='audio')
{window.snd.actionAudioWithId(curr_link_target,curr_link_action);doneaction=true;found=true;}
if((curr_link_action=='play')||(curr_link_action=='stop')||(curr_link_action=='pause'))
{var tg_video=window.f.findObjByInteractiveId(curr_link_target);if(tg_video.itype==window.ide.itypevideo){var vid_div=window.ed.get('video_current'+tg_video.divid);if(curr_link_action=='play'){if(vid_div!=null){if(tg_video.youtubeid){tg_video.yt_player.playVideo();}else{vid_div.play();}}else{window.ed.checkVideosAndShow(0,0,0,tg_video,null,true);}}
if(curr_link_action=='stop'){if(vid_div!=null)
{if(tg_video.youtubeid){tg_video.yt_player.stopVideo();}else{vid_div.pause();vid_div.currentTime=0;}}}
if(curr_link_action=='pause'){if(vid_div!=null)
{if(tg_video.youtubeid){tg_video.yt_player.pauseVideo();}else{vid_div.pause();}}}}else{window.snd.actionAudioWithId(curr_link_target,curr_link_action,statDataObj);}
doneaction=true;found=true;}
if(curr_link_action=='openemail')
{if(curr_link_param.toLowerCase().indexOf("mailto:")<0)
{curr_link_param='mailto:'+curr_link_param;}
doneaction=true;found=true;statDataObj.action='Email';statDataObj.label=LINK_NAME;statDataObj.label2=curr_link_param;window.stats.event('Link','Email',statDataObj,0);if(isApp()){var message={'action':"linkPress",'url':curr_link_param};postDataToApp(message);}
else{window.location=curr_link_param;}}
if(curr_link_action=='popup')
{var url='';var type='ed-popup-default';if((typeof(curr_link_param)=='object')||(typeof(curr_link_param)=='array'))
{if(curr_link_param.length>1)
{url=curr_link_param[0];type=curr_link_param[1];}
else
{url=curr_link_param;}}
else
{url=curr_link_param;}
url=window.ed.validateLinkAction(url);if(ed.html5popup_links_forceNewWindow)
{if(isApp()){url=modifySRCUrlForApps(url,'popup');}
var focusRequest=window.open(url,"newLink");focusRequest.focus();}
else
{var curr_domain1=window.location+'';if(curr_domain1.substr(0,8)=='https://'){if(url.substr(0,7)=='http://'){url='https'+url.substr(4);console.log('CHANGED POPUP URL: '+url);}}
var url_processed=false;if(isApp()){var curr_domain1=window.location+'';if((curr_domain1.substr(0,8)!='https://')&&(curr_domain1.substr(0,7)!='http://')){if((url.substr(0,7)=='http://')||(url.substr(0,8)=='https://')){var message={'action':"linkPress",'url':url};postDataToApp(message);url_processed=true;}}}
if(!url_processed){window.ed_show_popup(url,type);}}
doneaction=true;found=true;statDataObj.action='Popup';statDataObj.label=LINK_NAME;statDataObj.label2=url;window.stats.event('Link','Popup',statDataObj,0);}
if(curr_link_action=='popup_survey')
{var url='';var type='ed-popup-survey';var survey_id=parseInt(curr_link_target);if((typeof(curr_link_target)=='object')||(typeof(curr_link_param)=='array'))
{if(curr_link_target.length>1)
{survey_id=curr_link_target[0];}
else
{survey_id=curr_link_target;}}
else
{survey_id=curr_link_target;}
if(survey_id>0)
{var survey_obj=window.ed.findsurvey(survey_id);if(survey_obj!=null)
{var additional_data={is_mobile_element:false,};var resform=ed_form_builder.createForm(survey_obj,'',additional_data);console.log(resform);console.log('survey_idsurvey_id -....>>'+survey_id);window.ed_show_popup('',type,resform);doneaction=true;found=true;statDataObj.action='Popup Survey';statDataObj.label=LINK_NAME;statDataObj.label2=curr_link_target;window.stats.event('Link','Popup Survey',statDataObj,0);}}}
if(curr_link_action=='showobject')
{doneaction=true;ed.connectedImageClicked_BY_USER(PAGE_NAME,LINK_ID,linkAction,false,ed._version_of_linktest,false,allShowObjectIdsInThisLink);found=true;}
if(curr_link_action=='playanimation')
{var anim_index=0;if(curr_link_param.length>1)
{anim_index=curr_link_param[1];}
ObjGoAnim(true,false,curr_link_target,anim_index,'show',-1,false);statDataObj.action='Start';statDataObj.label=LINK_NAME;statDataObj.category='Animation';statDataObj.label2='';window.stats.event('Animation','Start',statDataObj,LINK_ID);doneaction=true;found=true;}
if((curr_link_action=='show')||(curr_link_action=='hide'))
{var anim_index=0;if(curr_link_param.length>1)
{anim_index=curr_link_param[1];}
var curr_manip_obj=window.f.findObjByInteractiveId(curr_link_target);if(curr_manip_obj!=null)
{if(curr_manip_obj.itype==window.ide.itypetextblock)
{curr_link_target=curr_link_target+'';ed.connectedtextblockClicked_BY_USER(PAGE_NAME,LINK_ID,curr_link_target,false,ed._version_of_linktest,false,curr_link_action,curr_manip_obj);}}
var anim_index=0;doneaction=true;found=true;}
if((curr_link_action=='increasefont')||(curr_link_action=='decreasefont'))
{if(!doneaction)
{ed.connectedtextblockClicked_BY_USER(PAGE_NAME,LINK_ID,curr_link_target,false,ed._version_of_linktest,false,curr_link_action);doneaction=true;found=true;}}
if((curr_link_action=='textblock')&&(!found))
{ed.connectedtextblockClicked_BY_USER(PAGE_NAME,LINK_ID,curr_link_target,false,ed._version_of_linktest,false,'');doneaction=true;found=true;}
if(curr_link_action=='gotourl')
{linkAction=window.ed.validateLinkAction(curr_link_param);statDataObj.action='External';statDataObj.label=LINK_NAME;statDataObj.label2=curr_link_param;var external='External';if(element.wishlist_product){statDataObj.action='Wishlist';external='Wishlist';if('sku'in element.wishlist_product){statDataObj.action='Add to cart';external='Cart';}}
try
{window.stats.event('Link',external,statDataObj,0);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5373; column: 186;  :: '+v);console.log(e.message);}
var doprocess=true;if(dev_param=='*boots*')
{try
{openCartPopup(curr_link_param);doprocess=false;}catch(e){doprocess=true;}}
if(element.wishlist_product){window.wishlist.addItem(element.wishlist_product);doprocess=false;}
if(curr_link_param.indexOf('*call_custom_js_funct=')>-1)
{var js_code=getTextBetween(curr_link_param,'*call_custom_js_funct=','*');if(js_code){try
{eval(js_code);doprocess=false;}catch(e){doprocess=true;}}}
if(doprocess)
{if(isApp()){var message={'action':"linkPress",'url':curr_link_param};postDataToApp(message);}
else{var focusRequest=window.open(curr_link_param,"_blank");focusRequest.focus();}}
found=true;}}}}}}}
if(!found)
{}
else
{}}
else
{}}
else
{}}
if(!found)
{if(window.ide.contain_video&&ed.checkVideosAndShow(originalPressedX,pressedY,-1))
{found=true;}}
if((!found)&&(last_image_clicked!=''))
{ed.hideShowObject(last_image_clicked,true);found=true;}
if(!found)
{return false;}
else
{return true;}};window.ed.hideShowObject=function(nameObject,onlyHideDivWithThisName){if(typeof(onlyHideDivWithThisName)=='undefined')
{var onlyHideDivWithThisName=false;}
if(ed._linkImageElemShown.length>0)
{for(var cnt in window.ed._linkImageElemShown)
{var currobj_full=window.ed._linkImageElemShown[cnt];var srchObjName=currobj_full.imagename;var showLayer=currobj_full.islayer;showLayer=showLayer.replace("'","");showLayer=showLayer.replace("'","");showLayer=eval(showLayer);srchObjName=srchObjName.replace("'","");srchObjName=srchObjName.replace("'","");srchObjName=srchObjName.replace("'","");if(onlyHideDivWithThisName)
{srchObjName=nameObject;nameObject='-1';}
var found=false;for(var cntr=0;cntr<2;cntr++)
{if(cntr==0)
{var currObj=window.ide.currentPageObjPgs.interactive;}
else if((cntr==1)&&(window.ide.orientIsBookMode))
{var currObj_t=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);var currObj=null;if(currObj_t!=null)
{currObj=currObj_t.interactive;}}
else
{found=true;}
if(!found)
{for(var l in currObj)
{var currObjThs=currObj[l];if((currObjThs.divid==srchObjName)&&(currObjThs.preloaded||showLayer))
{var thisObj=document.getElementById(currObjThs.divid);var parentDiv=document.getElementById(currObjThs.parentDivInner);var absoluteParentDiv=document.getElementById(currObjThs.parentDivInner.replace('Inner',''));if(showLayer)
{var thisObjShow=ed.get('tblObjLy');eval('thisObjShow.style.'+ed.webTransformNm+'Transition="opacity 0.3s linear";');thisObjShow.style.opacity='0';window.setTimeout("window.ed.freeLayer();",310);currObjThs.preloaded=false;found=true;}
else
{if(currObjThs.isScrollableImage)
{try
{for(var l in window.ed.arrIscrolls)
{var iscroller=window.ed.arrIscrolls[l];if(iscroller!='')
{var addjs="var tmpiscrl = eval('window.ed."+iscroller+"');";addjs+="if((tmpiscrl != null)&&(tmpiscrl != 'undefined')){tmpiscrl.destroy();}window.ed.arrIscrolls["+l.toString()+"] = '';";}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5425; column: 323;  :: '+v);console.log('Error while freeing iscroll -> '+e.message);}
window.ed.trace('[GO ANIM CALLED FOR] -> ObjGoAnim(true,false,'+currObjThs.id+',-11,"och",-1,false);');ObjGoAnim(true,false,currObjThs.id,-11,'och',-1,false);window.setTimeout(addjs,350);found=true;}
else
{window.ed.trace('[GO ANIM CALLED FOR] -> ObjGoAnim(true,false,'+currObjThs.id+',-11,"och",-1,false);');ObjGoAnim(true,false,currObjThs.id,-11,'och',-1,false);found=true;}}}}}}}
ed._linkImageElemShown=new Array;ed._linkImageShowLayer=false;}};window.ed.showConnectedImage=function(divId,assignSource,parentDiv,hasAnim,animString,imgArrSecondId,anim_index,anim_name,called_from_anim){if(typeof(imgArrFirstId)=='undefined')
{imgArrFirstId=-1;}
if(typeof(imgArrSecondId)=='undefined')
{imgArrSecondId=-1;}
if(typeof(currObj)=='undefined')
{currObj=null;}
var isScrollable=false;var currObj=window.ide.currentPageObjPgs.interactive[imgArrSecondId];if(typeof(currObj)=='undefined')
{var currObj=null;}
var searchRightPage=false;if(currObj==null)
{searchRightPage=true;}
else
{if(currObj.divid!=divId)
{searchRightPage=true;}}
if((searchRightPage)&&(window.ide.orientIsBookMode))
{var find_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(find_obj!=null)
{currObj=find_obj.interactive[imgArrSecondId];}}
if(currObj==null)
{return false;}
if(currObj.isScrollableImage)
{isScrollable=true;}
try
{if(currObj!=null)
{if(currObj.isScrollableImage)
{isScrollable=true;var addscrollbarStr='hScrollbar:true,vScrollbar:true,fadeScrollbar: true,';if(currObj.hideScrollbars)
{addscrollbarStr='hScrollbar:false,vScrollbar:false,fadeScrollbar: false,';}
document.getElementById(currObj.imagesrcimg).src=assignSource;var addjs='window.ed.'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+' = new iScroll("'+currObj.scrollholder+'",{x:'+currObj.startScrollX+',y:'+currObj.startScrollY+','+addscrollbarStr+' bounce: true, zoom:false });window.ed.arrIscrolls.push("'+currObj.iscrollid+ed.startingWatch.getSeconds().toString()+ed.startingWatch.getMinutes().toString()+ed.startingWatch.getHours().toString()+'");';try
{eval(addjs);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5455; column: 148;  :: '+v);console.log('Error when showing scrollable image ->'+e.message);}}}}catch(e){isScrollable=false;}
try
{if(!isScrollable)
{var obj=document.getElementById(currObj.dividimage);obj.style.backgroundImage='url('+assignSource+')';}}catch(e){return false;}
try
{document.getElementById(divId).style.opacity='0.0001';}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5460; column: 190;  :: '+v);}
var objId=divId.replace('img','');window.ed.markConnectedImageAsPreloaded(divId);document.getElementById(divId).style[ed.webTransformNm+"Transition"]=' ';document.getElementById(divId).style.opacity='0.0001';document.getElementById(divId).style['visibility']='visible';ObjGoAnim(true,true,currObj.id,-11,'ns',-1,false);ed.enableCommandsAndHideLoader(window.ed.loader2);};window.ed.connectedImagePreload=function(src,divId,imgId,parentDiv,hasAnim,animString,imgArrSecondId,anim_index,anim_name,called_from_anim){if(typeof(currObj)=='undefined')
{currObj=null;}
if(typeof(animString)=='undefined')
{var animString='';}
if(typeof(hasAnim)=='undefined')
{var hasAnim=false;}
if(typeof(imgArrFirstId)=='undefined')
{imgArrFirstId=-1;}
if(typeof(imgArrSecondId)=='undefined')
{imgArrSecondId=-1;}
try
{if(document.getElementById(parentDiv).style.opacity=='0.0001')
{document.getElementById(parentDiv).style.opacity='1';}
var d=imgId;eval('var imgsCon'+d.toString()+' = new Image();');eval('imgsCon'+d.toString()+'.onload = function(){window.ed.showConnectedImage(this.alt,this.src,"'+parentDiv+'",'+hasAnim+',"'+animString+'",'+imgArrSecondId.toString()+','+anim_index+',"'+anim_name+'",'+called_from_anim+');}');eval('imgsCon'+d.toString()+'.onerror = function(){window.ed.showConnectedImage(this.alt,this.src,"'+parentDiv+'",'+hasAnim+',"'+animString+'",'+imgArrSecondId.toString()+','+anim_index+',"'+anim_name+'",'+called_from_anim+');}');eval('imgsCon'+d.toString()+'.alt = "'+divId+'";');eval('imgsCon'+d.toString()+'.src = "'+src+'";');}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5474; column: 757;  :: '+v);}};window.ed.markConnectedImageAsPreloaded=function(getDivId){var found=false;var currObj=window.ide.currentPageObjPgs.interactive;for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.divid==getDivId)
{found=true;window.ed.setAnimObjectPreloadStatus(currObjThs.id,true);currObjThs.preloaded=true;}}
if((!found)&&(window.ide.orientIsBookMode))
{var currObj_t=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(currObj_t!=null)
{var currObj=currObj_t.interactive;for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.divid==getDivId)
{found=true;window.ed.setAnimObjectPreloadStatus(currObjThs.id,true);currObjThs.preloaded=true;}}}}};window.ed.loadImageFromAnim=function(object_id){window.ed.showImageOnClick(object_id,false,ed._previous_version_of_call,true);};window.ed.connectedImageClicked_BY_USER=function(pagename,linkid,idImage,showLayer,version_of_call,calledFromAnim,all_ids_of_multiaction_showobject){if(typeof(calledFromAnim)=='undefined')
{var calledFromAnim=false;}
var anim_index=0;var anim_name='show';if(idImage.indexOf(',')>0)
{var arr_steps=idImage.split(',');try
{idImage=arr_steps[0];anim_index=arr_steps[1];if(typeof(arr_steps[2])!='undefined')
{anim_name=arr_steps[2];}}catch(e){anim_name='show';}}
var doCleanThem=true;if(ed._previous_version_of_call==version_of_call)
{doCleanThem=false;}
var found=false;var srchObjName='img'+idImage;for(var cntr=0;cntr<2;cntr++)
{var currObj=null;if(cntr==0)
{currObj=window.ide.currentPageObjPgs.interactive;}
if((cntr==1)&&(window.ide.orientIsBookMode))
{currObj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(currObj!=null)
{currObj=currObj.interactive;}}
else if((cntr==1)&&(!window.ide.orientIsBookMode))
{found=true;}
if(!found)
{for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.divid==srchObjName)
{var thisObj=document.getElementById(currObjThs.divid);var parentDiv=document.getElementById(currObjThs.parentDivInner);var absoluteParentDiv=document.getElementById(currObjThs.parentDivInner.replace('Inner',''));var currentSrc=currObjThs.src;ed._linkImageElemShown.push({imagename:"'"+srchObjName+"'",islayer:"'"+showLayer+"'"})
if(showLayer)
{ed._linkImageShowLayer=showLayer;var thisObjShow=ed.get('tblObjLy');var divObjShow=ed.get('showObjectLayer');if(ide.get('layerButtonClose')!=null)
{ide.get('layerButtonClose').outerHTML='';}
$('#showObjectLayer').append('<div id="layerButtonClose" class="FSgalleryCloseButton gpuAcc button90 FSCclosegallery coloroverride" style="right:0px" onclick="javascript:window.ed.closeFSCLayer();"><div></div><span></span></div>');var objImgElem=thisObjShow.getElementsByTagName('img');divObjShow.style.width=window.ide.screenWidth+'px';divObjShow.style.height=window.ide.screenHeight+'px';ed.loadingLayer=true;ed.showLoader();var img=new Image();img.onload=function(){window.ed.runCurrentLayer(this);}
img.onerror=function(){window.ed.runCurrentLayer(this);}
img.src=currentSrc;found=true;break;}
else
{window.ed.trace('[GO ANIM CALLED FOR] -> ObjGoAnim(true,false,'+currObjThs.id+','+anim_index+','+anim_name+',-1,true)');ObjGoAnim(true,false,currObjThs.id,anim_index,anim_name,-1,true,all_ids_of_multiaction_showobject);found=true;break;}}}}}};window.ed.hideLinksPopup_end=function(){var popupobj=ed.get('links_popup');var iframepopupobj=ed.get('links_popup_inner');ed.initiateAlpha(popupobj);iframepopupobj.src='';popupobj.style.opacity=0;popupobj.style.width='0px';popupobj.style.top='-2000px';ed._popup_shown=false;$('#links_popup').remove();};window.ed.hideLinksPopup=function(){ed.loaderSetAlphaObject("0",document.getElementById("links_popup"),300)
window.setTimeout('window.ed.hideLinksPopup_end();',400);};window.ed.isLinkEnabled=function(HTML_activeOnObjId){var isEnabled=true;try
{if(HTML_activeOnObjId!='')
{isEnabled=false;var arr=HTML_activeOnObjId.split(',');for(var l in arr)
{var currobjId=arr[l];if(currobjId!='')
{if(ed.IsImgVisibleForLink(parseInt(currobjId,10)))
{isEnabled=true;}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5514; column: 155;  :: '+v);window.ed.trace('Error while gettinge active only on objid for link-> '+e.message);}
return isEnabled;};window.ed.getAllShowObjectIdsInThisLink=function(multi_actions,multi_targets,multi_params){try
{var resvar='';var char='';var arr_m_actions=multi_actions.split('||');if(typeof(multi_params)==='object'){multi_params=multi_params[0];}
if(typeof(mutli_params)!=='string'){multi_params=multi_params.toString();}
if(typeof(multi_targets)!=='string'){multi_targets=multi_targets.toString();}
var arr_m_params=multi_params.split('||');var arr_m_targets=multi_targets.split('||');for(var m in arr_m_actions)
{var currtitle=arr_m_actions[m];if(currtitle=='show')
{var currval=arr_m_targets[m];if(arr_m_targets[m].indexOf(',')>0)
{var tmpvar=arr_m_targets[m].split(',');currval=tmpvar[0];}
resvar=resvar+char+currval
char=',';}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5524; column: 146;  :: '+v);window.ed.trace('ERROR WHILE FINDING ALL OBJECT IDS IN THIS LINK FOR MULTILINK ->'+e.message);}
return resvar;};window.ed.validateLinkAction=function(_link_action){var tempStr=_link_action;try
{if(typeof(customJSValidateLinkType)=='function')
{tempStr=customJSValidateLinkType(tempStr);}}catch(e){tempStr=_link_action;}
return tempStr;};window.ed.checkTypeAndLinkAction=function(currentURL,additional_params){if(typeof(additional_params)=='undefined')
{additional_params='';}
var returnurl=currentURL;var el_url=currentURL;var ww=0;var hh=0;additional_params='..'+additional_params;if(additional_params.toLowerCase().indexOf('width=')>0)
{try
{additional_params=additional_params.toLowerCase().replace('&amp;','&');additional_params=additional_params.toLowerCase().replace('px','');var tmpWW=additional_params.toLowerCase().split('width=')[1];if(tmpWW.indexOf('&')>0)
{tmpWW=tmpWW.split('&')[0];}
if(tmpWW.toLowerCase()=='full')
{tmpWW=ed._current_ScreenWidth_withRatio-50;}
if(!isNaN(tmpWW))
{ww=parseInt(tmpWW);}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5537; column: 156;  :: '+v);}}
if(additional_params.toLowerCase().indexOf('height=')>0)
{try
{additional_params=additional_params.toLowerCase().replace('&amp;','&');additional_params=additional_params.toLowerCase().replace('px','');var tmpHH=additional_params.toLowerCase().split('height=')[1];if(tmpHH.indexOf('&')>0)
{tmpHH=tmpHH.split('&')[0];}
if(tmpHH.toLowerCase()=='full')
{tmpHH=ed._current_ScreenHeight_withRatio-100;}
if(!isNaN(tmpHH))
{hh=parseInt(tmpHH);}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5545; column: 156;  :: '+v);}}
if(ww==0)
{ww=400;}
if(hh==0)
{hh=500;}
try{document.getElementById('links_popup_inner').style.height=(hh)+'px';document.getElementById('links_popup_inner').style.width=(ww)+'px';}catch(e){}
ed._defaultPopupWidth=ww;ed._defaultPopupHeight=hh;return returnurl;};window.ed.click_on_image=function(event){window.ed._last_image_clicked=this.id;};window.ed.ed_atp=function(actions_events_array){var stats_link_id=-1;window.ed.testIfLinkWasPressed(-1,-1,'',actions_events_array,stats_link_id);}
;
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)
return data[i].identity;}
else if(dataProp)
return data[i].identity;}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};
;
function reorderWindowPGS()
{var isFirstPage=true;var previousD=-1;var lastMainPage=0;for(var d in window.eddata.pages)
{var curobj=window.eddata.pages[d];window.eddata.pages[d].isfirstpage=isFirstPage;if(curobj.ismainpage)
{if(previousD>-1)
{window.eddata.pages[previousD].islastsubpage=true;}
previousD=-1;lastMainPage=d;}
if(curobj.isswipesubpage)
{previousD=d;}
isFirstPage=false;}
var alreadySetLastPage=false;if(window.eddata.pages[d].id!='')
{window.eddata.pages[d].islastswipepage=true;if(d>lastMainPage)
{window.eddata.pages[d].islastpage=false;alreadySetLastPage=true;}}
else
{window.eddata.pages[d-1].islastswipepage=true;if((d-1)>lastMainPage)
{window.eddata.pages[d-1].islastpage=true;alreadySetLastPage=true;}}
if(!alreadySetLastPage)
{window.eddata.pages[lastMainPage].islastpage=true;}
else
{window.eddata.pages[lastMainPage].islastMainPageButNotSwipePage=true;}};window.ed.findsurvey=function(survey_id){var first_survey=null;var resvar=null;var found=false;for(var d in window.eddata.pages)
{if(!found)
{var tmppgs=window.eddata.pages[d];for(var l in tmppgs.interactive)
{if(!found)
{var curinteractive=tmppgs.interactive[l];if(curinteractive.itype==window.ide.itypesurvey)
{if(!first_survey){first_survey=curinteractive;}
if(curinteractive.id==survey_id)
{found=true;resvar=curinteractive;}}}}}}
if((!resvar)&&(survey_id+''=='2068')){resvar=first_survey;}
return resvar;}
window.ed.checkIfParalaxShouldPreload=function(){var pgobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(pgobj.ismainparalaxpage)
{var tmpobj=window.f.findNextObjFromWindowPgsByPageNumber(pgobj.pagenumber,true,true);if(tmpobj!=null)
{if(tmpobj.isparalaxsubpage)
{ide.preloadMainCanvases(tmpobj);}}}}
window.ed.resetParalaxStuffAndPages=function(){var currobjpgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(!currobjpgs.isparalaxsubpage)
{window.ide.paralaxScrollY=0;;window.ide.lastcorrectparalaxY=0;;window.ide.isparalaxbufferactivated=false;window.ide.paralaxCurrentOverlap=0;for(var d in window.ed.paralaxImages)
{window.ed.paralaxImages[d].src=window.ed.defaultNoImageValueSrc;window.ed.paralaxImages[d]=null;}
window.ed.paralaxImages=new Array();var tmparrpgs=ide.loadPagesArray.split(',');for(var d in tmparrpgs){var tmpcurpg=parseInt(tmparrpgs[d]);if(!isNaN(tmpcurpg))
{if(parseInt(tmpcurpg)>0)
{var pgobj=window.f.findObjFromWindowPgsByPagenumber(tmpcurpg);if(pgobj!=null)
{if(pgobj.isparalaxsubpage)
{pgobj=window.f.findObjFromWindowPgsByPagenumber(tmpcurpg);}
if(pgobj.ismainparalaxpage)
{$('#'+pgobj.holderdivid).stop().css({y:'0px'});pgobj.paralaxY=0;var arr_pgs=pgobj.paralaxallages.split(',');for(var d in arr_pgs)
{var tmppg=arr_pgs[d];if(!isNaN(parseInt(tmppg)))
{var pgnum=parseInt(tmppg);var page_obj=window.f.findObjFromWindowPgsByPagenumber(pgnum);$('#'+page_obj.holderdivid).stop().css({y:'0px'});page_obj.paralaxY=0;}}}}}}}}}
window.ed.setCookie=function(c_name,value,exdays){var exdate=new Date();exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+((exdays==null)?"":"; expires="+exdate.toUTCString());document.cookie=c_name+"="+c_value;};window.ed.getCookie=function(c_name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++)
{x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==c_name)
{return unescape(y);}}};window.ed.encode64s=function(input){var keyStr="ABCDEFGHIJKLMNOP"+"QRSTUVWXYZabcdef"+"ghijklmnopqrstuv"+"wxyz0123456789+/"+"=";input=escape(input);var output="";var chr1,chr2,chr3="";var enc1,enc2,enc3,enc4="";var i=0;do{chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
keyStr.charAt(enc1)+
keyStr.charAt(enc2)+
keyStr.charAt(enc3)+
keyStr.charAt(enc4);chr1=chr2=chr3="";enc1=enc2=enc3=enc4="";}while(i<input.length);return output;};window.ed.urlDecode=function(urlString){var resvar=urlString;resvar=decodeURI(resvar);return resvar;};window.ed.AtachEvent=function(object,Event,funct){window.f.AtachEvent(object,Event,funct);};window.ed.validateJavascript=function(responseTxt){eval(responseTxt);};window.ed.getItemFromQueryString=function(name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return results==null?"":decodeURIComponent(results[1].replace(/\+/g," "));};window.ed.preloadCustomHTML=function(url,callback,calledWhenPageId){try
{var xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()
{if(xmlhttp.readyState==4&&xmlhttp.status==200)
{try
{if((calledWhenPageId==window.ide.currentPage)||(calledWhenPageId==window.ed._ignorePage))
{window.ed.tempHTMLContain=xmlhttp.responseText;eval(callback);}}
catch(e){console.log('Preload HTML Error (Invalid Script) -> '+e.message+' \n Call->'+callback);}}}
xmlhttp.open("GET",url,true);xmlhttp.send();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5616; column: 179;  :: '+v);console.log('Error while loading custom HTML ->'+e.message);}};window.ed.preloadCustomImage=function(img_url,ready_funct,img_alt,cancelgpuAcc){if(typeof(cancelgpuAcc)=='undefined')
{var cancelgpuAcc=false;}
var d=ed.preloadIndex;eval('var prld'+d.toString()+' = new Image();');if(ready_funct!='')
{try
{eval('prld'+d.toString()+'.onload = function(){'+ready_funct+';}');}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5620; column: 203;  :: '+v);console.log('Invalid script : '+ready_funct);}
try
{var find='"';var thsrgx=new RegExp(find,"g");eval('prld'+d.toString()+'.onerror = function(){console.log("Error loading image. Image could not be loaded. '+img_url.toString().replace(thsrgx,'')+'");'+ready_funct+';}');}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5622; column: 354;  :: '+v);console.log('Invalid script : '+ready_funct);}}
if(img_alt!='')
{eval('prld'+d.toString()+'.alt = "'+img_alt+'";');}
eval("prld"+d.toString()+".src = '"+img_url+"';");ed.preloadIndex=ed.preloadIndex+1;};window.ed.get=function(elemName){return document.getElementById(elemName);};window.ed.stringReplace=function(str,strsearch,strreplace,indexCallled){if(typeof(indexCallled)=='undefined')
{var indexCallled=-1;}
try
{var find=strsearch;var thsrgx=new RegExp(find,"g");str=str.replace(thsrgx,strreplace);return str;}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5628; column: 233;  :: '+v);console.log("Error while replacing ["+str+"] search ["+strsearch+"] replace ["+strsearch+"] INDEX["+indexCallled.toString()+"]");}};window.ed.getAllElementsById=function(elemenr){var thsarr=new Array();for(var m=0;m<1000;m++)
{if(document.getElementById(elemenr+m.toString())!=null)
{thsarr.push(document.getElementById(elemenr+m.toString()));}}
return thsarr;};window.ed.hideFacebook=function(){window.setTimeout("window.ed._facebookIsShown = false;",500);ed.enableCommands();document.getElementById('FBLIKEframesrc').src='';document.getElementById('facebookLikeDivHolder').style.display='none';};window.ed.setWindowWidthAndHeight=function(check){window.setTimeout("window.scrollTo(0,window.ed.scrollToY);",10000);window.setTimeout("window.scrollTo(0,window.ed.scrollToY);",20000);window.setTimeout("window.scrollTo(0,window.ed.scrollToY);",600000);var resvar=false;var scrwidth=document.documentElement.clientWidth;var scrheight=document.documentElement.clientHeight;if(check)
{if((scrwidth!=ed._current_ScreenWidth)||(ed._current_ScreenHeight!=scrheight))
{if(ed._isDesktopBrowser)
{if(!ed.isAndroid)
{if((Math.abs((ed._current_ScreenHeight-scrheight))>100)||(Math.abs((ed._current_ScreenWidth-scrwidth))>1))
{resvar=true;}
else
{resvar=false;}}
else
{if((Math.abs((ed._current_ScreenHeight-scrheight))>100)||(Math.abs((ed._current_ScreenWidth-scrwidth))>1))
{resvar=true;}
else
{resvar=false;}}}
else
{if(Math.abs((ed._current_ScreenHeight-scrheight))>100)
{resvar=true;}
else
{resvar=false;}}}}
ed._current_ScreenWidth=scrwidth;ed._current_ScreenHeight=scrheight;try
{var tmpRatio=window.ide.defaultInitialScale;ed._current_ScreenWidth_withRatio=ed._current_ScreenWidth;ed._current_ScreenHeight_withRatio=ed._current_ScreenHeight;}catch(e){}
return resvar;};window.ed.loaderSetAlphaObject=function(alpha,elementObject,timing){$('#'+elementObject.id).stop();$('#'+elementObject.id).transition({opacity:(parseInt(alpha)/100)},timing,'linear',function(){});if(parseInt(alpha)==0)
{elementObject.style.visibility='visible';}
else
{elementObject.style.visibility='visible';}};window.ed.loaderSetAlpha=function(alpha,elementId,timing,callback){try
{if(typeof(callback)=='undefined')
{var callback='';}
$('#'+elementId).stop();$('#'+elementId).transition({opacity:(parseInt(alpha)/100)},timing,'linear',function(){eval(callback)});if(parseInt(alpha)==0)
{document.getElementById(elementId).style.visibility='visible';}
else
{document.getElementById(elementId).style.visibility='visible';}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5660; column: 199;  :: '+v);console.log('Cannot set visibility to undefined obj -> '+elementId);}};window.ed.setOpacity=function(animate,obj,opacity,transition,time,delay,preventReset){if(typeof(preventReset)=='undefined')
{var preventReset=true;}
if(animate)
{if(transition=='')
{transition='linear';}
thsDelay=parseInt(delay);if(parseInt(thsDelay)>0)
{window.setTimeout("window.ed.setOpacity("+animate+",window.ed.get('"+obj.id+"'),"+opacity+",'"+transition+"','"+time+"',0,"+preventReset+");",thsDelay);}
else
{if(window.ed.isIe58)
{try
{$('#'+obj.id).fadeTo(time,opacity);}catch(e)
{window.ed.trace('Error while zooming');}}
else
{if(window.ed.isIe9)
{$('#'+obj.id).fadeTo(time,opacity);}
else
{obj.style[window.ed.webTransitionFunct]='opacity '+time+' '+transition;obj.style.opacity=opacity;}}}}
else
{if(window.ed.isIe58)
{try
{$('#'+obj.id).fadeTo(time,opacity);}catch(e)
{window.ed.trace('Error while zooming');}}
else
{if(window.ed.isIe9)
{$('#'+obj.id).fadeTo(time,opacity);}
else
{if(!preventReset)
{if(transition=='')
{obj.style[window.ed.webTransitionFunct]=window.ed.webTransformFunctCSS;}}
obj.style['opacity']=opacity;}}}};window.ed.checkIfAnyAction=function(commitedVersion){if((ed.checkIfCanHideLoader())&&(ed.commandsEnabled))
{ed.enableCommands();}
if(commitedVersion==ed._actionversion)
{if(!ed._enabledTracking)
{}}};window.ed.sendInteractiveStats=function(Category,action,page_id,label,label2,value,imagename,duration,edition_obj_id,imageid){if(typeof(imageid)=='undefined')
{var imageid=0;}
if(isNaN(imageid))
{imageid=0;}
if(typeof(edition_obj_id)=='undefined')
{var edition_obj_id=0;}
if(isNaN(edition_obj_id))
{edition_obj_id=0;}
try
{if((typeof(imagename)!='undefined')&&(imagename!=''))
{var statDataObj={category:Category,page_id:-1,label:'',label2:'',value:0,image:imagename};}
else
{var statDataObj={category:Category,page_id:-1,label:'',label2:'',value:0};if((typeof(duration)!='undefined')&&(duration>-1))
{statDataObj.duration=duration;}}
statDataObj.page_id=page_id;statDataObj.action=action;statDataObj.label=label;statDataObj.label2=label2;statDataObj.value=value;if(imageid>0)
{statDataObj.image_id=imageid;}
if(edition_obj_id>0)
{statDataObj.edition_object_id=edition_obj_id;}
window.stats.event(Category,action,statDataObj,edition_obj_id);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5711; column: 198;  :: '+v);console.log("Invalid request statistics -> "+e.message);}}
;
var ed_code={getCodeHtml:function(parent_index,interactive_index,into_parent_div){var currobj=window.eddata.pages[parent_index].interactive[interactive_index];var codeId=currobj.id;var no_source_div;var holder_el=drawer.getBaseStructure(parent_index,interactive_index,into_parent_div);var src_html,no_source_div;var css=drawer.getGeneralCss(currobj);holder_el.attr('title','Code').addClass('gpuAcc').css(css).html(currobj.code_inner_html);if(!currobj.code_inner_html||currobj.code_inner_html==''){no_source_div=$('<div></div>');no_source_div.addClass('no-content').append($('<div class="icon"></div>'))
holder_el.append(no_source_div);}
else
{holder_el.html(currobj.code_inner_html)}
window.eddata.pages[parent_index].interactive[interactive_index].holderDivId='code'+codeId;return holder_el[0].outerHTML;}}
;
var ed_iframe={get_iframe_html:function(parent_index,interactive_index,into_parent_div){var currobj=window.eddata.pages[parent_index].interactive[interactive_index];var iframeId=currobj.id;var no_source_div;var holder_el=drawer.getBaseStructure(parent_index,interactive_index,into_parent_div);var iframe_el=$('<iframe></iframe>');var src_html,no_source_div;var css=drawer.getGeneralCss(currobj);var is_mobile=window.ed.istouchdevice;var url_link=currobj.url_link;if(isApp()){url_link=modifySRCUrlForApps(url_link,'iframe');}
holder_el.attr('title','Iframe').addClass('gpuAcc').css(css);if(!url_link||url_link==''){no_source_div=$('<div></div>');no_source_div.addClass('no-content').append($('<div class="icon"></div>'))
holder_el.append(no_source_div);}
if(url_link){iframe_el.attr('width','100%').attr('height','100%').attr('src',url_link);if(isApp()){sandbox="allow-forms allow-scripts allow-same-origin"
iframe_el.attr('sandbox',sandbox);}
holder_el.append(iframe_el);}
if(currobj.iframe_scaling==1)
{holder_el.css({width:(currobj.w/1.4)+'px',height:(currobj.h/1.4)+'px',scale:1.4,'transform-origin':'0 0','-ms-transform-origin':'0 0','-moz-transform-origin':'0 0','-webkit-transform-origin':'0 0',});}
if(is_mobile){holder_el.css({'-webkit-overflow-scrolling':'touch','overflow':'scroll'});}
window.eddata.pages[parent_index].interactive[interactive_index].holderDivId='iframe'+iframeId;src_html=holder_el.wrap('<p>').parent().html();return src_html;},}
;
var edThreesixty={_windowResizeRegistered:false,THUMB_PADDING:20,_oneImgDistance:10,getDiv:function(parent_index,interactive_index,into_parent_div)
{var currobj=window.eddata.pages[parent_index].interactive[interactive_index];currobj.holderDivId='threesixty'+currobj.id;currobj.contentloaded=true;currobj.divid=currobj.holderDivId;var protoStr=''+'<div class="el_threesixty gpuAcc element_holder" ontouchstart="window.ed._is_gallery_mouse_down = true;" ontouchend="window.ed._is_gallery_mouse_down = false;"  '+'>'+'   <img class="preloader"></img>'+'   <div class="progbar">'+'       <div class="progthumb"></div>'+'   </div>'+'   <div class="iscroll_holder">'+'        <div class="iscroll_content"></div>'+'    </div>'+'</div>';var div=$(protoStr).attr('id',currobj.holderDivId).css({left:currobj.x,top:currobj.y,width:currobj.w,height:currobj.h,opacity:0.01});var src_html=div[0].outerHTML;var pageNum=window.eddata.pages[parent_index].pagenumber;setTimeout(function(){window.ed.checkPreloadedImgs(pageNum,currobj.holderDivId,'threesixty');},300);return src_html;},drawDivForMobile:function(pageobj,div){var self=this;div=$(div);if(!div.length){return}
var html=$(''+'   <img class="preloader"></img>'+'   <div class="progbar">'+'       <div class="progthumb"></div>'+'   </div>'+'   <div class="iscroll_holder">'+'        <div class="iscroll_content"></div>'+'    </div>');div.append(html);div.removeClass('ed-gallery').removeClass('gallery').addClass('el_threesixty handle_touches');this.finalizeElement(pageobj,div);},finalizeElement:function(data,div)
{var self=this;jtrace('finalize edThreesixty',data);var div=$(div);if(!div.length){div=$('#'+data.holderDivId);}
var i=0;div.find('.progbar').addClass('hidden');if(data.additional_params)
{var color=data.additional_params.threesixty_background;if(color){div.css({'background-color':color});}}
var iscroll=new IScrollProbe(div.find('.iscroll_holder')[0],{scrollX:true,probeType:3,momentum:true,janMarryGoRound:true,});iscroll.disable();iscroll.on('scroll',this._onScroll);iscroll.maxScrollX=-2147480000;iscroll.x=iscroll.maxScrollX / 2;iscroll.hasHorizontalScroll=true;div.data('iscroll',iscroll);div.data('scrollStartPoint',iscroll.x);if(!self._windowResizeRegistered)
{self._windowResizeRegistered=true;var resetTO=false;$(document).on("edResize",function(){clearTimeout(resetTO);resetTO=setTimeout(function(){$('.el_threesixty').each(function()
{var iscroll=$(this).data('iscroll');if(!iscroll){return}
iscroll.maxScrollX=-2147480000;iscroll.x=iscroll.maxScrollX / 2;self._onScroll.call(iscroll);});},100);});}
div.find('.progbar').on('mousedown',this,this._thumbMouseDown);div.find('.progbar').on('mousemove',this,this._thumbMouseMove);var preloader=div.find('.preloader');var thumbsLoaded=false;preloader.on('load',function(e)
{var imgEl=div.find('.threesixty_img').filter(function(){return $(this).data('index')==i});if(!imgEl.length)
{imgEl=$('<div class="threesixty_img"></div>');imgEl.data('index',i);div.append(imgEl);}
imgEl.css({'background-image':'url('+$(this).attr('src')+')'});if(i==0){imgEl.addClass('max');}
i++;if(!thumbsLoaded)
{if(i<=data.jsobj.images.length-1)
{preloader.attr('src',data.jsobj.images[i].thumb);}
else
{thumbsLoaded=true;iscroll.enable();if(!data.additional_params||data.additional_params.threesixty_slider==1)
{div.find('.progbar').removeClass('hidden');}
jtrace('*** Loading big images ***');i=0;preloader.attr('src',data.jsobj.images[i].bigimg);self._updateProgressThumbPos(div);}}
else if(i<=data.jsobj.images.length-1)
{preloader.attr('src',data.jsobj.images[i].bigimg);}})
if(!data.jsobj.images||!data.jsobj.images.length){return}
jtrace('*** Loading thumbs ***');preloader.attr('src',data.jsobj.images[0].thumb);},_elFromIscroll:function(iscroll)
{return $(iscroll.wrapper).parents('.el_threesixty').first();},getImages:function(el)
{return $(el).find('.threesixty_img');},_updateProgressThumbPos:function(el)
{el=$(el);var images=this.getImages(el);if(!images.length){console.log('Error _updateProgressThumbPos: div not found');return}
var index=images.filter('.max').data('index');var bar=el.find('.progbar');var thumb=bar.find('.progthumb');var progress=index /(images.length-1);var x=this.THUMB_PADDING+(bar.width()-2*this.THUMB_PADDING)*progress;thumb.css({left:x});},_onScroll:function(e)
{var self=edThreesixty;var iscroll=this;var el=self._elFromIscroll(this);var images=el.find('.threesixty_img');jtrace('index!',[iscroll.x,iscroll.maxScrollX]);var imgCount=images.length;var scrollStart=el.data('scrollStartPoint');var allImagesDist=imgCount*self._oneImgDistance;var floatIndex=-(iscroll.x-scrollStart)%allImagesDist / self._oneImgDistance;if(floatIndex<0){floatIndex=imgCount+floatIndex}
var index=Math.floor(floatIndex);var img=images.filter(function(){return $(this).data('index')==index});images.not(img).smartRemoveClass('max');img.smartAddClass('max');self._updateProgressThumbPos(el);},_thumbMouseDown:function(e)
{var self=e.data;$(this).addClass('dragging');var el=$(this).parents('.el_threesixty');var thumb=$(this);function mouseUp(e)
{delete self._dragData;thumb.removeClass('dragging');$('body').off('mouseup',mouseUp);return false;}
$('body').on('mouseup',mouseUp);self._updateIndexFromThumbPos(e.offsetX,$(this).parents('.el_threesixty'));return false;},_thumbMouseMove:function(e)
{var self=e.data;if(!$(this).hasClass('dragging')){return}
self._updateIndexFromThumbPos(e.offsetX,$(this).parents('.el_threesixty'));return false;},_updateIndexFromThumbPos:function(offset,el)
{var self=this;var images=self.getImages(el);var count=images.length-1;var width=el.find('.progbar').width()-2*self.THUMB_PADDING;offset=Math.min(offset-self.THUMB_PADDING,width);var index=Math.max(0,offset / width*count);var startIndex=(self._dragData?self._dragData.startIndex:images.filter('.max').data('index'))||0;var dIndex=index-startIndex;jtrace('---- thumb ------');jtrace('offset',offset);jtrace('startIndex',startIndex);jtrace('dIndex',dIndex);jtrace('index',index);var startX=self._dragData?self._dragData.startX:el.data('iscroll').x;var x=startX+(startIndex-index)*self._oneImgDistance;if(!self._dragData)
{self._dragData={startX:x,startIndex:index}}
el.data('iscroll').scrollTo(x,0,0);self._onScroll.call(el.data('iscroll'));},}
;
window.ed.clearFSCGallery=function(){window.ed.isiscrollroll=false;var gal_id=ed.FSCGalleryVisibleId;ed.FSCGalleryVisible=false;ed.FSCGalleryVisibleId=0;ed.enableCommands();if(ed._loader_visible)
{ed.hideLoader();}
if(ed.fscGalScroll!=null)
{try
{ed.fscGalScroll.destroy();ed.fscGalScroll=null;}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5774; column: 183;  :: '+v);console.log("Error while freeind fscgalScroll -"+e.message);}}
ed.get(ed._galFSCDiv.id).innerHTML='';ed.get(ed._galFSCDiv.id).style['width']='0px';ed.get(ed._galFSCDiv.id).style['height']='0px';ed.get(ed._galFSCDiv.id).style['display']='none';$('#edition-layers').stop().css({display:'none'});window.ed.sendInteractiveStats('Gallery','Close full screen',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,$('#'+ed._galFSCDiv.id).attr('title'),'',0,'',0,gal_id);};window.ed.checkGalleriesForPage=function(_page_id,showConnectedObj,wasalreadycalledload){if(typeof(wasalreadycalledload)=='undefined')
{var wasalreadycalledload=false;}
if(typeof(showConnectedObj)=='undefined')
{var showConnectedObj=-1;}
try
{var shouldload=false;var hasgalleries=false;var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(_page_id);for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];var galleryId=currobj.id;var parentDivId=currobj.divid;if(currobj.itype==window.ide.itypegallery)
{hasgalleries=true;if((!currobj.loaded)&&(!currobj.loaderror))
{shouldload=true;}
else
{if(!currobj.loaderror)
{currobj.contentloaded=false;if(!currobj.connected)
{ed.drawGallery(currobj.id);}
else if(parseInt(currobj.id)==parseInt(showConnectedObj))
{ed.drawGallery(currobj.id);}}}}}
if((shouldload)&&(hasgalleries)&&(!wasalreadycalledload))
{}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5792; column: 126;  :: '+v);console.log('ERROR While loading XML File -> '+e.message)}};window.ed.setImageOwnCoordinatesAndStyles=function(element,_gallery_id,d,m,effect,divid){try
{var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if(objParentArrGall==null){return;}
var parentObjW=objParentArrGall.w;var parentObjH=objParentArrGall.h;var thsw=element.width;var thsh=element.height;objParentArrGall.jsobj.images[m].width=thsw;objParentArrGall.jsobj.images[m].height=thsh;if(effect=='fill')
{if(parseInt(thsw)>parseInt(thsh))
{var topoffset=Math.floor((parseInt(parentObjH)-parseInt(thsh))/2);if(ed.get(divid)!=null)
{ed.get(divid).style['background-size']='cover';}}
else
{var leftoffset=Math.floor((parseInt(parentObjW)-parseInt(thsw))/2);if(ed.get(divid)!=null)
{ed.get(divid).style['background-size']='cover';}}}
else
{ed.get(divid).style['background-size']='contain';ed.get(divid).style['background-position']='center center';}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5802; column: 245;  :: '+v);ed.trace('Error while setting width and height of image ->'+e.message);}};window.ed.closeFSCGallery=function(){window.ed.isiscrollroll=false;$('.fscgalleryloaderdouble').remove();ed.FSCarrGalleryOptions=null;$('#'+ed._galFSCDiv.id).transition({opacity:0},350,window.ed.defaultEasing,function(){window.ed.clearFSCGallery();});};window.ed.runIscroll=function(objimg){try{var parentNod=ed.get(objimg).parentNode.parentNode;ed.fscGalScrollImage=objimg;ed.fscGalScrollImageParent=parentNod.id;window.ed.fscGalScroll=new iScroll(ed.fscGalScrollImageParent,{zoomMin:1,hScrollbar:true,fadeScrollbar:true,hScrollbar:true,bounce:false,zoom:true,lockDirection:false});}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5802; column: 1088;  :: '+v);ed.trace('Error while creating iScroll -> '+e.message);};};window.ed.endedLoadingFSCImage=function(elem,fromw,fromh){if(typeof(fromw)=='undefined')
{var fromw=-1;}
if(typeof(fromh)=='undefined')
{var fromh=-1;}
if((fromw>0)&&(fromh>0))
{var imageWidth=fromw;var imageHeight=fromh;}
else
{var imageWidth=elem.width;var imageHeight=elem.height;}
var objImg=ed.FSCarrGalleryOptions.galleryId+'img';var parentNod=ed.get(objImg).parentNode.parentNode;ed.fscGalScrollImage=objImg;ed.fscGalScrollImageParent=parentNod.id;ed._currnt_gal_width=imageWidth;ed._currnt_gal_height=imageHeight;var ratio=imageWidth / imageHeight;var setHeight=$('#edition-layers').height();var setWidth=Math.round(setHeight*ratio);var currentSCREENWIDTH=$('#edition-layers').width();var currentSCREENHEIGHT=$('#edition-layers').height();if(setWidth>currentSCREENWIDTH)
{var setWidth=currentSCREENWIDTH;var setHeight=Math.round(setWidth/ratio);}
if(setHeight>currentSCREENHEIGHT)
{var setHeight=currentSCREENHEIGHT;var setWidth=Math.round(setHeight*ratio);}
var offsetX=0;var offsetY=0;if(setHeight>=currentSCREENHEIGHT)
{offsetX=Math.round((currentSCREENWIDTH-setWidth)/ 2);}
if(setWidth>=currentSCREENWIDTH)
{offsetY=Math.round((currentSCREENHEIGHT-setHeight)/ 2);}
ed.get(objImg).style['position']='relative';ed.get(objImg).style['z-index']=8;ed.get(objImg).style['left']=offsetX.toString()+'px';ed.get(objImg).style['top']=offsetY.toString()+'px';if(imageWidth>imageHeight)
{ed.get(objImg).style['width']=setWidth.toString()+'px';ed.get(objImg).style['height']=setHeight.toString()+'px';ed.get(objImg).style['max-height']='100%';ed.get(objImg).style['max-width']='100%';}
else
{ed.get(objImg).style['width']=setWidth.toString()+'px';ed.get(objImg).style['height']=setHeight.toString()+'px';ed.get(objImg).style['max-height']='100%';ed.get(objImg).style['max-width']='100%';}
try
{$('.fscgalleryloaderdouble').transition({opacity:1},'fast',function(){$('.fscgalleryloaderdouble').remove();});}catch(e){('.fscgalleryloaderdouble').remove();}
ed.hideLoader();if(ed.fscGalScroll!=null)
{ed.fscGalScroll.refresh();}
else
{$('#'+objImg).fadeTo(250,1,function(){ed._currentlyLoadingFSCImage=false;window.ed.runIscroll(objImg);});}
var currentIndx=ed.FSCarrGalleryOptions.itemindex-1;var obj=ed.FSCarrGalleryOptions.mainobj.jsobj.images[currentIndx];$('#FSCDescText').find('.fsctitle').text(obj.title);$('#FSCDescText').find('.fscdescription').text(obj.description);};window.ed.runFSCGalleryImage=function(_gall_id){};window.ed.increaseCountingTimer=function(_gal_id){try
{var objgal=window.f.findArrGalleryObjectByGalleryId(_gal_id);var swipeEnabled=true;try
{if(objgal.jsobj.settings.swipeenabled!=1)
{swipeEnabled=false;}}catch(e){ed.trace('Error while increasing counting timer')}
if(swipeEnabled)
{ed._gallery_touch_counter++;objgal.jsobj.settings.touchcounter=ed._gallery_touch_counter.toString();}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5833; column: 237;  :: '+v);ed.trace('Error while increasing counting timer')}};window.ed.checkIfWholeGalleryDownloaded=function(thissrcLoaded,_gallery_id){if(typeof(thissrcLoaded)!='undefined')
{for(var d in ed.downloadItems.items)
{var currobj=ed.downloadItems.items[d];if((currobj!=null)||(typeof(currobj)=='undefined'))
{if(typeof(currobj.loadpath)!='undefined')
{if((currobj.loadpath==thissrcLoaded.src)||(thissrcLoaded.src.indexOf(currobj.loadpath)>-1))
{ed.downloadItems.items[d]=null;}}}}}
var everythingdownloaded=true;for(var d in ed.downloadItems.items)
{var currobj=ed.downloadItems.items[d];if(currobj!=null)
{if(currobj.gallerindx==_gallery_id)
{everythingdownloaded=false;}}}
var found=false;for(var d in ed.downloadItems.items)
{var currobj=ed.downloadItems.items[d];try
{if(currobj!=null)
{if(typeof(currobj.loadpath)!='undefined')
{found=true;}}}catch(e){}}
if(!found)
{ed.preventBecauseGallery=false;ed.hideLoader(0);}
if(everythingdownloaded)
{var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if(objParentArrGall!=null){ed.runGallery(window.ide.currentPage,false,_gallery_id,1);objParentArrGall.contentloaded=true;}
window.ed.checkPreloadedImgs(window.ide.currentPage,'gal'+_gallery_id,window.ide.itypegallery);}
else
{if(!ed._loader_visible)
{ed.showLoader(ed.loader5);}}};window.ed.FSCGalleryNextOrPrevious=function(gotoPage){if(ed._currentlyLoadingFSCImage)
{return false;}
var goToNext=false;var goToPrevious=false;if(gotoPage==ed._galnextGalleryImage)
{goToNext=true;}
else if(gotoPage==ed._galpreviousGalleryImage)
{goToPrevious=true;}
if((ed.FSCGalleryVisible)&&(ed.FSCGalleryVisibleId>0))
{if((goToNext)||(goToPrevious))
{var currentIndx=ed.FSCarrGalleryOptions.itemindex;var allimages=ed.FSCarrGalleryOptions.allImagesCount;var goToIndex=currentIndx;var statTitle='Next';if(goToNext)
{goToIndex++;}
else
{statTitle='Previous';goToIndex--;}
if(goToIndex<1)
{goToIndex=allimages;}
if(goToIndex>allimages)
{goToIndex=1;}
var downloadImage=ed.FSCarrGalleryOptions.images[goToIndex];try
{var img_id=ed.FSCarrGalleryOptions.ids[goToIndex];}catch(e){var img_id=0;}
try
{window.ed.galshowlinkbtn(null,'gal'+ed.FSCGalleryVisibleId+'linkbtnfsc',0,ed.FSCarrGalleryOptions.links[goToIndex],true);}catch(e){}
window.ed.sendInteractiveStats('Gallery',statTitle,window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,ed.FSCarrGalleryOptions.mainobj.dev_name,'',0,ed.FSCarrGalleryOptions.titles[goToIndex],0,ed.FSCGalleryVisibleId,img_id);var objImg=ed.FSCarrGalleryOptions.galleryId+'img';ed.FSCarrGalleryOptions.itemindex=goToIndex;ed.get('FSClabelpages').innerHTML=goToIndex.toString()+' / '+allimages.toString();ed.showLoader();try
{var addHTML=$('#loadingMenu')[0].outerHTML;addHTML=addHTML.replace('loadingMenu','fscloadingmenu');addHTML=addHTML.replace('class="','class="fscgalleryloaderdouble ');$('#edition-layers').append(addHTML);$('.fscgalleryloaderdouble').css({opacity:0,'z-index':999999});$('.fscgalleryloaderdouble').transition({opacity:1},'fast');}catch(e){}
$('#'+objImg).fadeTo(250,0);ed._currentlyLoadingFSCImage=true;ed.galleryFSCZoomedIn=false;if(ed.fscGalScroll!=null)
{try
{ed.fscGalScroll.destroy();ed.fscGalScroll=null;}catch(e){}}
if(ed._isDesktopBrowser&&ed.get(ed.galleryZoomInZoomOutDivName)!=null)
{ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomOutButton','');ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomInButton','');ed.get(ed.galleryZoomInZoomOutDivName).className='FSgalleryZoomInButton '+ed.get(ed.galleryZoomInZoomOutDivName).className;}
window.setTimeout("window.ed.preloadCustomImage('"+downloadImage+"','window.ed.setImageSrc(this,\""+objImg+"\",\"\");window.ed.endedLoadingFSCImage(this);','');",250);}}};window.ed.zoomInZoomOutFSCGalllery=function(){if(ed.galleryFSCZoomedIn)
{ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomOutButton','');ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomInButton','');ed.get(ed.galleryZoomInZoomOutDivName).className='FSgalleryZoomInButton '+ed.get(ed.galleryZoomInZoomOutDivName).className;zoomFromX=Math.round(parseInt(ed._current_ScreenWidth)/2);ed.fscGalScroll.zoom(zoomFromX,0,1,800);ed.galleryFSCZoomedIn=false;}
else
{ed.galleryFSCZoomedIn=true;zoomFromX=Math.round(parseInt(ed._current_ScreenWidth)/2);ed.fscGalScroll.zoom(zoomFromX,0,ed.FSCgalleryMaxZoom,800);ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomOutButton','');ed.get(ed.galleryZoomInZoomOutDivName).className=ed.get(ed.galleryZoomInZoomOutDivName).className.replace('FSgalleryZoomInButton','');ed.get(ed.galleryZoomInZoomOutDivName).className='FSgalleryZoomOutButton '+ed.get(ed.galleryZoomInZoomOutDivName).className;}};window.ed.runFSCGallery=function(_gall_id){try
{var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gall_id);var currentImageIndex=objParentArrGall.jsobj.settings.currentindex;var counts=objParentArrGall.jsobj.images.length;if(counts>=1)
{if((ed._galFSCDiv==null)||(typeof(ed._galFSCDiv)=='undefined'))
{$('#edition-layers').append('<div id="pageGalleryFullscrenDiv" class="gpuAcc gallFullScreen NoSelect textAlignLeft"></div>');ed._galFSCDiv=document.getElementById('pageGalleryFullscrenDiv');}
ed.FSCarrGalleryOptions={rootpath:'',galleryId:objParentArrGall.id,itemindex:currentImageIndex,allImagesCount:counts,mainobj:objParentArrGall,images:new Array(),links:new Array(),titles:new Array(),ids:new Array()};ed.FSCGalleryVisible=true;ed._currentlyLoadingFSCImage=true;ed.FSCGalleryVisibleId=_gall_id;var currentWdth='auto';var currentHght='auto';var galleryFSCItmindx=1;var rootPath='';for(var lm in objParentArrGall.jsobj.images)
{var crntobj=objParentArrGall.jsobj.images[lm];ed.FSCarrGalleryOptions.images.push(galleryFSCItmindx);ed.FSCarrGalleryOptions.images[galleryFSCItmindx]=crntobj.bigimg;ed.FSCarrGalleryOptions.links.push(galleryFSCItmindx);ed.FSCarrGalleryOptions.links[galleryFSCItmindx]=crntobj.link;ed.FSCarrGalleryOptions.titles.push(galleryFSCItmindx);ed.FSCarrGalleryOptions.titles[galleryFSCItmindx]=crntobj.title;ed.FSCarrGalleryOptions.ids.push(galleryFSCItmindx);ed.FSCarrGalleryOptions.ids[galleryFSCItmindx]=crntobj.image_id;galleryFSCItmindx++;}
var includeScript='';var addstyle='';var addStyleRight='';var cssstyle=' align="center" ';var imageId=_gall_id+'img';var currentSRC=rootPath+ed.FSCarrGalleryOptions.images[currentImageIndex];$('#'+imageId).fadeTo(0,0);window.setTimeout("window.ed.preloadCustomImage('"+currentSRC+"','window.ed.setImageSrc(this,\""+imageId+"\",\"\");window.ed.endedLoadingFSCImage(this);','');",250);currentSRC=ed.defaultNoImageValueSrc;includeScript=includeScript+'<div id="parentParentOfImageFSCGallery'+_gall_id.toString()+'" class="rhrforfscgallerytoanimparent" style="width: 100%; height: 100%;"><img id="'+imageId+'" class="rhrforfscgallerytoanim NoSelect" src="'+currentSRC+'" style="border:0;width:100%;height:100%;" class="gpuAcc" /></div>';includeScript=includeScript+'</div>';if(objParentArrGall.jsobj.images.length>1)
{includeScript=includeScript+'<div id="FSCbuttonleft" class="FSgalleryLeftButton gpuAcc button90 FSCleftarrow coloroverride" onclick="javascript:window.ed.FSCGalleryNextOrPrevious(window.ed._galpreviousGalleryImage);" '+addstyle+' ><div></div><span></span></div>';includeScript=includeScript+'<div id="FSCbuttonright" class="FSgalleryRightButton gpuAcc button90 FSCrightarrow coloroverride" style="right:0px;'+addStyleRight+'" onclick="javascript:window.ed.FSCGalleryNextOrPrevious(window.ed._galnextGalleryImage);"><div></div><span></span></div>';}
includeScript=includeScript+'<div id="FSCbuttonclose" class="FSgalleryCloseButton gpuAcc button90 FSCclosegallery coloroverride" style="right:0px" onclick="javascript:window.ed.closeFSCGallery();"><div></div><span></span></div>';includeScript=includeScript+'<div id="gal'+_gall_id.toString()+'linkbtnfsc" class="FSCGalleryLinkButton FSCgallinkbutton gpuAcc button90 coloroverride"></div>';if(ed._isDesktopBrowser)
{includeScript=includeScript+'<div id="'+ed.galleryZoomInZoomOutDivName+'" class="FSgalleryZoomInButton gpuAcc button90 FSCzoominouttogle coloroverride" style="right:0px" onclick="javascript:window.ed.zoomInZoomOutFSCGalllery();"><div></div><span></span></div>';}
if(objParentArrGall.jsobj.settings.showdesctext==1){includeScript+='<div id="FSCDescText">'+'<div class="fsctitle">Title</div>'+'<div class="fscdescription">Description</div>'+'</div>';}
includeScript=includeScript+'<div id="FSClabelpages" class="FSgalleryLabel gpuAcc" >'+(currentImageIndex).toString()+' / '+counts.toString()+'</div>';ed.get(ed._galFSCDiv.id).innerHTML='';ed.get(ed._galFSCDiv.id).innerHTML=ed.get(ed._galFSCDiv.id).innerHTML+includeScript;$('#'+ed._galFSCDiv.id).attr('title',objParentArrGall.jsobj.settings.albumtitle);window.ed.sendInteractiveStats('Gallery','Full screen',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,objParentArrGall.jsobj.settings.albumtitle,'',0,'',0,ed.FSCGalleryVisibleId);$('#'+ed._galFSCDiv.id).css({'width':'100%','height':'100%'});ed.get(ed._galFSCDiv.id).style['display']='block';ed.disableCommands();ed.showLoader();if(objParentArrGall.jsobj.images.length>1)
{var hammerHandler=new Hammer($('#pageGalleryFullscrenDiv')[0]);hammerHandler.on('panstart',function(ev){window.ed.onFSCGalPanStart(ev);});hammerHandler.on('pan',function(ev){window.ed.onFSCGalPan(ev);});hammerHandler.on('panend',function(ev){window.ed.onFSCGalPanEnd(ev);});}
$('#'+ed._galFSCDiv.id).fadeTo(0,0);try
{window.ed.galshowlinkbtn(null,'gal'+_gall_id+'linkbtnfsc',0,ed.FSCarrGalleryOptions.links[currentImageIndex],true);}catch(e){}
window.setTimeout("$('#edition-layers').stop().css({display:'block'});$('#"+ed._galFSCDiv.id+"').fadeTo(350,1);window.ed.runFSCGalleryImage("+_gall_id.toString()+");",150);}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 5901; column: 126;  :: '+v);console.log('Error while trying to run FULLSCREEN Gallery -> '+e.message);}};window.ed.galFSCButtonStartHandler=function(event){if(typeof(this.id)!='undefined')
{ed._galFSCBtnPressedElement=this.id;ed._is_gallery_mouse_down=true;event.preventDefault();event.returnValue=false;return false;}};window.ed.onFSCGalPanStart=function(ev){this.neededmoveXforswipe=Math.round($('#edition-layers').width()/4);if(this.neededmoveXforswipe>300)
{this.neededmoveXforswipe=300;}
else if(this.neededmoveXforswipe<120)
{this.neededmoveXforswipe=120;}
this.offsetFSC=0;try
{if(window.ed.fscGalScroll.scale>1)
{window.ed.galleryFSCZoomedIn=true;}
else
{window.ed.galleryFSCZoomedIn=false;}}catch(e){}};window.ed.onFSCGalPan=function(ev){if(!window.ed.galleryFSCZoomedIn)
{this.offsetFSC=ev.deltaX;var opacityset=Math.abs(this.offsetFSC)/this.neededmoveXforswipe;if(opacityset>1)
{opacityset=1;}
else if(opacityset<0)
{opacityset=0;}
opacityset=1-opacityset;if(this.offsetFSC<0)
{$('#FSCbuttonright').css({opacity:1});$('#FSCbuttonleft').css({opacity:opacityset});$('.rhrforfscgallerytoanim').css({x:this.offsetFSC,opacity:opacityset});}
else if(this.offsetFSC>0)
{$('#FSCbuttonleft').css({opacity:1});$('#FSCbuttonright').css({opacity:opacityset});$('.rhrforfscgallerytoanim').css({x:this.offsetFSC,opacity:opacityset});}
else
{$('#FSCbuttonleft').css({opacity:1});$('#FSCbuttonright').css({opacity:1});$('.rhrforfscgallerytoanim').css({x:0,opacity:1});}}};window.ed.onFSCGalPanEnd=function(ev){if((this.offsetFSC<=-this.neededmoveXforswipe)&&(!window.ed.galleryFSCZoomedIn))
{$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');$('.rhrforfscgallerytoanim').transition({x:0},'fast');window.ed.FSCGalleryNextOrPrevious(window.ed._galnextGalleryImage);}
else if((this.offsetFSC>=this.neededmoveXforswipe)&&(!window.ed.galleryFSCZoomedIn))
{$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');$('.rhrforfscgallerytoanim').transition({x:0},'fast');window.ed.FSCGalleryNextOrPrevious(window.ed._galpreviousGalleryImage);}
else
{$('.rhrforfscgallerytoanim').transition({x:0,opacity:1},'fast');$('#FSCbuttonright').transition({opacity:1},'fast');$('#FSCbuttonleft').transition({opacity:1},'fast');}
this.offsetFSC=0;};window.ed.galFSCButtonMoveHandler=function(event){event.preventDefault();event.returnValue=false;return false;};window.ed.galFSCButtonEndHandler=function(event){var canCheckEndHandling=false;if(event.touches!=null)
{if(event.touches.length<=0)
{canCheckEndHandling=true;}}
else
{canCheckEndHandling=true;}
if((ed._is_gallery_mouse_down)&&(canCheckEndHandling))
{var objBtn=ed.get(ed._galFSCBtnPressedElement);if(objBtn!=null)
{var galid=objBtn.id.replace('fscbtn','');galid=galid.replace('gal','').replace('inner','');if(!isNaN(galid))
{ed.runFSCGallery(galid);}
ed._is_gallery_mouse_down=false;event.preventDefault();event.returnValue=false;return false;}}};window.ed.galleryStartHandler=function(event){window.ed.resetDesktopMode(event.type);if(typeof(this.id)!='undefined')
{ed.pressedGalleryElement=this.id;var _gal_id=ed.pressedGalleryElement.replace('gal','').replace('inner','');ed.increaseCountingTimer(_gal_id);ed.galleryEndLastXtouch=0;ed.galleryEndLastYtouch=0;if(event.touches!=null)
{if(event.touches.length<=1)
{ed.galleryStartingX=Math.round((Math.round(parseInt(event.touches[0].screenX)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX));ed.galleryStartingY=Math.round((Math.round(parseInt(event.touches[0].screenY)/ window.ide.defaultInitialScale)-(ed._paddingTop/2)));ed.galleryEndLastXtouch=event.touches[0].screenX;ed.galleryEndLastYtouch=event.touches[0].screenY;ed.galleryStartingTime=new Date();}}
else
{ed.galleryStartingX=Math.round((Math.round(parseInt(event.pageX)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX));ed.galleryStartingY=Math.round((Math.round(parseInt(event.pageY)/ window.ide.defaultInitialScale)-(ed._paddingTop/2)));ed.galleryStartingTime=new Date();}
ed._is_gallery_mouse_down=true;event.preventDefault();event.returnValue=false;return false;}};window.ed.galleryMoveHandler=function(event){if(event.touches!=null)
{if(event.touches.length<=1)
{ed.galleryEndLastXtouch=event.touches[0].screenX;ed.galleryEndLastYtouch=event.touches[0].screenY;}}
event.preventDefault();event.returnValue=false;return false;};window.ed.galleryEndHandler=function(event){var was_last_image_clicked=window.ed._last_image_clicked;window.ed._last_image_clicked='';var canCheckEndHandling=false;if(event.touches!=null)
{if(event.touches.length<=0)
{canCheckEndHandling=true;}}
else
{canCheckEndHandling=true;}
if(canCheckEndHandling)
{var elementPressed=ed.get(ed.pressedGalleryElement);try
{if(ed._is_gallery_mouse_down)
{ed._is_gallery_mouse_down=false;if(elementPressed!=null)
{if(event.touches!=null)
{if(event.touches.length<=1)
{var galEndX=Math.round((Math.round(parseInt(ed.galleryEndLastXtouch)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX));var galEndY=Math.round((Math.round(parseInt(ed.galleryEndLastYtouch)/ window.ide.defaultInitialScale)-(ed._paddingTop/2)));}}
else
{var galEndX=Math.round((Math.round(parseInt(event.pageX)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX));var galEndY=Math.round((Math.round(parseInt(event.pageY)/ window.ide.defaultInitialScale)-(ed._paddingTop/2)));}
var differenceX=ed.galleryStartingX-galEndX;var differenceY=ed.galleryStartingY-galEndY;var timeDifference=new Date()-ed.galleryStartingTime;if((Math.abs(differenceX)<=10)&&(Math.abs(differenceX)>=-10)&&(timeDifference<400))
{thisClickedX=ed._pressedElementX;thisClickedY=ed._pressedElementY;ed._pressedElementX=-500;ed._pressedElementY=-500;var objPgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(objPgs!=null)
{thisClickedX=Math.round((objPgs.iscroll[0].pointX-objPgs.iscroll[0].x-window.ide.playerPlacementOffset.left)/ objPgs.iscroll[0].scale);thisClickedY=Math.round((objPgs.iscroll[0].pointY-objPgs.iscroll[0].y-window.ide.playerPlacementOffset.top)/ objPgs.iscroll[0].scale);objPgs.iscroll[0].pointX=-1;objPgs.iscroll[0].pointY=-1;}
if((!ed._popup_shown)&&(!ed._video_shown)&&(!ed._facebookIsShown))
{if(ed.testIfLinkWasPressed(thisClickedX,thisClickedY,was_last_image_clicked))
{}}}
if((Math.abs(differenceX)>40)&&(timeDifference<1000))
{var _gal_id=elementPressed.id.replace('gal','').replace('inner','');var obj_gal_current=window.f.findArrGalleryObjectByGalleryId(_gal_id);var swipeEnabled=true;try
{if(obj_gal_current.jsobj.settings.swipeenabled!=1)
{swipeEnabled=false;}}catch(e){ed.trace('Error while increasing counting timer')}
if(swipeEnabled)
{if(differenceX>0)
{ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,ed._galnextGalleryImage,ed._gallery_touch_counter,false,true);}
else
{ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,ed._galpreviousGalleryImage,ed._gallery_touch_counter,false,true);}}
else
{if(differenceX>0)
{ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,ed._galnextGalleryImage,ed._gallery_touch_counter,false,true,true);}
else
{ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,ed._galpreviousGalleryImage,ed._gallery_touch_counter,false,true,true);}}}
else if((Math.abs(differenceX)<40)&&(timeDifference<1000))
{try
{var imageUrl='';var _gal_id=elementPressed.id.replace('gal','').replace('inner','');var obj_gal_current=window.f.findArrGalleryObjectByGalleryId(_gal_id);var currentGalleryIndex=ed.arrGalleryObjectSettings[_gal_id].settings['currentindex'];if(obj_gal_current.jsobj.images[currentGalleryIndex].link!='')
{imageUrl=obj_gal_current.jsobj.images[currentGalleryIndex].link;if(imageUrl.indexOf("://")<1)
{imageUrl='http://'+imageUrl;}}
if(imageUrl!='')
{}
else
{if(obj_gal_current.jsobj.settings.showfullscreenbutton==1)
{ed.runFSCGallery(_gallery_id);}}
ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,currentGalleryIndex,ed._gallery_touch_counter,false);}catch(e)
{}}
else
{try
{var imageUrl='';var _gal_id=elementPressed.id.replace('gal','').replace('inner','');var obj_gal_current=window.f.findArrGalleryObjectByGalleryId(_gal_id);var currentGalleryIndex=obj_gal_current.jsobj.settings.currentindex;ed._gallery_touch_counter++;ed.runGallery(window.ide.currentPage,true,_gal_id,currentGalleryIndex,ed._gallery_touch_counter,false);}catch(e)
{}}}}}catch(e)
{ed._is_gallery_mouse_down=false;}}
event.preventDefault();event.returnValue=false;return false;};window.ed.galleryMouseOutHandler=function(event){ed.galleryEndHandler(event);};window.ed.galshowlinkbtn=function(interactiveobj,classlinkbtn,duration,imagesobj,isfsc){if(isfsc)
{var imageUrl=imagesobj;if(imageUrl!='')
{if(imageUrl.indexOf("://")<1)
{imageUrl='http://'+imageUrl;}
$('#'+classlinkbtn).on(window.ed._touch_end_event_nm,function(){try
{var focusRequest=window.open(imageUrl,"GalleryLink",'');focusRequest.focus();}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6000; column: 213;  :: '+v);}});$('#'+classlinkbtn).stop().css({'display':'inline'}).delay(duration).transition({'opacity':'1'},250,window.ed.jqueryTransition,function(){});}
else
{$('#'+classlinkbtn).stop().delay(duration).transition({'opacity':'0'},250,window.ed.jqueryTransition,function(){$('#'+classlinkbtn).css({'display':'none'})});}}
else
{var imageUrl='';if(imagesobj.link!='')
{imageUrl=imagesobj.link;}
if(imageUrl!='')
{if(imageUrl.indexOf("://")<1)
{imageUrl='http://'+imageUrl;}
$('#'+classlinkbtn).on(window.ed._touch_end_event_nm,function(){try
{var focusRequest=window.open(imageUrl,"GalleryLink",'');focusRequest.focus();}catch(e){}});$('#'+classlinkbtn).stop().css({'display':'inline'}).delay(duration).transition({'opacity':'1'},250,window.ed.jqueryTransition,function(){});}
else
{$('#'+classlinkbtn).stop().delay(duration).transition({'opacity':'0'},250,window.ed.jqueryTransition,function(){$('#'+classlinkbtn).css({'display':'none'})});}}}
window.ed.drawGallery=function(_gallery_id){try
{var fullWidth=0;$('.mainGalDiv').stop().css({'opacity':0.0001,'visibility':'hidden'});var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if((objParentArrGall.id==_gallery_id)&&(objParentArrGall!=null))
{var parentDivElement=ed.get(objParentArrGall.divid);var parentDivElementInner=ed.get(objParentArrGall.holderDivId);var parentDivElementBg=ed.get(objParentArrGall.dividbg);var rootPath='';var bgColor=objParentArrGall.fill_color;var bgAlpha=objParentArrGall.fill_opacity;var viewMode=objParentArrGall.jsobj.settings.viewmode;var image_class='imageGallery_image';var transitionTime=parseInt(objParentArrGall.jsobj.settings.time);var swipeenabled=objParentArrGall.jsobj.settings.swipeenabled;if(transitionTime==0)
{transitionTime=0;}
if(bgColor=='transparent')
{parentDivElementBg.style['background-color']='none';}
else
{parentDivElementBg.style['background-color']=bgColor;parentDivElementBg.style.visibility="visible";}
if(bgAlpha.toString()!='')
{if(parseInt(bgAlpha)<100)
{if(parseInt(bgAlpha)>0)
{$('#'+parentDivElementBg.id).fadeTo(0,(parseInt(bgAlpha)/ 100));}
else
{$('#'+parentDivElementBg.id).fadeTo(0,0);}}}
if(swipeenabled==1)
{if(parentDivElement!=null)
{if(window.ed.istouchdevice)
{window.f.AtachEvent(parentDivElement.id,window.ed._touch_start_event_nm,'window.ed.galleryStartHandler');window.f.AtachEvent(parentDivElement.id,window.ed._touch_move_event_nm,'window.ed.galleryMoveHandler');window.f.AtachEvent(parentDivElement.id,window.ed._touch_end_event_nm,'window.ed.galleryEndHandler');if(window.ed._touch_out_event_nm!='')
{window.f.AtachEvent(parentDivElement.id,window.ed._touch_out_event_nm,'window.ed.galleryMouseOutHandler');}}
else
{window.f.AtachEvent(parentDivElement.id,'mousedown','window.ed.galleryStartHandler');window.f.AtachEvent(parentDivElement.id,'mousemove','window.ed.galleryMoveHandler');window.f.AtachEvent(parentDivElement.id,'mouseup','window.ed.galleryEndHandler');}}}
var isFSCButtonVisible=objParentArrGall.jsobj.settings.showfullscreenbutton;var showFullscreenButton=(isFSCButtonVisible==1);if(showFullscreenButton)
{var fscBtnEl=ed.get(parentDivElementInner.id+'fscbtn');if(fscBtnEl!=null)
{fscBtnEl.style['display']='inline';fscBtnEl.style['visibility']='visible';var toLeft=objParentArrGall.w-$('#'+fscBtnEl.id).width();fscBtnEl.style['top']='0px';fscBtnEl.style['left']=toLeft.toString()+'px';if(window.ed.istouchdevice){window.f.AtachEvent(fscBtnEl.id,window.ed._touch_start_event_nm,'ed.galFSCButtonStartHandler');window.f.AtachEvent(fscBtnEl.id,window.ed._touch_move_event_nm,'ed.galFSCButtonMoveHandler');window.f.AtachEvent(fscBtnEl.id,window.ed._touch_end_event_nm,'ed.galFSCButtonEndHandler');}
else{window.f.AtachEvent(fscBtnEl.id,'mousedown','ed.galFSCButtonStartHandler');window.f.AtachEvent(fscBtnEl.id,'mousemove','ed.galFSCButtonMoveHandler');window.f.AtachEvent(fscBtnEl.id,'mouseup','ed.galFSCButtonEndHandler');}}}
var allowdots=true;var ActiveClass='Active';for(var m in objParentArrGall.jsobj.images)
{var currimg=objParentArrGall.jsobj.images[m];if(!ed._loader_visible)
{ed.showLoader(ed.loader4);}
var parentDivNm=objParentArrGall.holderDivId;if(parentDivElement!=null)
{var path=rootPath+currimg.img;var divid=parentDivNm+'_img'+currimg.id.toString();currimg.owndivid=divid;if(ed.get(divid)==null)
{var innrTxtTitle=currimg.title;var innrTxtDescription=currimg.description;if(typeof(currimg.description)=='undefined')
{innrTxtDescription='';}
if((innrTxtTitle!='')||(innrTxtDescription!=''))
{ed.get(objParentArrGall.divid).innerHTML=ed.get(objParentArrGall.divid).innerHTML+'<div id="'+divid+'" class="'+image_class+' gpuAcc imageRendering"><div id="'+divid+'holder" class="galImageTitleAndDescHolder gpuAcc imageRendering"><div id="'+divid+'title" class="galImageTitle galImageTitle'+objParentArrGall.id.toString()+' gpuAcc imageRendering">'+innrTxtTitle+'</div><div id="'+divid+'desc" class="galImageDescription galImageDescription'+objParentArrGall.id.toString()+' gpuAcc imageRendering">'+innrTxtDescription+'</div></div></div>';}
else
{ed.get(objParentArrGall.divid).innerHTML=ed.get(objParentArrGall.divid).innerHTML+'<div id="'+divid+'" class="'+image_class+' gpuAcc imageRendering"></div>';}}
ed.preventBecauseGallery=true;ed.preloadCustomImage(path,"window.ed.setImageBg(this,'"+divid+"','');window.ed.setImageOwnCoordinatesAndStyles(this,"+_gallery_id+",0,"+m+",'"+viewMode+"','"+divid+"');window.ed.checkIfWholeGalleryDownloaded(this,"+_gallery_id.toString()+");");ed.downloadItems.items.push(divid);ed.downloadItems.items[divid]={loadpath:path,gallerindx:_gallery_id};}
if((objParentArrGall.jsobj.settings.showthumbs=="1")||(objParentArrGall.jsobj.settings.shownavigationbar=="1"))
{var scale=1;var set_width=100;switch(objParentArrGall.jsobj.settings.thumbdimension){case"small":scale=0.5;$('.galImageTitle'+objParentArrGall.id.toString()).css({'font-size':'14px'});$('.galImageDescription'+objParentArrGall.id.toString()).css({'font-size':'14px'});break;case"medium":scale=1;$('.galImageTitle'+objParentArrGall.id.toString()).css({'font-size':'14px'});$('.galImageDescription'+objParentArrGall.id.toString()).css({'font-size':'14px'});break;case"large":scale=1.5;$('.galImageTitle'+objParentArrGall.id.toString()).css({'font-size':'14px'});$('.galImageDescription'+objParentArrGall.id.toString()).css({'font-size':'14px'});break;default:scale=1;$('.galImageTitle'+objParentArrGall.id.toString()).css({'font-size':'14px'});$('.galImageDescription'+objParentArrGall.id.toString()).css({'font-size':'14px'});break;}
if(objParentArrGall.jsobj.settings.bigger_gall_text_size){$('.galImageTitle'+objParentArrGall.id.toString()).css({'font-size':'20px'});$('.galImageDescription'+objParentArrGall.id.toString()).css({'font-size':'20px'});}
set_width=Math.round(set_width*scale);var thumbDivNm=objParentArrGall.holderDivId+'Thumbs';fullWidth+=set_width+5+5;if($('#'+thumbDivNm)[0]==null)
{var addclsdisabled="";if(objParentArrGall.jsobj.settings.shownavigationbar!="1")
{addclsdisabled=" navbardisabled";}
if((objParentArrGall.jsobj.settings.showthumbs=="1"))
{$('#'+objParentArrGall.holderDivId).append('<div id="'+thumbDivNm+'" class="ed-gal-thumb-holder'+addclsdisabled+'" style="height:'+(set_width).toString()+'px;" align="center"><div id="'+thumbDivNm+'Inner" class="'+thumbDivNm+'Inner innerGalleryThumbHolder" style="height:'+set_width.toString()+'px;"></div></div>');}}
if(objParentArrGall.jsobj.settings.shownavigationbar=="1")
{var holderbottomdots=objParentArrGall.holderDivId+'Dots';if($('#'+holderbottomdots).length==0)
{$('#'+objParentArrGall.holderDivId).append('<div id="'+holderbottomdots+'" class="ed-gal-dots-holder" align="center"><div class="ed-gal-dot-previous ed-galdotprev'+objParentArrGall.id+'"></div><div id="'+holderbottomdots+'Inner" class="'+holderbottomdots+'Inner innerGalleryDotsHolder"></div><div class="ed-gal-dot-next ed-galdotnext'+objParentArrGall.id+'"></div></div>');$('.ed-galdotprev'+objParentArrGall.id.toString()).attr('title',currimg.title);$('.ed-galdotnext'+objParentArrGall.id.toString()).attr('title',currimg.title);$('.ed-galdotnext'+objParentArrGall.id.toString()).on(window.ed._touch_start_event_nm,function(){ed.this_is_new_double_click=1;window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});$('.ed-galdotprev'+objParentArrGall.id.toString()).on(window.ed._touch_start_event_nm,function(){ed.this_is_new_double_click=1;window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});if(window.ed.istouchdevice)
{$('.ed-galdotnext'+objParentArrGall.id.toString()).on('mousedown',function(){window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});$('.ed-galdotprev'+objParentArrGall.id.toString()).on('mousedown',function(){window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});}
var bothleftandrightiwdth=($('.ed-galdotnext'+objParentArrGall.id.toString()).width())*2;var singleDotWidth=30;var expectedAllDotsWitdh=singleDotWidth*objParentArrGall.jsobj.images.length;var galfullw=objParentArrGall.w;if(galfullw<(expectedAllDotsWitdh+bothleftandrightiwdth))
{allowdots=false;}}
if(allowdots)
{$('#'+holderbottomdots+'Inner').append('<div class="ed-gal-dot dot-'+objParentArrGall.id.toString()+' dot-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()+' '+ActiveClass+'"><div class="ed-gal-dot-icon"></div></div>');$('.dot-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()).on(window.ed._touch_start_event_nm,function(){window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});}}
if((objParentArrGall.jsobj.settings.showthumbs=="1"))
{$('#'+thumbDivNm+'Inner').css({'width':fullWidth+'px'});$('#'+thumbDivNm+'Inner').append('<div class="ed-gal-thumb thumb-'+objParentArrGall.id.toString()+' thumb-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()+' '+ActiveClass+'" style="width:'+set_width.toString()+'px;height:'+set_width.toString()+'px;background-image:url(\''+currimg.thumb.toString()+'\');" ></div>');ActiveClass='';$('.thumb-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()).attr('title',currimg.title);$('.thumb-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()).on(window.ed._touch_start_event_nm,function(){window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});if(window.ed.istouchdevice)
{$('.thumb-'+objParentArrGall.id.toString()+'-'+currimg.id.toString()).on('mousedown',function(){window.ed.gotoGalleryImage(this.className,objParentArrGall.id,objParentArrGall.jsobj.settings.albumtitle);});}}}}
if((fullWidth>$('#'+objParentArrGall.holderDivId).width())&&($('#'+objParentArrGall.holderDivId).width()>0))
{var iscrollGal=new iScroll(thumbDivNm,{fadeScrollbar:true,hScrollbar:true,bounce:false,zoom:false,lockDirection:false});}}}catch(e)
{console.log('ERROR While drawing  GALLERY -> '+e.message)}};window.ed.gotoGalleryImage=function(classes,galid,albumtitle){var found=false;for(var d=0;d<100;d++)
{var curr_class_nm=' thumb-'+galid.toString()+'-'+d.toString();if(classes.indexOf(curr_class_nm)>0)
{found=true;ed.runGallery(window.ide.currentPage,true,galid,d);}
var curr_class_nm=' dot-'+galid.toString()+'-'+d.toString();if(classes.indexOf(curr_class_nm)>0)
{found=true;ed.runGallery(window.ide.currentPage,true,galid,d);}}
if(!found)
{var curr_class_nm=' ed-galdotnext'+galid.toString();if(classes.indexOf(curr_class_nm)>0)
{ed.runGallery(window.ide.currentPage,true,galid,ed._galnextGalleryImage);found=true;}}
if(!found)
{var curr_class_nm=' ed-galdotprev'+galid.toString();if(classes.indexOf(curr_class_nm)>0)
{ed.runGallery(window.ide.currentPage,true,galid,ed._galpreviousGalleryImage);found=true;}}}
window.ed.galheightoffsetsingle=29;window.ed.runGallery=function(calledWhenPage,animate,_gallery_id,imageindex,touchCounterCalled,isLoop,skipMotionThroughIsSwipe,nextOrPreviousIsFadeIn){if(typeof(nextOrPreviousIsFadeIn)=='undefined')
{var nextOrPreviousIsFadeIn=false;}
if(typeof(skipMotionThroughIsSwipe)=='undefined')
{var skipMotionThroughIsSwipe=false;}
if(typeof(touchCounterCalled)=='undefined')
{var touchCounterCalled=1;}
if(typeof(isLoop)=='undefined')
{var isLoop=false;}
if(calledWhenPage!=window.ide.currentPage)
{return false;}
var goToPrevious=false;var goToNext=false;if(imageindex==ed._galnextGalleryImage)
{goToNext=true;}
if(imageindex==ed._galpreviousGalleryImage)
{goToPrevious=true;}
var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if(objParentArrGall==null)
{var count=0;var tmp_gal_id=-1;var rig
for(var d in window.ide.currentPageObjPgs.interactive)
{var currobj=window.ide.currentPageObjPgs.interactive[d];if(currobj.itype==window.ide.itypegallery)
{if(window.ide.currentPageObjPgs.pagenumber==window.ide.currentPage)
{if((tmp_gal_id!=d)&&(tmp_gal_id>-1))
{count++;}
if(tmp_gal_id==-1)
{count++;}
tmp_gal_id=currobj.id;}}}
if((count<=0)&&(tmp_gal_id<0))
{if(window.ide.orientIsBookMode)
{var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(currobj){for(var s in currobj.interactive)
{var tmpiobj=currobj.interactive[s];if(currobj.pagenumber==window.ide.currentPage)
{if((tmp_gal_id!=d)&&(tmp_gal_id>-1))
{count++;}
if(tmp_gal_id==-1)
{count++;}
tmp_gal_id=tmpiobj.id;}}}}}
if((count==1)&&(tmp_gal_id>-1))
{_gallery_id=tmp_gal_id;}}
try
{var statTitle='Click to image';var GALLERY_NAME='';var IMAGE_NAME='';var IMAGE_ID='';var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if((parseInt(objParentArrGall.id)==parseInt(_gallery_id))&&(objParentArrGall!=null))
{GALLERY_NAME=objParentArrGall.dev_name;var parentDivElement=ed.get(objParentArrGall.divid);var parentDivElementInner=ed.get(objParentArrGall.holderDivId);var parentDivElementBg=ed.get(objParentArrGall.dividbg);var timeForTransition=objParentArrGall.jsobj.settings.time;if(isNaN(timeForTransition))
{timeForTransition=0;}
timeForTransition=parseInt(timeForTransition);if(timeForTransition>1)
{timeForTransition=timeForTransition*1000;if(timeForTransition<300)
{timeForTransition=300;}}
if(timeForTransition<2)
{timeForTransition=0;}
if(goToNext)
{statTitle='Next';imageindex=parseInt(objParentArrGall.jsobj.settings.currentindex)+1;}
if(goToPrevious)
{statTitle='Previous';imageindex=parseInt(objParentArrGall.jsobj.settings.currentindex)-1;}
var showTitleAndDescription=false;if(objParentArrGall.jsobj.settings.showdesctext==1)
{showTitleAndDescription=true;}
var currentTouchCounter=parseInt(objParentArrGall.jsobj.settings.touchcounter);if(isLoop)
{if(currentTouchCounter!=touchCounterCalled)
{return false;}}
if(objParentArrGall.jsobj.settings.swipeenabled==1)
{nextOrPreviousIsFadeIn=false;}
else
{nextOrPreviousIsFadeIn=true;}
for(var m in objParentArrGall.jsobj.images)
{var currimg=objParentArrGall.jsobj.images[m];if(parentDivElement!=null)
{if(imageindex<1)
{imageindex=(objParentArrGall.jsobj.images.length);}
else if(imageindex>(objParentArrGall.jsobj.images.length))
{imageindex=1;}
if(!animate)
{var divid=objParentArrGall.jsobj.images[m].owndivid;if(ed.get(divid)!=null)
{if(objParentArrGall.jsobj.images[m].id==imageindex)
{$('#'+divid).css('left','0px');parentDivElement.style['visibility']='visible';ed.get(divid).style['display']='block';$('#'+divid).fadeTo(250,1);objParentArrGall.jsobj.settings.currentindex=imageindex;$('.dot-'+objParentArrGall.id.toString()).removeClass('Active');$('.dot-'+objParentArrGall.id.toString()+'-'+imageindex.toString()).addClass('Active');$('.thumb-'+objParentArrGall.id.toString()).removeClass('Active');$('.thumb-'+objParentArrGall.id.toString()+'-'+imageindex.toString()).addClass('Active');window.ed.galshowlinkbtn(objParentArrGall,'gal'+objParentArrGall.id+'linkbtn',0,objParentArrGall.jsobj.images[m],false);if(showTitleAndDescription)
{var holderInsideTitle=divid+'holder';if(ed.get(holderInsideTitle)!=null)
{$('#'+holderInsideTitle).css('top',(objParentArrGall.h+1).toString()+'px');$('#'+holderInsideTitle).css('left','0px');$('#'+holderInsideTitle).css('display','block');$('#'+holderInsideTitle).css('display','block');var toTop=$('#'+holderInsideTitle).height();toTop=objParentArrGall.h-toTop;if(objParentArrGall.jsobj.settings.shownavigationbar=="1")
{toTop=toTop-window.ed.galheightoffsetsingle;}
if(objParentArrGall.jsobj.settings.showthumbs=="1")
{toTop=toTop-($('#'+'gal'+objParentArrGall.id.toString()+'Thumbs').height()+window.ed.galheightoffsetsingle);}
$('#'+holderInsideTitle).css({'top':(toTop+40).toString()+'px'});$('#'+holderInsideTitle).transition({'top':toTop.toString()+'px'},250,window.ed.jqueryTransition,function(){});}}}
else
{ed.get(divid).style['display']='none';}}}
else if(animate)
{var divid=objParentArrGall.jsobj.images[m].owndivid;if(ed.get(divid)!=null)
{if(objParentArrGall.jsobj.images[m].id==imageindex)
{var foundParent=false;var moveNext=false;var movePrevious=false;var currentShownIndex=objParentArrGall.jsobj.settings.currentindex;IMAGE_NAME=objParentArrGall.jsobj.images[m].title;IMAGE_ID=objParentArrGall.jsobj.images[m].image_id;for(var j in objParentArrGall.jsobj.images)
{var thsobj=objParentArrGall.jsobj.images[j];if(thsobj.id==currentShownIndex)
{foundParent=true;var divparent=thsobj.owndivid;if(currentShownIndex>imageindex)
{movePrevious=true;}
else
{moveNext=true;}}}
if((skipMotionThroughIsSwipe)&&(animate))
{if(goToPrevious)
{var moveNext=false;var movePrevious=true;}
else if(goToNext)
{var moveNext=true;var movePrevious=false;}}
if(foundParent)
{if(imageindex!=currentShownIndex)
{$('#'+divid).stop();$('#'+divparent).stop();parentDivElement.style['visibility']='visible';objParentArrGall.jsobj.settings.currentindex=imageindex;$('.dot-'+objParentArrGall.id.toString()).removeClass('Active');$('.dot-'+objParentArrGall.id.toString()+'-'+imageindex.toString()).addClass('Active');$('.thumb-'+objParentArrGall.id.toString()).removeClass('Active');$('.thumb-'+objParentArrGall.id.toString()+'-'+imageindex.toString()).addClass('Active');var wdthPrnt=objParentArrGall.w;if(moveNext)
{if(nextOrPreviousIsFadeIn)
{$('#'+divid).css({'display':'block','position':'absolute','left':'0px','opacity':'0.0001'}).delay(50).transition({'opacity':'1'},300,window.ed.jqueryTransition,function(){});$('#'+divparent).css({'display':'block','position':'absolute','left':'0px'}).delay(50).transition({'opacity':'0.0001'},300,window.ed.jqueryTransition,function(){});}
else
{$('#'+divid).css({'display':'block','position':'absolute','left':wdthPrnt.toString()+'px','opacity':'1'}).delay(50).transition({'left':'0px'},300,window.ed.jqueryTransition,function(){});$('#'+divparent).css({'display':'block','position':'absolute','left':'0px','opacity':'1'}).delay(50).transition({'left':'-'+(wdthPrnt+1).toString()+'px'},300,window.ed.jqueryTransition,function(){});}
window.ed.galshowlinkbtn(objParentArrGall,'gal'+objParentArrGall.id+'linkbtn',150,objParentArrGall.jsobj.images[m],false);if(showTitleAndDescription)
{var holderInsideTitle=divid+'holder';if(ed.get(holderInsideTitle)!=null)
{$('#'+holderInsideTitle).css('top',(objParentArrGall.h+1).toString()+'px');$('#'+holderInsideTitle).css('left','0px');$('#'+holderInsideTitle).css('display','block');$('#'+holderInsideTitle).css('display','block');var toTop=$('#'+holderInsideTitle).height();toTop=objParentArrGall.h-toTop;if(objParentArrGall.jsobj.settings.shownavigationbar=="1")
{toTop=toTop-window.ed.galheightoffsetsingle;}
if(objParentArrGall.jsobj.settings.showthumbs=="1")
{toTop=toTop-($('#'+'gal'+objParentArrGall.id.toString()+'Thumbs').height()+window.ed.galheightoffsetsingle);}
$('#'+holderInsideTitle).css({'top':(toTop+40).toString()+'px'});$('#'+holderInsideTitle).delay(150).transition({'top':toTop.toString()+'px'},250,window.ed.jqueryTransition,function(){});}}}
else
{$('#'+divid).css('left','-'+wdthPrnt.toString()+'px');$('#'+divid).stop();$('#'+divparent).stop();if(nextOrPreviousIsFadeIn)
{$('#'+divid).css({'display':'block','left':'0px','opacity':'0.0001'}).delay(50).transition({'opacity':'1'},250,window.ed.jqueryTransition,function(){});$('#'+divparent).css({'display':'block','left':'0px'}).delay(51).transition({'opacity':'0.0001'},250,window.ed.jqueryTransition,function(){});}
else
{$('#'+divid).css({'display':'block','opacity':'1'}).delay(50).transition({'left':'0px','top':'0px'},250,window.ed.jqueryTransition,function(){});$('#'+divparent).css({'display':'block','opacity':'1'}).delay(51).transition({'left':''+(wdthPrnt+1).toString()+'px'},250,window.ed.jqueryTransition,function(){});}
$('#'+divid).css('display','block');$('#'+divparent).css('display','block');window.ed.galshowlinkbtn(objParentArrGall,'gal'+objParentArrGall.id+'linkbtn',150,objParentArrGall.jsobj.images[m],false);if(showTitleAndDescription)
{var holderInsideTitle=divid+'holder';if(ed.get(holderInsideTitle)!=null)
{$('#'+holderInsideTitle).css('top',(objParentArrGall.h+1).toString()+'px');$('#'+holderInsideTitle).css('left','0px');$('#'+holderInsideTitle).css('display','block');$('#'+holderInsideTitle).css('display','block');var toTop=$('#'+holderInsideTitle).height();toTop=objParentArrGall.h-toTop;if(objParentArrGall.jsobj.settings.shownavigationbar=="1")
{toTop=toTop-window.ed.galheightoffsetsingle;}
if(objParentArrGall.jsobj.settings.showthumbs=="1")
{toTop=toTop-($('#'+'gal'+objParentArrGall.id.toString()+'Thumbs').height()+window.ed.galheightoffsetsingle);}
$('#'+holderInsideTitle).css({'top':(toTop+40).toString()+'px'});$('#'+holderInsideTitle).delay(150).transition({'top':toTop.toString()+'px'},250,window.ed.jqueryTransition,function(){});}}}}}}}}}}
try
{if((!isLoop)&&(animate))
{window.ed.sendInteractiveStats('Gallery',statTitle,window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,GALLERY_NAME,'',0,IMAGE_NAME,0,_gallery_id,IMAGE_ID);}}catch(e){}
if(timeForTransition>0)
{ed._gallery_touch_counter++;currentTouchCounter=ed._gallery_touch_counter;objParentArrGall.jsobj.settings.touchcounter=currentTouchCounter;window.setTimeout('window.ed.runGallery('+window.ide.currentPage.toString()+',true,'+_gallery_id.toString()+',window.ed._galnextGalleryImage,'+currentTouchCounter.toString()+',true);',timeForTransition);}}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6202; column: 126;  :: '+v);console.log('ERROR While running  GALLERY -> '+e.message)}};window.ed.goToGalleryLink=function(param,target,statDataObj){try
{var arrs=param.split(',');if(parseInt(param)>0)
{var _page_id=param;var _gallery_id=target;var objParentArrGall=window.f.findArrGalleryObjectByGalleryId(_gallery_id);if(objParentArrGall!=null)
{for(var d in objParentArrGall.jsobj.images)
{if(objParentArrGall.jsobj.images[d].image_id.toString()==param.toString())
{var goto_image_id=objParentArrGall.jsobj.images[d].id;ed.runGallery(window.ide.currentPage,true,_gallery_id,goto_image_id);}}}}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6208; column: 126;  :: '+v);ed.trace('Error while handling go to gallery links ->'+e.message);}};
;
window.ed.setCurrentTouchCoords=function(event){ed.main=new Date();if(!ed._isDesktopBrowser)
{if(typeof(event.touches)=='undefined')
{ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;ed._current_screen_x=event.pageX;ed._current_screen_y=event.pageY;}
else
{if(event.touches.length<=1)
{ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;ed._current_screen_x=event.touches[0].screenX;ed._current_screen_y=event.touches[0].screenY;}}}
else
{ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;ed._current_screen_x=event.pageX;ed._current_screen_y=event.pageY;}};window.ed.resetDesktopMode=function(eventtype){if(eventtype==='mousedown'){ed._isDesktopBrowser=true;}
else if(eventtype==='touchstart'){ed._isDesktopBrowser=false;}
else if(eventtype==='pointerdown'){ed._isDesktopBrowser=false;}
else if(eventtype==='MSPointerDown'){ed._isDesktopBrowser=false;}}
window.ed.endOutHandler=function(event){if(ide.pageflip&&(window.edgl.argo.indexOf('*ctrlkey*')>-1)){return;}
ed.endHandler(event);},window.ed.mouseOutHandler=function(event){if(ide.pageflip&&(window.edgl.argo.indexOf('*ctrlkey*')>-1)){return;}
ed.endHandler(event);};window.ed.shouldReturnTrueAndAllowDefault=function(event){try
{var isIe=false;var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(/Edge\/12./i.test(navigator.userAgent)){isIe=true;}
if(msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./))
{isIe=true;}
if(isIe)
{if(($(event.target).hasClass('allowMouseDownAndMouseUpVideo'))&&(event.buttons>0)&&(!isNaN(event.buttons)&&(!isNaN(event.which))))
{return true;}
else
{return false;}}}catch(e){return false;}}
window.ed.resetVariablesUsedToTrack=function(){ed._current_screen_x=0;ed.startHandlerLastClickedX=0;ed._current_screen_Y=0;ed.startHandlerLastClickedY=0;ed.main=new Date();};window.ed.onTouchEndSetVars=function(){ed._currentlyScrollingSubpages=false;};window.ed.startHndlLowres=function(event){window.ed.resetDesktopMode(event.type);ed._pressedElementX=-1;ed._pressedElementY=-1;var thisElem=this;var setIt=false;try
{if(thisElem.id.indexOf('Inner')>0)
{thisElem=thisElem.parentNode;}
var rect=thisElem.getBoundingClientRect();}catch(e){return false;}
window.ed._currentPageObjPgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var clickedX=0;var clickedY=0;var thsclickedX=0;var thsclickedY=0;if(!ed._isDesktopBrowser)
{if(event.touches.length<=1)
{thsclickedX=event.touches[0].pageX;thsclickedY=event.touches[0].pageY;setIt=true;}}
else
{thsclickedX=event.pageX;thsclickedY=event.pageY;setIt=true;}
var offsetX=window.ide.pageOffsetX;var offsetY=window.ide.pageOffsetY;var searchName=thisElem.id.toLowerCase().replace('pagehtmldiv','lowres');var currentZoom=1;thsclickedX=Math.round(((thsclickedX / currentZoom)-offsetX)/ window.ide.defaultInitialScale);thsclickedY=Math.round(((thsclickedY / currentZoom)-offsetY)/ window.ide.defaultInitialScale);var rectLeft=Math.round(((rect.left / currentZoom)-offsetX)/ window.ide.defaultInitialScale);var rectTop=Math.round(((rect.top / currentZoom)-offsetY)/ window.ide.defaultInitialScale);rectLeft=-rectLeft;rectTop=-rectTop;clickedX=thsclickedX+rectLeft;clickedY=thsclickedY+rectTop;ed._pressedElement=thisElem;if(setIt)
{ed._pressedElementX=clickedX;ed._pressedElementY=clickedY;}};window.ed.moveHndlLowres=function(event){};window.ed.videoStartHndler=function(event){ed.clickOverVideo=true;try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.videoMoveHndler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.videoEndHndler=function(event){window.setTimeout('window.ed.clickOverVideo=false;',50);try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.aboutboxStartHandler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.aboutboxMoveHandler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.aboutboxEndHandler=function(event){window.ed.hideAboutBox();try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.donothingStartHandler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.donothingMoveHandler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.donothingEndHandler=function(event){try
{event.preventDefault();event.returnValue=false;return false;}catch(e){}};window.ed.mouseWheel=function(event){if((!window.ed.isiscrollroll)||(!window.initer.isIe9))
{if(window.ed.playershown)
{var currpage=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if((currpage.isparalaxsubpage)||(currpage.ismainparalaxpage))
{var whlDt=event.originalEvent.wheelDelta;if(whlDt==null)
{whlDt=-10*event.originalEvent.detail;}
if(whlDt==0)
{whlDt=event.originalEvent.deltaY*-1;}
if(whlDt<0)
{whlDt=-1*window.ide.paralaxVelocity;}
else if(whlDt>0)
{whlDt=1*window.ide.paralaxVelocity;}
var distanceY=whlDt;if(window.ide.contain_paralax_pages){window.ide.increaseParalaxScroll(whlDt);}
var poverlap=window.ide.currentPageObjPgs.poverlap;var percentdistanceY=((distanceY / 100)*poverlap);paralaY=distanceY-percentdistanceY;if(window.ide.contain_paralax_pages){window.ide.positionParalaxPagesStart();}
window.ide.handleMovingPages(0,distanceY,true,0,paralaY);event.preventDefault();event.returnValue=false;return false;}}}}
;
window.ed.startingHandler=function(event){var target=$(event.target);while(target.length)
{if(target.hasClass('ed_overtake_touches')){console.log('overtake_touches');return true}
target=target.parent();}
window.ed.allowoneparalaxscroll=0;window.ed.resetDesktopMode(event.type);window.ide.paralaxDifferenceFromLastFireY=0;ed.startX_second=0;ed.startY_second=0;window.ide.positionPagesStartingHandler();try
{if(window.ed.shouldReturnTrueAndAllowDefault(event))
{console.log('shouldReturnTrueAndAllowDefault');return true;}}catch(e){}
window.ed.clickwasusedtogotopage=false;window.ed.washandlingMovingPages=false;if(window.ed.preventGlobalHandling)
{console.log('preventGlobalHandling');return false;}
window.scrollTo(0,window.ed.scrollToY);ed._was_end_handler=false;if(ed.clickOverVideo)
{console.log('clickOverVideo');return false;}
if(ed._is_gallery_mouse_down)
{console.log('_is_gallery_mouse_down');return false;}
if(ed._is_textbox_mouse_down)
{console.log('_is_textbox_mouse_down');return false;}
if(ed.isIeTouch)
{if(event.isPrimary)
{ed.arrPointerArray[0]=event;}
else
{ed.arrPointerArray[1]=event;}}
ed._disableXScroll=false;ed._disableYScroll=false;ed.setCurrentTouchCoords(event);if(ed._isDesktopBrowser)
{ed._isMouseDown=true;}
if(!ed._isDesktopBrowser)
{ed._isMouseDown=true;}
if(ed._facebookIsShown)
{ed._click_was_used_to_hide=true;ed.hideFacebook();}
if(ed._video_shown)
{ed._video_shown=false;if(window.ide.contain_video){ed.pauseAllActualVideos();}}
if((ed._popup_shown)&&(!ed._popupFiredFromStaticLinks))
{console.log('_popup_shown');ed._click_was_used_to_hide=true;ed.hideLinksPopup();event.preventDefault();return false;}
if(ed._openedAboutBox)
{ed._click_was_used_to_hide=true;ed.hideAboutBox();}
if(event.touches!=null)
{if(event.touches.length<=2)
{ed.lastClickX=Math.round((Math.round(parseInt(event.touches[0].screenX)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX)/ed._originalRatio);ed.lastClickY=Math.round((Math.round(parseInt(event.touches[0].screenY)/ window.ide.defaultInitialScale)-(ed._paddingTop/2))/ed._originalRatio);ed.linkLastClickX=parseInt(event.touches[0].screenX);ed.linkLastClickY=parseInt(event.touches[0].screenY);}}
else
{ed.lastClickX=Math.round((Math.round(parseInt(event.pageX)/ window.ide.defaultInitialScale)-ed.zoomPageOffsetX)/ed._originalRatio);ed.lastClickY=Math.round((Math.round(parseInt(event.pageY)/ window.ide.defaultInitialScale)-(ed._paddingTop/2))/ed._originalRatio);ed.linkLastClickX=parseInt(event.pageX);ed.linkLastClickY=parseInt(event.pageY);}
if(window.ide.contain_paralax_pages){ide.positionParalaxPagesStart(event);}
if(!ed.commandsEnabled)
{window.ed.trace('disabled commands');event.preventDefault();return false;}
ed._actionversion=ed._actionversion+1;ed.distanceX=0;ed.timerCounter=0;ed._isDoubleClick=false;var evnt=event;var ratio=ed.preferredHeight / ed._originalPageHeight;try
{if(ed._isDesktopBrowser)
{ed.startX=event.pageX;ed.startY=event.pageY;}
else
{if(typeof(event.touches)!='undefined')
{ed.startX=event.touches[0].screenX;ed.startY=event.touches[0].screenY;}
else
{if(event.isPrimary)
{ed.startX=event.pageX;ed.startY=event.pageY;}
else
{ed.startX_second=event.pageX;ed.startY_second=event.pageY;}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6315; column: 197;  :: '+v);}
ed.IscrollRollPressedX=ed.startX;ed.IscrollRollPressedY=ed.startY;window.ed._previousDifference=0;if(event.touches!=null)
{if(event.touches.length>=2)
{ed.startX_second=event.touches[1].screenX;ed.startY_second=event.touches[1].screenY;var beetweenFingersX=Math.abs(event.touches[0].screenX-event.touches[1].screenX);var beetweenFingersY=Math.abs(event.touches[0].screenY-event.touches[1].screenY);var thisD=window.ide.currentPage-1;ed.startScaleOfPage=window.f.getCurrentPageScale(window.ide.currentPage);c2=Math.pow(beetweenFingersX,2)+Math.pow(beetweenFingersY,2);var lenDaljica=Math.sqrt(c2);ed.startDistance=lenDaljica;ed.differenceX=Math.abs(event.touches[0].screenX-event.touches[1].screenX);ed.differenceY=Math.abs(event.touches[0].screenY-event.touches[1].screenY);var x1=event.touches[0].screenX;var y1=event.touches[0].screenY;var x2=event.touches[1].screenX;var y2=event.touches[1].screenY;var ThisFromX=0;var ThisFromY=0;var razdalja=Math.abs(x1-x2);if(x1<x2)
{ThisFromX=Math.round(x1+razdalja/2);}
else
{ThisFromX=Math.round(x2+razdalja/2);}
var razdalja=Math.abs(y1-y2);if(y1<y2)
{ThisFromY=Math.round(y1+razdalja/2);}
else
{ThisFromY=Math.round(y2+razdalja/2);}
try
{ed.page_currently_zoomed_in=false;if((window.f.getCurrentPageScale(window.ide.currentPage)>window.ide.defaultPublicationScale))
{ed.page_currently_zoomed_in=true;}}catch(e){}
if(ed.page_currently_zoomed_in)
{try
{var objName='lowres'+(window.ide.currentPage-1).toString();elem=ed.get(objName);elemRect=elem.getBoundingClientRect();var offsetX=ed.zoomPageOffsetX;var offsetY=Math.round(ed._paddingTop / 2);var searchName=objName;var currentZoom=1;ed.zoomFromX=ThisFromX;ed.zoomFromY=ThisFromY;if(ed.zoomFromX>ed._originalPageWidth)
{ed.zoomFromX=Math.round(ed._originalPageWidth);}
if(ed.zoomFromY>ed._originalPageHeight)
{ed.zoomFromY=Math.round(ed._originalPageHeight);}}catch(e)
{ed.zoomFromX=ThisFromX;ed.zoomFromY=ThisFromY;}}
else
{ed.zoomFromX=ThisFromX;ed.zoomFromY=ThisFromY;}}}
ed.checkScaleAndEnableTracking(event);var touchesCount=0;if(event.touches!=null)
{touchesCount=event.touches.length;}
else
{touchesCount=1}
if(touchesCount>=2)
{event.returnValue=true;result=true;}
else
{if((ed._enabledTracking)&&(!ed._wasPreviousEnabledTwoFingers))
{if((!ed._isSingleClick)&&(touchesCount<2))
{}
else
{var time=new Date();var timeDifference=time-ed._singleClickWasClickedAtTime;if(event.touches!=null)
{var thisDistanceX=Math.abs(parseInt(event.touches[0].screenX)-ed.endHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(event.touches[0].screenY)-ed.endHandlerLastClickedY);}
else
{var thisDistanceX=Math.abs(parseInt(event.pageX)-ed.endHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(event.pageY)-ed.endHandlerLastClickedY);}
try
{ed.page_currently_zoomed_in=false;if((window.f.getCurrentPageScale(window.ide.currentPage)>window.ide.defaultPublicationScale))
{ed.page_currently_zoomed_in=true;}}catch(e){}
if((!ed._popup_shown)&&(!ed._video_shown)&&(ed.commandsEnabled))
{if(event.touches!=null)
{ed.endHandlerLastClickedX=parseInt(event.touches[0].screenX);ed.endHandlerLastClickedY=parseInt(event.touches[0].screenY);}
else
{ed.endHandlerLastClickedX=parseInt(event.pageX);ed.endHandlerLastClickedY=parseInt(event.pageY);}}
var limit=30;limit=Math.round(limit*window.ide.defaultInitialScale);if((timeDifference<350)&&(thisDistanceX<limit)&&(thisDistanceY<limit))
{ed._isDoubleClick=true;var objName='lowres'+(window.ide.currentPage-1).toString();var halfWidth=-(ed.get(objName).offsetWidth/2);var halfHeihgt=-(ed.get(objName).offsetHeight/2);if((window.f.getCurrentPageScale(window.ide.currentPage)>window.ide.defaultPublicationScale)||(!ed._enableZoom))
{var thisD=window.ide.currentPage-1;var objName='lowres'+(thisD).toString();var thisObj=ed.get(objName);var objLinkName='pageHTMLDiv'+(thisD).toString();var halfWidth=Math.round(thisObj.offsetWidth/2);var halfHeihgt=Math.round(thisObj.offsetHeight/2);if(event.touches!=null)
{var ThisFromX=event.touches[0].screenX;var ThisFromY=event.touches[0].screenY;}
else
{var ThisFromX=event.pageX;var ThisFromY=event.pageY;}}
else
{if(ed._enableZoom)
{var thisD=window.ide.currentPage-1;var objName='lowres'+(thisD).toString();var objLinkName='pageHTMLDiv'+(thisD).toString();var thisObj=ed.get(objName);var halfWidth=Math.round(thisObj.offsetWidth/2);var halfHeihgt=Math.round(thisObj.offsetHeight/2);if(event.touches!=null)
{var ThisFromX=event.touches[0].screenX;var ThisFromY=event.touches[0].screenY;}
else
{var ThisFromX=event.pageX;var ThisFromY=event.pageY;}}}
event.returnValue=false;result=false;}
else
{event.preventDefault();}}}
else
{event.returnValue=false;result=false;}}
ed._isSingleClick=false;if((ed._isMouseDown))
{if(!ed._isDesktopBrowser)
{if(ed.isIeTouch)
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}
else
{if(event.touches.length<2)
{ed.distanceX=event.touches[0].screenX-ed.startX;ed.distanceY=event.touches[0].screenY-ed.startY;ed.measureXOffset=event.touches[0].screenX-ed.startX;ed.measureYOffset=event.touches[0].screenY-ed.startY;ed.distanceX=event.touches[0].screenX-ed.startX;ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;}}}
else
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;if(ide.pageflip&&!ed.page_currently_zoomed_in&&!window.pgfl.do_auto_listanje){listanjex=event.clientX;listanjey=event.clientY;window.pgfl.klik_zgoraj_na_strani_levo_oz_desno(listanjex,listanjey);}}}
event.preventDefault();event.returnValue=false;result=false;};
;
window.ed.moveHandler=function(event){var paralaX=-9999;var paralaY=-9999;if(ide.pageflip&&(window.edgl.argo.indexOf('*ctrlkey*')>-1)&&!event.ctrlKey){console.log('return *ctrlkey* FLIP moveHandler ')
return;}
var target=$(event.target);while(target.length)
{if(target.hasClass('ed_overtake_touches')){return true}
target=target.parent();}
if(ed.isIeTouch)
{if(event.isPrimary)
{ed.arrPointerArray[0]=event;}
else
{ed.arrPointerArray[1]=event;}}
if(window.ed.preventGlobalHandling)
{window.ed.trace('PREVENT GLOBAL MOVING -> CONDITION 2 [preventGlobalHandling : '+window.ed.preventGlobalHandling+']');return false;}
try
{event.preventDefault();event.returnValue=false;}catch(e){}
if(window.ed.isiscrollroll)
{var tmpThisX=0;var tmpThisY=0;if(!ed._isDesktopBrowser)
{if(ed.isIeTouch)
{if(event.isPrimary)
{tmpThisX=event.pageX;tmpThisY=event.pageY;}
else
{if(ed.arrPointerArray.length>0)
{if(ed.arrPointerArray[0]!=null)
{tmpThisX=ed.arrPointerArray[0].pageX;tmpThisY=ed.arrPointerArray[0].pageY;}}}}
else
{if(event.touches!=null)
{tmpThisX=event.touches[0].screenX;tmpThisY=event.touches[0].screenY;}
else
{tmpThisX=event.pageX;tmpThisY=event.pageY;}}}
else
{tmpThisX=event.pageX;tmpThisY=event.pageY;}
ed.IscrollRollPressedX=tmpThisX;ed.IscrollRollPressedY=tmpThisY;window.ed.trace('PREVENT GLOBAL MOVING -> CONDITION 1');return false;}
if((ed._isMouseDown))
{if(!ed._isDesktopBrowser)
{if(ed.isIeTouch)
{if(event.isPrimary)
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}
else
{if(ed.arrPointerArray.length>0)
{if(ed.arrPointerArray[0]!=null)
{ed.distanceX=ed.arrPointerArray[0].pageX-ed.startX;ed.distanceY=ed.arrPointerArray[0].pageY-ed.startY;ed.measureXOffset=ed.arrPointerArray[0].pageX-ed.startX;ed.measureYOffset=ed.arrPointerArray[0].pageY-ed.startY;ed.distanceX=ed.arrPointerArray[0].pageX-ed.startX;ed.startHandlerLastClickedX=ed.arrPointerArray[0].pageX;ed.startHandlerLastClickedY=ed.arrPointerArray[0].pageY;}}}}
else
{if(typeof(event.touches)!='undefined')
{ed.distanceX=event.touches[0].screenX-ed.startX;ed.distanceY=event.touches[0].screenY-ed.startY;ed.measureXOffset=event.touches[0].screenX-ed.startX;ed.measureYOffset=event.touches[0].screenY-ed.startY;ed.distanceX=event.touches[0].screenX-ed.startX;ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;}
else
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}}}
else
{if(typeof(event.touches)!='undefined')
{ed.distanceX=event.touches[0].screenX-ed.startX;ed.distanceY=event.touches[0].screenY-ed.startY;ed.measureXOffset=event.touches[0].screenX-ed.startX;ed.measureYOffset=event.touches[0].screenY-ed.startY;ed.distanceX=event.touches[0].screenX-ed.startX;ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;}
else
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}}}
if(ed._is_gallery_mouse_down)
{window.ed.trace('PREVENT GLOBAL MOVING -> CONDITION 3');return false;}
if(ed._is_textbox_mouse_down)
{window.ed.trace('PREVENT GLOBAL MOVING -> TEXTBOX MOUSE DOWN');return false;}
if((!ed._isDesktopBrowser)&&(!ed.isIeTouch))
{ed._isMouseDown=true;}
if(!ed.commandsEnabled)
{}
if(event.touches!=null)
{if((event.touches.length>1)&&(!ed._move_hanlder_started_to_scroll_left_or_right))
{ed._wasPreviousEnabledTwoFingers=true;}}
if(window.ed.isIeTouch)
{if((!event.isPrimary)||(ed.arrPointerArray.length>1))
{ed._wasPreviousEnabledTwoFingers=true;}}
if((!window.pgfl.do_auto_listanje)&&(ed._enabledTracking)&&(!ed._isMouseDown)&&(!ed._isDoubleClick)&&(window.f.getCurrentPageScale(window.ide.currentPage)<=window.ide.defaultPublicationScale.toFixed(3))){if(ide.pageflip){ide.addStructureAndShowIt(window.ide.currentPage,-1);var listanjex=event.clientX;var listanjey=event.clientY;window.pgfl.moving_zgoraj_na_strani_levo_oz_desno(listanjex,listanjey);}}
if((((ed._enabledTracking)&&(ed._isMouseDown)&&(!ed._isDoubleClick)&&(window.f.getCurrentPageScale(window.ide.currentPage)<=window.ide.defaultPublicationScale.toFixed(3))&&(!ed._wasPreviousEnabledTwoFingers)))||(ed._currentlyScrollingSubpages)||ed._move_hanlder_started_to_scroll_left_or_right)
{ed._wasDistanceX=ed.distanceX;if(!ed._isDesktopBrowser)
{if(ed.isIeTouch)
{if(event.isPrimary)
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}
else
{if(ed.arrPointerArray.length>0)
{if(ed.arrPointerArray[0]!=null)
{ed.distanceX=ed.arrPointerArray[0].pageX-ed.startX;ed.distanceY=ed.arrPointerArray[0].pageY-ed.startY;ed.measureXOffset=ed.arrPointerArray[0].pageX-ed.startX;ed.measureYOffset=ed.arrPointerArray[0].pageY-ed.startY;ed.distanceX=ed.arrPointerArray[0].pageX-ed.startX;ed.startHandlerLastClickedX=ed.arrPointerArray[0].pageX;ed.startHandlerLastClickedY=ed.arrPointerArray[0].pageY;}}}}
else
{if(event.touches!=null)
{ed.distanceX=event.touches[0].screenX-ed.startX;ed.distanceY=event.touches[0].screenY-ed.startY;ed.measureXOffset=event.touches[0].screenX-ed.startX;ed.measureYOffset=event.touches[0].screenY-ed.startY;ed.distanceX=event.touches[0].screenX-ed.startX;ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;}
else
{return false;}}}
else
{if(typeof(event.touches)!='undefined')
{ed.distanceX=event.touches[0].screenX-ed.startX;ed.distanceY=event.touches[0].screenY-ed.startY;ed.measureXOffset=event.touches[0].screenX-ed.startX;ed.measureYOffset=event.touches[0].screenY-ed.startY;ed.distanceX=event.touches[0].screenX-ed.startX;ed.startHandlerLastClickedX=event.touches[0].screenX;ed.startHandlerLastClickedY=event.touches[0].screenY;}
else
{ed.distanceX=event.pageX-ed.startX;ed.distanceY=event.pageY-ed.startY;ed.measureXOffset=event.pageX-ed.startX;ed.measureYOffset=event.pageY-ed.startY;ed.distanceX=event.pageX-ed.startX;ed.startHandlerLastClickedX=event.pageX;ed.startHandlerLastClickedY=event.pageY;}}
var sumcoord=ed.currentDistance+ed.distanceX;var doanimate=false;var isparalaxverticalscroll=false;var scrolledy=0;var allow_touch_scrolling=false;if(((!window.ide.currentPageObjPgs.hasSubpages)&&(!(window.ide.currentPageObjPgs.isswipesubpage))&&(!(window.ide.currentPageObjPgs.isparalaxsubpage))&&(!(window.ide.currentPageObjPgs.multi_group_subpages))))
{if(!ide.pageflip){ed.distanceY=0;}
ed._disableYScroll=true;ed._disableXScroll=false;doanimate=true;}
else
{var ratio=ed.distanceY / ed.distanceX;ratio=Math.abs(ratio);if((((ratio>1.4)&&(!ed._fadein_subpage_visible)&&(!ed._disableYScroll))||((ed._disableXScroll)&&(!ed._fadein_subpage_visible))))
{ed._disableXScroll=true;doanimate=true;if((window.ide.currentPageObjPgs.isparalaxsubpage)||(window.ide.currentPageObjPgs.ismainparalaxpage))
{if(window.ide.currentPageObjPgs.poverlap>-1)
{{var diffY=Math.abs(window.ide.paralaxDifferenceFromLastFireY)-Math.abs(ed.distanceY);if(Math.abs(diffY)>10)
{window.ide.paralaxDifferenceFromLastFireY=ed.distanceY;allow_touch_scrolling=true;var whlDt=0;window.ed.allowoneparalaxscroll+=1;if(ed.distanceY<0)
{whlDt=-1*window.ide.paralaxVelocityTouch;}
else if(ed.distanceY>0)
{whlDt=1*window.ide.paralaxVelocityTouch;}
var distanceY=whlDt;if(window.ide.contain_paralax_pages){window.ide.increaseParalaxScroll(whlDt);}
if(window.ide.contain_paralax_pages){window.ide.positionParalaxPagesStart();}
var poverlap=window.ide.currentPageObjPgs.poverlap;var percentdistanceY=parseFloat((scrolledy / 100)*poverlap);paralaY=scrolledy-percentdistanceY;paralaX=0;isparalaxverticalscroll=true;}}}}
else
{allow_touch_scrolling=true;}}
else if(((ratio<0.6)&&(!ed._disableXScroll))||(ed._disableYScroll))
{ed._disableYScroll=true;doanimate=true;}}
if(ed._disableXScroll)
{sumcoord=0;}
if(ed._disableYScroll&&!ide.pageflip)
{ed.distanceY=0;}
if(ed.distanceY>0)
{}
var foryscroll=ed.distanceY;if(scrolledy!=0)
{foryscroll=scrolledy;}
ed._move_hanlder_started_to_scroll_left_or_right=true;if(doanimate)
{if(!ed._disableYScroll)
{if(allow_touch_scrolling)
{ed._currentlyScrollingSubpages=true;window.ide.handleMovingPages(sumcoord,foryscroll,true,paralaX,paralaY+0,false,false);}}
else
{ed._currentlyScrollingSubpages=false;window.ide.handleMovingPages(sumcoord,ed.distanceY,false,paralaX,paralaY,false,event.clientX,event.clientY);}}
event.preventDefault();event.returnValue=false;return(false);}
else if((parseInt(window.f.getCurrentPageScale(window.ide.currentPage))>window.ide.defaultPublicationScale)&&(ed._isMouseDown))
{if(ed.isIeTouch)
{if(ed.arrPointerArray.length>=2)
{var currevent_primary=ed.arrPointerArray[0];var currevent_second=ed.arrPointerArray[1];var daljica_velikost_od_startaX_zacetna=Math.abs(ed.startX)-Math.abs(ed.startX_second);var daljica_velikost_od_startaX_trenutna=Math.abs(currevent_primary.pageX)-Math.abs(currevent_second.pageX);if(Math.abs(daljica_velikost_od_startaX_zacetna)>Math.abs(daljica_velikost_od_startaX_trenutna))
{var actual_difference=Math.abs(daljica_velikost_od_startaX_trenutna)-Math.abs(daljica_velikost_od_startaX_zacetna);}
else
{var actual_difference=Math.abs(daljica_velikost_od_startaX_trenutna)-Math.abs(daljica_velikost_od_startaX_zacetna);}
if(window.ide.currentPageObjPgs.iscroll!=null)
{if(actual_difference>0)
{window.ide.currentPageObjPgs.iscroll[0].zoom(window.ide.currentPageObjPgs.iscroll[0].scale+0.05,currevent_primary.pageX,currevent_primary.pageY,0);}
else
{window.ide.currentPageObjPgs.iscroll[0].zoom(window.ide.currentPageObjPgs.iscroll[0].scale-0.05,currevent_primary.pageX,currevent_primary.pageY,0);}}}}
return true;event.preventDefault();event.returnValue=false;return(false);}
else
{if(!ed._move_hanlder_started_to_scroll_left_or_right)
{if(ed.isIeTouch)
{if(ed.arrPointerArray.length>=2)
{var currevent_primary=ed.arrPointerArray[0];var currevent_second=ed.arrPointerArray[1];var daljica_velikost_od_startaX_zacetna=Math.abs(ed.startX)-Math.abs(ed.startX_second);var daljica_velikost_od_startaX_trenutna=Math.abs(currevent_primary.pageX)-Math.abs(currevent_second.pageX);if(Math.abs(daljica_velikost_od_startaX_zacetna)>Math.abs(daljica_velikost_od_startaX_trenutna))
{var actual_difference=Math.abs(daljica_velikost_od_startaX_trenutna)-Math.abs(daljica_velikost_od_startaX_zacetna);}
else
{var actual_difference=Math.abs(daljica_velikost_od_startaX_trenutna)-Math.abs(daljica_velikost_od_startaX_zacetna);}
if(!window.initer.isIe9)
{if(window.ide.currentPageObjPgs.iscroll!=null)
{if(actual_difference>0)
{window.ide.currentPageObjPgs.iscroll[0].zoom(window.ide.currentPageObjPgs.iscroll[0].scale+0.05,currevent_primary.pageX,currevent_primary.pageY,0);}
else
{window.ide.currentPageObjPgs.iscroll[0].zoom(window.ide.currentPageObjPgs.iscroll[0].scale-0.05,currevent_primary.pageX,currevent_primary.pageY,0);}}}}}
else
{return true;}}
else
{event.preventDefault();event.returnValue=false;return(false);}}
event.preventDefault();event.returnValue=false;return(false);};
;
window.ed.endHandler=function(event){var pageflip_reset=pgfl.pageflip_reset;pgfl.pageflip_reset=false;pageflip_reset=false;var target=$(event.target);while(target.length&&target.hasClass('ed_overtake_touches')){return true}
var was_last_image_clicked=window.ed._last_image_clicked;window.ed._last_image_clicked='';var move_hanlder_started_to_scroll_left_or_right=false;var this_is_while_moveing_and_isScroll=ed._currentlyMovingIfScale;if(ed._is_gallery_mouse_down)
{return false;}
if(ed._is_textbox_mouse_down)
{return false;}
if(ed.isIeTouch)
{if(ed.arrPointerArray.length>0)
{var obj=ed.arrPointerArray.pop();}
if(ed.arrPointerArray.length<1)
{ed._isMouseDown=false;ed._disableYScroll=false;ed._disableXScroll=false;}}
else
{ed._isMouseDown=false;ed._disableYScroll=false;ed._disableXScroll=false;}
if(!ed.commandsEnabled)
{event.preventDefault();return false;}
var currentXOffset=ed.measureXOffset;var currentYOffset=ed.measureYOffset;if(ed._isDesktopBrowser)
{if(!ed._was_end_handler)
{ed._was_end_handler=true;}
else
{return false;}}
if(event.touches!=null)
{if(event.touches.length<=0)
{move_hanlder_started_to_scroll_left_or_right=ed._move_hanlder_started_to_scroll_left_or_right;ed._move_hanlder_started_to_scroll_left_or_right=false;ed.thisTimeTwoFingersWereUsed=false;ed._wasPreviousEnabledTwoFingers=false;}}
else
{ed.thisTimeTwoFingersWereUsed=false;ed._wasPreviousEnabledTwoFingers=false;move_hanlder_started_to_scroll_left_or_right=ed._move_hanlder_started_to_scroll_left_or_right;ed._move_hanlder_started_to_scroll_left_or_right=false;}
ed._actionversion=ed._actionversion+1;window.setTimeout("window.ed.checkIfAnyAction('"+ed._actionversion.toString()+"');",ed._eDitionSwipeTimeoutForCheckLoading);if(event.touches!=null)
{ed.pressed=event.touches.length;}
else
{ed.pressed=1;}
ed.checkScaleAndEnableTracking(event);window.clearInterval(ed.main);ed.timer=new Date()-ed.main;var timeDifferenceBetweenStartAndEndClick=new Date()-ed.main;ed.timerCounter=new Date()-ed.main;ed._isSingleClick=false;if(event.touches!=null)
{var thisDistanceX=Math.abs(parseInt(ed._current_screen_x)-ed.startHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(ed._current_screen_y)-ed.startHandlerLastClickedY);}
else
{var thisDistanceX=Math.abs(parseInt(ed._current_screen_x)-ed.startHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(ed._current_screen_y)-ed.startHandlerLastClickedY);}
var thisDistanceX_measured_offset=(parseInt(ed._current_screen_x)-ed.startHandlerLastClickedX);var thisDistanceY_measured_offset=(parseInt(ed._current_screen_y)-ed.startHandlerLastClickedY);thisDistanceX_measured_offset=-thisDistanceX_measured_offset;thisDistanceY_measured_offset=-thisDistanceY_measured_offset;window.ed._currentPageObjPgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var last_previous_time_difference=new Date()-ed.last_click_time;if((ed.timerCounter<230)&&((last_previous_time_difference<300||ed.this_is_new_double_click==0))&&(Math.abs(thisDistanceX)<10)&&(Math.abs(thisDistanceY)<10))
{ed.this_is_new_double_click++;ed.last_click_time=new Date();}
else
{ed.this_is_new_double_click=0;}
if(ed.this_is_new_double_click>1)
{ed.this_is_new_double_click=0;if(!window.ed.isiscrollroll&&!window.pgfl.do_auto_listanje)
{if(!window.initer.isIe9)
{if(window.f.getCurrentPageScale(window.ide.currentPage)>(Math.round(window.ide.defaultPublicationScale*1000)/1000))
{if(window.ed._enableZoom)
{ed.zoomOut(window.ide.defaultPublicationScale,true,0,0,false,false,-1);}}
else
{if(window.ed._enableZoom)
{if(window.ide.currentPageObjPgs.iscroll!=null)
{var from_x_zoom=event.pageX;var from_y_zoom=event.pageY;if((from_x_zoom<=0)&&(from_y_zoom<=0))
{from_x_zoom=ed.startHandlerLastClickedX;from_y_zoom=ed.startHandlerLastClickedY;}
if(window.ide.currentPageObjPgs.zoom)
{window.ide.currentPageObjPgs.iscroll[0].zoom(window.ide.bestViewZoomFactor,from_x_zoom,from_y_zoom,500);}}}}}
return true;}}
if((!ed._isDoubleClick)&&(ed._enabledTracking)){if(event&&event.ctrlKey&&ide.pageflip&&(window.edgl.argo.indexOf('*ctrlkey*')>-1)){console.log("ctrlkey: ",event.ctrlKey);return;}
if(ide.pageflip&&(!window.pgfl.do_auto_listanje)&&(pgfl.pageflip_direction!==0)){console.log('ZALISTAJ END HANFDLER ');window.pgfl.endHandler_event=event;window.pgfl.pg_currobj=false;window.pgfl.zalistaj(event.clientX,event.clientY);return;}
if(ide.pageflip&&(window.pgfl.do_auto_listanje)){ed._enabledTracking=true;return;}}
var offsetRange=6;var timerforclick=300;if(!ed._isDesktopBrowser)
{offsetRange=40;timerforclick=500;}
if(((parseInt(ed.timerCounter)<timerforclick)&&(ed._enabledTracking)&&(Math.abs(ed.distanceX)<=offsetRange))&&(!ed._isDoubleClick))
{if(ed._currentlyScrollingSubpages)
{if(ed.distanceY<0)
{if((window.ed._currentPageObjPgs.ismainparalaxpage)||(window.ed._currentPageObjPgs.isparalaxsubpage))
{}
else
{if((ed.distanceY<(-(ed._current_ScreenHeight/3)))&&(!window.ed._currentPageObjPgs.islastsubpage))
{if(!ide.pageflip){window.f.nextPage(true);}else{}}
else
{ed.comeBack();}}}
else
{if((ed.distanceY>(ed._current_ScreenHeight/3))&&(!window.ed._currentPageObjPgs.ismainpage))
{if(!ide.pageflip){window.f.previousPage(true);}else{}}
else
{ed.comeBack();}}
ed.onTouchEndSetVars();}
ed.onTouchEndSetVars();if((Math.abs(currentXOffset)<70)&&(Math.abs(currentYOffset)<70)&&(Math.abs(timeDifferenceBetweenStartAndEndClick)<500))
{if(event.touches!=null)
{var thisDistanceX=Math.abs(parseInt(ed._current_screen_x)-ed.startHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(ed._current_screen_y)-ed.startHandlerLastClickedY);}
else
{var thisDistanceX=Math.abs(parseInt(ed._current_screen_x)-ed.startHandlerLastClickedX);var thisDistanceY=Math.abs(parseInt(ed._current_screen_y)-ed.startHandlerLastClickedY);}
thisClickedX=ed._pressedElementX;thisClickedY=ed._pressedElementY;var objPgs=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(objPgs!=null)
{try
{if(!window.ed.isiscrollroll)
{thisClickedX=Math.round((objPgs.iscroll[0].pointX-window.ide.playerPlacementOffset.left-objPgs.iscroll[0].x)/ objPgs.iscroll[0].scale);thisClickedY=Math.round((objPgs.iscroll[0].pointY-window.ide.playerPlacementOffset.top-objPgs.iscroll[0].y)/ objPgs.iscroll[0].scale);objPgs.iscroll[0].pointX=-1;objPgs.iscroll[0].pointY=-1;}
else
{thisClickedX=Math.round((ed.IscrollRollPressedX-window.ide.playerPlacementOffset.left-objPgs.iscroll[0].x)/ objPgs.iscroll[0].scale);thisClickedY=Math.round((ed.IscrollRollPressedY-window.ide.playerPlacementOffset.top-objPgs.iscroll[0].y)/ objPgs.iscroll[0].scale);ed.IscrollRollPressedX=-1;ed.IscrollRollPressedY=-1;}}catch(e){thisClickedX=-999;thisClickedY-999;}
try
{if(objPgs.isparalaxsubpage)
{var paralaxParent=window.f.findObjFromWindowPgsByPagenumber(objPgs.mainPageId);var currentPageParalaxY=parseFloat($('#'+objPgs.holderdivid).css('y').toString().replace('px',''));currentPageParalaxY=currentPageParalaxY+(objPgs.subpageindx*window.eddata.head.pageHeight);thisClickedX=Math.round((paralaxParent.iscroll[0].pointX-window.ide.playerPlacementOffset.left-paralaxParent.iscroll[0].x)/ paralaxParent.iscroll[0].scale);thisClickedY=Math.round((paralaxParent.iscroll[0].pointY-window.ide.playerPlacementOffset.top-paralaxParent.iscroll[0].y)/ paralaxParent.iscroll[0].scale)-currentPageParalaxY;paralaxParent.iscroll[0].pointX=-1;paralaxParent.iscroll[0].pointY=-1;}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6624; column: 807;  :: '+v);console.log(e.message);thisClickedX=-999;thisClickedY-999;}}
if((thisDistanceX<offsetRange)&&(thisDistanceY<offsetRange)&&(Math.abs(timeDifferenceBetweenStartAndEndClick)<600)&&(!ed._popup_shown)&&(!ed._video_shown)&&(!ed._facebookIsShown))
{ed._pressedElementX=-500;ed._pressedElementY=-500;if(ed.testIfLinkWasPressed(thisClickedX,thisClickedY,was_last_image_clicked))
{ed.this_is_new_double_click=0;}
else
{}}}
try
{if(window.ed.shouldReturnTrueAndAllowDefault(event))
{return true;}}catch(e){}
if(window.f.getCurrentPageScale(window.ide.currentPage)>window.ide.defaultPublicationScale.toFixed(3))
{ed.page_currently_zoomed_in=true;return false;}
else
{ed.resetVariablesUsedToTrack();ed.comeBack(false);ed.page_currently_zoomed_in=false;}
ed._singleClickWasClickedAtTime=new Date();ed._isSingleClick=true;}
else if((ed._enabledTracking)&&(move_hanlder_started_to_scroll_left_or_right)&&(!ed._isDoubleClick))
{if(window.f.getCurrentPageScale(window.ide.currentPage)>window.ide.defaultPublicationScale)
{ed.page_currently_zoomed_in=true;}
else
{ed.page_currently_zoomed_in=false;}
if(ed._currentlyScrollingSubpages)
{if((window.ed._currentPageObjPgs.ismainparalaxpage)||(window.ed._currentPageObjPgs.isparalaxsubpage))
{if(window.ide.contain_paralax_pages){window.ide.positionParalaxPagesEnd(false);}
ed.onTouchEndSetVars();return false;}
else
{if(ed.distanceY<0)
{if((ed.distanceY<(-(ed._current_ScreenHeight/3)))&&(!window.ed._currentPageObjPgs.islastsubpage)&&(!window.ed._currentPageObjPgs.islastfadeinsubpage))
{if(!ide.pageflip){window.f.nextPage(true);}else{}}
else
{ed.resetVariablesUsedToTrack();ed.comeBack();}}
else
{if((ed.distanceY>(ed._current_ScreenHeight/3))&&(!window.ed._currentPageObjPgs.ismainpage))
{if(!ide.pageflip){window.f.previousPage(true);}else{}}
else
{ed.resetVariablesUsedToTrack();ed.comeBack();}}
ed.onTouchEndSetVars();return false;}}
ed.onTouchEndSetVars();ed._isSingleClick=false;if(thisDistanceX_measured_offset>0){ed.direction="right";}
if(thisDistanceX_measured_offset<0){ed.direction="left";}
if((ed.timerCounter<250&&thisDistanceX_measured_offset>35)&&(!ed.page_currently_zoomed_in)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.previousPage(false);}else{}}
else if((ed.timerCounter<250&&thisDistanceX_measured_offset<-35)&&(!ed.page_currently_zoomed_in)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.nextPage(false);}else{}}
else if((ed.timerCounter<100&&thisDistanceX_measured_offset>80)&&(ed.page_currently_zoomed_in)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.previousPage(false);}else{}}
else if((ed.timerCounter<100&&thisDistanceX_measured_offset<-80)&&(ed.page_currently_zoomed_in)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.nextPage(false);}else{}}
else if(thisDistanceX_measured_offset<=-(window.ed._current_ScreenWidth_withRatio / 3)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.nextPage(false);}else{}}
else if(thisDistanceX_measured_offset>=(window.ed._current_ScreenWidth_withRatio / 3)){ed.resetVariablesUsedToTrack();if(!ide.pageflip){window.f.previousPage(false);}else{}}
else{ed.resetVariablesUsedToTrack();ed.comeBack();}
ed.timerCounter=0;ed.isTouchEnd=false;ed.distanceX=0;}
else
{ed.resetVariablesUsedToTrack();ed.comeBack();ed._isSingleClick=false;event.returnValue=false;try
{event.preventDefault();}catch(e){}
return(false);}
event.preventDefault();event.returnValue=false;return false;};
;
window.ed.gotoMobileView=function(){var usecookies=false;try
{localStorage.setItem("forcemobileversion","1");if(localStorage.getItem("forcemobileversion")=="1")
{}
else
{usecookies=true;}}catch(e)
{usecookies=true;}
if(usecookies)
{window.ed.setCookie('forcemobileversion',"1",1);}
window.location.reload();};window.ed.goToPreviousPage=function(){window.ed.goToStartOfPage(window.ed.previousPage);};window.ed.goToNextSubPage=function(){window.ed.goToStartOfPage(window.ed.nextSubpage);};window.ed.goToPreviousSubPage=function(){window.ed.goToStartOfPage(window.ed.previousSubpage);};window.ed.goToNextPage=function(){window.ed.goToStartOfPage(window.ed.nextPage);};window.ed.goToPreviousMainPage=function(){window.ed.goToStartOfPage(window.ed.previousMainPage);};window.ed.goToNextMainPage=function(){window.ed.goToStartOfPage(window.ed.nextMainPage);};window.ed.goToCurrentMainPage=function(){window.ed.goToStartOfPage(window.ed.currentMainPage);};window.ed.goToBottomSubpage=function(){window.ed.goToStartOfPage(window.ed.currentBottomSubpage);};window.ed.goToLastPage=function(){window.ed.goToStartOfPage(window.ed.lastMainPage);};window.ed.goToFirstPage=function(){window.ed.goToStartOfPage(window.ed.firstPage);};window.ed.goToLastMainPage=function(){window.ed.goToStartOfPage(window.ed.lastMainPage);};window.ed.goToPage=function(pageId){try
{if(window.ed._currentPageObjPgs.id!=pageId)
{window.ed.goToStartOfPage(pageId);}}catch(e){window.ed.goToStartOfPage(pageId);}};window.ed.goToStartOfPage=function(pageId){var found=false;var temp_find_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);window.ed._currentPageObjPgs=temp_find_obj;try
{var current_page_id=window.ide.currentPage;}catch(e){current_page_id=pageId;}
if(pageId==window.ed.nextPage)
{found=true;var nextPG=window.f.findNextObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),true);pageId=nextPG.pagenumber;}
if(pageId==window.ed.previousPage)
{found=true;var previousPG=window.f.findPreviousObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),true);pageId=previousPG.pagenumber;}
if(pageId==window.ed.previousMainPage)
{found=true;var previousPG=window.f.findPreviousObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),false);try
{if((!window.ed._currentPageObjPgs.ismainpage)&&((!previousPG.islastpage)&&(!previousPG.isfirstpage)))
{var element_html=window.ed.get(previousPG.divid);if(!element_html){element_html={};element_html.id=previousPG.divid;}
var tmpobj=window.f.findPreviousObjFromWindowPgsByElementObject(element_html,false);if(tmpobj!=null)
{previousPG=tmpobj;}}}catch(e){}
pageId=previousPG.pagenumber;}
if(pageId==window.ed.firstPage)
{pageId=window.eddata.pages[0].pagenumber;found=true;}
if(pageId==window.ed.lastPage)
{pageId=window.eddata.pages[window.eddata.pages.length-1].pagenumber;found=true;}
if(pageId==window.ed.currentBottomSubpage)
{found=true;var lastBtmSbpg=window.f.findLastSubpageFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),true);if(lastBtmSbpg!=null)
{pageId=lastBtmSbpg.pagenumber;}
else
{pageId=-999;}}
if(pageId==window.ed.nextMainPage)
{found=true;var nextPG=window.f.findNextObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),false);if(nextPG!=null)
{pageId=nextPG.pagenumber;}
else
{pageId=-999;}}
if(pageId==window.ed.lastMainPage)
{found=true;var lastBtmMpg=window.f.findLastMainPageFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid));if(lastBtmMpg!=null)
{pageId=lastBtmMpg.pagenumber;}
else
{pageId=-999;}}
if(pageId==window.ed.currentMainPage)
{found=true;var previousPG=window.f.findPreviousObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),false);pageId=previousPG.pagenumber;}
if(pageId==window.ed.previousSubpage)
{if((window.ide.currentPageObjPgs.isparalaxsubpage)||(window.ide.currentPageObjPgs.ismainparalaxpage))
{}
else
{found=true;var previousPg=window.f.findPreviousObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),true,true);if(previousPg!=null)
{if(previousPg.mainPageId==window.ed._currentPageObjPgs.mainPageId)
{pageId=previousPg.pagenumber;}}
else
{pageId=-999;}}}
if(pageId==window.ed.nextSubpage)
{if((window.ide.currentPageObjPgs.isparalaxsubpage)||(window.ide.currentPageObjPgs.ismainparalaxpage))
{}
else
{found=true;var nextPG=window.f.findNextObjFromWindowPgsByElementObject(window.ed.get(window.ed._currentPageObjPgs.divid),true,true);if(nextPG.mainPageId==window.ed._currentPageObjPgs.mainPageId)
{pageId=nextPG.pagenumber;}}}
if(!found)
{var tmpobj=window.f.findObjFromWindowPgsByObjectId(pageId);if(tmpobj!=null)
{if(tmpobj.pagenumber>-1)
{pageId=tmpobj.pagenumber;found=true;}}}
window.ed.thisIsInitialOffset=false;try
{var rightPage=-999;if(window.ide.orientIsBookMode)
{var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);var currobjPGS_right=window.f.findObjFromWindowPgsByPagenumber(currobjPGS.rightPage);rightPage=currobjPGS_right?currobjPGS_right.pagenumber:-1;if(pageId==rightPage)
{}}}catch(e){}
if(found)
{if((pageId>0)&&(pageId!=window.ide.currentPage)&&(pageId!=rightPage))
{window.f.goToPageWithAnimation(pageId);}}
return false;};
;
window.ed.txtblock_statsevent=function(forxtbox,src){window.ed.sendInteractiveStats('Link','External',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,$(forxtbox).text(),src,0);};window.ed.txtblockpersonalize=function(textblocktext){try
{var personalizationitems=new Array();var tmptxt=textblocktext;var fullquerystring=location.search;fullquerystring=fullquerystring.replace('?','');var arrofparams=fullquerystring.split("&");for(var d in arrofparams){var paramSngl=arrofparams[d].split("=");var pname=paramSngl[0];var pval=paramSngl[1];if(pname.toLowerCase().substring(0,4)=='edp_')
{personalizationitems[pname.toLowerCase()]=pval;}}
var tmparrtxt=tmptxt.toLowerCase().split("[edp_");if(tmparrtxt.length>1)
{for(var d in tmparrtxt)
{var currparram=tmparrtxt[d];if(d>0)
{var tmptwoarr=currparram.split("]")[0];var paramname='[edp_'+tmptwoarr+"]";var handled=false;var paramnamewithoutbrackets=paramname.replace("]","").replace("[","");if(paramnamewithoutbrackets.indexOf(',')>0){paramnamewithoutbrackets=paramnamewithoutbrackets.split(',')[0];}
if(typeof(personalizationitems[paramnamewithoutbrackets])!="undefined")
{var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,decodeURI(personalizationitems[paramnamewithoutbrackets]));handled=true;}
else
{var paramdefcheckarr=paramname.split(',',2);if(paramdefcheckarr.length>1)
{var defaultval=paramdefcheckarr[1].replace("]","");var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,defaultval);handled=true;}}
if(!handled)
{var defaultval="";var re=new RegExp(paramname.replace("]","\\]").replace("[","\\["),'gi');tmptxt=tmptxt.replace(re,defaultval);handled=true;}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6760; column: 280;  :: '+v);}
return tmptxt;};window.ed.drawtextblock=function(pagesElemstextblockArrIndex,texbox_id,parentdivid,for_page){ed.currentlyLoadingtextblockes=false;var currobj_pgs_tmp=window.f.findObjFromWindowPgsByPagenumber(for_page);if((window.ide.currentPage==for_page)||((currobj_pgs_tmp.rightPage==for_page)&&(window.ide.orientIsBookMode))||((currobj_pgs_tmp.leftPage==for_page)&&(window.ide.orientIsBookMode)))
{var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(for_page);for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];if(currobj.itype==window.ide.itypetextblock)
{var textblock_id=currobj.id;var parentdivid=currobj.divid;var background_div_id=currobj.dividbg;var holder_div_id=currobj.dividholder;var border_color='';var border_alpha='';var marginR='';var show_it=true;var add_close_button=false;var add_size_button=false;var enable_scrollbars=true;var scrollbar_set_color='000000';var scrollbar_set_alpha='50';var initial_text_size='24';var internal_text_size=100;var scrollbar_color_with_opacity='rgba(0,0,0,0.5)';if((currobj.id==texbox_id)&&(window.ide.get(holder_div_id)!=null))
{window.ide.get(holder_div_id).innerHTML=window.ed.txtblockpersonalize(currobj.text.replace(/\/additional_files\//g,window.eddata.path.global_path+"/additional_files/"));$('#'+holder_div_id).find('a').each(function(){$(this).on(window.ed._touch_start_event_nm,function(){window.ed.txtblock_statsevent(this,this.href);});if(window.ed.istouchdevice)
{$(this).on('mousedown',function(){window.ed.txtblock_statsevent(this,this.href);});}});var textblock_current_settings=currobj.settings;var arr_settings=textblock_current_settings.split("$");for(var single_setting in arr_settings)
{var currobj_settings=arr_settings[single_setting];if(currobj_settings!='')
{if(currobj_settings.indexOf("=")>0)
{var tmp_arr=currobj_settings.split("=");var current_setting_name=tmp_arr[0];var current_setting_value=tmp_arr[1];if((current_setting_name=='font_size')&&(current_setting_value!=''))
{window.ide.get(parentdivid).style.fontSize=current_setting_value+'px';initial_text_size=current_setting_value;}
else if((current_setting_name=='internal_font_size')&&(current_setting_value!=''))
{internal_text_size=current_setting_value;}
else if((current_setting_name=='font_clr')&&(current_setting_value!=''))
{window.ide.get(parentdivid).style.color='#'+current_setting_value;}
else if((current_setting_name=='marginL')&&(current_setting_value!=''))
{$('#'+holder_div_id).css('padding-left',current_setting_value+'px');if(parseInt(current_setting_value)>0)
{$('#'+holder_div_id).css({'min-width':'inherit'});}}
else if((current_setting_name=='marginT')&&(current_setting_value!=''))
{$('#'+holder_div_id).css('padding-top',current_setting_value+'px');$('#'+holder_div_id).parent().append('<div class="ed-textblock-top-padding txtblocktoppadding" style="height:'+current_setting_value+'px;"></div>');currobj.margint=parseInt(current_setting_value);}
else if((current_setting_name=='marginR')&&(current_setting_value!=''))
{marginR=current_setting_value;$('#'+holder_div_id).css({'padding-right':marginR+'px'});if(parseInt(marginR)>0)
{$('#'+holder_div_id).css({'min-width':'inherit'});}}
else if((current_setting_name=='marginB')&&(current_setting_value!=''))
{$('#'+holder_div_id).css('padding-bottom',current_setting_value+'px');$('#'+holder_div_id).parent().append('<div class="ed-textblock-bottom-padding txtblockbottompadding" style="height:'+current_setting_value+'px;"></div>');currobj.marginb=parseInt(current_setting_value);}
else if((current_setting_name=='size_button')&&(current_setting_value!=''))
{if(current_setting_value=='true')
{add_size_button=true;}}
else if((current_setting_name=='close_button')&&(current_setting_value!=''))
{if(current_setting_value=='true')
{add_close_button=true;}}
else if((current_setting_name=='scrollbar_visible')&&(current_setting_value!=''))
{if(current_setting_value!='true')
{enable_scrollbars=false;}}
else if((current_setting_name=='scrollbar_color')&&(current_setting_value!=''))
{scrollbar_set_color=current_setting_value;}
else if((current_setting_name=='scrollbar_alpha')&&(current_setting_value!=''))
{scrollbar_set_alpha=current_setting_value;}
if((scrollbar_set_color!='')&&(scrollbar_set_alpha!=''))
{var rgbobj=window.f.hexToRgb('#'+scrollbar_set_color);var border_opacity=(parseInt(scrollbar_set_alpha)/100).toString();var rgbaVal='rgba('+rgbobj.r.toString()+','+rgbobj.g.toString()+','+rgbobj.b.toString()+','+border_opacity.toString()+')';scrollbar_color_with_opacity=rgbaVal;}}}}
parentdivid=currobj.holderDivId;var divForStyles=parentdivid;if(currobj.initially_hidden==1)
{show_it=false;}
if(currobj.fill_color!='')
{$('#'+divForStyles).css('background-color',currobj.fill_color);$('#'+divForStyles).find('.ed-textblock-bottom-padding').css('background-color',currobj.fill_color).css('opacity',0);$('#'+divForStyles).find('.ed-textblock-top-padding').css('background-color',currobj.fill_color).css('opacity',0);}
if(currobj.fill_opacity.toString()!='')
{try
{var rgbobj=window.f.hexToRgb(currobj.fill_color);var rgbobj_opacity=(parseInt(currobj.fill_opacity)/100).toString();$('#'+divForStyles).css({'background-color':'rgba('+rgbobj.r.toString()+','+rgbobj.g.toString()+','+rgbobj.b.toString()+','+rgbobj_opacity.toString()+')'});}
catch(e)
{}}
if(currobj.border_color!='')
{$('#'+divForStyles).css({'border-color':currobj.border_color,'border-style':'solid'});if((currobj.border_color!='')&&((currobj.border_color!='#'))&&(currobj.border_opacity!=''))
{var rgbobj=window.f.hexToRgb(currobj.border_color);var border_opacity=(parseInt(currobj.border_opacity)/100).toString();var rgbaVal='rgba('+rgbobj.r.toString()+','+rgbobj.g.toString()+','+rgbobj.b.toString()+','+border_opacity.toString()+')';$('#'+divForStyles).css({'border-color':rgbaVal});}}
if(currobj.border_width!='')
{$('#'+divForStyles).css('border-width',currobj.border_width+'px');}
if(currobj.border_radius!='')
{$('#'+divForStyles).css('border-radius',currobj.border_radius+'px');}
currobj.originalTextSize=initial_text_size;if((internal_text_size!='')&&(initial_text_size!=''))
{currobj.originalTextSize=Math.round(parseInt(initial_text_size)*(parseInt(internal_text_size)/100)).toString();initial_text_size=currobj.originalTextSize;}
if((add_size_button)&&(marginR!=''))
{if(parseInt(marginR)>10)
{var button_id_increase=texbox_id.toString()+'_txtbox_increase';var button_id_decrease=texbox_id.toString()+'_txtbox_decrease';if(window.ide.get(button_id_increase)==null)
{var add_html='<div id="'+button_id_increase+'" class="text_box_increase_text_button gpuAcc" style="width:'+(marginR-10).toString()+'px;margin-right:10px;height:'+marginR.toString()+'px;bottom:'+(parseInt(marginR)+5).toString()+'px"></div>';add_html+='<div id="'+button_id_decrease+'" class="text_box_decrease_text_button gpuAcc" style="width:'+(marginR-10).toString()+'px;margin-right:10px;height:'+marginR.toString()+'px"></div>';$('#'+parentdivid).append(add_html);try
{$('#'+button_id_increase).on(window.ed._touch_start_event_nm,function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_increase','');window.ed.adjusttextblockText(txtboxId,1);});$('#'+button_id_decrease).on(window.ed._touch_start_event_nm,function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_decrease','');window.ed.adjusttextblockText(txtboxId,-1);});if((window.initer.isIe9)||(window.initer.isIe10))
{$('#'+button_id_increase).on('click',function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_increase','');window.ed.adjusttextblockText(txtboxId,1);});$('#'+button_id_decrease).on('click',function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_decrease','');window.ed.adjusttextblockText(txtboxId,-1);});}
if(window.ed.istouchdevice)
{$('#'+button_id_increase).on('mousedown',function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_increase','');window.ed.adjusttextblockText(txtboxId,1);});$('#'+button_id_decrease).on('mousedown',function(){var txtboxId='textblock_text_'+this.id.replace('_txtbox_decrease','');window.ed.adjusttextblockText(txtboxId,-1);});}}catch(e){}}}}
if((add_close_button)&&(marginR!=''))
{var button_id=texbox_id.toString()+'_txtbox_close';if(window.ide.get(button_id)==null)
{if(parseInt(marginR)>10)
{var add_html='<div id="'+button_id+'" class="text_box_close_button gpuAcc" style="width:'+(parseInt(marginR)-10).toString()+'px;margin-right:10px;height:'+marginR.toString()+'px"></div>';$('#'+parentdivid).append(add_html);var keyeventname=window.ed._touch_start_event_nm;if(window.ed.istouchdevice)
{keyeventname=window.ed._touch_start_event_nm+' mousedown';}
if((window.initer.isIe9)||(window.initer.isIe10))
{keyeventname=window.ed._touch_start_event_nm+' click';}
$('#'+button_id).on(keyeventname,function(){$('#textblock'+texbox_id.toString()).stop().transition({opacity:0.001},250,window.ed.defaultEasing,function(){try
{var txtbox_id=this[0].id.replace('textblock','').replace('inner','');}catch(e){txtbox_id=-1;}
var currElemTitle='';for(var d in window.eddata.pages)
{for(var l in window.eddata.pages[d].interactive)
{var currElem=window.eddata.pages[d].interactive[l];if(currElem.itype==window.ide.itypetextblock)
{if(currElem.id==txtbox_id)
{currElemTitle=currElem.dev_name;}}}}
$('#textblock'+texbox_id.toString()).stop().css({visibility:'hidden',display:'none'});window.ed.sendInteractiveStats('Textbox','Close',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,currElemTitle,'',0,'','',txtbox_id);});});}}}
if(currobj.iscroll!=null)
{currobj.iscroll.destroy();currobj.iscroll=null;}
if(show_it)
{$('#'+parentdivid).stop().css({opacity:0.0001,visibility:'hidden'});currobj.contentloaded=true;window.ed.checkPreloadedImgs(currobjPGS.pagenumber,parentdivid,window.ide.itypetextblock);try{currobj.iscroll.refresh();}catch(e){}}
else
{$('#'+parentdivid).stop().css({display:'none','visibility':'hidden'});}
if(window.initer.isIe9)
{currobj.iscroll=new eDitionTextbox('#'+parentdivid,{startX:0,startY:0,HWCompositing:false,scrollIndicatorColor:scrollbar_color_with_opacity,interactiveScrollbars:true,useCenterOfUnzoomedElement:true,resizePolling:60,freeScroll:true,bindToWrapper:false,scrollX:true,scrollY:true,scrollbars:enable_scrollbars,mouseWheel:true,wheelAction:'scroll',zoom:false,preventDefault:true});}
else
{var hwcompositing=true;if(window.initer.isIe10)
{hwcompositing=false;}
currobj.iscroll=new eDitionTextbox('#'+parentdivid,{startX:0,startY:0,HWCompositing:hwcompositing,scrollIndicatorColor:scrollbar_color_with_opacity,interactiveScrollbars:true,useCenterOfUnzoomedElement:true,resizePolling:0,freeScroll:true,bindToWrapper:false,scrollX:true,scrollY:true,scrollbars:enable_scrollbars,mouseWheel:true,wheelAction:'scroll',zoom:false,preventDefault:false});}
if(window.initer.isIe9)
{window.f.AtachEvent(parentdivid,'mouseover','window.ed.txtboxmousedown');window.f.AtachEvent(parentdivid,'mouseleave','window.ed.txtboxmouseout');window.f.AtachEvent(parentdivid,'mouseup','window.ed.txtboxmouseout');}
var isScrollable=window.ed.textblocksetscrollableornot(currobj.iscroll,'#'+parentdivid,'#'+parentdivid+'inner');if(!isScrollable)
{window.ed.alltextblocktimeouts.push(window.setTimeout('window.ed.nonscrollabletxtblockwasseen('+window.ed.textboxreadtimeoutcalledwhenpageid.toString()+',"'+texbox_id+'");',window.ed.textboxreadtimeout));}
currobj.iscroll.on('scrollEnd',window.ed.evnt_txtblock_scrollend);currobj.iscroll.on('scrollStart',window.ed.evnt_txtblock_startscroll);currobj.iscroll.on('scrollCancel',window.ed.evnt_txtblock_scrollend);}}}}
ed.hideLoader();};window.ed.txtboxmousedown=function(event){try
{if(this.options.scrollY){if(window.initer.isIe9)
{window.ed.isiscrollroll=true;}}}catch(e){}}
window.ed.txtboxmouseclick=function(event){}
window.ed.txtboxmouseout=function(event){if(typeof(window.ed.cntrtmeouttxtbx)=="undefined"){window.ed.cntrtmeouttxtbx=0;}
window.ed.cntrtmeouttxtbx++;window.setTimeout("if(window.ed.cntrtmeouttxtbx=="+window.ed.cntrtmeouttxtbx.toString()+"){window.ed.isiscrollroll=false;}",1000);}
window.ed.textblocksetscrollableornot=function(iscroll,parent,child,forcescroll){var isscrollable=true;try
{var parentHeight=$(parent).height();var currElemTitle='';var interindex=0;var pgindx=0;var ielem=null;for(var d in window.eddata.pages)
{for(var l in window.eddata.pages[d].interactive)
{var currElem=window.eddata.pages[d].interactive[l];if(currElem.itype==window.ide.itypetextblock)
{if(currElem.iscroll==iscroll)
{ielem=currElem;}}}}
var padding=($(child).css('padding').replace('px','')*2);var margin=($(child).css('margin').replace('px','')*2);if(ielem!=null)
{if(((ielem.marginb)!='undefined')||(typeof(ielem.margint)!='undefined'))
{var padding=0;if(typeof(ielem.marginb)!='undefined')
{}
if(typeof(ielem.margint)!='undefined')
{}}}
var childinnerScrollableHeight=($(child).height()-padding-margin)-10;if(!isNaN(childinnerScrollableHeight)&&(!isNaN(parentHeight)))
{if(parseInt(childinnerScrollableHeight)<=parseInt(parentHeight))
{isscrollable=false;var previousScollY=iscroll.options.scrollY;iscroll.options.scrollY=false;if(previousScollY)
{iscroll.refresh();}}}}catch(e){isscrollable=true;}
if((isscrollable)||(forcescroll)){var previousScollY=iscroll.options.scrollY;iscroll.options.scrollY=true;if(!previousScollY)
{iscroll.refresh();}}
return isscrollable;};window.ed.nonscrollabletxtblockwasseen=function(calledwhenpage,txtbox_id){if(calledwhenpage==window.ide.currentPage)
{var currElemTitle='';var interindex=0;var pgindx=0;for(var d in window.eddata.pages)
{for(var l in window.eddata.pages[d].interactive)
{var currElem=window.eddata.pages[d].interactive[l];if(currElem.itype==window.ide.itypetextblock)
{if(currElem.id==txtbox_id)
{pgindx=d;interindex=l;currElemTitle=currElem.dev_name;}}}}
try
{window.ed.sendInteractiveStats('Textbox','Scroll',window.f.findObjFromWindowPgsByPagenumber(calledwhenpage).id,currElemTitle,'',100,'',0,txtbox_id);window.eddata.pages[pgindx].interactive[interindex].isAlreadySentStats=true;}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6889; column: 360;  :: '+v);console.log(e.message);}}};window.ed.evnt_txtblock_startscroll=function(event){try
{try
{var isScrollable=window.ed.textblocksetscrollableornot(this,'#'+this.wrapper.id,'#'+this.wrapper.id+'inner');if(!isScrollable){event.preventDefault();event.returnvalue=false;}}catch(e){}
if(!this.refreshed)
{this.refreshed=true;this.refresh();}}catch(e){}};window.ed.evnt_txtblock_scrollend=function(event){var position=0;if((Math.abs(this.maxScrollY)>5)&&(Math.abs(this.maxScrollX)>5))
{if(Math.abs(this.maxScrollY)>Math.abs(this.maxScrollX))
{position=this.y / this.maxScrollY;}
else
{position=this.x / this.maxScrollX;}}
else if(Math.abs(this.maxScrollY)>5)
{position=this.y / this.maxScrollY;}
else if(Math.abs(this.maxScrollX)>5)
{position=this.x / this.maxScrollX;}
else if((Math.abs(this.maxScrollX)<=5)&&(Math.abs(this.maxScrollY)<=5))
{position=1;}
var txtbox_id=this.wrapper.id.replace('textblock','').replace('inner','');var currElemTitle='';var pgindx=0;var interindex=0;for(var d in window.eddata.pages)
{for(var l in window.eddata.pages[d].interactive)
{var currElem=window.eddata.pages[d].interactive[l];if(currElem.itype==window.ide.itypetextblock)
{if(currElem.id==txtbox_id)
{pgindx=d;interindex=l;currElemTitle=currElem.dev_name;}}}}
try
{if($('#'+this.wrapper.id).css('visibility')=='visible')
{if(!isNaN(position))
{if(Math.round(position*100)>=95)
{if(!window.eddata.pages[pgindx].interactive[interindex].isAlreadySentStats)
{window.eddata.pages[pgindx].interactive[interindex].isAlreadySentStats=true;window.ed.sendInteractiveStats('Textbox','Scroll',window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,currElemTitle,'',Math.round(position*100),'',0,txtbox_id);}}}}}catch(e){}}
window.appendtextblockesGlobalStyles=function(){if(!window.ed.textblockStylesInjected)
{var textblock_css_index=0;var whole_value='';var current_value='';if(typeof(window.eddata.textBlock)!='undefined')
{var whole_css_style=window.eddata.textBlock.cssStyle;if(whole_css_style!='')
{for(var l in window.eddata.textBlock.fonts)
{var currobj=window.eddata.textBlock.fonts[l];var current_font_name=currobj.name;var current_font_webname=currobj.web_name;var current_font_css=currobj.web_css;var replace_val="ED_"+current_font_name;var replace_val_with=current_font_webname;var regex=new RegExp(replace_val,"g");whole_css_style=whole_css_style.replace(regex,replace_val_with);whole_css_style=current_font_css+whole_css_style;}}}}
if(whole_css_style!='')
{var head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=whole_css_style;}else{style.appendChild(document.createTextNode(whole_css_style));}
head.appendChild(style);window.ed.textblockStylesInjected=true;}}
window.ed.clearAllTextblockTimeouts=function(){try
{for(var d in window.ed.alltextblocktimeouts){try
{var currid=window.ed.alltextblocktimeouts[d];window.clearTimeout(currid);}catch(e){}}
window.ed.alltextblocktimeouts=new Array();}catch(e){console.log('exception while cloearing all textblock timeouts -> '+e.message);}};window.ed.checktextblockesForPage=function(_page_id,showConnectedObj,wasalreadycalledload){window.ed.textboxreadtimeoutcalledwhenpageid=window.ide.currentPage;if(typeof(wasalreadycalledload)=='undefined')
{var wasalreadycalledload=false;}
window.appendtextblockesGlobalStyles();if(typeof(showConnectedObj)=='undefined')
{var showConnectedObj=-1;}
try
{var shouldload=false;var hastextblockes=false;var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(_page_id);for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];var textblock_id=currobj.id;var parentDivId=currobj.divid;if((currobj.itype==window.ide.itypetextblock)&&(currobj.devparam.indexOf('*notonipad*')<1)&&(currobj.devparam.indexOf('*notonhtml5*')<1))
{hastextblockes=true;if((!currobj.loaded)&&(!currobj.loaderror))
{shouldload=true;}
else
{currobj.contentloaded=false;if(!currobj.loaderror)
{{window.ed.drawtextblock(d,textblock_id,parentDivId,currobjPGS.pagenumber);}}}}}
if((shouldload)&&(hastextblockes)&&(!wasalreadycalledload))
{}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6940; column: 126;  :: '+v);console.log('ERROR While loading textblock -> '+e.message)}};window.ed.adjusttextblockText=function(for_div_font,plusorminus,originalsize){try
{var textblockobj=null;var currTxtBoxid=-1;var currTxtBoxTitle='';var currpage=-1;var OBJECT_NAME='';for(var d in window.eddata.pages)
{for(var l in window.eddata.pages[d].interactive)
{if(window.eddata.pages[d].interactive[l].itype==window.ide.itypetextblock)
{if(('textblock_text_'+window.eddata.pages[d].interactive[l].id)==for_div_font)
{currpage=window.eddata.pages[d].id;textblockobj=window.eddata.pages[d].interactive[l];currTxtBoxid=window.eddata.pages[d].interactive[l].id;currTxtBoxTitle=window.eddata.pages[d].interactive[l].dev_name;OBJECT_NAME=currTxtBoxTitle;if(typeof(originalsize)=='undefined')
{originalsize=window.eddata.pages[d].interactive[l].originalTextSize;}
break;}}}}
if(window.ide.get(for_div_font)!=null)
{var current_font_size=parseInt(window.ide.get(for_div_font).style.fontSize.replace('px',''));if(plusorminus>0)
{current_font_size+=window.ed.textblock_increase_font_step;}
else
{current_font_size-=window.ed.textblock_increase_font_step;}
var up_boundary=(parseInt(originalsize)+parseInt(window.ed.textblock_increase_font_step)*4);var bottom_boundary=(parseInt(originalsize)-parseInt(window.ed.textblock_increase_font_step)*4);if((parseInt(current_font_size)<up_boundary)&&(current_font_size>=bottom_boundary))
{window.ide.get(for_div_font).style.fontSize=current_font_size.toString()+'px';var statActionLbl='Font decrease';if(plusorminus>0)
{statActionLbl='Font increase';}
var statDataObj={category:'Textbox',page_id:currpage,label:OBJECT_NAME,action:statActionLbl,edition_object_id:currTxtBoxid};window.stats.event('Textbox',statDataObj.action,statDataObj,currTxtBoxid);}
try
{if(textblockobj!=null)
{var isScrollable=window.ed.textblocksetscrollableornot(textblockobj.iscroll,'#'+textblockobj.iscroll.wrapper.id.toString(),'#'+textblockobj.iscroll.wrapper.id.toString()+'inner');textblockobj.iscroll.refresh();}}catch(e){}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 6959; column: 359;  :: '+v);console.log("Error while setting textblock text ->"+e.message);}};window.ed.connectedtextblockClicked_BY_USER=function(pagename,linkid,idImage,showLayer,version_of_call,calledFromAnim,actionname,actionobj){if(typeof(calledFromAnim)=='undefined')
{var calledFromAnim=false;}
var anim_index=0;var anim_name='show';if(idImage.indexOf(',')>0)
{var arr_steps=idImage.split(',');try
{idImage=arr_steps[0];anim_name=arr_steps[1];}catch(e){anim_name='show';}}
else
{anim_name=actionname;}
var doCleanThem=true;if(ed._previous_version_of_call==version_of_call)
{doCleanThem=false;}
var found=false;var srchObjName='textblock'+idImage;var current_index=0;var pageId=-1;for(var cntr=0;cntr<2;cntr++)
{var currObj=null;if(cntr==0)
{currObj=window.ide.currentPageObjPgs.interactive;current_index=window.ide.currentPageObjPgs.arrindex;try
{pageId=window.ide.currentPageObjPgs.id;}catch(e){}}
if((cntr==1)&&(window.ide.orientIsBookMode))
{currObj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);try
{pageId=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage).id;}catch(e){}
current_index=currObj.arrindex;if(currObj!=null)
{currObj=currObj.interactive;}}
else if((cntr==1)&&(!window.ide.orientIsBookMode))
{found=true;}
if(!found)
{for(var l in currObj)
{var currObjThs=currObj[l];if(currObjThs.itype==window.ide.itypetextblock)
{if((currObjThs.holderDivId==srchObjName)&&(!found))
{var LINK_ID=linkid;var OBJECT_ID=currObjThs.id;var OBJECT_NAME=currObjThs.dev_name;var PAGE_NAME=pagename;var thisObj=document.getElementById(currObjThs.holderDivId);var parentDiv=document.getElementById(currObjThs.divid);var absoluteParentDiv=document.getElementById(currObjThs.holderDivId);if((anim_name=='show')&&((window.ide.get(currObjThs.holderDivId).style.visibility=='hidden')||($('#'+currObjThs.holderDivId).css('display')=='none')))
{found=true;$('#'+currObjThs.holderDivId).stop().css({opacity:0.0001,visibility:'visible',display:'block'}).removeClass('hidden').delay(50).transition({opacity:1},250,window.ed.defaultEasing);window.setTimeout("try{window.eddata.pages["+current_index+"].interactive["+l.toString()+"].iscroll.refresh();}catch(e){};",301);var parentobj=window.eddata.pages[current_index].interactive[l];window.ed.textblocksetscrollableornot(parentobj.iscroll,'#'+parentobj.holderDivId,'#'+parentobj.holderDivId+'inner',true);var statDataObj={action:'',category:'Link',page_id:pageId,label:OBJECT_NAME,edition_object_id:LINK_ID};statDataObj.action='Show textbox';window.stats.event('Link',statDataObj.action,statDataObj,LINK_ID);}
else if((anim_name=='hide')&&(window.ide.get(currObjThs.holderDivId).style.visibility=='visible'))
{found=true;$('#'+currObjThs.holderDivId).stop().delay(5).transition({opacity:0.0001},250,window.ed.defaultEasing,function(){this.stop().css({'visibility':'hidden','display':'none'}).addClass('hidden');});var statDataObj={action:'Close',category:'Textbox',page_id:pageId,label:OBJECT_NAME,edition_object_id:OBJECT_ID};window.stats.event('Textbox',statDataObj.action,statDataObj,OBJECT_ID);}
else if(((anim_name=='incfont')||(anim_name=='increasefont'))&&(window.ide.get(currObjThs.holderDivId).style.visibility=='visible'))
{found=true;window.ed.adjusttextblockText('textblock_text_'+currObjThs.id,1,currObjThs.originalTextSize);}
else if(((anim_name=='decfont')||(anim_name=='decreasefont'))&&(window.ide.get(currObjThs.holderDivId).style.visibility=='visible'))
{found=true;window.ed.adjusttextblockText('textblock_text_'+currObjThs.id,-1,currObjThs.originalTextSize);}}}}}}};
;
(function(){var snd={debug:false,inited:false,init:function(){snd.inited=true;},applyEvents:function(divid,playerelem){if(window.ed.istouchdevice)
{window.f.AtachEvent(divid,window.ed._touch_start_event_nm,'snd.sndStartHandle');window.f.AtachEvent(divid,window.ed._touch_move_event_nm,'snd.sndMoveHandle');window.f.AtachEvent(divid,window.ed._touch_end_event_nm,'snd.sndEndHandle');}
else{window.f.AtachEvent(divid,'mousedown','snd.sndStartHandle');window.f.AtachEvent(divid,'mousemove','snd.sndMoveHandle');window.f.AtachEvent(divid,'mouseup','snd.sndEndHandle');}
window.f.AtachEvent(playerelem,'ended','snd.soundendedplaying');window.f.AtachEvent(playerelem,'error','snd.sounderrorplaying');},soundendedplaying:function(event){var hasRepeat=false;var animElId=event.target.id;try
{if(typeof(animElId)=='undefined')
{var animElId='';}
var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if((currobj.pagenumber==window.ide.currentPage)||(((currobj.leftPage==window.ide.currentPage)&&(currobj.leftPage!=currobj.pagenumber)))&&(window.ide.orientIsBookMode))
{var currobjPGS=currobj;for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];var sound_id=currsndobj.id;var parentdivid=currsndobj.holderDivId;if(currsndobj.divid==animElId)
{window.snd.sendStats('Finished',currobjPGS.id,currsndobj.mp3Title,'',1,$('#'+currsndobj.divid)[0].duration,currsndobj.id);window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;window.snd.onSoundPlayerSendPercentHeard(false,currsndobj.id,currsndobj.mp3Title.toString());;if($('#'+currsndobj.divid)[0]!=null)
{if(typeof(currsndobj.repeat)!='undefined')
{if(currsndobj.repeat.toString()=='1')
{hasRepeat=true;$('#'+currsndobj.divid)[0].load();$('#'+currsndobj.divid)[0].play();window.snd.sendStats('Play',currobjPGS.id,currsndobj.mp3Title,'',0,$('#'+currsndobj.divid)[0].duration,currsndobj.id);}}}}}}}}
if((window.ide.orientIsBookMode)&&(!hasRepeat))
{var currobj=window.f.findObjFromWindowPgsByPagenumber(currobj.rightPage);if(currobj!=null)
{if((currobj.pagenumber==window.ide.currentPage)||(((currobj.leftPage==window.ide.currentPage)&&(currobj.leftPage!=currobj.pagenumber)))&&(window.ide.orientIsBookMode))
{var currobjPGS=currobj;for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];var sound_id=currsndobj.id;var parentdivid=currsndobj.holderDivId;if(currsndobj.divid==animElId)
{if($('#'+currsndobj.divid)[0]!=null)
{window.snd.sendStats('Finished',currobjPGS.id,currsndobj.mp3Title,'',1,$('#'+currsndobj.divid)[0].duration,currsndobj.id);window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;window.snd.onSoundPlayerSendPercentHeard(false,currobjPGS.id,currsndobj.mp3Title.toString());if(typeof(currsndobj.repeat)!='undefined')
{if(currsndobj.repeat.toString()=='1')
{hasRepeat=true;$('#'+currsndobj.divid)[0].load();$('#'+currsndobj.divid)[0].play();window.snd.sendStats('Play',currobjPGS.id,currsndobj.mp3Title,'',0,$('#'+currsndobj.divid)[0].duration,currsndobj.id);}}}}}}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7016; column: 346;  :: '+v);};if(!hasRepeat)
{snd.stopPlayingPlayerFromElement(event);}
event.preventDefault();event.returnValue=false;return false;},sounderrorplaying:function(event){try
{var e=event;switch(e.target.error.code){case e.target.error.MEDIA_ERR_ABORTED:break;case e.target.error.MEDIA_ERR_NETWORK:snd.stopPlayingPlayerFromElement(event);break;case e.target.error.MEDIA_ERR_DECODE:snd.stopPlayingPlayerFromElement(event);break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:snd.stopPlayingPlayerFromElement(event);break;default:snd.stopPlayingPlayerFromElement(event);break;}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7019; column: 536;  :: '+v);}},sndStartHandle:function(event){event.preventDefault();event.returnValue=false;return false;},sndMoveHandle:function(event){event.preventDefault();event.returnValue=false;return false;},sndEndHandle:function(event){snd.stopPlayingPlayer(event);event.preventDefault();event.returnValue=false;return false;},stopPlayingPlayerFromElement:function(evnt){try
{var animobjElemId=evnt.target.id;var objname=evnt.target.id.replace('inner','anim');var objElem=$('#'+animobjElemId);if(objElem.length>0){objElem=objElem[0].pause();$('#'+objname).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-stopped");}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7020; column: 422;  :: '+v);console.log("Error on ended playing sound! -> "+e.message);}},onSoundPlayerSendPercentHeard:function(shouldrepeat,edition_object_id,mp3title){var audioObj=$('#snd'+edition_object_id.toString()+'inner')[0];if(audioObj!=null)
{var percentage_heared=audioObj.currentTime / audioObj.duration;if(!isNaN(percentage_heared))
{var statDataObj={category:'Audio',action:'playback_percent',page_id:window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage).id,label:mp3title,duration:audioObj.duration,current_time:audioObj.currentTime,percent:Math.round(percentage_heared*100),edition_object_id:edition_object_id};window.stats.event('Audio','playback_percent',statDataObj,Math.round(percentage_heared*100));}
window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;}},stopPlayingPlayer:function(evnt){var animobjElemId=evnt.target.id;var objname=evnt.target.id.replace('anim','inner');var objElem=$('#'+objname)[0];var elemObj={title:evnt.target.title};var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobjPGS!=null)
{if((currobjPGS.pagenumber==window.ide.currentPage)||(((currobjPGS.leftPage==window.ide.currentPage)||(currobjPGS.rightPage==window.ide.currentPage)))&&(window.ide.orientIsBookMode))
{for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.dividinner==animobjElemId)
{elemObj=currsndobj;}}}}
{if(typeof(currsndobj)=='undefined')
{if((window.ide.orientIsBookMode))
{currobjPGS=window.f.findObjFromWindowPgsByPagenumber(currobjPGS.rightPage);if(currobjPGS){for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.dividinner==animobjElemId)
{elemObj=currsndobj;}}}}}}}}
if(!objElem.paused)
{objElem.pause();$('#'+animobjElemId).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-stopped");var currPercentage=objElem.currentTime / objElem.duration;window.snd.sendStats('Stop',currobjPGS.id,elemObj.mp3Title,'',currPercentage,objElem.duration,elemObj.id);window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;window.setTimeout('if(window.ed.sndplayercontrolnumber == '+window.ed.sndplayercontrolnumber.toString()+'){window.snd.onSoundPlayerSendPercentHeard(true,"'+elemObj.id.toString()+'","'+elemObj.mp3Title.toString()+'");}',10000)}
else
{snd.stopAllOtherSoundPlayers(animobjElemId);objElem.load();objElem.play();var currPercentage=objElem.currentTime / objElem.duration;if(isNaN(currPercentage))
{currPercentage=0;}
$('#'+animobjElemId).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-playing");window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;window.snd.sendStats('Play',currobjPGS.id,elemObj.mp3Title,'',currPercentage,objElem.duration,elemObj.id);}},actionAudioWithId:function(value,action,statdataobj){var animobjElemId='snd'+value.toString()+'anim';var objElemId='snd'+value.toString()+'inner';var interactiveObj=window.f.findObjByInteractiveId(value);if(($('#'+objElemId)[0]!=null)&&($('#'+animobjElemId)[0]!=null))
{var objElem=$('#'+objElemId)[0];snd.stopAllOtherSoundPlayers(animobjElemId);var currPercentage=objElem.currentTime / objElem.duration;if(action=='play')
{objElem.load();objElem.play();$('#'+animobjElemId).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-playing");if(typeof(statdataobj)=='undefined'){statdataobj={page_id:0};}
window.snd.sendStats('Play',statdataobj.page_id,interactiveObj.mp3Title,'',currPercentage,objElem.duration,interactiveObj.id);window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;}
else if(action=='stop')
{objElem.pause();$('#'+animobjElemId).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-stopped");window.snd.sendStats('Stop',statdataobj.page_id,interactiveObj.mp3Title,'',currPercentage,objElem.duration,interactiveObj.id);window.ed.sndplayercontrolnumber=window.ed.sndplayercontrolnumber+1;window.setTimeout('if(window.ed.sndplayercontrolnumber == '+window.ed.sndplayercontrolnumber.toString()+'){window.snd.onSoundPlayerSendPercentHeard(true,"'+interactiveObj.id.toString()+'","'+interactiveObj.mp3Title.toString()+'");}',10000);}}},stopAllOtherSoundPlayers:function(animElId){try
{if(typeof(animElId)=='undefined')
{var animElId='';}
var currobj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPage);if(currobj!=null)
{if((currobj.pagenumber==window.ide.currentPage)||(((currobj.leftPage==window.ide.currentPage)&&(currobj.leftPage!=currobj.pagenumber)))&&(window.ide.orientIsBookMode))
{var currobjPGS=currobj;for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];var sound_id=currsndobj.id;var parentdivid=currsndobj.holderDivId;if(currsndobj.dividinner!=animElId)
{if($('#'+currsndobj.divid)[0]!=null)
{if(!$('#'+currsndobj.divid)[0].paused)
{$('#'+currsndobj.divid)[0].pause();$('#'+currsndobj.dividinner).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-stopped");var currPercentage=$('#'+currsndobj.divid)[0].currentTime / $('#'+currsndobj.divid)[0].duration;if(isNaN(currPercentage))
{currPercentage=0;}
window.snd.sendStats('Stop',currobjPGS.id,currsndobj.mp3Title,'',currPercentage,$('#'+currsndobj.divid)[0].duration,currsndobj.id);}}}}}}}
if(window.ide.orientIsBookMode)
{var currobj=window.f.findObjFromWindowPgsByPagenumber(currobj.rightPage);if(currobj!=null)
{if((currobj.pagenumber==window.ide.currentPage)||(((currobj.leftPage==window.ide.currentPage)&&(currobj.leftPage!=currobj.pagenumber)))&&(window.ide.orientIsBookMode))
{var currobjPGS=currobj;for(var d in currobjPGS.interactive)
{var currsndobj=currobjPGS.interactive[d];if(currsndobj.itype==window.ide.itypeaudio)
{var currsndobj=currobjPGS.interactive[d];var sound_id=currsndobj.id;var parentdivid=currsndobj.holderDivId;if(currsndobj.dividinner!=animElId)
{if($('#'+currsndobj.divid)[0]!=null)
{if(!$('#'+currsndobj.divid)[0].paused)
{$('#'+currsndobj.divid)[0].pause();$('#'+currsndobj.dividinner).removeClass("sound-player-stopped").removeClass("sound-player-playing").addClass("sound-player-stopped");}}}}}}}}}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7066; column: 313;  :: '+v);};},drawSoundPlayer:function(_page_id,sndid){var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(_page_id);for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];var sound_id=currobj.id;var parentdivid=currobj.holderDivId;if(currobj.itype==window.ide.itypeaudio)
{if(currobj.id==sndid)
{window.snd.applyEvents(currobj.dividinner,currobj.divid);$('#'+parentdivid).stop().css({opacity:0.0001,visibility:'visible'});currobj.contentloaded=true;window.ed.checkPreloadedImgs(currobjPGS.pagenumber,parentdivid,window.ide.itypeaudio);if(typeof(currobj.autoPlayMode)!='undefined')
{if(currobj.autoPlayMode.toString()=='1')
{snd.actionAudioWithId(currobj.id.toString(),'play');}}}}}},sendStats:function(action,page_id,label,label2,value,duration,edition_object_id){var statDataObj={category:'Audio',action:action,page_id:-1,label:'',label2:'',value:0};if((typeof(duration)!='undefined')&&(duration>0))
{statDataObj.duration=duration;}
if(typeof(edition_object_id)!='undefined')
{statDataObj.edition_object_id=edition_object_id;}
statDataObj.page_id=page_id;statDataObj.action=action;statDataObj.label=label;statDataObj.label2=label2;statDataObj.value=Math.round(value*100);try
{window.stats.event('Audio',action,statDataObj,0);}catch(e){var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7076; column: 185;  :: '+v);console.log("Stats Audio msg ->"+e.message);}},checkForSoundsForPage:function(_page_id){if(snd.debug)
{console.log('Load sounds for page -> '+_page_id);}
try
{var shouldload=false;var hasaudios=false;var currobjPGS=window.f.findObjFromWindowPgsByPagenumber(_page_id);for(var d in currobjPGS.interactive)
{var currobj=currobjPGS.interactive[d];var sound_id=currobj.id;var parentDivId=currobj.divid;if(currobj.itype==window.ide.itypeaudio)
{currobj.loaded=true;currobj.contentloaded=false;window.snd.drawSoundPlayer(_page_id,currobj.id);}}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7082; column: 126;  :: '+v);console.log('ERROR While loading sounds -> '+e.message);}}};window.snd=snd;})();
;
edPageDragStarted=function(){$(document).trigger("edPageDragStarted",window.ide.currentPage);}
edPageDragReturned=function(){$(document).trigger("edPageDragReturned",window.ide.currentPage);}
edPageChangeStarted=function(topage){$(document).trigger("edPageChangeStarted",window.ide.currentPage);}
edPageChangeEnded=function(){$(document).trigger("edPageChangeEnded",window.ide.currentPage);}
edStartingPageSet=function(){$(document).trigger("edStartingPageSet",window.ide.currentPage);}
edPageLoaded=function(){window.ed.already_requested_html5.push(window.ide.currentPage);if(window.eddata.appearance.edition_style=='facingpages'){window.ed.already_requested_html5.push(window.ide.currentPage+((window.ide.currentPage%2==0)?+1:-1));}
if(window.edgl.argo.indexOf('*edf_animexport_mode*')>-1){call_after_edition_loaded_dev();}
$(document).trigger("edPageLoaded",window.ide.currentPage);}
edCurrentPageZoomStart=function(){$(document).trigger("edPageZoomStart",window.ide.currentPage);}
edCurrentPageZoomEnd=function(){$(document).trigger("edPageZoomEnd",window.ide.currentPage);}
function setPlayerSize(x,y,w,h,duration){try
{$('#'+window.ide.mainStageElementParent).stop().transition({left:x.toString()+'px',top:y.toString()+'px',width:w.toString()+'px',height:h.toString()+'px'},'ease-in-out',duration,function(){window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);});}catch(e)
{$('#'+window.ide.mainStageElementParent).stop().transition({left:x.toString()+'px',top:y.toString()+'px',width:w.toString()+'px',height:h.toString()+'px'},'swing',duration,function(){window.ide.add_and_resize_pages_to_fit(window.ide.currentPage);});}}
function objectWithName(elementName)
{var chars='abcdefghijklmnoprstuvzxyqw0123456789_-';if(!elementName){return $()}
var elementName=stripAllCharsButThese(elementName.toLowerCase(),chars);var els=window.ide.currentPageObjPgs.interactive;if(!els){return $()}
var result=$();for(var i=0;i<=els.length-1;i++)
{if(!els[i].dev_name){continue}
var curName=stripAllCharsButThese(els[i].dev_name.toLowerCase(),chars)
if(curName==elementName)
{result=result.add('#'+els[i].divid);}}
return result}
function searchEdition(text,callback){}
window.ed.ed_attach_search_results_to_page=function(pageId,searchResults){if(pageId==-1)
{window.ed.removeAllSearchResults();return;}
var pgobj=window.f.findObjFromWindowPgsByObjectId(pageId);if((pgobj.pagenumber==window.ide.currentPageObjPgs.pagenumber)||((window.ide.currentPage==pgobj.leftPage)&&(window.ide.orientIsBookMode)))
{window.ed.removeAllSearchResults();window.ed.checkPageSearchResults(pgobj.pagenumber);}
else
{window.ed.goToPage(pageId);}}
;
(function(){var drawer={getBaseStructure:function(parent_index,interactive_index,into_parent_div){var currobj=window.eddata.pages[parent_index].interactive[interactive_index];var id=currobj.id;var holder_el=$('<div></div>');var css={'z-index':interactive_index,top:currobj.y,left:currobj.x,width:currobj.w,height:currobj.h};holder_el.attr('id',currobj.itype+id).attr('name',currobj.itype+id).addClass('gpuAcc').addClass('ed-'+currobj.itype).css(css);return holder_el;},getGeneralCss:function(currobj){var background_rgb=window.f.hexToRgb(currobj.fill_color);var border_rgb=window.f.hexToRgb(currobj.border_color);var fill_opacity=parseInt(currobj.fill_opacity)/ 100;var border_opacity=parseInt(currobj.border_opacity)/100;var result={'background-color':'rgba('+background_rgb.r+','+background_rgb.g+','+background_rgb.b+','+fill_opacity+')','border-color':'rgba('+border_rgb.r+','+border_rgb.g+','+border_rgb.b+','+border_opacity+')','border-width':currobj.border_width,'border-style':'solid','border-radius':currobj.border_radius};return result;},drawSoundCloud:function(parent_index,interactive_index,into_parent_div){var src_html=ed_soundcloud.get_desktop_soundcloud_html(parent_index,interactive_index,into_parent_div);return src_html;},drawIframe:function(parent_index,interactive_index,into_parent_div){var src_html=ed_iframe.get_iframe_html(parent_index,interactive_index,into_parent_div);return src_html;},drawThreesixty:function(parent_index,interactive_index,into_parent_div){var src_html=edThreesixty.getDiv(parent_index,interactive_index,into_parent_div);return src_html;},drawCode:function(parent_index,interactive_index,into_parent_div){var src_html=ed_code.getCodeHtml(parent_index,interactive_index,into_parent_div);return src_html;},drawGallery:function(parentindex,interactiveindex,intoparentDiv){var currobj=window.eddata.pages[parentindex].interactive[interactiveindex];var gal_unique_id=currobj.id.toString();var data=window.eddata.pages[parentindex].interactive[interactiveindex];data.holderDivId='gal'+gal_unique_id;data.dividbg='gal'+gal_unique_id+'background';data.divid='gal'+gal_unique_id+'inner';data.imageindex=0;data.contentloaded=false;var center=this.getCenter(data);var returnHTML='';if(document.getElementById('gal'+gal_unique_id)==null)
{var HTML_zindex=interactiveindex;returnHTML='<div id="gal'+gal_unique_id+'" name="gal'+gal_unique_id+'" class="mainGalDiv gpuAcc imageRendering" style="position:absolute;'+'top:'+currobj.y+'px;'+'left:'+currobj.x+'px;'+'margin-left:'+center.x+'px;'+'margin-top:'+center.y+'px;'+
this.originStr(data)+'z-index:'+HTML_zindex+';display:inline;overflow:hidden;top:'+currobj.y+'px;left:'+currobj.x+'px;width:'+currobj.w+'px;height:'+currobj.h+'px;border:0px;visibility:hidden;"><div id="gal'+gal_unique_id+'background" class="backgroundImages gpuAcc imageRendering" style="width:'+currobj.w+'px;height:'+currobj.h+'px;"></div><div id="gal'+gal_unique_id+'inner" class="holderImages gpuAcc imageRendering" style="width:'+currobj.w+'px;height:'+currobj.h+'px;"></div><div id="gal'+gal_unique_id+'imagessmall" class="holderImagesSmall gpuAcc imageRendering" style="width:'+currobj.w+'px;height:'+currobj.h+'px;"></div><div id="gal'+gal_unique_id+'linkbtn" class="gallinkbutton gpuAcc imageRendering"></div><div id="gal'+gal_unique_id+'fscbtn" class="galFullscreenButton gpuAcc imageRendering"></div></div>';}
return returnHTML;},drawpscrollholder:function(intopageobj){var resvar='';if(intopageobj.ismainparalaxpage)
{var mainpholder='.edition-player';if($(mainpholder).find('.ed-pscroll-parent').length<1)
{$(document).on("edStartingPageSet",function(event,page){$('.ed-pscroll-parent').stop().css({'display':'block',opacity:0.001}).transition({'opacity':1},200,window.tlbr.tlbrDefaultEasing,function(){});});$(document).on("edPageChangeStarted",function(event,page){$('.ed-pscroll-parent').remove();});window.ed.calculatemaxscrolly();$('.ed-pscroll-parent').remove();resvar+='<div class="ed-additional-hide-element ed-pscroll-parent pscrollholder"><div class="ed-pscroll-child pscrolldragger"><div class="ed-pscroll-dragger pinnerdragger"></div></div></div>';$(mainpholder).append(resvar);if($('.ed-pscroll-parent').css('display')=='none')
{$('.ed-pscroll-parent').stop().css({'display':'block',opacity:0.001}).transition({'opacity':1},200,window.tlbr.tlbrDefaultEasing,function(){});}
if(window.eddata.appearance.subpage_indicator_color!='')
{$('.ed-pscroll-parent').css({'background-color':window.eddata.appearance.subpage_indicator_color});$('.ed-pscroll-dragger').css({'background-color':window.eddata.appearance.subpage_indicator_active_color});}
$(".ed-pscroll-child").draggable({containment:".ed-pscroll-parent",axis:"y",start:function(){},drag:function(){var percent=window.ed.getcurrentdragpercent(this);window.ide.paralaxBufferActivePageScroll=0;window.ide.paralaxScrollY=-(ed.paralaxmaxscrolly*percent);window.ide.isparalaxbufferactivated=false;window.ide.handleMovingPages(0,1,true,0,1,true);},stop:function(){}});try
{}catch(e){}}}},drawtextblock:function(parentindex,interactiveindex,intoparentDiv){var currobj=window.eddata.pages[parentindex].interactive[interactiveindex];var txtbox_unique_id=currobj.id.toString();var returnHTML='';var center=this.getCenter(currobj);if((document.getElementById('textblock'+txtbox_unique_id)==null)&&(currobj.devparam.indexOf('*notonipad*')<1)&&(currobj.devparam.indexOf('*notonhtml5*')<1))
{window.eddata.pages[parentindex].interactive[interactiveindex].isAlreadySentStats=false;window.eddata.pages[parentindex].interactive[interactiveindex].holderDivId='textblock'+txtbox_unique_id;window.eddata.pages[parentindex].interactive[interactiveindex].divid='textblock'+txtbox_unique_id+'inner';window.eddata.pages[parentindex].interactive[interactiveindex].dividbg='textblock'+txtbox_unique_id+'background';window.eddata.pages[parentindex].interactive[interactiveindex].dividholder='textblock'+txtbox_unique_id+'inner';window.eddata.pages[parentindex].interactive[interactiveindex].iscroll=null;window.eddata.pages[parentindex].interactive[interactiveindex].contentloaded=false;var HTML_zindex=interactiveindex;returnHTML='<div id="textblock'+txtbox_unique_id+'" name="textblock'+txtbox_unique_id+'" class="mainGalDiv mainTxtBoxDiv gpuAcc imageRendering" style="'+'position:absolute;'+'z-index:'+HTML_zindex.toString()+';'+'iscroll:null;'+'display:inline;'+'overflow:hidden;'+'top:'+currobj.y+'px;'+'left:'+currobj.x+'px;'+'width:'+currobj.w+'px;'+'height:'+currobj.h+'px;'+'border:0px;'+'visibility:hidden;'+'margin-left:'+center.x+'px;'+'margin-top:'+center.y+'px;'+
this.originStr(currobj)+'"><div id="textblock'+txtbox_unique_id+'inner" class="holdertextblock gpuAcc imageRendering" style="min-width:100%;min-height:100%;"></div><div id="textblock'+txtbox_unique_id+'background" class="backgroundImages gpuAcc imageRendering" style="width:'+currobj.w.toString()+'px;height:'+currobj.h.toString()+'px;"></div></div>';}
window.eddata.pages[parentindex].interactive[interactiveindex].connected=currobj.initially_hidden;return returnHTML;},originStr:function(obj){var center=this.getCenter(obj);var value=center.percentsX+' '+center.percentsY;return''+'webkit-transform-origin:'+value+';'+'-moz-transform-origin:'+value+';'+'-ms-transform-origin:'+value+';'+'-o-transform-origin:'+value+';'+'transform-origin:'+value+';'},getCenter:function(obj)
{var result={x:0,y:0,percentsX:0,percentsY:0}
if(obj.anim_show.toLowerCase().indexOf("xcenter")>-1||obj.anim_show.toLowerCase().indexOf("ycenter")>-1){x=parseInt(obj.xcenter,10);y=parseInt(obj.ycenter,10);if(x){result.x=-Math.round(obj.w*(x/100));result.percentsX=x.toString()+"%";}
if(y){result.y=-Math.round(obj.h*(y/100));result.percentsY=y.toString()+"%";}}
return result;},drawImage:function(parentindex,interactiveindex,intoparentDiv){var currobj=window.eddata.pages[parentindex].interactive[interactiveindex];var image_unique_id=currobj.id;var objConnected=currobj.initially_hidden;var htmlObj_has_anim=true
var htmlObj_anim_show=currobj.anim_show;var htmlObj_anim_hide=currobj.anim_hide;var htmlObj_close_on_click=currobj.closeonclick==1;var htmlObj_preload=parseInt(currobj.preload)==1;var obj_dev_name=currobj.dev_name;var HTML_zindex=interactiveindex;var additionalHTMLCSS=""
var HTML_displayBox="inline"
var value_xcenter="0";var value_ycenter="0";var offsetImageLeftPercent="0%";var offsetImageTopPercent="0%";var HTML_Display='';var center=this.getCenter(currobj);var HTML_isscrollableimage=false
var HTML_scrollable=currobj.scrollable;var HTML_scrollpos=currobj.scrollpos;var HTML_defaultwidth=currobj.orig_w;var HTML_defaultheight=currobj.orig_h;if(typeof(currobj.scrollable)=='undefined')
{HTML_scrollable='';}
if(typeof(currobj.scrollpos)=='undefined')
{HTML_scrollpos='';}
var HTML_offsetx=0;var HTML_offsety=0;var HTML_scrollbarHide=false;var returnHTML='';if((HTML_scrollable!='')&&(HTML_defaultwidth>0)&&(HTML_defaultheight>0)&&(HTML_scrollpos!=''))
{if(currobj.scrollbar==0)
{HTML_scrollbarHide=true}
HTML_isscrollableimage=true
if(HTML_scrollable=="sc_vert")
{tmpratio=parseInt(HTML_defaultwidth)/parseInt(HTML_defaultheight);setImgWidth=currobj.w;setImgHeight=Math.round(setImgWidth/tmpratio);HTML_offsetx=0;HTML_offsety=0;if(HTML_scrollpos=="tl")
{}
if(HTML_scrollpos=="cl")
{HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2))}
if(HTML_scrollpos=="bl")
{HTML_offsety==-((setImgHeight-currobj.h))}
if(HTML_scrollpos=="tc")
{}
if(HTML_scrollpos=="cc")
{HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2))}
if(HTML_scrollpos=="bc")
{HTML_offsety=-((setImgHeight-currobj.h))}
if(HTML_scrollpos=="tr")
{}
if(HTML_scrollpos=="cr")
{HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2))}
if(HTML_scrollpos=="br")
{HTML_offsety=-((setImgHeight-currobj.h))}}
if(HTML_scrollable=="sc_horz")
{tmpratio=HTML_defaultwidth/HTML_defaultheight;setImgHeight=currobj.h;setImgWidth=Math.round(currobj.h*tmpratio);HTML_offsetx=0;HTML_offsety=0;if(HTML_scrollpos=="tl")
{}
if(HTML_scrollpos=="cl")
{}
if(HTML_scrollpos=="bl")
{}
if(HTML_scrollpos=="tc")
{HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2))}
if(HTML_scrollpos=="cc")
{HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2))}
if(HTML_scrollpos=="bc")
{HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2))}
if(HTML_scrollpos=="tr")
{HTML_offsetx=-((setImgWidth-currobj.w))}
if(HTML_scrollpos=="cr")
{HTML_offsetx=-((setImgWidth-currobj.w))}
if(HTML_scrollpos=="br")
{HTML_offsetx=-((setImgWidth-currobj.w))}}
if(HTML_scrollable=="sc_both")
{setImgHeight=HTML_defaultheight;setImgWidth=HTML_defaultwidth;HTML_offsetx=0;HTML_offsety=0;if(HTML_scrollpos=="tl")
{}
if(HTML_scrollpos=="cl")
{HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2));}
if(HTML_scrollpos=="bl")
{HTML_offsety=-((setImgHeight-currobj.h));}
if(HTML_scrollpos=="tc")
{HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2));}
if(HTML_scrollpos=="cc")
{HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2));HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2));}
if(HTML_scrollpos=="bc")
{HTML_offsetx=Math.round((currobj.w/2)-(setImgWidth/2));HTML_offsety=-((setImgHeight-currobj.h));}
if(HTML_scrollpos=="tr")
{HTML_offsetx=-((setImgWidth-currobj.w));}
if(HTML_scrollpos=="cr")
{HTML_offsetx=-((setImgWidth-currobj.w));HTML_offsety=Math.round((currobj.h/2)-(setImgHeight/2));}
if(HTML_scrollpos=="br")
{HTML_offsetx=-((setImgWidth-currobj.w));HTML_offsety=-((setImgHeight-currobj.h));}}}
var HTML_Display="block"
if(currobj.preload==1)
{HTML_Display="none";}
if((currobj.preload=1)&&(currobj.connected))
{htmlObj_preload="false"}
if(currobj.dat!='')
{var dname="";window.eddata.pages[parentindex].interactive[interactiveindex].preloaded=htmlObj_preload;window.eddata.pages[parentindex].interactive[interactiveindex].connected=objConnected;window.eddata.pages[parentindex].interactive[interactiveindex].holderDivId='img'+image_unique_id.toString();window.eddata.pages[parentindex].interactive[interactiveindex].divid='img'+image_unique_id.toString();window.eddata.pages[parentindex].interactive[interactiveindex].dividimage='img'+image_unique_id.toString()+'inner';window.eddata.pages[parentindex].interactive[interactiveindex].zindex=HTML_zindex;window.eddata.pages[parentindex].interactive[interactiveindex].dividinner='img'+image_unique_id.toString()+'inner';if((currobj.dat=='xxx.png')||(currobj.dat.indexOf('xxx-fake-fix-img-tbox.png')>-1)){window.eddata.pages[parentindex].interactive[interactiveindex].src='data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==';}else{window.eddata.pages[parentindex].interactive[interactiveindex].src=currobj.dat;}
window.eddata.pages[parentindex].interactive[interactiveindex].hasAnim=true;window.eddata.pages[parentindex].interactive[interactiveindex].pageId=parentindex;window.eddata.pages[parentindex].interactive[interactiveindex].parentDivInner=intoparentDiv;window.eddata.pages[parentindex].interactive[interactiveindex].ontop=false;window.eddata.pages[parentindex].interactive[interactiveindex].isScrollableImage=HTML_isscrollableimage;window.eddata.pages[parentindex].interactive[interactiveindex].hideScrollbars=HTML_scrollbarHide;window.eddata.pages[parentindex].interactive[interactiveindex].scrollholder='img'+image_unique_id.toString()+'inner';window.eddata.pages[parentindex].interactive[interactiveindex].scrollmode=HTML_scrollable;window.eddata.pages[parentindex].interactive[interactiveindex].startScrollX=HTML_offsetx;window.eddata.pages[parentindex].interactive[interactiveindex].startScrollY=HTML_offsety;window.eddata.pages[parentindex].interactive[interactiveindex].scrollpos=HTML_scrollpos;window.eddata.pages[parentindex].interactive[interactiveindex].iscroll=null;window.eddata.pages[parentindex].interactive[interactiveindex].contentloaded=false;window.eddata.pages[parentindex].interactive[interactiveindex].iscrollid='img'+image_unique_id.toString()+'inneriscroll';if(!HTML_isscrollableimage)
{window.eddata.pages[parentindex].interactive[interactiveindex].imagesrcimg='img'+image_unique_id.toString();}
else
{window.eddata.pages[parentindex].interactive[interactiveindex].imagesrcimg='img'+image_unique_id.toString()+'scrollimage';}
var useMaskClipRect="";if(currobj.usemask==1)
{useMaskClipRect="clip:rect(0px "&currobj.w&"px "&currobj.h&"px 0px);"}
var clickThroughStyle='';if(htmlObj_close_on_click)
{clickThroughStyle=" clickthrough";}
if(window.ed.isBetaScript)
{dname=currobj.dev_name.replace(/'/g,"\'");}
var edlabel=currobj.dev_name.split("'").join('').split('"').join('');var el_name=currobj.dev_name;if(!HTML_isscrollableimage)
{var add_class_wl='';if(window.edgl.eddevp.indexOf('*wishlist*')>-1||window.edgl.eddevp.indexOf('*shopping_cart*')>-1){for(var ecai in window.eddata.pages[parentindex].interactive[interactiveindex].event_click_actions){var evt=window.eddata.pages[parentindex].interactive[interactiveindex].event_click_actions[ecai];if(evt.action=='gotourl'){if(evt.params){var wl_url=evt.params[0];if(wl_url){if(window.eddata.wishlist){if(window.eddata.wishlist[wl_url]){var pr_obj=window.eddata.wishlist[wl_url];pr_obj.url=wl_url;window.eddata.pages[parentindex].interactive[interactiveindex].wishlist_product=pr_obj;add_class_wl=' ed-wishlist-html5 ed-wishlist-visible ';}}}}}}}
var link_transition='';if(window.eddata.appearance.link_style){if(window.eddata.pages[parentindex].interactive[interactiveindex].event_click_actions){for(var ooo in window.eddata.pages[parentindex].interactive[interactiveindex].event_click_actions){link_transition=' '+window.eddata.appearance.link_style+' ';break;}}}
if(window.eddata.pages[parentindex].interactive[interactiveindex].hover_effect){link_transition=' '+window.eddata.pages[parentindex].interactive[interactiveindex].hover_effect+' ';}
returnHTML='<div id="img'+image_unique_id+'" data-edlabel="'+edlabel+'" name="img'+image_unique_id+'" class="gpuAcc imageRendering imagesDefaults '+clickThroughStyle+' noeventsonparentalleventsforchildren '+add_class_wl+link_transition+'" style="position:absolute;z-index:'+HTML_zindex+';display:'+HTML_Display+';top:'+currobj.y+'px;left:'+currobj.x+'px;width:'+currobj.w+'px;margin-left:'+center.x+'px;margin-top:'+center.y+'px;height:'+currobj.h+'px;border:0px;'+additionalHTMLCSS+';visibility:hidden;'+this.originStr(currobj)+'"><div id="img'+image_unique_id+'inner" class="gpuAcc innerImageHolder imageRendering '+add_class_wl+'" style="left:0px;top:0px;background-repeat:no-repeat;width:100%;height:100%;"  >'+dname+'<p class="reader-only-img"">'+el_name+'</p></div></div>';}
else
{returnHTML='<div id="img'+image_unique_id+'" name="img'+image_unique_id+'" class="gpuAcc imageRendering imagesDefaults" style="position:absolute;z-index:'+HTML_zindex+';display:'+HTML_Display+';top:'+currobj.y+'px;left:'+currobj.y+'px;margin-left:'+center.x+'px;margin-top:'+center.x+'px;width:'+currobj.w+'px;height:'+currobj.h+'px;border:0px;'+additionalHTMLCSS+';visibility:hidden;overflow:visible;'+this.originStr(currobj)+useMaskClipRect+'"><div id="img'+image_unique_id+'inner" style="position:absolute;display:block;left:0px;top:0px;width:'+currobj.w+'px;height:'+currobj.h+'px;overflow:hidden;"><img id="img'+image_unique_id+'scrollimage"  alt="Scrolling image" title="'+dname+'" alt="'+dname+'" class="imageRendering gpuAcc" style="position:relative;width:'+setImgWidth+'px;height:'+setImgHeight+'px;left:0px;top:0px;" /></div></div>';}}
return returnHTML;},drawVideo:function(parentindex,interactiveindex,intoparentDiv){var currobj=window.eddata.pages[parentindex].interactive[interactiveindex];var vidName=currobj.id.toString();var notExistsType=99;var returnHTML='';var htmlSrc=currobj.mp4;var videoimage=currobj.videoImage;var HTML_zindex=interactiveindex;var videoPosterBg="background-color:#000;";var videoplaybtnclass=" btn-play-mp4 ";var videotype=1;if(((typeof(htmlSrc)=='undefined')||(htmlSrc==""))&&(typeof(currobj.youtubeid)!='undefined'))
{videotype=2;}
else if(typeof(htmlSrc)=='undefined')
{videotype=notExistsType;}
if(videotype==2)
{videoplaybtnclass=" btn-play-youtube ";htmlSrc=currobj.youtubeid;}
else
{if((videoimage!='')&&(typeof(videoimage)!='undefined'))
{videoPosterBg="background-color:#000;background-image:url(\'"+videoimage+"\');";}}
var videousePoster=1;if(typeof(currobj.useposter)!='undefined')
{if((currobj.useposter=='0')&&(videotype==1))
{videoPosterBg="background-color:rgba(0,0,0,0.1);";videousePoster=0;}}
window.eddata.pages[parentindex].interactive[interactiveindex].holderDivId='video'+vidName;window.eddata.pages[parentindex].interactive[interactiveindex].divid='video'+vidName;window.eddata.pages[parentindex].interactive[interactiveindex].src=htmlSrc;window.eddata.pages[parentindex].interactive[interactiveindex].zindex=HTML_zindex;window.eddata.pages[parentindex].interactive[interactiveindex].type=videotype;window.eddata.pages[parentindex].interactive[interactiveindex].parentDivInner=intoparentDiv;window.eddata.pages[parentindex].interactive[interactiveindex].contentloaded=true;if(!window.ed_checkConnectivity()){videoplaybtnclass=" background-no-connection ";}
if(videotype!=notExistsType)
{var youtubePosterImage='';if(videotype==2)
{var videoPosterImage='https://img.youtube.com/vi/'+window.eddata.pages[parentindex].interactive[interactiveindex].youtubeid+'/hqdefault.jpg';if(window.eddata.pages[parentindex].interactive[interactiveindex].videoImage!=''&&window.eddata.pages[parentindex].interactive[interactiveindex].videoImage!=undefined)
{videoPosterImage=window.eddata.pages[parentindex].interactive[interactiveindex].videoImage;}else{window.eddata.pages[parentindex].interactive[interactiveindex].videoImage=videoPosterImage;}
youtubePosterImage='background-image:url(\''+videoPosterImage+'\');background-size:cover;background-position:center center;background-repeat:no-repeat;';}
var center=this.getCenter(currobj);returnHTML='<div id="video'+vidName+'" name="video'+vidName+'"  class="imageRenderingVideo imageRendering gpuAcc" title="Play Video" style="position:absolute;'+'top:'+currobj.y+'px;'+'left:'+currobj.x+'px;'+'margin-left:'+center.x+'px;'+'margin-top:'+center.y+'px;'+
this.originStr(currobj)+'visibility:hidden;z-index:'+HTML_zindex.toString()+';'+videoPosterBg+'overflow:hidden;display:inline;top:'+currobj.y.toString()+'px;left:'+currobj.x.toString()+'px;width:'+currobj.w.toString()+'px;height:'+currobj.h.toString()+'px;'+youtubePosterImage+'"><div style="position:relative;width:50%;height:50%;left:25%;top:25%;background-position:50% 50%;" class="imageRenderingVideoPLAY gpuAcc '+videoplaybtnclass+'"></div>';if(videotype==2)
{returnHTML+='<div style="position:relative;width:25%;height:15%;left:75%;top:35%;background-position:100% 50%;background-repeat:no-repeat;" class="imageRendering gpuAcc youtubelogoimage"></div>';}
returnHTML+='</div>';}
else
{window.eddata.pages[parentindex].interactive[interactiveindex].x=-1;window.eddata.pages[parentindex].interactive[interactiveindex].y=-1;window.eddata.pages[parentindex].interactive[interactiveindex].w=-1;window.eddata.pages[parentindex].interactive[interactiveindex].h=-1;}
return returnHTML;},drawAudio:function(parentindex,interactiveindex,intoparentDiv){var currobj=window.eddata.pages[parentindex].interactive[interactiveindex];var addhtmlclass='';var htmlElemAddHtml='';var snd_unique_id=currobj.id.toString();var innerX=0;var innerY=0;var innerW=0;var innerH=0;if(currobj.w>currobj.h)
{innerX=Math.round((currobj.w-currobj.h)/2);innerW=currobj.h;innerH=currobj.h;}
else
{innerY=Math.round((currobj.h-currobj.w)/2);innerW=currobj.w;innerH=currobj.w;}
window.eddata.pages[parentindex].interactive[interactiveindex].holderDivId='snd'+snd_unique_id.toString();window.eddata.pages[parentindex].interactive[interactiveindex].divid='snd'+snd_unique_id.toString()+'inner';window.eddata.pages[parentindex].interactive[interactiveindex].dividinner='snd'+snd_unique_id.toString()+'anim';window.eddata.pages[parentindex].interactive[interactiveindex].contentloaded=false;if(typeof(currobj.invisible)!='undefined')
{if(currobj.invisible.toString()=='1')
{addhtmlclass=' soundplayerhidden';}}
returnHTML='<div id="snd'+snd_unique_id+'" name="snd'+snd_unique_id+'" class="mainGalDiv gpuAcc imageRendering" style="position:absolute;z-index:'+interactiveindex.toString()+';display:inline;overflow:hidden;top:'+currobj.y.toString()+'px;left:'+currobj.x.toString()+'px;width:'+currobj.w.toString()+'px;height:'+currobj.h.toString()+'px;border:0px;visibility:hidden;">';returnHTML+='<audio id="snd'+snd_unique_id+'inner" '+htmlElemAddHtml+' class="audioelem" >';returnHTML+='<source src="'+currobj.mp3+'" type="audio/mpeg">';returnHTML+='Your browser does not support the audio element.';returnHTML+='</audio> ';returnHTML+='<div id="snd'+snd_unique_id+'anim" class="sound-player sound-player-stopped '+addhtmlclass+'" style="left:'+innerX.toString()+'px;top:'+innerY.toString()+'px;width:'+innerW.toString()+'px;height:'+innerH.toString()+'px;"></div>';returnHTML+='</div>';return returnHTML;},drawLink:function(divid,linkid,linkobj){var self=this;function animPosMods(currobj){var center=self.getCenter(currobj);return''+'top:'+currobj.y+'px;'+'left:'+currobj.x+'px;'+'margin-left:'+center.x+'px;'+'margin-top:'+center.y+'px;'+
self.originStr(currobj)}
var additionalStyles='';var additionalClass='';var hover_effect='';if(window.eddata.appearance.link_style){hover_effect=window.eddata.appearance.link_style;}
if(linkobj.hover_effect){hover_effect=linkobj.hover_effect;}
if(hover_effect){additionalClass+=' '+hover_effect+' ';}
var tmpArr=linkobj.linkStyle.split(',');for(var l in tmpArr)
{var crntobj=tmpArr[l];if(crntobj!='')
{if(crntobj.indexOf('nlink')>-1)
{var getstlyesarr=crntobj.split('nlink_')[1].split('-');var backgroundColorHex='';var borderColorHex='';var borderColorRgba='';for(var d in getstlyesarr)
{var currValue=getstlyesarr[d];try
{switch(parseInt(d)){case 0:backgroundColorHex='#'+currValue.toString();break;case 1:var rgbafromHex=window.f.hexToRgb(backgroundColorHex);additionalStyles+='background-color:RGBA('+rgbafromHex.r+','+rgbafromHex.g+','+rgbafromHex.b+','+(parseInt(currValue)/100).toString()+');';break;case 2:borderColorHex='#'+currValue.toString();break;case 3:var rgbafromHex=window.f.hexToRgb(borderColorHex);borderColorRgba='RGBA('+rgbafromHex.r+','+rgbafromHex.g+','+rgbafromHex.b+','+(parseInt(currValue)/100).toString()+');';break;case 4:if(borderColorRgba!='')
{additionalStyles+='border:'+currValue.toString()+'px solid '+borderColorRgba;}
break;}}catch(e)
{var v='';for(var g in epa){if(typeof(e[epa[g]])!=='undefined'){v+='; '+epa[g]+': '+ e[epa[g]];}};edexcept('try-catch-std', '  file: html5.js; line: 7268; column: 126;  :: '+v);console.log("Link with id["+linkid+"] has invalid style -> ["+crntobj+"]");}}}
if(crntobj.indexOf('nradius_')>-1)
{if(linkobj.type=='rect')
{var borderradius=crntobj.split('nradius_')[1];if(parseInt(borderradius)>0)
{additionalStyles+='border-radius:'+borderradius.toString()+'px;';}}}}}
if(linkobj.type=='ellipse')
{additionalStyles+='border-radius:50%;';}
if(linkobj.type=='poly')
{var tmpArr=linkobj.points.split('*');var polyPointsString='';var char='';for(var d in tmpArr)
{var crntobj=tmpArr[d];if(crntobj!='')
{var tmpArrPoints=crntobj.split(',');var currentPoints='';var char2='';for(var pt in tmpArrPoints)
{var currPoint=parseInt(tmpArrPoints[pt]);if(pt==0)
{currPoint=currPoint-parseInt(linkobj.x);}
else
{currPoint=currPoint-parseInt(linkobj.y);}
currentPoints+=char2+currPoint.toString();char2=',';}
polyPointsString+=char+currentPoints;char=' ';}}
additionalStyles=additionalStyles.replace('background-color','fill');additionalStyles=additionalStyles.replace('border:','stroke-width:');additionalStyles=additionalStyles.replace(' solid ',';stroke:');tmpSrcHTML='<div id="'+divid.toString()+'" class="element_holder links '+linkobj.type+additionalClass+' gpuAcc NoSelect x_clickthrough " width="'+linkobj.w+'" height="'+linkobj.h+'" style="left:'+linkobj.x+'px;top:'+linkobj.y+'px;width:'+linkobj.w+'px;height:'+linkobj.h+'px;overflow:visible;'+animPosMods(linkobj)+'opacity:0;"><svg width="'+linkobj.w+'" height="'+linkobj.h+'">';tmpSrcHTML+='  <polygon points="'+polyPointsString+'" style="'+additionalStyles+'" />';tmpSrcHTML+='</svg></div>';}
else
{var addText='';var colortext='#000000';if(typeof(linkobj.link_text)!='undefined')
{addText=linkobj.link_text;colortext=linkobj.link_text_color;}
tmpSrcHTML='<div id="'+divid.toString()+'" class="element_holder links '+linkobj.type+additionalClass+' gpuAcc NoSelect x_clickthrough" style="left:'+linkobj.x+'px;top:'+linkobj.y+'px;text-align:center;color:'+colortext+';line-height:'+linkobj.h+'px;width:'+linkobj.w+'px;height:'+linkobj.h+'px;'+additionalStyles+animPosMods(linkobj)+'opacity:0;">'+addText+'</div>';}
return tmpSrcHTML;},drawBasePageStructure:function(d){var curpage=window.eddata.pages[d];var isparalax=false;if(curpage!=null)
{if(curpage.ismainparalaxpage)
{isparalax=true;}}
var addgpuforpagesholder=' gpuAcc';if((window.initer.isIe10)||(window.initer.isIe9))
{addgpuforpagesholder='';}
var pagesholderparent_add_class='';if(curpage.blur_page){pagesholderparent_add_class+=' edition-page-blur ';}
if(curpage.background_color!=''){pagesholderparent_add_class+=' transparentPage ';}
var tmpSrcHTML='';tmpSrcHTML='<div id="iscrollholder'+d.toString()+'" class="iscrollHolder gpuAcc NoSelect" align="left"> ';if(isparalax)
{tmpSrcHTML+='<div id="mainholderparalax'+d.toString()+'" class="paralaxverticalHolder gpuAcc NoSelect" >';tmpSrcHTML+='<div id="dummparalax'+d.toString()+'" class="dummyparalaxtopoffset" ></div>';}
tmpSrcHTML+='<div id="pagesholderparent'+d.toString()+'" class="pagesHolder'+addgpuforpagesholder+pagesholderparent_add_class+' NoSelect" >';tmpSrcHTML+='<div id="pageHTMLDiv'+d.toString()+'" class="classlinksclass gpuAcc imageRendering NoSelect" style="visibility:hidden;opacity:1;position:absolute;display:block;z-index:802;overflow:visible;background-image:none;background-size:100% 100%;background-repeat:no-repeat;overflow:hidden;" align="left">';tmpSrcHTML+='<div id="pageHTMLDiv'+d.toString()+'Inner" class="gpuAcc NoSelect" style="width:'+window.eddata.head.pageWidth.toString()+'px;height:'+window.eddata.head.pageHeight.toString()+'px;overflow:visible;opacity:0;">';tmpSrcHTML+='<div id="pageHTMLDiv'+d.toString()+'Links" class="classlinksactualDivclass gpuAcc imageRendering NoSelect clickthrough" style="position:absolute;display:block;z-index:1300;overflow:visible;background-image:none;left:0px;top:0px;width:100%;height:100%;background-size:100% 100%;background-repeat:no-repeat;overflow:hidden;" align="left">';tmpSrcHTML+='</div>';tmpSrcHTML+='</div>';tmpSrcHTML+='</div>';tmpSrcHTML+='<div id="pageHTML'+d.toString()+'" style="position:absolute;overflow:visible;" align="center" class="gpuAcc NoSelect lowresdiv">';var addBgColorToCss='';if(typeof(curpage.background_color)!='undefined')
{if(curpage.background_color!='')
{if((curpage.canvas=='')||(typeof(curpage.canvas)=='undefined'))
{addBgColorToCss='background-color:'+curpage.background_color+';';}}}
if(window.ide.HTML_lock_images_instead_of_divs_lowres==1)
{tmpSrcHTML+='<img id="lowres'+d.toString()+'" alt="" class="lowres gpuAcc NoSelect imageRendering" border="0" style="position:absolute;display:block;border:0px;visibility:visible;'+addBgColorToCss+'background-image:url(\''+window.ed.getThumbToLoad(window.eddata.pages[d])+'\');" />';}
else
{tmpSrcHTML+='<div id="lowres'+d.toString()+'" class="lowres gpuAcc NoSelect imageRendering" style="position:absolute;display:block;border:0px;visibility:visible;'+addBgColorToCss+'background-image:url(\''+window.ed.getThumbToLoad(window.eddata.pages[d])+'\');"></div>';}
tmpSrcHTML+='</div>';if(isparalax)
{tmpSrcHTML+='</div>';}
tmpSrcHTML+='</div>';tmpSrcHTML+='</div>';return tmpSrcHTML;}};window.drawer=drawer;})();
;
﻿(function(jQuery){function getStyle(elem,name){return(elem.currentStyle&&elem.currentStyle[name])||elem.style[name];}
function getClip(elem){var cssClip=$(elem).css('clip')||'';if(!cssClip){var pieces={top:getStyle(elem,'clipTop'),right:getStyle(elem,'clipRight'),bottom:getStyle(elem,'clipBottom'),left:getStyle(elem,'clipLeft')};if(pieces.top&&pieces.right&&pieces.bottom&&pieces.left){cssClip='rect('+pieces.top+' '+pieces.right+' '+pieces.bottom+' '+pieces.left+')';}}
return cssClip.replace(/,/g,' ');}
jQuery.fx.step.clip=function(fx){if(fx.pos===0){var cRE=/rect\(([0-9\.\-]{1,})(px|em)[,]?\s+([0-9\.\-]{1,})(px|em)[,]?\s+([0-9\.\-]{1,})(px|em)[,]?\s+([0-9\.\-]{1,})(px|em)\)/;fx.start=cRE.exec(getClip(fx.elem));if(typeof fx.end==='string'){fx.end=cRE.exec(fx.end.replace(/,/g,' '));}}
if(fx.start&&fx.end){var sarr=new Array(),earr=new Array(),spos=fx.start.length,epos=fx.end.length,emOffset=fx.start[ss+1]=='em'?(parseInt($(fx.elem).css('fontSize'))*1.333*parseInt(fx.start[ss])):1;for(var ss=1;ss<spos;ss+=2){sarr.push(parseInt(emOffset*fx.start[ss]));}
for(var es=1;es<epos;es+=2){earr.push(parseInt(emOffset*fx.end[es]));}
fx.elem.style.clip='rect('+
parseInt((fx.pos*(earr[0]-sarr[0]))+sarr[0])+'px '+
parseInt((fx.pos*(earr[1]-sarr[1]))+sarr[1])+'px '+
parseInt((fx.pos*(earr[2]-sarr[2]))+sarr[2])+'px '+
parseInt((fx.pos*(earr[3]-sarr[3]))+sarr[3])+'px)';}}})(jQuery);var anim_global_nm_trans="webkit";var str_webkitTransitionEnd="webkit"+"TransitionEnd";var str_webkitTransition="webkit"+"Transition";var str_webkitTransform="webkit"+"Transform";var str_webkitTransformOrigin="webkit"+"TransformOrigin";var hide_Q="hide";var show_Q="show";var visible_Q="visible";var hidden_Q="hidden";var ena_Q="1"
var nula_Q="0"
var empty_Q=""
var to_Q="to"
var set_Q="set"
var from_Q="from"
var number_Q="number"
var operator_Q="operator"

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT animstr */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT param_name */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT lower_case_s_val */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT animstr */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT param_name */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT def_val */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT replace_obj */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT calc_val */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT prm_info */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT curr_obj */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT curr_img */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT xset */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT yset */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT alphaset */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT zoomset */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT rotateset */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT n_init_v */
n_init_v=-123573;anim_parent_div_id=empty_Q;function trim_Q(str){if(!str){return("");}
return str.replace(/^\s+|\s+$/g,'');};function errorFireAnimEnd(msg){}
function animBeforeGoNextPage(){for(var curr_id in anim_objects){var curr_obj=anim_objects[curr_id];if(curr_obj){var curr_img=document.getElementById(curr_obj.divid);if(curr_obj.anim_timer){clearTimeout(curr_obj.anim_timer);curr_obj.anim_timer=false;}
if(curr_obj.animcheck_timer){clearTimeout(curr_obj.animcheck_timer);curr_obj.animcheck_timer=false;}
if(curr_img){curr_img.removeEventListener(str_webkitTransitionEnd,onCustomAnimEndSys_Q);curr_img.style[str_webkitTransition]='';curr_img.style[str_webkitTransform]='';curr_img.style.opacity='0';}}}}

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT anim_timer */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT animcheck_timer */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT prnt */
function parentAnimShowFunc(hideS_Q){var prnt=document.getElementById(anim_parent_div_id);if(prnt){if(hideS_Q){prnt.style.visibility=hidden_Q;prnt.style.opacity=nula_Q;}else{if(prnt.style.visibility!=visible_Q)
{prnt.style.visibility=visible_Q;window.setTimeout('document.getElementById("'+anim_parent_div_id+'").style.opacity = "1";',100);}}}}

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT msgg */
function StrToIntDef_Q(s,def_int){var ret_val=parseInt(s+"",10);if(isNaN(ret_val)){ret_val=def_int;}
return(ret_val);}
function getTextBetween_Q(txt_Q,pred_Q,po_Q){var zac_Q=txt_Q.indexOf(pred_Q);if(zac_Q<0){return(empty_Q)}
var kon_Q=txt_Q.indexOf(po_Q,zac_Q+pred_Q.length);if(kon_Q<0){return(empty_Q)}
return(txt_Q.substr(zac_Q+pred_Q.length,kon_Q-(zac_Q+pred_Q.length)))}
function replaceAll(strorig_Q,strfrom_Q,strto_Q)
{return strorig_Q.replace(new RegExp(strfrom_Q.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),("g")),(typeof(strto_Q)=="string")?strto_Q.replace(/\$/g,"$$$$"):strto_Q);}

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT lower_case_s_val */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT ret_val */
function getStrValueFromAnimStr_Q(animstr,param_name,lower_case_s_val){var ret_val=getTextBetween_Q("$"+animstr+"$","$"+param_name+"=","$");if(!(typeof lower_case_s_val=="undefined")){if(lower_case_s_val==true){ret_val=ret_val.toLowerCase();}}
return(ret_val);}

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT calc_val */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT def_val */
function getNumValueFromAnimStr_Q(animstr,param_name,def_val,replace_obj){if(param_name==empty_Q){var sval=animstr;}else{var sval=getTextBetween_Q("$"+animstr+"$","$"+param_name+"=","$");}
sval=replace_animvar_in_aritmetic_expression_Q(sval);var calc_val=def_val;if(sval!=empty_Q){var calc_val=pa_calcInfixExpression_Q(sval,replace_obj);if(isNaN(calc_val)){calc_val=def_val;}}
return(calc_val);}
function is_object_empty_Q(obj_Q){for(var o_Q in obj_Q){return(false);}return(true);}
function noValueFromNameExists_Q(animstr,var_name,repl_obj){if((n_init_v==getNumValueFromAnimStr_Q(animstr,var_name+to_Q,n_init_v,repl_obj))&&(n_init_v==getNumValueFromAnimStr_Q(animstr,var_name+set_Q,n_init_v,repl_obj))&&(n_init_v==getNumValueFromAnimStr_Q(animstr,var_name+from_Q,n_init_v,repl_obj)))
{return(true);}else{return(false);}}

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT animstr */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT var_name */

/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT repl_obj */
function getFromValueIfOnlyExists_Q(animstr,var_name,repl_obj){var ret_val=n_init_v;if((n_init_v==getNumValueFromAnimStr_Q(animstr,var_name+set_Q,n_init_v,repl_obj)))
{ret_val=getNumValueFromAnimStr_Q(animstr,var_name+from_Q,n_init_v,repl_obj);}
return(ret_val);}
function doSet_Vals_Q(prm_info,curr_obj,curr_img,xset,yset,alphaset,zoomset,rotateset){return;var anim_alpha=curr_obj.calpha;var anim_x=curr_obj.cx;var anim_y=curr_obj.cy;var anim_zoom=curr_obj.czoom;var anim_rotation=curr_obj.crotate;if(prm_info=="step0"){if(n_init_v!=alphaset){anim_alpha=alphaset;}
if(n_init_v!=xset){anim_x=xset;}
if(n_init_v!=yset){anim_y=yset;}
if(n_init_v!=zoomset){anim_zoom=zoomset;}
if(n_init_v!=rotateset){anim_rotation=rotateset;}
var zoom_str=((anim_zoom/100)+empty_Q).replace(",",".");var strTransform=window.ed.translateZFunct+" "+window.ed.translateFunct+"("+Math.round(anim_x)+"px,"+Math.round(anim_y)+"px"+window.ed.addToTranslateFunct+") rotate("+Math.round(anim_rotation)+"deg) "+window.ed.scaleFunct+"("+zoom_str+","+zoom_str+""+window.ed.addToScaleFunct+") ";var stropacity=((anim_alpha/100)+empty_Q).replace(",",".");curr_obj.cx=anim_x;curr_obj.cy=anim_y;curr_obj.calpha=anim_alpha;curr_obj.czoom=anim_zoom;curr_obj.crotate=anim_rotation;curr_img.style[str_webkitTransition]='';curr_img.style.opacity=stropacity;curr_img.style[str_webkitTransform]=strTransform;}}
function animobj_init(animobj_id){var curr_obj=anim_objects[animobj_id];curr_obj.anim_ind=0;curr_obj.anim_name=show_Q;curr_obj.set_step=false;if(curr_obj.anim_timer){clearTimeout(curr_obj.anim_timer);}
curr_obj.anim_timer=false;curr_obj.animcheck_timer=false;if(curr_obj.anim_show==empty_Q){curr_obj.anim_show="delay=0.1#alphafrom=0$time=0.5";}
if((curr_obj.anim_hide==empty_Q)||(curr_obj.anim_hide=="stop")){curr_obj.anim_hide="#alphato=0$time=1.0#visibleset=0";}
curr_obj.anim_hide=replaceAll(curr_obj.anim_hide,"$initvalues=1","$xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1");curr_obj.anim_hide=replaceAll(curr_obj.anim_hide,"initvalues=1$","xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1$");curr_obj.anim_hide=replaceAll(curr_obj.anim_hide,"#initvalues=1","#xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1");curr_obj.anim_hide=replaceAll(curr_obj.anim_hide,"initvalues=1#","xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1#");curr_obj.anim_show=replaceAll(curr_obj.anim_show,"$initvalues=1","$xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1");curr_obj.anim_show=replaceAll(curr_obj.anim_show,"initvalues=1$","xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1$");curr_obj.anim_show=replaceAll(curr_obj.anim_show,"#initvalues=1","#xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1");curr_obj.anim_show=replaceAll(curr_obj.anim_show,"initvalues=1#","xset=x$yset=y$alphaset=100$zoomset=100$rotateset=0$visibleset=1#");if(curr_obj.anim_show.indexOf("#")==-1){curr_obj.anim_show=curr_obj.anim_show+"#";}
if(curr_obj.anim_hide.indexOf("#")==-1){curr_obj.anim_hide=curr_obj.anim_hide+"#";}
curr_obj.anim_show_array=curr_obj.anim_show.split("#");curr_obj.anim_hide_array=curr_obj.anim_hide.split("#");curr_obj.xcenter=0;curr_obj.ycenter=0;curr_obj.force_stop_anim=false;/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT repl_obj1 */
var repl_obj1={x:curr_obj.x,y:curr_obj.y,PW:window.ed.stageWidth,PH:window.ed.stageHeight,w:curr_obj.w,h:curr_obj.h};curr_obj.xcenter=Math.round(getNumValueFromAnimStr_Q(curr_obj.anim_show_array[0],"xcenter",0,repl_obj1));curr_obj.ycenter=Math.round(getNumValueFromAnimStr_Q(curr_obj.anim_show_array[0],"ycenter",0,repl_obj1));curr_obj.dx=curr_obj.x+curr_obj.xcenter;curr_obj.dy=curr_obj.y+curr_obj.ycenter;curr_obj.dalpha=100;curr_obj.dzoom=100;curr_obj.drotate=0;curr_obj.dxmask=0;curr_obj.dymask=0;curr_obj.cx=curr_obj.x+curr_obj.xcenter;curr_obj.cy=curr_obj.y+curr_obj.ycenter;curr_obj.calpha=100;curr_obj.czoom=100;curr_obj.crotate=0;curr_obj.crotate=0;curr_obj.cxmask=0;curr_obj.cymask=0;curr_obj.use_mask=(curr_obj.anim_show.indexOf("xmask")>-1)||(curr_obj.anim_show.indexOf("ymask")>-1)||(curr_obj.anim_hide.indexOf("xmask")>-1)||(curr_obj.anim_hide.indexOf("ymask")>-1);curr_obj.need_hiddenno_set=true;curr_obj.inited_obj=true;}
function processMessages(millis)
{var date=new Date();var curDate=null;do{curDate=new Date();}
while(curDate-date<millis);}
function pa_getOperatorPriority_Q(operator_Q){if((operator_Q=="+")||(operator_Q=="-")){return(1);}
if((operator_Q=="*")||(operator_Q=="/")){return(2);}
return(-1);}
function pa_calcSimpleAritmetic_Q(num1_Q,num2_Q,oper_Q){if(oper_Q=="-"){return(num1_Q-num2_Q);}
if(oper_Q=="+"){return(num1_Q+num2_Q);}
if(oper_Q=="*"){return(num1_Q*num2_Q);}
if(oper_Q=="/"){return(num1_Q/num2_Q);}}
function pa_calcInfixExpression_Q(expr_Q,replace_array_Q){expr_Q=replaceAll(expr_Q,"*"," * ");expr_Q=replaceAll(expr_Q,"/"," / ");expr_Q=replaceAll(expr_Q,"+"," + ");expr_Q=replaceAll(expr_Q,"-"," - ");expr_Q=" "+expr_Q+" "
if(replace_array_Q){for(var nm in replace_array_Q){expr_Q=replaceAll(expr_Q,nm,replace_array_Q[nm]+empty_Q);}}
var curr_str_Q=empty_Q;var item_array_Q=new Array();var prvi_minus_Q=false;for(var i=0;i<expr_Q.length;i++){var ch=expr_Q.charAt(i);if(ch!=" "){curr_str_Q=curr_str_Q+ch}else{if(curr_str_Q!=empty_Q){if(item_array_Q.length==0){if(pa_getOperatorPriority_Q(curr_str_Q)!=-1){if(curr_str_Q=="-"){prvi_minus_Q=true;}}else{var vrednost=parseFloat(curr_str_Q);if(prvi_minus_Q){vrednost=-vrednost;}
item_array_Q.push({tip:number_Q,val:vrednost});}}else{if(pa_getOperatorPriority_Q(curr_str_Q)!=-1){item_array_Q.push({tip:operator_Q,val:curr_str_Q});}else{item_array_Q.push({tip:number_Q,val:parseFloat(curr_str_Q)});}}}
curr_str_Q=empty_Q;}}
var numstack_array_Q=new Array();var operstack_array_Q=new Array();for(var i=0;i<item_array_Q.length;i++){if(item_array_Q[i].tip==number_Q){numstack_array_Q.push(item_array_Q[i].val);}else if(item_array_Q[i].tip==operator_Q){if((operstack_array_Q.length>0)&&(pa_getOperatorPriority_Q(item_array_Q[i].val)<=pa_getOperatorPriority_Q(operstack_array_Q[operstack_array_Q.length-1]))){var oper=operstack_array_Q.pop();var num1=numstack_array_Q.pop();var num2=numstack_array_Q.pop();var res=pa_calcSimpleAritmetic_Q(num2,num1,oper)
numstack_array_Q.push(res);operstack_array_Q.push(item_array_Q[i].val);}else{operstack_array_Q.push(item_array_Q[i].val);}}}
while(operstack_array_Q.length>0){var oper=operstack_array_Q.pop();var num1=numstack_array_Q.pop();var num2=numstack_array_Q.pop();var res=pa_calcSimpleAritmetic_Q(num2,num1,oper)
numstack_array_Q.push(res);}
return(numstack_array_Q[0]);}
function animation_global_int_var_set(varname_Q,varvalue_Q){window.ed.animation_global_int_vars[varname_Q]=parseInt(varvalue_Q+"",10);}
function animation_local_int_var_set(varname_Q,varvalue_Q){window.ed.animation_local_int_vars[varname_Q]=parseInt(varvalue_Q+"",10);}
function animation_global_int_var_get(varname_Q){if(typeof(window.ed.animation_global_int_vars[varname_Q])=='undefined'){return(0);}
return window.ed.animation_global_int_vars[varname_Q];}
function animation_local_int_var_get(varname_Q){if(typeof(window.ed.animation_local_int_vars[varname_Q])=='undefined'){return(0);}
return window.ed.animation_local_int_vars[varname_Q];}
function animation_int_vars_printall(){var firstv=true;var contain_elements=false;for(var i in window.ed.animation_global_int_vars){if(firstv){}
firstv=false;contain_elements=true;}
if(contain_elements){}
var firstv=true;var contain_elements=false;for(var i in window.ed.animation_local_int_vars){if(firstv){}
firstv=false;contain_elements=true;}
if(contain_elements){}}
function get_animvar_text(expr,sstr){var varnamevars="abcdefghijklmnoprstuvzyxwqABCDEFGHIJKLMNOPRSTUVZXYQW0123456789";expr=expr+" ";var p=expr.indexOf(sstr);if(p<0){return("");}
p=p+sstr.length;var i=0;while(i<50){i++;if(varnamevars.indexOf(expr.substr(i+p,1))<0){break;}}
var res=expr.substr(p,i)
return res;}
function replace_animvar_in_aritmetic_expression_Q(cexpr){if(cexpr.indexOf("intvar_")<0){return(cexpr);}
var cntt=0;while(cntt<20){cntt++;var found=false;var res=get_animvar_text(cexpr,"glintvar_");if(res!=""){found=true;cexpr=replaceAll(cexpr,"glintvar_"+res,animation_global_int_var_get(res));}
if(!found){break;}}
var cntt=0;while(cntt<20){cntt++;var found=false;var res=get_animvar_text(cexpr,"intvar_");if(res!=""){found=true;cexpr=replaceAll(cexpr,"intvar_"+res,animation_local_int_var_get(res));}
if(!found){break;}}
return(cexpr);}
function calc_anim_one_intvar(calc_expr,repl_obj){calc_expr=calc_expr+"=";var arr=calc_expr.split("=",2);var cvar=arr[0];var cexpr=arr[1];var cexpr_res=0;var cexpr_res=Math.round(getNumValueFromAnimStr_Q(cexpr,"",0,repl_obj));if(cvar.indexOf("glintvar_")==0){animation_global_int_var_set(cvar.substr(9),cexpr_res);}
if(cvar.indexOf("intvar_")==0){animation_local_int_var_set(cvar.substr(7),cexpr_res);}}
function calc_anim_intvars(animstr,repl_obj){animstr="$"+animstr+"$";var cntt=0;while(cntt<20){cntt++;var found=false;var res=getTextBetween_Q(animstr,"$intvar_","$");var res2=getTextBetween_Q(animstr,"$glintvar_","$");if((res!="")&&(res2!="")){if(animstr.indexOf(res)>animstr.indexOf(res2)){res="";}
if(animstr.indexOf(res2)>animstr.indexOf(res)){res2="";}}
if(res!=""){found=true;animstr=replaceAll(animstr,"intvar_"+res,"X");calc_anim_one_intvar("intvar_"+res,repl_obj);}
if(res2!=""){found=true;animstr=replaceAll(animstr,"glintvar_"+res2,"X");calc_anim_one_intvar("glintvar_"+res2,repl_obj);}
if(!found){break;}}}
function calc_if_pogoj_true(pogoj_str,repl_obj){if((pogoj_str.substr(0,1)=="(")&&(pogoj_str.substr(pogoj_str.length-1,1)==")")){pogoj_str=pogoj_str.substr(1,pogoj_str.length-2);}
var arr=false;var oper="";if(pogoj_str.indexOf("<=")>-1){arr=pogoj_str.split("<=",2);oper="<=";}else if(pogoj_str.indexOf(">=")>-1){arr=pogoj_str.split(">=",2);oper=">=";}else if(pogoj_str.indexOf("<>")>-1){arr=pogoj_str.split("<>",2);oper="<>";}else if(pogoj_str.indexOf("!=")>-1){arr=pogoj_str.split("!=",2);oper="!=";}else if(pogoj_str.indexOf("==")>-1){arr=pogoj_str.split("==",2);oper="==";}else if(pogoj_str.indexOf("=")>-1){arr=pogoj_str.split("=",2);oper="=";}else if(pogoj_str.indexOf("<")>-1){arr=pogoj_str.split("<",2);oper="<";}else if(pogoj_str.indexOf(">")>-1){arr=pogoj_str.split(">",2);oper=">";}else{pogoj_str=pogoj_str+">0"
oper=">";arr=pogoj_str.split(">",2);}
var v1=getNumValueFromAnimStr_Q(arr[0],"",0,repl_obj)
var v2=getNumValueFromAnimStr_Q(arr[1],"",0,repl_obj)
var res_true=false;switch(oper){case"<=":res_true=(v1<=v2);break;case">=":res_true=(v1>=v2);break;case"<>":res_true=(v1!=v2);break;case"!=":res_true=(v1!=v2);break;case"==":res_true=(v1==v2);break;case"=":res_true=(v1==v2);break;case"<":res_true=(v1<v2);break;case">":res_true=(v1>v2);break;}
return res_true;}
function gotoPageByStrCommand(goto_page_str_Q){switch(goto_page_str_Q){case"":break;case"gotonextpage":case"next":window.ed.goToPage(window.ed.nextPage);return(true);break;case"prev":case"previous":case"back":case"gotopreviouspage":window.ed.goToPage(window.ed.previousPage);return(true);break;case"main":case"currmain":case"gotocurrentmainpage":window.ed.goToPage(window.ed.currentMainPage);return(true);break;case"nextmain":case"gotonextmainpage":window.ed.goToPage(window.ed.nextMainPage);return(true);break;case"prevmain":case"gotopreviousmainpage":window.ed.goToPage(window.ed.previousMainPage);return(true);break;}
return(false);}
function hideAllConnectedImages_Q(sel_objid,hide_list,hide_index,ignore_hide_list){console.log("hideAllConnectedImages_Q selid:"+sel_objid+" -- "+hide_list+"   ind novi"+hide_index+"  --  ignore hide list "+ignore_hide_list)
if(!hide_list){hide_list="";}
if(hide_list!=""){hide_list=","+hide_list+",";}
if(!ignore_hide_list){ignore_hide_list="";}
if(ignore_hide_list!=""){ignore_hide_list=","+ignore_hide_list+",";}
for(var curr_id in anim_objects){var curr_obj=anim_objects[curr_id];var curr_img=document.getElementById(curr_obj.divid);if((curr_img)&&(curr_obj.connected)){if((curr_obj.connected)||((hide_list!="")&&(hide_list.indexOf(","+curr_id+",")>-1))){if((curr_id+""!=sel_objid+"")&&((hide_list=="")||(hide_list.indexOf(","+curr_id+",")>-1))&&((ignore_hide_list=="")||(ignore_hide_list.indexOf(","+curr_id+",")==-1))){if(($('#'+curr_obj.divid).css('opacity')>0.0001)&&($('#'+curr_obj.divid).css("visibility")=="visible")){ObjGoAnim(false,false,curr_id,hide_index,"hide",-1,false,'');}else{$('#'+curr_obj.divid).css({"visibility":"hidden","display":"none"});curr_obj.need_hiddenno_set=true;}}}}}}
;
function getJqueryPropForAnimProp_Q(anim_prop){if(anim_prop=="alpha"){return("opacity");}
if(anim_prop=="x"){return("left");}
if(anim_prop=="y"){return("top");}
if(anim_prop=="zoom"){return("scale");}
if(anim_prop=="rotate"){return("rotate");}
if(anim_prop=="xmask"){return("xmask");}
if(anim_prop=="ymask"){return("ymask");}
return("");}
function onAnimEndEventV2(animobj_id,check_anim_ind,check_anim_name){if(window.edgl.argo.indexOf('*billy*')>-1){console.log(" onAnimEndEventV2 "+animobj_id+", tmpindFrom:"+check_anim_ind+" , tmpnameFrom:"+check_anim_name);}
if(isNaN(parseInt(animobj_id+"",10))){return;}
var curr_obj=false;if(anim_objects){var curr_obj=anim_objects[animobj_id];}
if(curr_obj&&((typeof curr_obj==='object'))){if(curr_obj.id){if((check_anim_ind+""==curr_obj.anim_ind+"")&&(curr_obj.anim_name==check_anim_name)){curr_obj.anim_ind++;ObjGoAnim_internal(curr_obj.id,curr_obj.anim_ind,curr_obj.anim_name);}else{if(window.ed.debugAnimations){console.log(" onAnimEndEventV2 - NO GO NEXT DIFF "+animobj_id+", ind:"+curr_obj.anim_ind+" , animname:"+curr_obj.anim_name);}}}}else{}}
function onCustomAnimTimer(animobj_id){var more_exceptions=false;if(window.edgl.argo.indexOf('*billy*')>-1){more_exceptions=true;}
if(isNaN(parseInt(animobj_id+"",10))){if(more_exceptions){edexcept('animations',"ERR onCustomAnimTimer animobj_id not int "+animobj_id);}
return;}
var curr_obj=false;if(anim_objects){var curr_obj=anim_objects[animobj_id];}
if(curr_obj&&((typeof curr_obj==='object'))){if(curr_obj.anim_timer){clearTimeout(curr_obj.anim_timer);curr_obj.anim_timer=false;}
if(curr_obj.id){if(!curr_obj.set_step){curr_obj.anim_ind++;}
ObjGoAnim_internal(curr_obj.id,curr_obj.anim_ind,curr_obj.anim_name);}}else{}}
function imgVisibleForLinkCallBack(animobj_id){return;if(typeof(anim_objects[animobj_id])==='object'){var curr_obj=anim_objects[animobj_id];if(curr_obj){curr_obj.imgvisible_forlink=(($('#'+curr_obj.animDivId).css('opacity')>0.0001)&&($('#'+curr_obj.animDivId).css("visibility")=="visible"));}}}
function IsImgVisibleForLink_Anim(animobj_id){var res=false;if(typeof(anim_objects[animobj_id])==='object'){var curr_obj=anim_objects[animobj_id];if(curr_obj){res=(($('#'+curr_obj.animDivId).css('opacity')>0.0001)&&($('#'+curr_obj.animDivId).css("visibility")=="visible"));}}
return res;}
function InitAllLinks_Q(){var cpages_interactive=[];var cpg=window.ide.currentPage;if(typeof(window.ide.currentPageObjPgs.interactive)!="undefined"){cpages_interactive.push(window.ide.currentPageObjPgs.interactive);}
if(window.ide.orientIsBookMode){var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(tmp_obj)
{cpages_interactive.push(tmp_obj.interactive);}}
var element_div_for_ids={};for(var pp=0;pp<cpages_interactive.length;pp++){for(var d=0;d<cpages_interactive[pp].length;d++){var curr_obj=cpages_interactive[pp][d];if(curr_obj){element_div_for_ids[curr_obj.id]=curr_obj.animDivId;}}}
for(var pp=0;pp<cpages_interactive.length;pp++){for(var d=0;d<cpages_interactive[pp].length;d++){var curr_obj=cpages_interactive[pp][d];if(curr_obj){if(curr_obj.activeOnObjId){var obj_active=false;if(element_div_for_ids[curr_obj.activeOnObjId]){var jqobj=$('#'+element_div_for_ids[curr_obj.activeOnObjId]);obj_active=((jqobj.css('opacity')>0.0001)&&(jqobj.css("visibility")=="visible")&&(jqobj.css("display")!="none"));}
if(!obj_active){$('#'+curr_obj.animDivId).toggleClass('hidden',true);if(window.edgl.argo.indexOf('*billy*')>-1){console.log('initial deactivation of link is:'+curr_obj.id)}}}}}}}
function hiddenClassAnimFunc(animobj_id,toParams,setParams){toParams=toParams||{};setParams=setParams||{};if(typeof(anim_objects[animobj_id])==='object'){var curr_obj=anim_objects[animobj_id];if(curr_obj){var image=$('#'+curr_obj.animDivId);var opacitiy=image.css('opacity');var visibility=image.css("visibility");var imgvisible_forlink=((opacitiy>0.0001)&&(visibility=="visible"));if(typeof(curr_obj.active_only_links)!=='undefined'){for(var l in curr_obj.active_only_links){var link=curr_obj.active_only_links[l];var jqlink=$('#'+link.animDivId);if(window.edgl.argo.indexOf('*billy*')>-1){if(jqlink.hasClass('hidden')==imgvisible_forlink){console.log('SPREMEMBA HIDDEN ZA *LINK* '+link.id+' '+(imgvisible_forlink?'visible':'hidden'));}}
jqlink.toggleClass('hidden',!imgvisible_forlink);if(window.edgl.argo.indexOf('*billy*')>-1){console.log('actonly linkid:: '+link.id+'  imgvisible_forlink:'+imgvisible_forlink);console.log(toParams);console.log(setParams);console.log('opac: '+opacitiy+' '+(opacitiy>0.0001));console.log('visib: '+visibility+' '+(visibility=="visible"));}}}
var imgvisible_forimg=imgvisible_forlink||toParams.opacity||setParams.opacity;if(window.edgl.argo.indexOf('*billy*')>-1){if(image.hasClass('hidden')==imgvisible_forimg){console.log('SPREMEMBA HIDDEN ZA SLIKO '+animobj_id+' '+(imgvisible_forimg?'visible':'hidden'));}}
image.toggleClass('hidden',!imgvisible_forimg);}}}
function htmlDecodeCustom(param){return $("<div/>").html(param).text();}
function toggleLinksTop(){var obj=document.getElementById(window.ide.currentPageObjPgs.linksDiv);if(obj){if(obj.style.zIndex>1100){obj.style.zIndex=1000;}else{obj.style.zIndex=1300;}}}
refresh_anim_arr=true;function neg_refresh_anim_arr_func(){refresh_anim_arr=!refresh_anim_arr;}
function animLog(str,extra)
{if(true){return}
if(!str||str==''){str='<empty>';}
str='anim: '+str+'';if(extra===undefined){extra=''}
var chrome=inf&&inf.is_chrome;if(chrome){str='%c '+str+'  '}
console.log(str,chrome?'background:#5D2B1DFF; color:#FF9D7AFF; padding:3px; border-top-left-radius: 20px; border-bottom-left-radius: 20px;':extra,extra)}
function ObjGoAnim_internal(animobj_id,anim_ind,anim_name){if(window.edgl.argo.indexOf('*edf_printscreen_mode*')>-1){if(window.anim10stimerend){clearTimeout(window.anim10stimerend);}
window.anim10stimerend=setTimeout(function(){call_after_load_and_anim_finished_dev('anim-tmu');},8000);}
if(window.edgl.argo.indexOf('*billy*')>-1){console.log("---------------------------------------------------------------");console.log("####### ObjGoAnim_internal "+animobj_id+", "+anim_ind+", "+anim_name);}
var more_exceptions=false;if(window.edgl.argo.indexOf('*billy*')>-1){more_exceptions=true;}
var found=false;var cpg=window.ide.currentPage;if(typeof(window.ide.currentPageObjPgs.interactive)!="undefined"){for(var d=0;d<window.ide.currentPageObjPgs.interactive.length;d++){if(window.ide.currentPageObjPgs.interactive[d].id+""==animobj_id+""){found=true;}}}
if((!found)&&(window.ide.orientIsBookMode)){var tmp_obj=window.f.findObjFromWindowPgsByPagenumber(window.ide.currentPageObjPgs.rightPage);if(tmp_obj)
{for(var d=0;d<tmp_obj.interactive.length;d++){if(tmp_obj.interactive[d].id+""==animobj_id+""){found=true;}}}}
if(!found){if(window.ed.debugAnimations){console.log("NOT NOT NOT FOUND STOP objid:"+animobj_id+" ,  pg:"+cpg);}
return;}
if(isNaN(parseInt(anim_ind+"",10))){if(more_exceptions){edexcept('animations',"ERROR anim_ind "+anim_ind);}
return;}
if(isNaN(parseInt(animobj_id+"",10))){if(more_exceptions){edexcept('animations',"ERROR animobj_id "+animobj_id);}
return;}
var _xset=n_init_v;var _yset=n_init_v;var _alphaset=n_init_v;var _zoomset=n_init_v;var _rotateset=n_init_v;if(typeof(anim_objects)==='undefined'){if(more_exceptions){edexcept('animations',"ERROR NO anim_objects "+anim_objects);}
return;}
var curr_obj=false;if(typeof(anim_objects[animobj_id])==='object'){if(anim_objects[animobj_id].inited_obj==true){curr_obj=anim_objects[animobj_id];}}
if(typeof(curr_obj.force_stop_anim)!="undefined"){if(curr_obj.force_stop_anim){}}
if(!curr_obj){if(more_exceptions){edexcept('animations',"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ERROR no curr_obj animobj_id "+animobj_id);}
return;}
if(curr_obj.animcheck_timer){clearTimeout(curr_obj.animcheck_timer);curr_obj.animcheck_timer=false;}
var curr_img=document.getElementById(curr_obj.animDivId);if(!curr_img){if(more_exceptions){edexcept('animations',"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ERROR no curr_img animobj_id "+animobj_id);}
return;}
if(curr_obj.anim_timer){clearTimeout(curr_obj.anim_timer);curr_obj.anim_timer=false;}
if(anim_name==hide_Q){var curr_anim_array=curr_obj.anim_hide_array;}else{var curr_anim_array=curr_obj.anim_show_array;}
if(curr_obj.need_hiddenno_set){window.ed.setZIndexForInteractive(curr_obj.id,"orig");}
if(anim_ind>=curr_anim_array.length){animLog('Finished',{animobj_id:animobj_id,anim_ind:anim_ind,anim_name:anim_name})
if(anim_name==hide_Q){if($('#'+curr_obj.animDivId).css("visibility")=="hidden"){$('#'+curr_obj.animDivId).css({"visibility":"hidden","display":"none"});curr_obj.need_hiddenno_set=true;window.ed.freeShowObject(animobj_id);}}
curr_obj.imgvisible_forlink=(($('#'+curr_obj.animDivId).css('opacity')>0.006)&&($('#'+curr_obj.animDivId).css("visibility")=="visible"));if(!curr_obj.imgvisible_forlink){if(curr_obj.itype==window.ide.itypevideo)
{if(ed.get(curr_obj.divid)!=null)
{if(window.ed.get('video_current'+curr_obj.divid)!=null)
{try
{window.ed.get('video_current'+curr_obj.divid).pauseVideo();}catch(e){}
try
{window.ed.get('video_current'+curr_obj.divid).pause();}catch(e){}
try
{window.ed.get('video_current'+curr_obj.divid).stop();}catch(e){}}}}}
if(window.ed[curr_obj.iscrollid]){window.ed[curr_obj.iscrollid].refresh();}
setTimeout(function(){hiddenClassAnimFunc(animobj_id,{t:1});},90);if((window.edgl.argo.indexOf('*edf_printscreen_mode*')>-1)||(window.edgl.argo.indexOf('*edf_animexport_mode*')>-1)){anim_objects[animobj_id].ontime_finished=true;if(window.edgl.argo.indexOf('*debug2*')>-1){debugger;}
var all_done=true;for(var cao in anim_objects){if(!anim_objects[cao].ontime_finished){all_done=false;break;}}
if(all_done){if(window.edgl.argo.indexOf('*edf_printscreen_mode*')>-1){call_after_load_and_anim_finished_dev('aad3');}
if(window.edgl.argo.indexOf('*edf_animexport_mode*')>-1){call_animplay_finished_dev('aad3ae');}}}
return;}
/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT curr_animstr */
var curr_animstr=curr_anim_array[anim_ind];curr_obj.imgvisible_forlink=(($('#'+curr_obj.animDivId).css('opacity')>0.0001)&&($('#'+curr_obj.animDivId).css("visibility")=="visible"));if(window.ed.isBetaScript){var alert_val_Q=getStrValueFromAnimStr_Q(curr_animstr,"alert");if(alert_val_Q!=""){if(alert_val_Q.substr(0,1)!="#"){alert("ANIM COMMAND ALERT \n"+alert_val_Q+" \n ObjGoAnim_internal objid:"+animobj_id+", ind:"+anim_ind+", name:"+anim_name+" \n animstr:"+curr_animstr);}}
var trace_val_Q=getStrValueFromAnimStr_Q(curr_animstr,"trace");if(trace_val_Q!=""){if(trace_val_Q.substr(0,1)!="#"){console.log("ANIM COMMAND TRACE \n"+trace_val_Q+" \n ObjGoAnim_internal objid:"+animobj_id+", ind:"+anim_ind+", name:"+anim_name+" \n animstr:"+curr_animstr);}}}
var repl_obj={x:curr_obj.dx,y:curr_obj.dy,PW:window.ed.stageWidth,PH:window.ed.stageHeight,w:curr_obj.w,h:curr_obj.h};var curr_alpha=curr_obj.calpha;var curr_x=curr_obj.cx;var curr_y=curr_obj.cy;var curr_zoom=curr_obj.czoom;var curr_rotation=curr_obj.crotate;var curr_xmask=curr_obj.cxmask;var curr_ymask=curr_obj.cymask;if(curr_animstr.indexOf("intvar_")>-1){calc_anim_intvars(curr_animstr,repl_obj);animation_int_vars_printall();}
if(getStrValueFromAnimStr_Q(curr_animstr,"removefromview")==ena_Q){$('#'+curr_obj.animDivId).css({"visibility":"hidden","display":"none"});curr_obj.need_hiddenno_set=true;window.ed.freeShowObject(animobj_id);setTimeout(function(){hiddenClassAnimFunc(animobj_id,{t:2});},90);return;}
if(getStrValueFromAnimStr_Q(curr_animstr,"removefromview")==nula_Q){curr_animstr=curr_animstr+"$visibleset=1$";return;}
animLog(animobj_id+': Step #'+anim_ind+' running',{params:curr_animstr,anim_name:anim_name})
var delay=0.0;if(anim_ind==0){delay=Math.round(10*getNumValueFromAnimStr_Q(curr_animstr,"delay",0,repl_obj))/10;}
var a_time=Math.round(10*getNumValueFromAnimStr_Q(curr_animstr,"time",0,repl_obj))/10;if(getStrValueFromAnimStr_Q(curr_animstr,"moveontop")==ena_Q){window.ed.setZIndexForInteractive(curr_obj.id,"top");}
if(delay>0){a_time=delay;}
var isPause=false;if(getStrValueFromAnimStr_Q(curr_animstr,"pause")==ena_Q){isPause=true;}
/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT CAB_anim_array */
var CAB_anim_array=new Array();/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT paramFrom */
/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT paramTo */
/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT paramSet */
var paramFrom;var paramTo;var paramSet;var array_vals_for_check=new Array();if(window.edgl.argo.indexOf('*edf_printscreen_mode*')>-1){if(a_time>0.3){a_time=0.3;}}
/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT array_vals_for_check */
array_vals_for_check.push({name:"alpha",init_prop:curr_obj.dalpha,curr_val:curr_alpha});array_vals_for_check.push({name:"x",init_prop:curr_obj.dx,curr_val:curr_x});array_vals_for_check.push({name:"y",init_prop:curr_obj.dy,curr_val:curr_y});array_vals_for_check.push({name:"zoom",init_prop:curr_obj.dzoom,curr_val:curr_zoom});array_vals_for_check.push({name:"rotate",init_prop:curr_obj.drotate,curr_val:curr_rotation});array_vals_for_check.push({name:"xmask",init_prop:curr_obj.dxmask,curr_val:curr_xmask});array_vals_for_check.push({name:"ymask",init_prop:curr_obj.dymask,curr_val:curr_ymask});for(var arv in array_vals_for_check){var special_set_0=false;var cp_obj=array_vals_for_check[arv];var varname=cp_obj.name;var cur_val=cp_obj.curr_val;var init_prop=cp_obj.init_prop;paramFrom=getNumValueFromAnimStr_Q(curr_animstr,varname+from_Q,n_init_v,repl_obj);paramTo=getNumValueFromAnimStr_Q(curr_animstr,varname+to_Q,n_init_v,repl_obj);paramSet=getNumValueFromAnimStr_Q(curr_animstr,varname+set_Q,n_init_v,repl_obj);if((paramSet==n_init_v)&&(paramFrom!=n_init_v)&&(paramTo!=n_init_v)){paramSet=paramFrom;}
if((paramFrom==n_init_v)&&(paramSet==n_init_v)&&(paramTo!=n_init_v)){}
if((paramFrom!=n_init_v)&&(paramTo==n_init_v)&&(paramSet==n_init_v)){if((anim_ind==1)&&(noValueFromNameExists_Q(curr_anim_array[0],varname,repl_obj))){paramTo=init_prop;}else{paramTo=cur_val;}}
if((anim_ind==0)&&(paramFrom==n_init_v)&&(paramTo==n_init_v)&&(paramSet==n_init_v)){paramSet=getFromValueIfOnlyExists_Q(curr_anim_array[1],varname,repl_obj);special_set_0=true;}
if(a_time<0.01){if(paramTo!=n_init_v){paramSet=paramTo;paramTo=n_init_v;}}
CAB_anim_array.push({p:varname,t:paramTo,s:paramSet,sset:special_set_0});}
var need_hiddenno_set=false;var vis_set=getStrValueFromAnimStr_Q(curr_animstr,"visibleset");var vis_set_jq_val="";if(vis_set!=empty_Q){if(vis_set==ena_Q){vis_set_jq_val="visible";}
if(vis_set==nula_Q){vis_set_jq_val="hidden";}}
if(curr_obj.need_hiddenno_set){curr_obj.need_hiddenno_set=false;need_hiddenno_set=true;if(vis_set_jq_val==""){vis_set_jq_val="visible";}}
var goto_ukaz_Q=getStrValueFromAnimStr_Q(curr_animstr,"goto",true);if(goto_ukaz_Q==""){var condgoto_ukaz_Q=getStrValueFromAnimStr_Q(curr_animstr,"condgoto");if(condgoto_ukaz_Q!=""){var arrcg=condgoto_ukaz_Q.split("?");if((arrcg.length>=2)&&(trim_Q(arrcg[1])!="")){if(calc_if_pogoj_true(arrcg[0],repl_obj)){goto_ukaz_Q=trim_Q(arrcg[1]);}}}}
if(window.edgl.argo.indexOf('*edf_printscreen_mode*')>-1){if(goto_ukaz_Q!=empty_Q){a_time=0.3;goto_ukaz_Q=empty_Q;}}
if(goto_ukaz_Q!=empty_Q){var goto_array_Q=goto_ukaz_Q.split(",");if(goto_array_Q.length==1){var goto_ind=StrToIntDef_Q(goto_array_Q[0],-1);if((goto_ind>=0)&&(goto_ind!=anim_ind)){curr_obj.anim_ind=goto_ind;ObjGoAnim_internal(animobj_id,curr_obj.anim_ind,curr_obj.anim_name);return;}}else if(goto_array_Q.length>=2){var goto_ind=StrToIntDef_Q(trim_Q(goto_array_Q[0]),-1);var goto_objid=StrToIntDef_Q(trim_Q(goto_array_Q[1]),-1);var goto_name=empty_Q;if(goto_array_Q.length>=3){goto_name=trim_Q(goto_array_Q[2]);}
if((!goto_name)||(goto_name==empty_Q)){goto_name=show_Q;}
if((goto_ind>=0)&&(goto_objid>0)){setTimeout(function(){hiddenClassAnimFunc(animobj_id,{t:3});},90);ObjGoAnim(false,false,goto_objid,goto_ind,goto_name,-1,false,'');return;}}
return;}
var run_ukaz_Q=getStrValueFromAnimStr_Q(curr_animstr,"run",true);if(run_ukaz_Q!=""){var run_array_Q=run_ukaz_Q.split(",");if(run_array_Q.length>=2){var run_ind=StrToIntDef_Q(trim_Q(run_array_Q[0]),-1);var run_objid=StrToIntDef_Q(trim_Q(run_array_Q[1]),-1);var run_name="";if(run_array_Q.length>=3){run_name=trim_Q(run_array_Q[2]);}
if((!run_name)||(run_name==empty_Q)){run_name=show_Q;}
if((run_ind>=0)&&(run_objid>0)){ObjGoAnim(false,false,run_objid,run_ind,run_name,-1,false,'');if(run_objid+""==animobj_id+""){return;}}}}
var goto_page_str_Q=getStrValueFromAnimStr_Q(curr_animstr,"gotopage");if(goto_page_str_Q==""){var condgotopage_ukaz=getStrValueFromAnimStr_Q(curr_animstr,"condgotopage");if(condgotopage_ukaz!=""){var arrcg=condgotopage_ukaz.split("?");if((arrcg.length>=2)&&(trim_Q(arrcg[1])!="")){if(calc_if_pogoj_true(trim_Q(arrcg[0]),repl_obj)){goto_page_str_Q=trim_Q(arrcg[1]);}}}}
if(goto_page_str_Q!=""){var goto_page_val_Q=getNumValueFromAnimStr_Q(goto_page_str_Q,"",0,repl_obj);var pg=0;if(goto_page_val_Q>0){window.ed.goToPage(goto_page_val_Q);return;}
if(gotoPageByStrCommand(goto_page_str_Q)){return;}}
var stop_str_val=getStrValueFromAnimStr_Q(curr_animstr,"stop");if(stop_str_val==""){var condstop_str_val=getStrValueFromAnimStr_Q(curr_animstr,"condstop");if(condstop_str_val!=""){if(calc_if_pogoj_true(condstop_str_val,repl_obj)){stop_str_val="1";}}}
if((stop_str_val!="")&&(stop_str_val!="0")&&((stop_str_val=="1")||(getNumValueFromAnimStr_Q(stop_str_val,"",-1,repl_obj)>0)))
{if(window.ed[curr_obj.iscrollid]){window.ed[curr_obj.iscrollid].refresh();}
setTimeout(function(){hiddenClassAnimFunc(animobj_id,{t:4});},90);return;}
if((false)&&(anim_ind==0)&&(curr_obj.set_step==false)){doSet_Vals_Q("step0",curr_obj,curr_img,_xset,_yset,_alphaset,_zoomset,_rotateset);curr_obj.set_step=true;curr_obj.anim_timer=setTimeout("onCustomAnimTimer("+animobj_id+");",250);return;}
curr_obj.set_step=false;/*!!!!! NE BRIŠI !!!! DEFINE RENAME IDENT anim_type */
var jq_paramset_object_Q=new Object();var jq_paramto_object_Q=new Object();var jq_img_paramset_object_Q=new Object();var jq_img_paramto_object_Q=new Object();var used_step0_and_step1_togather_Q=true;if(anim_ind==0){a_time=a_time+0.1;}
if(CAB_anim_array.length>0){for(var an=0;an<CAB_anim_array.length;an++){var tproperty=CAB_anim_array[an].p;var tvalue=CAB_anim_array[an].t;var svalue=CAB_anim_array[an].s;var special_set_0=CAB_anim_array[an].sset;if((tvalue!=n_init_v)||(svalue!=n_init_v)){if(tvalue!=n_init_v){var jq_prop=getJqueryPropForAnimProp_Q(tproperty);if(jq_prop!=""){if((tproperty=="xmask")||(tproperty=="ymask")){jq_img_paramto_object_Q[jq_prop]=tvalue;}else if(tproperty=="alpha"){jq_paramto_object_Q[jq_prop]=tvalue/100;}else if(tproperty=="zoom"){jq_paramto_object_Q[jq_prop]=tvalue/100;}else{jq_paramto_object_Q[jq_prop]=tvalue;}}}
if(svalue!=n_init_v){var jq_prop=getJqueryPropForAnimProp_Q(tproperty);if((tproperty=="xmask")||(tproperty=="ymask")){jq_img_paramset_object_Q[jq_prop]=tvalue;}else if(tproperty=="alpha"){jq_paramset_object_Q[jq_prop]=svalue/100;}else if(tproperty=="zoom"){jq_paramset_object_Q[jq_prop]=svalue/100;}else{jq_paramset_object_Q[jq_prop]=svalue;}}}}}
if(vis_set_jq_val!=""){jq_paramset_object_Q["visibility"]=vis_set_jq_val;if(vis_set_jq_val=="visible"){jq_paramset_object_Q["display"]="block";}else{jq_paramset_object_Q["display"]="none";}}
if(need_hiddenno_set){if(typeof(jq_paramset_object_Q["opacity"])=='undefined'){jq_paramset_object_Q["opacity"]=curr_obj.dalpha/100;}
if(typeof(jq_paramset_object_Q["left"])=='undefined'){jq_paramset_object_Q["left"]=curr_obj.dx;}
if(typeof(jq_paramset_object_Q["top"])=='undefined'){jq_paramset_object_Q["top"]=curr_obj.dy;}
if(typeof(jq_paramset_object_Q["scale"])=='undefined'){jq_paramset_object_Q["scale"]=curr_obj.dzoom/100;}
if(typeof(jq_paramset_object_Q["rotate"])=='undefined'){jq_paramset_object_Q["rotate"]=curr_obj.drotate;}
if(curr_obj.use_mask){if(typeof(jq_img_paramset_object_Q["xmask"])=='undefined'){jq_img_paramset_object_Q["xmask"]=curr_obj.dxmask;}
if(typeof(jq_img_paramset_object_Q["ymask"])=='undefined'){jq_img_paramset_object_Q["ymask"]=curr_obj.dymask;}}}
var opacitiy_val=$('#'+curr_obj.animDivId).css('opacity');var visibility_val=$('#'+curr_obj.animDivId).css('visibility');if(typeof(jq_paramset_object_Q["opacity"])!='undefined'){opacitiy_val=jq_paramset_object_Q["opacity"];}
if(typeof(jq_paramto_object_Q["opacity"])!='undefined'){opacitiy_val=jq_paramto_object_Q["opacity"];}
if(typeof(jq_paramset_object_Q["visibility"])!='undefined'){visibility_val=jq_paramset_object_Q["visibility"];}
curr_obj.imgvisible_forlink=((opacitiy_val>0.0001)&&(visibility_val=="visible"));$('#'+curr_obj.animDivId).stop();var tmp_curr_xmask=n_init_v;var tmp_curr_ymask=n_init_v;if(!is_object_empty_Q(jq_img_paramset_object_Q)){if(typeof(jq_img_paramset_object_Q["xmask"])=='undefined'){jq_img_paramset_object_Q["xmask"]=curr_obj.cxmask;}
if(typeof(jq_img_paramset_object_Q["ymask"])=='undefined'){jq_img_paramset_object_Q["ymask"]=curr_obj.cymask;}
tmp_curr_xmask=jq_img_paramset_object_Q["xmask"];tmp_curr_ymask=jq_img_paramset_object_Q["ymask"];}
if(!is_object_empty_Q(jq_img_paramto_object_Q)){if(typeof(jq_img_paramto_object_Q["xmask"])=='undefined'){jq_img_paramto_object_Q["xmask"]=curr_obj.cxmask;}
if(typeof(jq_img_paramto_object_Q["ymask"])=='undefined'){jq_img_paramto_object_Q["ymask"]=curr_obj.cymask;}
tmp_curr_xmask=jq_img_paramto_object_Q["xmask"];tmp_curr_ymask=jq_img_paramto_object_Q["ymask"];}
if(tmp_curr_xmask!=n_init_v){curr_obj.cxmask=tmp_curr_xmask;}
if(tmp_curr_ymask!=n_init_v){curr_obj.cymask=tmp_curr_ymask;}
if((a_time>0.09)&&(isPause==false)&&((!is_object_empty_Q(jq_paramto_object_Q))||(!is_object_empty_Q(jq_img_paramto_object_Q)))){var anim_type=getStrValueFromAnimStr_Q(curr_animstr,"animtype",true);var timing_func="ease";if(anim_type!=empty_Q){if(anim_type=="linear"){timing_func="linear";}
if(anim_type=="easeout"){timing_func="ease-out";}
if(anim_type=="easein"){timing_func="ease-in";}
if(anim_type=="easeineaseout"){timing_func="ease-in-out";}}
if(window.ed.debugAnimations){console.log(jq_paramset_object_Q);}
if(window.ed.debugAnimations){console.log(jq_paramto_object_Q);}
var jq_time=Math.round(1000*a_time);if(curr_obj.animcheck_timer){clearTimeout(curr_obj.animcheck_timer);}
if(window.edgl.argo.indexOf('*billy*')>-1){console.log("jq_paramset_object_Q");console.log(jq_paramset_object_Q);}
hiddenClassAnimFunc(animobj_id,jq_paramto_object_Q,jq_paramset_object_Q);if(anim_type=='elastic'||anim_type=='bounce'||anim_type=='back')
{var steps;switch(anim_type)
{case'bounce':steps=[{time:0.5,val:1,easing:'ease-in'},{time:0.13,val:0.76,easing:'ease-out'},{time:0.13,val:1,easing:'ease-in'},{time:0.08,val:0.91,easing:'ease-out'},{time:0.08,val:1,easing:'ease-in'},{time:0.04,val:0.98,easing:'ease-out'},{time:0.04,val:1,easing:'ease-in'}];break;case'elastic':steps=[{time:0.44,val:1.07,easing:'ease-in-out'},{time:0.21,val:0.9,easing:'ease-in-out'},{time:0.17,val:1.03,easing:'ease-in-out'},{time:0.13,val:.97,easing:'ease-in-out'},{time:0.13,val:1,easing:'ease-in-out'},];break;case'back':steps=[{time:0.8,val:1.17,easing:'ease-in-out'},{time:0.13,val:1,easing:'ease-in-out'},];break;}
var obj=$('#'+curr_obj.animDivId);var curVals={};if(jq_paramto_object_Q.top!=undefined)
{curVals.top=parseFloat(obj.css('top'));}
if(jq_paramto_object_Q.left!=undefined)
{curVals.left=parseFloat(obj.css('left'));}
if(jq_paramto_object_Q.scale!=undefined)
{curVals.scale=parseFloat(obj.css('scale'));}
if(jq_paramto_object_Q.rotate!=undefined)
{curVals.rotate=parseFloat(obj.css('rotate'));}
if(jq_paramto_object_Q.opacity!=undefined)
{curVals.opacity=parseFloat(obj.css('opacity'));}
obj.css(jq_paramset_object_Q);animateStep(obj,0,steps,steps.length,jq_time,animobj_id,anim_ind,anim_name);function animateStep(obj,i,steps,stepsLength,time,animobj_id,anim_ind,anim_name)
{jtrace('i',i);var aim={};if(jq_paramto_object_Q.top!=undefined)
{aim.top=curVals.top+(jq_paramto_object_Q.top-curVals.top)*steps[i].val;}
if(jq_paramto_object_Q.left!=undefined)
{aim.left=curVals.left+(jq_paramto_object_Q.left-curVals.left)*steps[i].val;}
if(jq_paramto_object_Q.scale!=undefined)
{aim.scale=curVals.scale+(jq_paramto_object_Q.scale-curVals.scale)*steps[i].val;}
if(jq_paramto_object_Q.rotate!=undefined)
{aim.rotate=curVals.rotate+(jq_paramto_object_Q.rotate-curVals.rotate)*steps[i].val;}
if(jq_paramto_object_Q.opacity!=undefined)
{aim.opacity=curVals.opacity+(jq_paramto_object_Q.opacity-curVals.opacity)*steps[i].val;}
obj.transStop().transition(aim,time*steps[i].time,steps[i].easing,function(){if(i<stepsLength-1)
{animateStep(obj,i+1,steps,stepsLength,time,animobj_id,anim_ind,anim_name)}
else
{onAnimEndEventV2(animobj_id,anim_ind,anim_name)}});}}
else
{$('#'+curr_obj.animDivId).css(jq_paramset_object_Q).transStop().transition(jq_paramto_object_Q,jq_time,timing_func,function(){eval("onAnimEndEventV2("+animobj_id+","+anim_ind+",'"+anim_name+"');");});}
if(!is_object_empty_Q(jq_img_paramto_object_Q)){var clip_rect_to_Q=new Object();var txm=parseInt(jq_img_paramto_object_Q["xmask"],10);var tym=parseInt(jq_img_paramto_object_Q["ymask"],10);clip_rect_to_Q["clip"]='rect('+tym+'px '+(txm+curr_obj.w)+'px '+(tym+curr_obj.h)+'px '+(txm)+'px)';var clip_rect_set_Q=new Object();if(!is_object_empty_Q(jq_img_paramset_object_Q)){var txm=parseInt(jq_img_paramset_object_Q["xmask"],10);var tym=parseInt(jq_img_paramset_object_Q["ymask"],10);clip_rect_set_Q["clip"]='rect('+tym+'px '+(txm+curr_obj.w)+'px '+(tym+curr_obj.h)+'px '+(txm)+'px)';}}}else{if(window.ed.debugAnimations){console.log("SET OBJECT CSS PREDD ");console.log(jq_paramset_object_Q);}
if(!is_object_empty_Q(jq_paramset_object_Q)){if(window.ed.debugAnimations){console.log("SET OBJECT CSS ");console.log(jq_paramset_object_Q);}
$('#'+curr_obj.animDivId).css(jq_paramset_object_Q);}
if(!is_object_empty_Q(jq_img_paramset_object_Q)){var clip_rect_set_Q=new Object();var txm=parseInt(jq_img_paramset_object_Q["xmask"],10);var tym=parseInt(jq_img_paramset_object_Q["ymask"],10);clip_rect_set_Q["clip"]='rect('+tym+'px '+(txm+curr_obj.w)+'px '+(tym+curr_obj.h)+'px '+(txm)+'px)';}
if(a_time<0.09){curr_obj.anim_ind++;ObjGoAnim_internal(animobj_id,curr_obj.anim_ind,curr_obj.anim_name);}else{if(curr_obj.anim_timer){clearTimeout(curr_obj.anim_timer);curr_obj.anim_timer=false;}
setTimeout(function(){hiddenClassAnimFunc(animobj_id,{},jq_paramset_object_Q);},90);curr_obj.anim_timer=setTimeout("onCustomAnimTimer("+animobj_id+")",Math.round(a_time*1000));}}}
;
﻿function ObjGoAnim(ExtReq,fromOnLoadEvt,animobj_id,anim_ind,anim_name,pageNum,fromLink,ignore_hide_list){if(typeof(ignore_hide_list)=='undefined'){ignore_hide_list="";}
if((window.ed.debugAnimations)||(window.ed.debugLinks)){console.log("$$$$$%%%%%$$$ ObjGoAnim "+animobj_id+" ## ext:"+ExtReq+", onlEv:"+fromOnLoadEvt+", id:"+animobj_id+", ind:"+anim_ind+", nm:"+anim_name+", pg:"+pageNum+", ftomLnk:"+fromLink+",  ignore_hide_list:"+ignore_hide_list+" ");}
if(animobj_id>0){var curr_obj=anim_objects[animobj_id];if(curr_obj){if(!curr_obj.preloaded){}}}
if(animobj_id>0){var curr_obj=anim_objects[animobj_id];var curr_img=false;if(curr_obj){if(curr_obj.animDivId){curr_img=document.getElementById(curr_obj.animDivId);}}
if((curr_obj)&&(curr_img)){if(anim_name=="och"){if(curr_obj.closeonclick){if((curr_obj.preloaded)&&(curr_obj.inited_obj)&&($('#'+curr_obj.animDivId).css('opacity')>0.0001)&&($('#'+curr_obj.animDivId).css("visibility")=="visible")){curr_obj.anim_name="hide";curr_obj.anim_ind=0;ObjGoAnim_internal(animobj_id,curr_obj.anim_ind,curr_obj.anim_name);}else{$('#'+curr_obj.animDivId).css({"visibility":"hidden","display":"none"});curr_obj.need_hiddenno_set=true;window.ed.freeShowObject(animobj_id);}
return;}else{return;}}}
if((curr_obj)&&(curr_img)){if(fromLink&&(anim_name!="hide")){var ign_str_Q="";for(var curr2_id in anim_objects){var curr2_obj=anim_objects[curr2_id];if(curr2_obj.ignore_autohide){ign_str_Q=ign_str_Q+","+curr2_id;}}
hideAllConnectedImages_Q(animobj_id,"",0,ignore_hide_list+ign_str_Q);}}
if(curr_obj&&(curr_img)){if(!curr_obj.preloaded){if(anim_name=="hide"){return;}else{if(anim_name!="ns"){curr_obj.anim_name="show";}
if((anim_ind!=-11)){curr_obj.anim_ind=Math.max(anim_ind,0);}
if(!fromOnLoadEvt){window.ed.loadImageFromAnim(animobj_id);}else{}
return;}}else{if(anim_name=="hide"){if(curr_obj){if((curr_obj.preloaded)&&(curr_obj.inited_obj)&&($('#'+curr_obj.animDivId).css('opacity')>0.0001)&&($('#'+curr_obj.animDivId).css("visibility")=="visible")){curr_obj.anim_name="hide";curr_obj.anim_ind=Math.max(anim_ind,0);ObjGoAnim_internal(animobj_id,curr_obj.anim_ind,curr_obj.anim_name);}else{$('#'+curr_obj.animDivId).css({"visibility":"hidden","display":"none"});curr_obj.need_hiddenno_set=true;window.ed.freeShowObject(animobj_id);}}
return;}else{if(!curr_obj.inited_obj){animobj_init(animobj_id);}
if(anim_name!="ns"){curr_obj.anim_name="show";}
if((anim_ind!=-11)){curr_obj.anim_ind=Math.max(anim_ind,0);}
ObjGoAnim_internal(animobj_id,curr_obj.anim_ind,curr_obj.anim_name);return;}}}}
if((animobj_id==-11)&&(anim_name==show_Q)){if(window.ed.debugAnimations){console.log(anim_objects);}
parentAnimShowFunc(false);for(var curr_id in anim_objects){var curr_obj=anim_objects[curr_id];var curr_img=document.getElementById(curr_obj.animDivId);if((curr_img)&&(!curr_obj.connected)){if(curr_obj.preloaded){animobj_init(curr_obj.id);ObjGoAnim_internal(curr_obj.id,curr_obj.anim_ind,curr_obj.anim_name);}else{window.ed.loadImageFromAnim(curr_obj.id);}}}
InitAllLinks_Q();}
if((animobj_id==-11)&&(anim_name==show_Q)&&false){for(var curr_id in anim_objects){var curr_obj=anim_objects[curr_id];if(curr_obj){if(curr_obj.animcheck_timer){clearTimeout(curr_obj.animcheck_timer);}
$('#'+curr_obj.animDivId).stop(true,true);$('#'+curr_obj.animDivId).css({"opacity":"0.0001","scale":"1","rotate":"0"});curr_obj.force_stop_anim=true;}}}}
;
function _user_bookmarks_user_exists(){if(window.edgl.token&&window.edgl.token_user_id&&window.edgl.token_user_id!='0'){return true;}
return false;}
function bident_randomString(){var length=10;var chars='abcdefghijklmnopqrstuvwxyz0123456789';var result='';for(var i=length;i>0;--i)result+=chars[Math.floor(Math.random()*chars.length)];return result;}
function get_local_user_bookmarks(cb_funct){var ls_key='usrbm32_'+window.edgl.edition.edident;if(isApp()){window.webapp.appAction({action:'app.storage_get',key:ls_key},function(app_local_obj_plus){if(!app_local_obj_plus.value){app_local_obj_plus.value={}}else{app_local_obj_plus.value=JSON.parse(app_local_obj_plus.value);}
cb_funct(app_local_obj_plus);});}else{if(typeof(Storage)!=="undefined"){var ls_data=localStorage.getItem(ls_key);if(!ls_data){ls_data={};}else{ls_data=JSON.parse(ls_data);}
cb_funct({key:ls_key,value:ls_data});}else{console.log('Sorry! No Web Storage support..')}}}
function set_local_user_bookmarks(data,cb_funct_set){var ls_key='usrbm32_'+window.edgl.edition.edident;if(isApp()){window.webapp.appAction({action:'app.storage_set',key:ls_key,value:JSON.stringify(data)},function(app_local_obj_plus){if(!app_local_obj_plus.value){app_local_obj_plus.value={}}else{app_local_obj_plus.value=JSON.parse(app_local_obj_plus.value);}
cb_funct_set(app_local_obj_plus);});}else{if(typeof(Storage)!=="undefined"){localStorage.setItem(ls_key,JSON.stringify(data));if(cb_funct_set){cb_funct_set({key:ls_key,value:data});}}else{console.log('Sorry! No Web Storage support..')
if(cb_funct_set){cb_funct_set({key:ls_key,value:null});}}}}
window._last_ubm_sync_datetime='';function sync_web_user_bookmarks(sync_data,cb_funct_web){if(isApp()){var sync_data_str=JSON.stringify(sync_data);var rpl_from="\\";var repl_to="QRPBS";sync_data_str=sync_data_str.split(rpl_from).join(repl_to);var rpl_from="\'";var repl_to="QRPQT";sync_data_str=sync_data_str.split(rpl_from).join(repl_to);var rpl_from="\"";var repl_to="QRPDQ";sync_data_str=sync_data_str.split(rpl_from).join(repl_to);var data_for_sending=JSON.stringify({"edident":window.edgl.edition.edident,last_ubm_sync_datetime:window._last_ubm_sync_datetime,"data":sync_data_str});window.webapp.appAction({action:'app.edition_user_bookmarks',data:data_for_sending},cb_funct_web);}else{if(typeof(Storage)!=="undefined"){if(_user_bookmarks_user_exists()){$.ajax({url:'https://request.editiondigital.com/rq/ed_user_bookmarks.php?action=set',type:'post',data:{token:window.edgl.token,edident:window.edgl.edition.edident,last_ubm_sync_datetime:window._last_ubm_sync_datetime,data:JSON.stringify(sync_data)},success:function(data,textStatus,jQxhr){cb_funct_web(JSON.parse(data));},error:function(jqXhr,textStatus,errorThrown){console.log(errorThrown);}});}else{cb_funct_web({"error":1,"msg":"user_not_logged_in"});}}else{console.log('Sorry! No Web Storage support..')}}}
first_time_callback_ubaed=true;function callback_user_bookmarks_add_edit_delete(local_obj_changed){for(var o in local_obj_changed){break;}
var added=false;var changed=false;for(var key in local_obj_changed){if(!local_obj_changed.hasOwnProperty(key)){continue}
var found=false;for(var jb in EDO.bookmarks){if(EDO.bookmarks[jb].bident==key){for(var lp in local_obj_changed[key]){if(EDO.bookmarks[jb][lp]!=local_obj_changed[key][lp]){EDO.bookmarks[jb][lp]=local_obj_changed[key][lp];changed=true;}}
found=true;break;}}
if(!found){local_obj_changed[key].bident=key;EDO.bookmarks.push(local_obj_changed[key]);added=true;}}
if((added||changed)&&(first_time_callback_ubaed)){bookmarksChanged();freebm.drawPage(undefined,undefined,'callback_user_bookmarks_add_edit_delete');}
first_time_callback_ubaed=false;}
function user_bookmarks_add_edit_delete(data_obj){get_local_user_bookmarks(function(local_obj_plus){var local_obj=local_obj_plus.value;var d=new Date();var curr_seconds=Math.round(d.getTime()/ 1000);for(var bident in data_obj){if(!local_obj[bident+'']){local_obj[bident+'']=new Object();var mmm=1;local_obj[bident+'']['del']=0;}
for(var obd in data_obj[bident]){if(obd=='del'){if(data_obj[bident][obd]+''=='1'){data_obj[bident][obd]=1;}else{data_obj[bident][obd]=0;}}
local_obj[bident][obd]=data_obj[bident][obd];}
local_obj[bident]['sync']=0;local_obj[bident]['epoch']=curr_seconds;}
set_local_user_bookmarks(local_obj,function(local_obj_plus){var sync_data={};for(var bident in local_obj){if(!local_obj[bident].sync){sync_data[bident]={};for(var obd in local_obj[bident]){if(obd=='epoch'){sync_data[bident]['epoch']=curr_seconds-local_obj[bident]['epoch'];}else{sync_data[bident][obd]=local_obj[bident][obd];}}}}
sync_web_user_bookmarks(sync_data,function(response_data){if(response_data.error+''=='1'){console.log('sync_web_user_bookmarks ERR: '+response_data.msg);return;}
if(response_data.last_ubm_sync_datetime){window._last_ubm_sync_datetime=response_data.last_ubm_sync_datetime;}
var local_changes=false;var local_changes_backend=false;var local_changes_obj={};for(var bident in response_data.data){var one=response_data.data[bident];var this_obj=false;if(!local_obj[bident]){local_obj[bident]={};local_changes=true;this_obj={};}
for(var obd in one){if((obd=='epoch')||(obd=='sync')||(obd=='bident')){continue;}
if(local_obj[bident][obd]!=one[obd]){local_obj[bident][obd]=one[obd];if(!this_obj){this_obj={};}
this_obj[obd]=one[obd];local_changes=true;}}
if(!local_obj[bident].sync){local_obj[bident].sync=1;local_changes_backend=true;}
if(this_obj){local_changes_obj[bident]=this_obj;}}
if(local_changes_backend||local_changes){set_local_user_bookmarks(local_obj,function(local_obj_plus){callback_user_bookmarks_add_edit_delete(local_changes_obj);});}else{callback_user_bookmarks_add_edit_delete(local_changes_obj);}});});});}
function user_bookmarks_list(cb_list_ubm){window._last_ubm_sync_datetime='';get_local_user_bookmarks(function(local_obj_plus){var local_obj=local_obj_plus.value;cb_list_ubm(local_obj);setTimeout(function(){user_bookmarks_add_edit_delete({});},100);});}
;
if(typeof(window.edgl)=='object'){if(window.edgl.argo.indexOf('*test_errors*')!=-1){setTimeout(function(){ed_error_testing_developers_editiondigital__html5();},2000);setTimeout(function(){var i=100;var d=0;console.log((i/d));},2100);}}
;
setTimeout(function(){if(typeof(ed_js_ready_file)=="function"){ed_js_ready_file("player");}else{console.log("function ed_js_ready_file not defined");}},100);
;
